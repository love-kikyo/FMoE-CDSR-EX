gate_loss
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 09:40:49,255 | Running with the following configs:
	domains : ['Food', 'Kitchen', 'Clothing', 'Beauty']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 60
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 10
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 1.0
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/4 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 09:41:35,951 | Epoch 1/60 - client 1 -  Training Loss: 48.812

 25%|##5       | 1/4 [00:46<02:19, 46.65s/it]2025-08-27 09:41:48,283 | Epoch 1/60 - client 0 -  Training Loss: 44.516

 50%|#####     | 2/4 [00:58<00:52, 26.46s/it]2025-08-27 09:42:04,851 | Epoch 1/60 - client 2 -  Training Loss: 50.632

 75%|#######5  | 3/4 [01:15<00:21, 21.94s/it]2025-08-27 09:42:16,838 | Epoch 1/60 - client 3 -  Training Loss: 50.232

100%|##########| 4/4 [01:27<00:00, 18.01s/it]
100%|##########| 4/4 [01:27<00:00, 21.88s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 09:42:20,717 | Epoch1 Valid:
2025-08-27 09:42:20,718 | domain:Food
2025-08-27 09:42:20,718 | model_moe:
2025-08-27 09:42:20,718 | MRR: 0.2808
2025-08-27 09:42:20,719 | HR @1|5|10: 0.1890 	 0.3910 	 0.4782 	
2025-08-27 09:42:20,719 | NDCG @5|10: 0.2939 	 0.3223
2025-08-27 09:42:20,719 | domain:Kitchen
2025-08-27 09:42:20,720 | model_moe:
2025-08-27 09:42:20,720 | MRR: 0.0450
2025-08-27 09:42:20,720 | HR @1|5|10: 0.0170 	 0.0585 	 0.0939 	
2025-08-27 09:42:20,720 | NDCG @5|10: 0.0377 	 0.0491
2025-08-27 09:42:20,721 | domain:Clothing
2025-08-27 09:42:20,721 | model_moe:
2025-08-27 09:42:20,721 | MRR: 0.0113
2025-08-27 09:42:20,722 | HR @1|5|10: 0.0037 	 0.0110 	 0.0159 	
2025-08-27 09:42:20,722 | NDCG @5|10: 0.0071 	 0.0086
2025-08-27 09:42:20,722 | domain:Beauty
2025-08-27 09:42:20,722 | model_moe:
2025-08-27 09:42:20,723 | MRR: 0.1430
2025-08-27 09:42:20,723 | HR @1|5|10: 0.0885 	 0.1854 	 0.2584 	
2025-08-27 09:42:20,723 | NDCG @5|10: 0.1387 	 0.1621
2025-08-27 09:42:20,723 | 	avg_model_moe:
2025-08-27 09:42:20,724 | MRR: 0.1200
2025-08-27 09:42:20,724 | HR @1|5|10: 0.0746 	 0.1615 	 0.2116 	
2025-08-27 09:42:20,724 | NDCG @5|10: 0.1194 	 0.1355
2025-08-27 09:42:20,725 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:42:39,720 | Epoch 2/60 - client 2 -  Training Loss: 48.571

 25%|##5       | 1/4 [00:16<00:49, 16.37s/it]2025-08-27 09:42:51,675 | Epoch 2/60 - client 3 -  Training Loss: 47.910

 50%|#####     | 2/4 [00:28<00:27, 13.77s/it]2025-08-27 09:43:22,174 | Epoch 2/60 - client 1 -  Training Loss: 48.101

 75%|#######5  | 3/4 [00:58<00:21, 21.41s/it]2025-08-27 09:43:34,448 | Epoch 2/60 - client 0 -  Training Loss: 42.598

100%|##########| 4/4 [01:11<00:00, 17.80s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 09:43:38,331 | Epoch2 Valid:
2025-08-27 09:43:38,331 | domain:Food
2025-08-27 09:43:38,331 | model_moe:
2025-08-27 09:43:38,332 | MRR: 0.3077
2025-08-27 09:43:38,332 | HR @1|5|10: 0.2096 	 0.4231 	 0.5096 	
2025-08-27 09:43:38,332 | NDCG @5|10: 0.3226 	 0.3508
2025-08-27 09:43:38,333 | domain:Kitchen
2025-08-27 09:43:38,333 | model_moe:
2025-08-27 09:43:38,333 | MRR: 0.0697
2025-08-27 09:43:38,333 | HR @1|5|10: 0.0318 	 0.0944 	 0.1386 	
2025-08-27 09:43:38,334 | NDCG @5|10: 0.0631 	 0.0773
2025-08-27 09:43:38,334 | domain:Clothing
2025-08-27 09:43:38,334 | model_moe:
2025-08-27 09:43:38,334 | MRR: 0.0247
2025-08-27 09:43:38,335 | HR @1|5|10: 0.0134 	 0.0244 	 0.0367 	
2025-08-27 09:43:38,335 | NDCG @5|10: 0.0191 	 0.0229
2025-08-27 09:43:38,335 | domain:Beauty
2025-08-27 09:43:38,336 | model_moe:
2025-08-27 09:43:38,336 | MRR: 0.1793
2025-08-27 09:43:38,336 | HR @1|5|10: 0.1100 	 0.2536 	 0.3301 	
2025-08-27 09:43:38,336 | NDCG @5|10: 0.1841 	 0.2086
2025-08-27 09:43:38,337 | 	avg_model_moe:
2025-08-27 09:43:38,337 | MRR: 0.1453
2025-08-27 09:43:38,337 | HR @1|5|10: 0.0912 	 0.1989 	 0.2537 	
2025-08-27 09:43:38,338 | NDCG @5|10: 0.1472 	 0.1649
2025-08-27 09:43:38,338 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:43:57,019 | Epoch 3/60 - client 2 -  Training Loss: 46.777

 25%|##5       | 1/4 [00:16<00:49, 16.54s/it]2025-08-27 09:44:28,097 | Epoch 3/60 - client 1 -  Training Loss: 47.319

 50%|#####     | 2/4 [00:47<00:50, 25.09s/it]2025-08-27 09:44:40,464 | Epoch 3/60 - client 0 -  Training Loss: 41.301

 75%|#######5  | 3/4 [00:59<00:19, 19.28s/it]2025-08-27 09:44:52,493 | Epoch 3/60 - client 3 -  Training Loss: 46.195

100%|##########| 4/4 [01:12<00:00, 16.42s/it]
100%|##########| 4/4 [01:12<00:00, 18.00s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 09:44:56,376 | Epoch3 Valid:
2025-08-27 09:44:56,376 | domain:Food
2025-08-27 09:44:56,377 | model_moe:
2025-08-27 09:44:56,377 | MRR: 0.3188
2025-08-27 09:44:56,377 | HR @1|5|10: 0.2150 	 0.4445 	 0.5233 	
2025-08-27 09:44:56,377 | NDCG @5|10: 0.3375 	 0.3635
2025-08-27 09:44:56,378 | domain:Kitchen
2025-08-27 09:44:56,378 | model_moe:
2025-08-27 09:44:56,378 | MRR: 0.0751
2025-08-27 09:44:56,378 | HR @1|5|10: 0.0355 	 0.1022 	 0.1506 	
2025-08-27 09:44:56,379 | NDCG @5|10: 0.0691 	 0.0846
2025-08-27 09:44:56,379 | domain:Clothing
2025-08-27 09:44:56,379 | model_moe:
2025-08-27 09:44:56,380 | MRR: 0.0242
2025-08-27 09:44:56,380 | HR @1|5|10: 0.0122 	 0.0232 	 0.0416 	
2025-08-27 09:44:56,380 | NDCG @5|10: 0.0182 	 0.0240
2025-08-27 09:44:56,380 | domain:Beauty
2025-08-27 09:44:56,381 | model_moe:
2025-08-27 09:44:56,381 | MRR: 0.2062
2025-08-27 09:44:56,381 | HR @1|5|10: 0.1364 	 0.2799 	 0.3481 	
2025-08-27 09:44:56,382 | NDCG @5|10: 0.2111 	 0.2337
2025-08-27 09:44:56,382 | 	avg_model_moe:
2025-08-27 09:44:56,382 | MRR: 0.1560
2025-08-27 09:44:56,382 | HR @1|5|10: 0.0998 	 0.2125 	 0.2659 	
2025-08-27 09:44:56,383 | NDCG @5|10: 0.1590 	 0.1765
2025-08-27 09:44:56,383 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:45:14,564 | Epoch 4/60 - client 2 -  Training Loss: 45.230

 25%|##5       | 1/4 [00:16<00:49, 16.35s/it]2025-08-27 09:45:26,451 | Epoch 4/60 - client 3 -  Training Loss: 44.875

 50%|#####     | 2/4 [00:28<00:27, 13.72s/it]2025-08-27 09:45:38,656 | Epoch 4/60 - client 0 -  Training Loss: 40.264

 75%|#######5  | 3/4 [00:40<00:13, 13.03s/it]2025-08-27 09:46:08,946 | Epoch 4/60 - client 1 -  Training Loss: 46.310

100%|##########| 4/4 [01:10<00:00, 19.84s/it]
100%|##########| 4/4 [01:10<00:00, 17.68s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 09:46:12,775 | Epoch4 Valid:
2025-08-27 09:46:12,775 | domain:Food
2025-08-27 09:46:12,776 | model_moe:
2025-08-27 09:46:12,776 | MRR: 0.3275
2025-08-27 09:46:12,776 | HR @1|5|10: 0.2242 	 0.4598 	 0.5203 	
2025-08-27 09:46:12,776 | NDCG @5|10: 0.3494 	 0.3693
2025-08-27 09:46:12,777 | domain:Kitchen
2025-08-27 09:46:12,777 | model_moe:
2025-08-27 09:46:12,777 | MRR: 0.0808
2025-08-27 09:46:12,778 | HR @1|5|10: 0.0424 	 0.1064 	 0.1542 	
2025-08-27 09:46:12,778 | NDCG @5|10: 0.0745 	 0.0898
2025-08-27 09:46:12,778 | domain:Clothing
2025-08-27 09:46:12,778 | model_moe:
2025-08-27 09:46:12,779 | MRR: 0.0267
2025-08-27 09:46:12,779 | HR @1|5|10: 0.0147 	 0.0293 	 0.0391 	
2025-08-27 09:46:12,779 | NDCG @5|10: 0.0224 	 0.0255
2025-08-27 09:46:12,779 | domain:Beauty
2025-08-27 09:46:12,780 | model_moe:
2025-08-27 09:46:12,780 | MRR: 0.2147
2025-08-27 09:46:12,780 | HR @1|5|10: 0.1447 	 0.2943 	 0.3600 	
2025-08-27 09:46:12,780 | NDCG @5|10: 0.2221 	 0.2433
2025-08-27 09:46:12,781 | 	avg_model_moe:
2025-08-27 09:46:12,781 | MRR: 0.1624
2025-08-27 09:46:12,781 | HR @1|5|10: 0.1065 	 0.2224 	 0.2684 	
2025-08-27 09:46:12,782 | NDCG @5|10: 0.1671 	 0.1820
2025-08-27 09:46:12,782 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:46:27,037 | Epoch 5/60 - client 0 -  Training Loss: 39.439

 25%|##5       | 1/4 [00:12<00:36, 12.17s/it]2025-08-27 09:46:43,343 | Epoch 5/60 - client 2 -  Training Loss: 43.937

 50%|#####     | 2/4 [00:28<00:29, 14.60s/it]2025-08-27 09:47:13,542 | Epoch 5/60 - client 1 -  Training Loss: 45.342

 75%|#######5  | 3/4 [00:58<00:21, 21.72s/it]2025-08-27 09:47:25,420 | Epoch 5/60 - client 3 -  Training Loss: 43.805

100%|##########| 4/4 [01:10<00:00, 17.84s/it]
100%|##########| 4/4 [01:10<00:00, 17.64s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 09:47:29,271 | Epoch5 Valid:
2025-08-27 09:47:29,272 | domain:Food
2025-08-27 09:47:29,272 | model_moe:
2025-08-27 09:47:29,272 | MRR: 0.3331
2025-08-27 09:47:29,273 | HR @1|5|10: 0.2303 	 0.4637 	 0.5241 	
2025-08-27 09:47:29,273 | NDCG @5|10: 0.3548 	 0.3747
2025-08-27 09:47:29,273 | domain:Kitchen
2025-08-27 09:47:29,273 | model_moe:
2025-08-27 09:47:29,274 | MRR: 0.0862
2025-08-27 09:47:29,274 | HR @1|5|10: 0.0465 	 0.1146 	 0.1593 	
2025-08-27 09:47:29,274 | NDCG @5|10: 0.0808 	 0.0951
2025-08-27 09:47:29,275 | domain:Clothing
2025-08-27 09:47:29,275 | model_moe:
2025-08-27 09:47:29,275 | MRR: 0.0278
2025-08-27 09:47:29,275 | HR @1|5|10: 0.0183 	 0.0244 	 0.0391 	
2025-08-27 09:47:29,276 | NDCG @5|10: 0.0215 	 0.0261
2025-08-27 09:47:29,276 | domain:Beauty
2025-08-27 09:47:29,276 | model_moe:
2025-08-27 09:47:29,276 | MRR: 0.2216
2025-08-27 09:47:29,277 | HR @1|5|10: 0.1507 	 0.3038 	 0.3672 	
2025-08-27 09:47:29,277 | NDCG @5|10: 0.2302 	 0.2510
2025-08-27 09:47:29,277 | 	avg_model_moe:
2025-08-27 09:47:29,278 | MRR: 0.1672
2025-08-27 09:47:29,278 | HR @1|5|10: 0.1115 	 0.2266 	 0.2724 	
2025-08-27 09:47:29,278 | NDCG @5|10: 0.1718 	 0.1867
2025-08-27 09:47:29,278 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:48:02,091 | Epoch 6/60 - client 1 -  Training Loss: 44.274

 25%|##5       | 1/4 [00:30<01:31, 30.37s/it]2025-08-27 09:48:18,458 | Epoch 6/60 - client 2 -  Training Loss: 42.674

 50%|#####     | 2/4 [00:46<00:44, 22.13s/it]2025-08-27 09:48:30,677 | Epoch 6/60 - client 0 -  Training Loss: 38.659

 75%|#######5  | 3/4 [00:58<00:17, 17.61s/it]2025-08-27 09:48:42,582 | Epoch 6/60 - client 3 -  Training Loss: 42.778

100%|##########| 4/4 [01:10<00:00, 15.36s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 09:48:46,460 | Epoch6 Valid:
2025-08-27 09:48:46,461 | domain:Food
2025-08-27 09:48:46,461 | model_moe:
2025-08-27 09:48:46,461 | MRR: 0.3350
2025-08-27 09:48:46,462 | HR @1|5|10: 0.2326 	 0.4637 	 0.5256 	
2025-08-27 09:48:46,462 | NDCG @5|10: 0.3563 	 0.3767
2025-08-27 09:48:46,462 | domain:Kitchen
2025-08-27 09:48:46,463 | model_moe:
2025-08-27 09:48:46,463 | MRR: 0.0883
2025-08-27 09:48:46,463 | HR @1|5|10: 0.0470 	 0.1179 	 0.1602 	
2025-08-27 09:48:46,463 | NDCG @5|10: 0.0833 	 0.0968
2025-08-27 09:48:46,464 | domain:Clothing
2025-08-27 09:48:46,464 | model_moe:
2025-08-27 09:48:46,464 | MRR: 0.0239
2025-08-27 09:48:46,464 | HR @1|5|10: 0.0122 	 0.0281 	 0.0379 	
2025-08-27 09:48:46,465 | NDCG @5|10: 0.0202 	 0.0233
2025-08-27 09:48:46,465 | domain:Beauty
2025-08-27 09:48:46,465 | model_moe:
2025-08-27 09:48:46,465 | MRR: 0.2234
2025-08-27 09:48:46,466 | HR @1|5|10: 0.1507 	 0.3158 	 0.3696 	
2025-08-27 09:48:46,466 | NDCG @5|10: 0.2355 	 0.2529
2025-08-27 09:48:46,466 | 	avg_model_moe:
2025-08-27 09:48:46,467 | MRR: 0.1677
2025-08-27 09:48:46,467 | HR @1|5|10: 0.1106 	 0.2314 	 0.2733 	
2025-08-27 09:48:46,467 | NDCG @5|10: 0.1738 	 0.1875
2025-08-27 09:48:46,467 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:49:01,002 | Epoch 7/60 - client 0 -  Training Loss: 37.965

 25%|##5       | 1/4 [00:12<00:37, 12.34s/it]2025-08-27 09:49:12,907 | Epoch 7/60 - client 3 -  Training Loss: 41.869

 50%|#####     | 2/4 [00:24<00:24, 12.09s/it]2025-08-27 09:49:29,225 | Epoch 7/60 - client 2 -  Training Loss: 41.505

 75%|#######5  | 3/4 [00:40<00:14, 14.02s/it]2025-08-27 09:49:59,531 | Epoch 7/60 - client 1 -  Training Loss: 43.256

100%|##########| 4/4 [01:10<00:00, 20.45s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 09:50:03,619 | Epoch7 Valid:
2025-08-27 09:50:03,620 | domain:Food
2025-08-27 09:50:03,620 | model_moe:
2025-08-27 09:50:03,620 | MRR: 0.3337
2025-08-27 09:50:03,621 | HR @1|5|10: 0.2295 	 0.4675 	 0.5279 	
2025-08-27 09:50:03,621 | NDCG @5|10: 0.3569 	 0.3767
2025-08-27 09:50:03,621 | domain:Kitchen
2025-08-27 09:50:03,622 | model_moe:
2025-08-27 09:50:03,622 | MRR: 0.0903
2025-08-27 09:50:03,622 | HR @1|5|10: 0.0474 	 0.1234 	 0.1667 	
2025-08-27 09:50:03,622 | NDCG @5|10: 0.0865 	 0.1004
2025-08-27 09:50:03,623 | domain:Clothing
2025-08-27 09:50:03,623 | model_moe:
2025-08-27 09:50:03,623 | MRR: 0.0271
2025-08-27 09:50:03,623 | HR @1|5|10: 0.0171 	 0.0293 	 0.0379 	
2025-08-27 09:50:03,624 | NDCG @5|10: 0.0229 	 0.0258
2025-08-27 09:50:03,624 | domain:Beauty
2025-08-27 09:50:03,624 | model_moe:
2025-08-27 09:50:03,625 | MRR: 0.2247
2025-08-27 09:50:03,625 | HR @1|5|10: 0.1531 	 0.3098 	 0.3744 	
2025-08-27 09:50:03,625 | NDCG @5|10: 0.2340 	 0.2551
2025-08-27 09:50:03,625 | 	avg_model_moe:
2025-08-27 09:50:03,626 | MRR: 0.1689
2025-08-27 09:50:03,626 | HR @1|5|10: 0.1118 	 0.2325 	 0.2767 	
2025-08-27 09:50:03,626 | NDCG @5|10: 0.1751 	 0.1895
2025-08-27 09:50:03,627 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:50:17,709 | Epoch 8/60 - client 0 -  Training Loss: 37.354

 25%|##5       | 1/4 [00:12<00:36, 12.29s/it]2025-08-27 09:50:29,693 | Epoch 8/60 - client 3 -  Training Loss: 41.042

 50%|#####     | 2/4 [00:24<00:24, 12.11s/it]2025-08-27 09:51:00,101 | Epoch 8/60 - client 1 -  Training Loss: 42.313

 75%|#######5  | 3/4 [00:54<00:20, 20.47s/it]2025-08-27 09:51:16,601 | Epoch 8/60 - client 2 -  Training Loss: 40.444

100%|##########| 4/4 [01:11<00:00, 18.90s/it]
100%|##########| 4/4 [01:11<00:00, 17.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 09:51:20,494 | Epoch8 Valid:
2025-08-27 09:51:20,495 | domain:Food
2025-08-27 09:51:20,495 | model_moe:
2025-08-27 09:51:20,495 | MRR: 0.3407
2025-08-27 09:51:20,496 | HR @1|5|10: 0.2425 	 0.4736 	 0.5241 	
2025-08-27 09:51:20,496 | NDCG @5|10: 0.3646 	 0.3811
2025-08-27 09:51:20,496 | domain:Kitchen
2025-08-27 09:51:20,496 | model_moe:
2025-08-27 09:51:20,497 | MRR: 0.0919
2025-08-27 09:51:20,497 | HR @1|5|10: 0.0520 	 0.1220 	 0.1625 	
2025-08-27 09:51:20,497 | NDCG @5|10: 0.0876 	 0.1006
2025-08-27 09:51:20,498 | domain:Clothing
2025-08-27 09:51:20,498 | model_moe:
2025-08-27 09:51:20,498 | MRR: 0.0238
2025-08-27 09:51:20,498 | HR @1|5|10: 0.0110 	 0.0257 	 0.0403 	
2025-08-27 09:51:20,499 | NDCG @5|10: 0.0192 	 0.0240
2025-08-27 09:51:20,499 | domain:Beauty
2025-08-27 09:51:20,499 | model_moe:
2025-08-27 09:51:20,499 | MRR: 0.2293
2025-08-27 09:51:20,500 | HR @1|5|10: 0.1579 	 0.3086 	 0.3732 	
2025-08-27 09:51:20,500 | NDCG @5|10: 0.2371 	 0.2583
2025-08-27 09:51:20,500 | 	avg_model_moe:
2025-08-27 09:51:20,501 | MRR: 0.1714
2025-08-27 09:51:20,501 | HR @1|5|10: 0.1159 	 0.2325 	 0.2750 	
2025-08-27 09:51:20,501 | NDCG @5|10: 0.1771 	 0.1910
2025-08-27 09:51:20,501 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:51:52,507 | Epoch 9/60 - client 1 -  Training Loss: 41.469

 25%|##5       | 1/4 [00:30<01:30, 30.22s/it]2025-08-27 09:52:08,965 | Epoch 9/60 - client 2 -  Training Loss: 39.457

 50%|#####     | 2/4 [00:46<00:44, 22.13s/it]2025-08-27 09:52:21,149 | Epoch 9/60 - client 0 -  Training Loss: 36.778

 75%|#######5  | 3/4 [00:58<00:17, 17.59s/it]2025-08-27 09:52:33,010 | Epoch 9/60 - client 3 -  Training Loss: 40.267

100%|##########| 4/4 [01:10<00:00, 15.33s/it]
100%|##########| 4/4 [01:10<00:00, 17.68s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 09:52:36,861 | Epoch9 Valid:
2025-08-27 09:52:36,861 | domain:Food
2025-08-27 09:52:36,862 | model_moe:
2025-08-27 09:52:36,862 | MRR: 0.3379
2025-08-27 09:52:36,862 | HR @1|5|10: 0.2379 	 0.4682 	 0.5226 	
2025-08-27 09:52:36,863 | NDCG @5|10: 0.3607 	 0.3786
2025-08-27 09:52:36,863 | domain:Kitchen
2025-08-27 09:52:36,863 | model_moe:
2025-08-27 09:52:36,863 | MRR: 0.0915
2025-08-27 09:52:36,864 | HR @1|5|10: 0.0502 	 0.1238 	 0.1630 	
2025-08-27 09:52:36,864 | NDCG @5|10: 0.0878 	 0.1004
2025-08-27 09:52:36,864 | domain:Clothing
2025-08-27 09:52:36,865 | model_moe:
2025-08-27 09:52:36,865 | MRR: 0.0239
2025-08-27 09:52:36,865 | HR @1|5|10: 0.0122 	 0.0269 	 0.0367 	
2025-08-27 09:52:36,866 | NDCG @5|10: 0.0198 	 0.0230
2025-08-27 09:52:36,866 | domain:Beauty
2025-08-27 09:52:36,866 | model_moe:
2025-08-27 09:52:36,866 | MRR: 0.2292
2025-08-27 09:52:36,867 | HR @1|5|10: 0.1579 	 0.3098 	 0.3732 	
2025-08-27 09:52:36,867 | NDCG @5|10: 0.2374 	 0.2582
2025-08-27 09:52:36,867 | 	avg_model_moe:
2025-08-27 09:52:36,867 | MRR: 0.1706
2025-08-27 09:52:36,868 | HR @1|5|10: 0.1146 	 0.2322 	 0.2739 	
2025-08-27 09:52:36,868 | NDCG @5|10: 0.1764 	 0.1901
2025-08-27 09:52:36,868 | Early Stopping counter: 1 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:53:07,091 | Epoch 10/60 - client 1 -  Training Loss: 40.716

 25%|##5       | 1/4 [00:30<01:30, 30.22s/it]2025-08-27 09:53:19,265 | Epoch 10/60 - client 0 -  Training Loss: 36.246

 50%|#####     | 2/4 [00:42<00:39, 19.61s/it]2025-08-27 09:53:31,121 | Epoch 10/60 - client 3 -  Training Loss: 39.555

 75%|#######5  | 3/4 [00:54<00:16, 16.07s/it]2025-08-27 09:53:47,458 | Epoch 10/60 - client 2 -  Training Loss: 38.543

100%|##########| 4/4 [01:10<00:00, 16.17s/it]
100%|##########| 4/4 [01:10<00:00, 17.65s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 09:53:51,395 | Epoch10 Valid:
2025-08-27 09:53:51,396 | domain:Food
2025-08-27 09:53:51,396 | model_moe:
2025-08-27 09:53:51,396 | MRR: 0.3406
2025-08-27 09:53:51,397 | HR @1|5|10: 0.2418 	 0.4690 	 0.5287 	
2025-08-27 09:53:51,397 | NDCG @5|10: 0.3627 	 0.3823
2025-08-27 09:53:51,397 | domain:Kitchen
2025-08-27 09:53:51,397 | model_moe:
2025-08-27 09:53:51,398 | MRR: 0.0945
2025-08-27 09:53:51,398 | HR @1|5|10: 0.0529 	 0.1257 	 0.1621 	
2025-08-27 09:53:51,398 | NDCG @5|10: 0.0907 	 0.1024
2025-08-27 09:53:51,399 | domain:Clothing
2025-08-27 09:53:51,399 | model_moe:
2025-08-27 09:53:51,399 | MRR: 0.0231
2025-08-27 09:53:51,400 | HR @1|5|10: 0.0110 	 0.0257 	 0.0379 	
2025-08-27 09:53:51,400 | NDCG @5|10: 0.0190 	 0.0230
2025-08-27 09:53:51,400 | domain:Beauty
2025-08-27 09:53:51,400 | model_moe:
2025-08-27 09:53:51,401 | MRR: 0.2306
2025-08-27 09:53:51,401 | HR @1|5|10: 0.1567 	 0.3206 	 0.3732 	
2025-08-27 09:53:51,401 | NDCG @5|10: 0.2420 	 0.2593
2025-08-27 09:53:51,402 | 	avg_model_moe:
2025-08-27 09:53:51,402 | MRR: 0.1722
2025-08-27 09:53:51,402 | HR @1|5|10: 0.1156 	 0.2352 	 0.2755 	
2025-08-27 09:53:51,402 | NDCG @5|10: 0.1786 	 0.1917
2025-08-27 09:53:51,403 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:54:05,659 | Epoch 11/60 - client 0 -  Training Loss: 35.748

 25%|##5       | 1/4 [00:12<00:36, 12.21s/it]2025-08-27 09:54:17,490 | Epoch 11/60 - client 3 -  Training Loss: 38.882

 50%|#####     | 2/4 [00:24<00:23, 11.99s/it]2025-08-27 09:54:33,790 | Epoch 11/60 - client 2 -  Training Loss: 37.662

 75%|#######5  | 3/4 [00:40<00:13, 13.96s/it]2025-08-27 09:55:03,960 | Epoch 11/60 - client 1 -  Training Loss: 40.026

100%|##########| 4/4 [01:10<00:00, 20.36s/it]
100%|##########| 4/4 [01:10<00:00, 17.63s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 09:55:07,774 | Epoch11 Valid:
2025-08-27 09:55:07,776 | domain:Food
2025-08-27 09:55:07,776 | model_moe:
2025-08-27 09:55:07,777 | MRR: 0.3454
2025-08-27 09:55:07,777 | HR @1|5|10: 0.2471 	 0.4705 	 0.5333 	
2025-08-27 09:55:07,777 | NDCG @5|10: 0.3665 	 0.3872
2025-08-27 09:55:07,778 | domain:Kitchen
2025-08-27 09:55:07,778 | model_moe:
2025-08-27 09:55:07,778 | MRR: 0.0949
2025-08-27 09:55:07,779 | HR @1|5|10: 0.0525 	 0.1280 	 0.1676 	
2025-08-27 09:55:07,779 | NDCG @5|10: 0.0914 	 0.1042
2025-08-27 09:55:07,779 | domain:Clothing
2025-08-27 09:55:07,780 | model_moe:
2025-08-27 09:55:07,780 | MRR: 0.0215
2025-08-27 09:55:07,780 | HR @1|5|10: 0.0098 	 0.0244 	 0.0428 	
2025-08-27 09:55:07,780 | NDCG @5|10: 0.0173 	 0.0230
2025-08-27 09:55:07,781 | domain:Beauty
2025-08-27 09:55:07,781 | model_moe:
2025-08-27 09:55:07,781 | MRR: 0.2350
2025-08-27 09:55:07,781 | HR @1|5|10: 0.1675 	 0.3182 	 0.3744 	
2025-08-27 09:55:07,782 | NDCG @5|10: 0.2444 	 0.2629
2025-08-27 09:55:07,782 | 	avg_model_moe:
2025-08-27 09:55:07,782 | MRR: 0.1742
2025-08-27 09:55:07,783 | HR @1|5|10: 0.1192 	 0.2353 	 0.2795 	
2025-08-27 09:55:07,783 | NDCG @5|10: 0.1799 	 0.1943
2025-08-27 09:55:07,783 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:55:21,617 | Epoch 12/60 - client 3 -  Training Loss: 38.244

 25%|##5       | 1/4 [00:11<00:35, 11.99s/it]2025-08-27 09:55:33,919 | Epoch 12/60 - client 0 -  Training Loss: 35.271

 50%|#####     | 2/4 [00:24<00:24, 12.17s/it]2025-08-27 09:55:50,442 | Epoch 12/60 - client 2 -  Training Loss: 36.849

 75%|#######5  | 3/4 [00:40<00:14, 14.16s/it]2025-08-27 09:56:20,967 | Epoch 12/60 - client 1 -  Training Loss: 39.369

100%|##########| 4/4 [01:11<00:00, 20.62s/it]
100%|##########| 4/4 [01:11<00:00, 17.83s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 09:56:24,875 | Epoch12 Valid:
2025-08-27 09:56:24,875 | domain:Food
2025-08-27 09:56:24,876 | model_moe:
2025-08-27 09:56:24,876 | MRR: 0.3485
2025-08-27 09:56:24,876 | HR @1|5|10: 0.2510 	 0.4744 	 0.5310 	
2025-08-27 09:56:24,877 | NDCG @5|10: 0.3701 	 0.3888
2025-08-27 09:56:24,877 | domain:Kitchen
2025-08-27 09:56:24,877 | model_moe:
2025-08-27 09:56:24,877 | MRR: 0.0937
2025-08-27 09:56:24,878 | HR @1|5|10: 0.0506 	 0.1266 	 0.1667 	
2025-08-27 09:56:24,878 | NDCG @5|10: 0.0904 	 0.1032
2025-08-27 09:56:24,878 | domain:Clothing
2025-08-27 09:56:24,879 | model_moe:
2025-08-27 09:56:24,879 | MRR: 0.0234
2025-08-27 09:56:24,879 | HR @1|5|10: 0.0122 	 0.0244 	 0.0403 	
2025-08-27 09:56:24,879 | NDCG @5|10: 0.0185 	 0.0237
2025-08-27 09:56:24,880 | domain:Beauty
2025-08-27 09:56:24,880 | model_moe:
2025-08-27 09:56:24,880 | MRR: 0.2373
2025-08-27 09:56:24,881 | HR @1|5|10: 0.1651 	 0.3289 	 0.3840 	
2025-08-27 09:56:24,881 | NDCG @5|10: 0.2496 	 0.2673
2025-08-27 09:56:24,881 | 	avg_model_moe:
2025-08-27 09:56:24,881 | MRR: 0.1757
2025-08-27 09:56:24,882 | HR @1|5|10: 0.1197 	 0.2386 	 0.2805 	
2025-08-27 09:56:24,882 | NDCG @5|10: 0.1821 	 0.1958
2025-08-27 09:56:24,882 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:56:56,887 | Epoch 13/60 - client 1 -  Training Loss: 38.742

 25%|##5       | 1/4 [00:30<01:30, 30.15s/it]2025-08-27 09:57:08,743 | Epoch 13/60 - client 3 -  Training Loss: 37.648

 50%|#####     | 2/4 [00:42<00:38, 19.39s/it]2025-08-27 09:57:20,886 | Epoch 13/60 - client 0 -  Training Loss: 34.842

 75%|#######5  | 3/4 [00:54<00:16, 16.08s/it]2025-08-27 09:57:37,264 | Epoch 13/60 - client 2 -  Training Loss: 36.099

100%|##########| 4/4 [01:10<00:00, 16.20s/it]
100%|##########| 4/4 [01:10<00:00, 17.63s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 09:57:41,133 | Epoch13 Valid:
2025-08-27 09:57:41,134 | domain:Food
2025-08-27 09:57:41,134 | model_moe:
2025-08-27 09:57:41,134 | MRR: 0.3563
2025-08-27 09:57:41,135 | HR @1|5|10: 0.2624 	 0.4736 	 0.5318 	
2025-08-27 09:57:41,135 | NDCG @5|10: 0.3752 	 0.3945
2025-08-27 09:57:41,135 | domain:Kitchen
2025-08-27 09:57:41,135 | model_moe:
2025-08-27 09:57:41,136 | MRR: 0.0970
2025-08-27 09:57:41,136 | HR @1|5|10: 0.0539 	 0.1285 	 0.1717 	
2025-08-27 09:57:41,136 | NDCG @5|10: 0.0927 	 0.1067
2025-08-27 09:57:41,136 | domain:Clothing
2025-08-27 09:57:41,137 | model_moe:
2025-08-27 09:57:41,137 | MRR: 0.0237
2025-08-27 09:57:41,137 | HR @1|5|10: 0.0122 	 0.0257 	 0.0379 	
2025-08-27 09:57:41,137 | NDCG @5|10: 0.0194 	 0.0232
2025-08-27 09:57:41,138 | domain:Beauty
2025-08-27 09:57:41,138 | model_moe:
2025-08-27 09:57:41,138 | MRR: 0.2433
2025-08-27 09:57:41,139 | HR @1|5|10: 0.1734 	 0.3266 	 0.3780 	
2025-08-27 09:57:41,139 | NDCG @5|10: 0.2535 	 0.2702
2025-08-27 09:57:41,139 | 	avg_model_moe:
2025-08-27 09:57:41,139 | MRR: 0.1800
2025-08-27 09:57:41,140 | HR @1|5|10: 0.1255 	 0.2386 	 0.2798 	
2025-08-27 09:57:41,140 | NDCG @5|10: 0.1852 	 0.1986
2025-08-27 09:57:41,140 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:57:54,946 | Epoch 14/60 - client 3 -  Training Loss: 37.120

 25%|##5       | 1/4 [00:11<00:35, 11.93s/it]2025-08-27 09:58:07,190 | Epoch 14/60 - client 0 -  Training Loss: 34.437

 50%|#####     | 2/4 [00:24<00:24, 12.12s/it]2025-08-27 09:58:23,598 | Epoch 14/60 - client 2 -  Training Loss: 35.416

 75%|#######5  | 3/4 [00:40<00:14, 14.08s/it]2025-08-27 09:58:53,989 | Epoch 14/60 - client 1 -  Training Loss: 38.194

100%|##########| 4/4 [01:10<00:00, 20.52s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 09:58:57,873 | Epoch14 Valid:
2025-08-27 09:58:57,874 | domain:Food
2025-08-27 09:58:57,874 | model_moe:
2025-08-27 09:58:57,874 | MRR: 0.3546
2025-08-27 09:58:57,875 | HR @1|5|10: 0.2594 	 0.4774 	 0.5333 	
2025-08-27 09:58:57,875 | NDCG @5|10: 0.3755 	 0.3940
2025-08-27 09:58:57,875 | domain:Kitchen
2025-08-27 09:58:57,876 | model_moe:
2025-08-27 09:58:57,876 | MRR: 0.0997
2025-08-27 09:58:57,876 | HR @1|5|10: 0.0576 	 0.1308 	 0.1750 	
2025-08-27 09:58:57,876 | NDCG @5|10: 0.0954 	 0.1096
2025-08-27 09:58:57,877 | domain:Clothing
2025-08-27 09:58:57,877 | model_moe:
2025-08-27 09:58:57,877 | MRR: 0.0231
2025-08-27 09:58:57,877 | HR @1|5|10: 0.0110 	 0.0281 	 0.0367 	
2025-08-27 09:58:57,878 | NDCG @5|10: 0.0197 	 0.0224
2025-08-27 09:58:57,878 | domain:Beauty
2025-08-27 09:58:57,878 | model_moe:
2025-08-27 09:58:57,879 | MRR: 0.2427
2025-08-27 09:58:57,879 | HR @1|5|10: 0.1722 	 0.3349 	 0.3828 	
2025-08-27 09:58:57,879 | NDCG @5|10: 0.2559 	 0.2710
2025-08-27 09:58:57,879 | 	avg_model_moe:
2025-08-27 09:58:57,880 | MRR: 0.1800
2025-08-27 09:58:57,880 | HR @1|5|10: 0.1250 	 0.2428 	 0.2819 	
2025-08-27 09:58:57,880 | NDCG @5|10: 0.1866 	 0.1992
2025-08-27 09:58:57,880 | Early Stopping counter: 1 out of 10
2025-08-27 09:58:57,881 | Learning rate decay counter: 1 out of 1
2025-08-27 09:58:57,881 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 09:59:10,283 | Epoch 15/60 - client 0 -  Training Loss: 34.070

 25%|##5       | 1/4 [00:12<00:37, 12.41s/it]2025-08-27 09:59:22,330 | Epoch 15/60 - client 3 -  Training Loss: 36.642

 50%|#####     | 2/4 [00:24<00:24, 12.20s/it]2025-08-27 09:59:38,870 | Epoch 15/60 - client 2 -  Training Loss: 34.788

 75%|#######5  | 3/4 [00:40<00:14, 14.18s/it]2025-08-27 10:00:09,213 | Epoch 15/60 - client 1 -  Training Loss: 37.683

100%|##########| 4/4 [01:11<00:00, 20.56s/it]
100%|##########| 4/4 [01:11<00:00, 17.83s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:00:13,077 | Epoch15 Valid:
2025-08-27 10:00:13,077 | domain:Food
2025-08-27 10:00:13,078 | model_moe:
2025-08-27 10:00:13,078 | MRR: 0.3620
2025-08-27 10:00:13,078 | HR @1|5|10: 0.2686 	 0.4843 	 0.5340 	
2025-08-27 10:00:13,079 | NDCG @5|10: 0.3830 	 0.3995
2025-08-27 10:00:13,079 | domain:Kitchen
2025-08-27 10:00:13,079 | model_moe:
2025-08-27 10:00:13,079 | MRR: 0.1022
2025-08-27 10:00:13,080 | HR @1|5|10: 0.0585 	 0.1344 	 0.1846 	
2025-08-27 10:00:13,080 | NDCG @5|10: 0.0977 	 0.1139
2025-08-27 10:00:13,080 | domain:Clothing
2025-08-27 10:00:13,081 | model_moe:
2025-08-27 10:00:13,081 | MRR: 0.0233
2025-08-27 10:00:13,081 | HR @1|5|10: 0.0122 	 0.0220 	 0.0416 	
2025-08-27 10:00:13,081 | NDCG @5|10: 0.0175 	 0.0237
2025-08-27 10:00:13,082 | domain:Beauty
2025-08-27 10:00:13,082 | model_moe:
2025-08-27 10:00:13,082 | MRR: 0.2483
2025-08-27 10:00:13,083 | HR @1|5|10: 0.1806 	 0.3349 	 0.3828 	
2025-08-27 10:00:13,083 | NDCG @5|10: 0.2598 	 0.2754
2025-08-27 10:00:13,083 | 	avg_model_moe:
2025-08-27 10:00:13,083 | MRR: 0.1840
2025-08-27 10:00:13,084 | HR @1|5|10: 0.1300 	 0.2439 	 0.2858 	
2025-08-27 10:00:13,084 | NDCG @5|10: 0.1895 	 0.2031
2025-08-27 10:00:13,084 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:00:31,583 | Epoch 16/60 - client 2 -  Training Loss: 34.228

 25%|##5       | 1/4 [00:16<00:49, 16.40s/it]2025-08-27 10:01:01,917 | Epoch 16/60 - client 1 -  Training Loss: 37.198

 50%|#####     | 2/4 [00:46<00:49, 24.59s/it]2025-08-27 10:01:13,890 | Epoch 16/60 - client 3 -  Training Loss: 36.205

 75%|#######5  | 3/4 [00:58<00:18, 18.83s/it]2025-08-27 10:01:26,265 | Epoch 16/60 - client 0 -  Training Loss: 33.721

100%|##########| 4/4 [01:11<00:00, 16.28s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.04it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 10:01:30,164 | Epoch16 Valid:
2025-08-27 10:01:30,164 | domain:Food
2025-08-27 10:01:30,164 | model_moe:
2025-08-27 10:01:30,165 | MRR: 0.3601
2025-08-27 10:01:30,165 | HR @1|5|10: 0.2640 	 0.4843 	 0.5356 	
2025-08-27 10:01:30,165 | NDCG @5|10: 0.3816 	 0.3985
2025-08-27 10:01:30,165 | domain:Kitchen
2025-08-27 10:01:30,166 | model_moe:
2025-08-27 10:01:30,166 | MRR: 0.0996
2025-08-27 10:01:30,166 | HR @1|5|10: 0.0548 	 0.1326 	 0.1823 	
2025-08-27 10:01:30,166 | NDCG @5|10: 0.0957 	 0.1114
2025-08-27 10:01:30,167 | domain:Clothing
2025-08-27 10:01:30,167 | model_moe:
2025-08-27 10:01:30,167 | MRR: 0.0233
2025-08-27 10:01:30,168 | HR @1|5|10: 0.0122 	 0.0269 	 0.0379 	
2025-08-27 10:01:30,168 | NDCG @5|10: 0.0192 	 0.0228
2025-08-27 10:01:30,168 | domain:Beauty
2025-08-27 10:01:30,168 | model_moe:
2025-08-27 10:01:30,169 | MRR: 0.2480
2025-08-27 10:01:30,169 | HR @1|5|10: 0.1806 	 0.3361 	 0.3816 	
2025-08-27 10:01:30,169 | NDCG @5|10: 0.2601 	 0.2747
2025-08-27 10:01:30,169 | 	avg_model_moe:
2025-08-27 10:01:30,170 | MRR: 0.1828
2025-08-27 10:01:30,170 | HR @1|5|10: 0.1279 	 0.2450 	 0.2843 	
2025-08-27 10:01:30,170 | NDCG @5|10: 0.1891 	 0.2019
2025-08-27 10:01:30,171 | Early Stopping counter: 1 out of 10
2025-08-27 10:01:30,171 | Learning rate decay counter: 1 out of 1
2025-08-27 10:01:30,171 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:01:46,591 | Epoch 17/60 - client 2 -  Training Loss: 33.701

 25%|##5       | 1/4 [00:16<00:49, 16.42s/it]2025-08-27 10:02:16,969 | Epoch 17/60 - client 1 -  Training Loss: 36.751

 50%|#####     | 2/4 [00:46<00:49, 24.63s/it]2025-08-27 10:02:29,255 | Epoch 17/60 - client 0 -  Training Loss: 33.401

 75%|#######5  | 3/4 [00:59<00:18, 18.99s/it]2025-08-27 10:02:41,217 | Epoch 17/60 - client 3 -  Training Loss: 35.792

100%|##########| 4/4 [01:11<00:00, 16.22s/it]
100%|##########| 4/4 [01:11<00:00, 17.76s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:02:45,085 | Epoch17 Valid:
2025-08-27 10:02:45,086 | domain:Food
2025-08-27 10:02:45,086 | model_moe:
2025-08-27 10:02:45,086 | MRR: 0.3613
2025-08-27 10:02:45,087 | HR @1|5|10: 0.2647 	 0.4805 	 0.5379 	
2025-08-27 10:02:45,087 | NDCG @5|10: 0.3810 	 0.3999
2025-08-27 10:02:45,087 | domain:Kitchen
2025-08-27 10:02:45,088 | model_moe:
2025-08-27 10:02:45,088 | MRR: 0.1011
2025-08-27 10:02:45,088 | HR @1|5|10: 0.0557 	 0.1340 	 0.1855 	
2025-08-27 10:02:45,088 | NDCG @5|10: 0.0969 	 0.1135
2025-08-27 10:02:45,089 | domain:Clothing
2025-08-27 10:02:45,089 | model_moe:
2025-08-27 10:02:45,089 | MRR: 0.0256
2025-08-27 10:02:45,090 | HR @1|5|10: 0.0147 	 0.0281 	 0.0416 	
2025-08-27 10:02:45,090 | NDCG @5|10: 0.0214 	 0.0257
2025-08-27 10:02:45,090 | domain:Beauty
2025-08-27 10:02:45,090 | model_moe:
2025-08-27 10:02:45,091 | MRR: 0.2492
2025-08-27 10:02:45,091 | HR @1|5|10: 0.1794 	 0.3421 	 0.3816 	
2025-08-27 10:02:45,091 | NDCG @5|10: 0.2631 	 0.2759
2025-08-27 10:02:45,091 | 	avg_model_moe:
2025-08-27 10:02:45,092 | MRR: 0.1843
2025-08-27 10:02:45,092 | HR @1|5|10: 0.1286 	 0.2462 	 0.2866 	
2025-08-27 10:02:45,092 | NDCG @5|10: 0.1906 	 0.2037
2025-08-27 10:02:45,092 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:02:58,946 | Epoch 18/60 - client 3 -  Training Loss: 35.416

 25%|##5       | 1/4 [00:11<00:35, 11.94s/it]2025-08-27 10:03:11,310 | Epoch 18/60 - client 0 -  Training Loss: 33.109

 50%|#####     | 2/4 [00:24<00:24, 12.19s/it]2025-08-27 10:03:28,038 | Epoch 18/60 - client 2 -  Training Loss: 33.233

 75%|#######5  | 3/4 [00:41<00:14, 14.26s/it]2025-08-27 10:03:58,603 | Epoch 18/60 - client 1 -  Training Loss: 36.341

100%|##########| 4/4 [01:11<00:00, 20.70s/it]
100%|##########| 4/4 [01:11<00:00, 17.90s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:04:02,463 | Epoch18 Valid:
2025-08-27 10:04:02,464 | domain:Food
2025-08-27 10:04:02,464 | model_moe:
2025-08-27 10:04:02,464 | MRR: 0.3634
2025-08-27 10:04:02,465 | HR @1|5|10: 0.2686 	 0.4851 	 0.5409 	
2025-08-27 10:04:02,465 | NDCG @5|10: 0.3840 	 0.4023
2025-08-27 10:04:02,465 | domain:Kitchen
2025-08-27 10:04:02,465 | model_moe:
2025-08-27 10:04:02,466 | MRR: 0.1036
2025-08-27 10:04:02,466 | HR @1|5|10: 0.0580 	 0.1400 	 0.1901 	
2025-08-27 10:04:02,466 | NDCG @5|10: 0.1002 	 0.1165
2025-08-27 10:04:02,467 | domain:Clothing
2025-08-27 10:04:02,467 | model_moe:
2025-08-27 10:04:02,467 | MRR: 0.0243
2025-08-27 10:04:02,467 | HR @1|5|10: 0.0134 	 0.0293 	 0.0391 	
2025-08-27 10:04:02,468 | NDCG @5|10: 0.0207 	 0.0239
2025-08-27 10:04:02,468 | domain:Beauty
2025-08-27 10:04:02,468 | model_moe:
2025-08-27 10:04:02,468 | MRR: 0.2510
2025-08-27 10:04:02,469 | HR @1|5|10: 0.1842 	 0.3337 	 0.3852 	
2025-08-27 10:04:02,469 | NDCG @5|10: 0.2614 	 0.2780
2025-08-27 10:04:02,469 | 	avg_model_moe:
2025-08-27 10:04:02,469 | MRR: 0.1856
2025-08-27 10:04:02,470 | HR @1|5|10: 0.1311 	 0.2470 	 0.2888 	
2025-08-27 10:04:02,470 | NDCG @5|10: 0.1916 	 0.2052
2025-08-27 10:04:02,470 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:04:16,304 | Epoch 19/60 - client 3 -  Training Loss: 35.049

 25%|##5       | 1/4 [00:12<00:36, 12.03s/it]2025-08-27 10:04:32,728 | Epoch 19/60 - client 2 -  Training Loss: 32.777

 50%|#####     | 2/4 [00:28<00:29, 14.62s/it]2025-08-27 10:05:03,168 | Epoch 19/60 - client 1 -  Training Loss: 35.939

 75%|#######5  | 3/4 [00:58<00:21, 21.84s/it]2025-08-27 10:05:15,512 | Epoch 19/60 - client 0 -  Training Loss: 32.829

100%|##########| 4/4 [01:11<00:00, 18.09s/it]
100%|##########| 4/4 [01:11<00:00, 17.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:05:19,354 | Epoch19 Valid:
2025-08-27 10:05:19,354 | domain:Food
2025-08-27 10:05:19,355 | model_moe:
2025-08-27 10:05:19,355 | MRR: 0.3634
2025-08-27 10:05:19,355 | HR @1|5|10: 0.2678 	 0.4836 	 0.5409 	
2025-08-27 10:05:19,355 | NDCG @5|10: 0.3834 	 0.4022
2025-08-27 10:05:19,356 | domain:Kitchen
2025-08-27 10:05:19,356 | model_moe:
2025-08-27 10:05:19,356 | MRR: 0.1017
2025-08-27 10:05:19,356 | HR @1|5|10: 0.0557 	 0.1363 	 0.1906 	
2025-08-27 10:05:19,357 | NDCG @5|10: 0.0979 	 0.1153
2025-08-27 10:05:19,357 | domain:Clothing
2025-08-27 10:05:19,357 | model_moe:
2025-08-27 10:05:19,358 | MRR: 0.0263
2025-08-27 10:05:19,358 | HR @1|5|10: 0.0159 	 0.0293 	 0.0416 	
2025-08-27 10:05:19,358 | NDCG @5|10: 0.0221 	 0.0260
2025-08-27 10:05:19,358 | domain:Beauty
2025-08-27 10:05:19,359 | model_moe:
2025-08-27 10:05:19,359 | MRR: 0.2459
2025-08-27 10:05:19,359 | HR @1|5|10: 0.1722 	 0.3385 	 0.3828 	
2025-08-27 10:05:19,359 | NDCG @5|10: 0.2593 	 0.2736
2025-08-27 10:05:19,360 | 	avg_model_moe:
2025-08-27 10:05:19,360 | MRR: 0.1843
2025-08-27 10:05:19,360 | HR @1|5|10: 0.1279 	 0.2469 	 0.2890 	
2025-08-27 10:05:19,360 | NDCG @5|10: 0.1907 	 0.2043
2025-08-27 10:05:19,361 | Early Stopping counter: 1 out of 10
2025-08-27 10:05:19,361 | Learning rate decay counter: 1 out of 1
2025-08-27 10:05:19,361 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:05:49,767 | Epoch 20/60 - client 1 -  Training Loss: 35.549

 25%|##5       | 1/4 [00:30<01:31, 30.41s/it]2025-08-27 10:06:06,220 | Epoch 20/60 - client 2 -  Training Loss: 32.355

 50%|#####     | 2/4 [00:46<00:44, 22.20s/it]2025-08-27 10:06:18,230 | Epoch 20/60 - client 3 -  Training Loss: 34.703

 75%|#######5  | 3/4 [00:58<00:17, 17.55s/it]2025-08-27 10:06:30,513 | Epoch 20/60 - client 0 -  Training Loss: 32.566

100%|##########| 4/4 [01:11<00:00, 15.47s/it]
100%|##########| 4/4 [01:11<00:00, 17.79s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:06:34,354 | Epoch20 Valid:
2025-08-27 10:06:34,354 | domain:Food
2025-08-27 10:06:34,354 | model_moe:
2025-08-27 10:06:34,355 | MRR: 0.3644
2025-08-27 10:06:34,355 | HR @1|5|10: 0.2693 	 0.4858 	 0.5425 	
2025-08-27 10:06:34,355 | NDCG @5|10: 0.3850 	 0.4035
2025-08-27 10:06:34,355 | domain:Kitchen
2025-08-27 10:06:34,356 | model_moe:
2025-08-27 10:06:34,356 | MRR: 0.1038
2025-08-27 10:06:34,356 | HR @1|5|10: 0.0562 	 0.1400 	 0.1984 	
2025-08-27 10:06:34,357 | NDCG @5|10: 0.1003 	 0.1190
2025-08-27 10:06:34,357 | domain:Clothing
2025-08-27 10:06:34,357 | model_moe:
2025-08-27 10:06:34,357 | MRR: 0.0242
2025-08-27 10:06:34,358 | HR @1|5|10: 0.0122 	 0.0281 	 0.0403 	
2025-08-27 10:06:34,358 | NDCG @5|10: 0.0201 	 0.0241
2025-08-27 10:06:34,358 | domain:Beauty
2025-08-27 10:06:34,358 | model_moe:
2025-08-27 10:06:34,359 | MRR: 0.2513
2025-08-27 10:06:34,359 | HR @1|5|10: 0.1806 	 0.3385 	 0.3840 	
2025-08-27 10:06:34,359 | NDCG @5|10: 0.2631 	 0.2780
2025-08-27 10:06:34,359 | 	avg_model_moe:
2025-08-27 10:06:34,360 | MRR: 0.1859
2025-08-27 10:06:34,360 | HR @1|5|10: 0.1296 	 0.2481 	 0.2913 	
2025-08-27 10:06:34,360 | NDCG @5|10: 0.1921 	 0.2061
2025-08-27 10:06:34,361 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:06:48,319 | Epoch 21/60 - client 3 -  Training Loss: 34.382

 25%|##5       | 1/4 [00:12<00:36, 12.04s/it]2025-08-27 10:07:04,824 | Epoch 21/60 - client 2 -  Training Loss: 31.967

 50%|#####     | 2/4 [00:28<00:29, 14.67s/it]2025-08-27 10:07:35,240 | Epoch 21/60 - client 1 -  Training Loss: 35.191

 75%|#######5  | 3/4 [00:58<00:21, 21.86s/it]2025-08-27 10:07:47,485 | Epoch 21/60 - client 0 -  Training Loss: 32.317

100%|##########| 4/4 [01:11<00:00, 18.06s/it]
100%|##########| 4/4 [01:11<00:00, 17.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:07:51,319 | Epoch21 Valid:
2025-08-27 10:07:51,319 | domain:Food
2025-08-27 10:07:51,320 | model_moe:
2025-08-27 10:07:51,320 | MRR: 0.3645
2025-08-27 10:07:51,320 | HR @1|5|10: 0.2686 	 0.4836 	 0.5425 	
2025-08-27 10:07:51,320 | NDCG @5|10: 0.3843 	 0.4035
2025-08-27 10:07:51,321 | domain:Kitchen
2025-08-27 10:07:51,321 | model_moe:
2025-08-27 10:07:51,321 | MRR: 0.1040
2025-08-27 10:07:51,322 | HR @1|5|10: 0.0557 	 0.1441 	 0.1989 	
2025-08-27 10:07:51,322 | NDCG @5|10: 0.1017 	 0.1192
2025-08-27 10:07:51,322 | domain:Clothing
2025-08-27 10:07:51,322 | model_moe:
2025-08-27 10:07:51,323 | MRR: 0.0254
2025-08-27 10:07:51,323 | HR @1|5|10: 0.0134 	 0.0306 	 0.0440 	
2025-08-27 10:07:51,323 | NDCG @5|10: 0.0218 	 0.0259
2025-08-27 10:07:51,324 | domain:Beauty
2025-08-27 10:07:51,324 | model_moe:
2025-08-27 10:07:51,324 | MRR: 0.2497
2025-08-27 10:07:51,324 | HR @1|5|10: 0.1806 	 0.3349 	 0.3828 	
2025-08-27 10:07:51,325 | NDCG @5|10: 0.2607 	 0.2766
2025-08-27 10:07:51,325 | 	avg_model_moe:
2025-08-27 10:07:51,325 | MRR: 0.1859
2025-08-27 10:07:51,325 | HR @1|5|10: 0.1296 	 0.2483 	 0.2920 	
2025-08-27 10:07:51,326 | NDCG @5|10: 0.1921 	 0.2063
2025-08-27 10:07:51,326 | Early Stopping counter: 1 out of 10
2025-08-27 10:07:51,326 | Learning rate decay counter: 1 out of 1
2025-08-27 10:07:51,326 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:08:03,537 | Epoch 22/60 - client 0 -  Training Loss: 32.084

 25%|##5       | 1/4 [00:12<00:36, 12.21s/it]2025-08-27 10:08:19,900 | Epoch 22/60 - client 2 -  Training Loss: 31.607

 50%|#####     | 2/4 [00:28<00:29, 14.65s/it]2025-08-27 10:08:31,812 | Epoch 22/60 - client 3 -  Training Loss: 34.081

 75%|#######5  | 3/4 [00:40<00:13, 13.40s/it]2025-08-27 10:09:02,259 | Epoch 22/60 - client 1 -  Training Loss: 34.844

100%|##########| 4/4 [01:10<00:00, 20.13s/it]
100%|##########| 4/4 [01:10<00:00, 17.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:09:06,137 | Epoch22 Valid:
2025-08-27 10:09:06,139 | domain:Food
2025-08-27 10:09:06,140 | model_moe:
2025-08-27 10:09:06,142 | MRR: 0.3647
2025-08-27 10:09:06,143 | HR @1|5|10: 0.2701 	 0.4874 	 0.5432 	
2025-08-27 10:09:06,144 | NDCG @5|10: 0.3856 	 0.4037
2025-08-27 10:09:06,146 | domain:Kitchen
2025-08-27 10:09:06,147 | model_moe:
2025-08-27 10:09:06,149 | MRR: 0.1064
2025-08-27 10:09:06,150 | HR @1|5|10: 0.0585 	 0.1464 	 0.1980 	
2025-08-27 10:09:06,152 | NDCG @5|10: 0.1039 	 0.1205
2025-08-27 10:09:06,153 | domain:Clothing
2025-08-27 10:09:06,154 | model_moe:
2025-08-27 10:09:06,156 | MRR: 0.0263
2025-08-27 10:09:06,157 | HR @1|5|10: 0.0147 	 0.0293 	 0.0416 	
2025-08-27 10:09:06,159 | NDCG @5|10: 0.0220 	 0.0259
2025-08-27 10:09:06,160 | domain:Beauty
2025-08-27 10:09:06,162 | model_moe:
2025-08-27 10:09:06,163 | MRR: 0.2480
2025-08-27 10:09:06,165 | HR @1|5|10: 0.1770 	 0.3373 	 0.3840 	
2025-08-27 10:09:06,166 | NDCG @5|10: 0.2601 	 0.2754
2025-08-27 10:09:06,167 | 	avg_model_moe:
2025-08-27 10:09:06,169 | MRR: 0.1864
2025-08-27 10:09:06,170 | HR @1|5|10: 0.1301 	 0.2501 	 0.2917 	
2025-08-27 10:09:06,172 | NDCG @5|10: 0.1929 	 0.2064
2025-08-27 10:09:06,173 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:09:29,492 | Epoch 23/60 - client 3 -  Training Loss: 33.791

 25%|##5       | 1/4 [00:11<00:35, 11.80s/it]2025-08-27 10:09:41,601 | Epoch 23/60 - client 0 -  Training Loss: 31.852

 50%|#####     | 2/4 [00:23<00:23, 11.98s/it]2025-08-27 10:10:11,678 | Epoch 23/60 - client 1 -  Training Loss: 34.510

 75%|#######5  | 3/4 [00:53<00:20, 20.24s/it]2025-08-27 10:10:27,946 | Epoch 23/60 - client 2 -  Training Loss: 31.259

100%|##########| 4/4 [01:10<00:00, 18.67s/it]
100%|##########| 4/4 [01:10<00:00, 17.56s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:10:31,791 | Epoch23 Valid:
2025-08-27 10:10:31,793 | domain:Food
2025-08-27 10:10:31,794 | model_moe:
2025-08-27 10:10:31,795 | MRR: 0.3647
2025-08-27 10:10:31,796 | HR @1|5|10: 0.2686 	 0.4828 	 0.5448 	
2025-08-27 10:10:31,797 | NDCG @5|10: 0.3840 	 0.4043
2025-08-27 10:10:31,798 | domain:Kitchen
2025-08-27 10:10:31,799 | model_moe:
2025-08-27 10:10:31,800 | MRR: 0.1063
2025-08-27 10:10:31,801 | HR @1|5|10: 0.0580 	 0.1450 	 0.1989 	
2025-08-27 10:10:31,802 | NDCG @5|10: 0.1035 	 0.1208
2025-08-27 10:10:31,803 | domain:Clothing
2025-08-27 10:10:31,804 | model_moe:
2025-08-27 10:10:31,805 | MRR: 0.0270
2025-08-27 10:10:31,806 | HR @1|5|10: 0.0159 	 0.0257 	 0.0416 	
2025-08-27 10:10:31,807 | NDCG @5|10: 0.0211 	 0.0263
2025-08-27 10:10:31,808 | domain:Beauty
2025-08-27 10:10:31,809 | model_moe:
2025-08-27 10:10:31,810 | MRR: 0.2477
2025-08-27 10:10:31,811 | HR @1|5|10: 0.1770 	 0.3337 	 0.3816 	
2025-08-27 10:10:31,812 | NDCG @5|10: 0.2589 	 0.2747
2025-08-27 10:10:31,814 | 	avg_model_moe:
2025-08-27 10:10:31,815 | MRR: 0.1864
2025-08-27 10:10:31,816 | HR @1|5|10: 0.1299 	 0.2468 	 0.2917 	
2025-08-27 10:10:31,817 | NDCG @5|10: 0.1919 	 0.2065
2025-08-27 10:10:31,818 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:10:55,217 | Epoch 24/60 - client 3 -  Training Loss: 33.511

 25%|##5       | 1/4 [00:12<00:36, 12.02s/it]2025-08-27 10:11:11,602 | Epoch 24/60 - client 2 -  Training Loss: 30.938

 50%|#####     | 2/4 [00:28<00:29, 14.59s/it]2025-08-27 10:11:41,890 | Epoch 24/60 - client 1 -  Training Loss: 34.194

 75%|#######5  | 3/4 [00:58<00:21, 21.76s/it]2025-08-27 10:11:54,143 | Epoch 24/60 - client 0 -  Training Loss: 31.637

100%|##########| 4/4 [01:10<00:00, 18.00s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:11:58,009 | Epoch24 Valid:
2025-08-27 10:11:58,012 | domain:Food
2025-08-27 10:11:58,014 | model_moe:
2025-08-27 10:11:58,016 | MRR: 0.3663
2025-08-27 10:11:58,018 | HR @1|5|10: 0.2708 	 0.4866 	 0.5432 	
2025-08-27 10:11:58,021 | NDCG @5|10: 0.3866 	 0.4051
2025-08-27 10:11:58,023 | domain:Kitchen
2025-08-27 10:11:58,025 | model_moe:
2025-08-27 10:11:58,027 | MRR: 0.1041
2025-08-27 10:11:58,030 | HR @1|5|10: 0.0543 	 0.1473 	 0.2072 	
2025-08-27 10:11:58,032 | NDCG @5|10: 0.1023 	 0.1214
2025-08-27 10:11:58,034 | domain:Clothing
2025-08-27 10:11:58,036 | model_moe:
2025-08-27 10:11:58,038 | MRR: 0.0262
2025-08-27 10:11:58,040 | HR @1|5|10: 0.0147 	 0.0281 	 0.0416 	
2025-08-27 10:11:58,043 | NDCG @5|10: 0.0214 	 0.0257
2025-08-27 10:11:58,045 | domain:Beauty
2025-08-27 10:11:58,047 | model_moe:
2025-08-27 10:11:58,049 | MRR: 0.2489
2025-08-27 10:11:58,051 | HR @1|5|10: 0.1782 	 0.3325 	 0.3840 	
2025-08-27 10:11:58,053 | NDCG @5|10: 0.2594 	 0.2762
2025-08-27 10:11:58,055 | 	avg_model_moe:
2025-08-27 10:11:58,058 | MRR: 0.1864
2025-08-27 10:11:58,060 | HR @1|5|10: 0.1295 	 0.2486 	 0.2940 	
2025-08-27 10:11:58,062 | NDCG @5|10: 0.1924 	 0.2071
2025-08-27 10:11:58,064 | Early Stopping counter: 1 out of 10
2025-08-27 10:11:58,066 | Learning rate decay counter: 1 out of 1
2025-08-27 10:11:58,068 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:12:28,432 | Epoch 25/60 - client 1 -  Training Loss: 33.889

 25%|##5       | 1/4 [00:30<01:31, 30.36s/it]2025-08-27 10:12:44,942 | Epoch 25/60 - client 2 -  Training Loss: 30.640

 50%|#####     | 2/4 [00:46<00:44, 22.21s/it]2025-08-27 10:12:56,881 | Epoch 25/60 - client 3 -  Training Loss: 33.249

 75%|#######5  | 3/4 [00:58<00:17, 17.52s/it]2025-08-27 10:13:09,137 | Epoch 25/60 - client 0 -  Training Loss: 31.427

100%|##########| 4/4 [01:11<00:00, 15.44s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:13:13,016 | Epoch25 Valid:
2025-08-27 10:13:13,017 | domain:Food
2025-08-27 10:13:13,018 | model_moe:
2025-08-27 10:13:13,019 | MRR: 0.3647
2025-08-27 10:13:13,020 | HR @1|5|10: 0.2693 	 0.4858 	 0.5425 	
2025-08-27 10:13:13,021 | NDCG @5|10: 0.3852 	 0.4036
2025-08-27 10:13:13,022 | domain:Kitchen
2025-08-27 10:13:13,023 | model_moe:
2025-08-27 10:13:13,024 | MRR: 0.1084
2025-08-27 10:13:13,025 | HR @1|5|10: 0.0580 	 0.1524 	 0.2053 	
2025-08-27 10:13:13,026 | NDCG @5|10: 0.1070 	 0.1241
2025-08-27 10:13:13,027 | domain:Clothing
2025-08-27 10:13:13,028 | model_moe:
2025-08-27 10:13:13,029 | MRR: 0.0257
2025-08-27 10:13:13,030 | HR @1|5|10: 0.0134 	 0.0269 	 0.0403 	
2025-08-27 10:13:13,031 | NDCG @5|10: 0.0206 	 0.0249
2025-08-27 10:13:13,032 | domain:Beauty
2025-08-27 10:13:13,033 | model_moe:
2025-08-27 10:13:13,034 | MRR: 0.2492
2025-08-27 10:13:13,035 | HR @1|5|10: 0.1794 	 0.3361 	 0.3828 	
2025-08-27 10:13:13,036 | NDCG @5|10: 0.2607 	 0.2761
2025-08-27 10:13:13,037 | 	avg_model_moe:
2025-08-27 10:13:13,038 | MRR: 0.1870
2025-08-27 10:13:13,039 | HR @1|5|10: 0.1301 	 0.2503 	 0.2927 	
2025-08-27 10:13:13,040 | NDCG @5|10: 0.1934 	 0.2072
2025-08-27 10:13:13,041 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:13:52,981 | Epoch 26/60 - client 1 -  Training Loss: 33.609

 25%|##5       | 1/4 [00:30<01:30, 30.32s/it]2025-08-27 10:14:04,958 | Epoch 26/60 - client 3 -  Training Loss: 32.991

 50%|#####     | 2/4 [00:42<00:39, 19.53s/it]2025-08-27 10:14:17,222 | Epoch 26/60 - client 0 -  Training Loss: 31.234

 75%|#######5  | 3/4 [00:54<00:16, 16.21s/it]2025-08-27 10:14:33,725 | Epoch 26/60 - client 2 -  Training Loss: 30.344

100%|##########| 4/4 [01:11<00:00, 16.33s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:14:37,582 | Epoch26 Valid:
2025-08-27 10:14:37,582 | domain:Food
2025-08-27 10:14:37,582 | model_moe:
2025-08-27 10:14:37,583 | MRR: 0.3647
2025-08-27 10:14:37,583 | HR @1|5|10: 0.2701 	 0.4836 	 0.5417 	
2025-08-27 10:14:37,583 | NDCG @5|10: 0.3844 	 0.4034
2025-08-27 10:14:37,583 | domain:Kitchen
2025-08-27 10:14:37,584 | model_moe:
2025-08-27 10:14:37,584 | MRR: 0.1077
2025-08-27 10:14:37,584 | HR @1|5|10: 0.0585 	 0.1492 	 0.2090 	
2025-08-27 10:14:37,584 | NDCG @5|10: 0.1052 	 0.1245
2025-08-27 10:14:37,585 | domain:Clothing
2025-08-27 10:14:37,585 | model_moe:
2025-08-27 10:14:37,585 | MRR: 0.0264
2025-08-27 10:14:37,585 | HR @1|5|10: 0.0147 	 0.0318 	 0.0465 	
2025-08-27 10:14:37,586 | NDCG @5|10: 0.0228 	 0.0272
2025-08-27 10:14:37,586 | domain:Beauty
2025-08-27 10:14:37,586 | model_moe:
2025-08-27 10:14:37,586 | MRR: 0.2519
2025-08-27 10:14:37,587 | HR @1|5|10: 0.1842 	 0.3361 	 0.3816 	
2025-08-27 10:14:37,587 | NDCG @5|10: 0.2628 	 0.2778
2025-08-27 10:14:37,587 | 	avg_model_moe:
2025-08-27 10:14:37,588 | MRR: 0.1877
2025-08-27 10:14:37,588 | HR @1|5|10: 0.1319 	 0.2502 	 0.2947 	
2025-08-27 10:14:37,588 | NDCG @5|10: 0.1938 	 0.2082
2025-08-27 10:14:37,588 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:14:55,836 | Epoch 27/60 - client 2 -  Training Loss: 30.074

 25%|##5       | 1/4 [00:16<00:48, 16.27s/it]2025-08-27 10:15:25,904 | Epoch 27/60 - client 1 -  Training Loss: 33.331

 50%|#####     | 2/4 [00:46<00:48, 24.39s/it]2025-08-27 10:15:38,023 | Epoch 27/60 - client 0 -  Training Loss: 31.039

 75%|#######5  | 3/4 [00:58<00:18, 18.79s/it]2025-08-27 10:15:49,812 | Epoch 27/60 - client 3 -  Training Loss: 32.762

100%|##########| 4/4 [01:10<00:00, 16.02s/it]
100%|##########| 4/4 [01:10<00:00, 17.56s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:15:53,646 | Epoch27 Valid:
2025-08-27 10:15:53,646 | domain:Food
2025-08-27 10:15:53,647 | model_moe:
2025-08-27 10:15:53,647 | MRR: 0.3677
2025-08-27 10:15:53,647 | HR @1|5|10: 0.2754 	 0.4851 	 0.5455 	
2025-08-27 10:15:53,647 | NDCG @5|10: 0.3871 	 0.4067
2025-08-27 10:15:53,648 | domain:Kitchen
2025-08-27 10:15:53,648 | model_moe:
2025-08-27 10:15:53,648 | MRR: 0.1095
2025-08-27 10:15:53,648 | HR @1|5|10: 0.0580 	 0.1552 	 0.2118 	
2025-08-27 10:15:53,649 | NDCG @5|10: 0.1083 	 0.1265
2025-08-27 10:15:53,649 | domain:Clothing
2025-08-27 10:15:53,649 | model_moe:
2025-08-27 10:15:53,650 | MRR: 0.0263
2025-08-27 10:15:53,650 | HR @1|5|10: 0.0134 	 0.0318 	 0.0465 	
2025-08-27 10:15:53,650 | NDCG @5|10: 0.0225 	 0.0271
2025-08-27 10:15:53,650 | domain:Beauty
2025-08-27 10:15:53,651 | model_moe:
2025-08-27 10:15:53,651 | MRR: 0.2497
2025-08-27 10:15:53,651 | HR @1|5|10: 0.1806 	 0.3349 	 0.3828 	
2025-08-27 10:15:53,651 | NDCG @5|10: 0.2607 	 0.2765
2025-08-27 10:15:53,652 | 	avg_model_moe:
2025-08-27 10:15:53,652 | MRR: 0.1883
2025-08-27 10:15:53,652 | HR @1|5|10: 0.1319 	 0.2517 	 0.2966 	
2025-08-27 10:15:53,652 | NDCG @5|10: 0.1946 	 0.2092
2025-08-27 10:15:53,653 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:16:07,717 | Epoch 28/60 - client 0 -  Training Loss: 30.871

 25%|##5       | 1/4 [00:12<00:36, 12.27s/it]2025-08-27 10:16:24,164 | Epoch 28/60 - client 2 -  Training Loss: 29.824

 50%|#####     | 2/4 [00:28<00:29, 14.73s/it]2025-08-27 10:16:54,389 | Epoch 28/60 - client 1 -  Training Loss: 33.076

 75%|#######5  | 3/4 [00:58<00:21, 21.80s/it]2025-08-27 10:17:06,296 | Epoch 28/60 - client 3 -  Training Loss: 32.531

100%|##########| 4/4 [01:10<00:00, 17.90s/it]
100%|##########| 4/4 [01:10<00:00, 17.71s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:17:10,132 | Epoch28 Valid:
2025-08-27 10:17:10,132 | domain:Food
2025-08-27 10:17:10,133 | model_moe:
2025-08-27 10:17:10,133 | MRR: 0.3634
2025-08-27 10:17:10,133 | HR @1|5|10: 0.2670 	 0.4889 	 0.5455 	
2025-08-27 10:17:10,133 | NDCG @5|10: 0.3852 	 0.4035
2025-08-27 10:17:10,134 | domain:Kitchen
2025-08-27 10:17:10,134 | model_moe:
2025-08-27 10:17:10,134 | MRR: 0.1102
2025-08-27 10:17:10,135 | HR @1|5|10: 0.0594 	 0.1547 	 0.2145 	
2025-08-27 10:17:10,135 | NDCG @5|10: 0.1083 	 0.1277
2025-08-27 10:17:10,135 | domain:Clothing
2025-08-27 10:17:10,135 | model_moe:
2025-08-27 10:17:10,136 | MRR: 0.0270
2025-08-27 10:17:10,136 | HR @1|5|10: 0.0134 	 0.0318 	 0.0501 	
2025-08-27 10:17:10,136 | NDCG @5|10: 0.0229 	 0.0287
2025-08-27 10:17:10,136 | domain:Beauty
2025-08-27 10:17:10,137 | model_moe:
2025-08-27 10:17:10,137 | MRR: 0.2478
2025-08-27 10:17:10,137 | HR @1|5|10: 0.1770 	 0.3361 	 0.3816 	
2025-08-27 10:17:10,138 | NDCG @5|10: 0.2596 	 0.2749
2025-08-27 10:17:10,138 | 	avg_model_moe:
2025-08-27 10:17:10,138 | MRR: 0.1871
2025-08-27 10:17:10,140 | HR @1|5|10: 0.1292 	 0.2529 	 0.2979 	
2025-08-27 10:17:10,140 | NDCG @5|10: 0.1940 	 0.2087
2025-08-27 10:17:10,140 | Early Stopping counter: 1 out of 10
2025-08-27 10:17:10,140 | Learning rate decay counter: 1 out of 1
2025-08-27 10:17:10,141 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:17:26,487 | Epoch 29/60 - client 2 -  Training Loss: 29.571

 25%|##5       | 1/4 [00:16<00:49, 16.35s/it]2025-08-27 10:17:38,359 | Epoch 29/60 - client 3 -  Training Loss: 32.299

 50%|#####     | 2/4 [00:28<00:27, 13.72s/it]2025-08-27 10:17:50,559 | Epoch 29/60 - client 0 -  Training Loss: 30.699

 75%|#######5  | 3/4 [00:40<00:13, 13.02s/it]2025-08-27 10:18:20,871 | Epoch 29/60 - client 1 -  Training Loss: 32.805

100%|##########| 4/4 [01:10<00:00, 19.85s/it]
100%|##########| 4/4 [01:10<00:00, 17.68s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:18:24,699 | Epoch29 Valid:
2025-08-27 10:18:24,699 | domain:Food
2025-08-27 10:18:24,700 | model_moe:
2025-08-27 10:18:24,700 | MRR: 0.3637
2025-08-27 10:18:24,700 | HR @1|5|10: 0.2670 	 0.4851 	 0.5455 	
2025-08-27 10:18:24,700 | NDCG @5|10: 0.3841 	 0.4038
2025-08-27 10:18:24,701 | domain:Kitchen
2025-08-27 10:18:24,701 | model_moe:
2025-08-27 10:18:24,701 | MRR: 0.1110
2025-08-27 10:18:24,702 | HR @1|5|10: 0.0599 	 0.1561 	 0.2145 	
2025-08-27 10:18:24,702 | NDCG @5|10: 0.1094 	 0.1284
2025-08-27 10:18:24,702 | domain:Clothing
2025-08-27 10:18:24,702 | model_moe:
2025-08-27 10:18:24,703 | MRR: 0.0273
2025-08-27 10:18:24,703 | HR @1|5|10: 0.0147 	 0.0342 	 0.0489 	
2025-08-27 10:18:24,703 | NDCG @5|10: 0.0240 	 0.0287
2025-08-27 10:18:24,703 | domain:Beauty
2025-08-27 10:18:24,704 | model_moe:
2025-08-27 10:18:24,704 | MRR: 0.2490
2025-08-27 10:18:24,704 | HR @1|5|10: 0.1770 	 0.3325 	 0.3828 	
2025-08-27 10:18:24,704 | NDCG @5|10: 0.2594 	 0.2762
2025-08-27 10:18:24,705 | 	avg_model_moe:
2025-08-27 10:18:24,705 | MRR: 0.1878
2025-08-27 10:18:24,705 | HR @1|5|10: 0.1296 	 0.2520 	 0.2979 	
2025-08-27 10:18:24,705 | NDCG @5|10: 0.1942 	 0.2093
2025-08-27 10:18:24,706 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:18:36,577 | Epoch 30/60 - client 3 -  Training Loss: 32.083

 25%|##5       | 1/4 [00:11<00:35, 11.87s/it]2025-08-27 10:18:48,773 | Epoch 30/60 - client 0 -  Training Loss: 30.528

 50%|#####     | 2/4 [00:24<00:24, 12.06s/it]2025-08-27 10:19:19,002 | Epoch 30/60 - client 1 -  Training Loss: 32.560

 75%|#######5  | 3/4 [00:54<00:20, 20.36s/it]2025-08-27 10:19:35,352 | Epoch 30/60 - client 2 -  Training Loss: 29.333

100%|##########| 4/4 [01:10<00:00, 18.78s/it]
100%|##########| 4/4 [01:10<00:00, 17.66s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 10:19:39,281 | Epoch30 Valid:
2025-08-27 10:19:39,281 | domain:Food
2025-08-27 10:19:39,282 | model_moe:
2025-08-27 10:19:39,282 | MRR: 0.3624
2025-08-27 10:19:39,282 | HR @1|5|10: 0.2624 	 0.4874 	 0.5394 	
2025-08-27 10:19:39,282 | NDCG @5|10: 0.3843 	 0.4013
2025-08-27 10:19:39,283 | domain:Kitchen
2025-08-27 10:19:39,283 | model_moe:
2025-08-27 10:19:39,283 | MRR: 0.1138
2025-08-27 10:19:39,284 | HR @1|5|10: 0.0626 	 0.1607 	 0.2150 	
2025-08-27 10:19:39,284 | NDCG @5|10: 0.1129 	 0.1306
2025-08-27 10:19:39,284 | domain:Clothing
2025-08-27 10:19:39,284 | model_moe:
2025-08-27 10:19:39,285 | MRR: 0.0278
2025-08-27 10:19:39,285 | HR @1|5|10: 0.0147 	 0.0355 	 0.0465 	
2025-08-27 10:19:39,285 | NDCG @5|10: 0.0247 	 0.0283
2025-08-27 10:19:39,285 | domain:Beauty
2025-08-27 10:19:39,286 | model_moe:
2025-08-27 10:19:39,286 | MRR: 0.2468
2025-08-27 10:19:39,286 | HR @1|5|10: 0.1758 	 0.3373 	 0.3816 	
2025-08-27 10:19:39,287 | NDCG @5|10: 0.2597 	 0.2742
2025-08-27 10:19:39,287 | 	avg_model_moe:
2025-08-27 10:19:39,287 | MRR: 0.1877
2025-08-27 10:19:39,287 | HR @1|5|10: 0.1289 	 0.2552 	 0.2956 	
2025-08-27 10:19:39,288 | NDCG @5|10: 0.1954 	 0.2086
2025-08-27 10:19:39,288 | Early Stopping counter: 3 out of 10
2025-08-27 10:19:39,288 | Learning rate decay counter: 1 out of 1
2025-08-27 10:19:39,288 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:20:09,409 | Epoch 31/60 - client 1 -  Training Loss: 32.321

 25%|##5       | 1/4 [00:30<01:30, 30.12s/it]2025-08-27 10:20:21,180 | Epoch 31/60 - client 3 -  Training Loss: 31.890

 50%|#####     | 2/4 [00:41<00:38, 19.33s/it]2025-08-27 10:20:33,263 | Epoch 31/60 - client 0 -  Training Loss: 30.366

 75%|#######5  | 3/4 [00:53<00:16, 16.02s/it]2025-08-27 10:20:49,505 | Epoch 31/60 - client 2 -  Training Loss: 29.115

100%|##########| 4/4 [01:10<00:00, 16.11s/it]
100%|##########| 4/4 [01:10<00:00, 17.55s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:20:53,366 | Epoch31 Valid:
2025-08-27 10:20:53,366 | domain:Food
2025-08-27 10:20:53,367 | model_moe:
2025-08-27 10:20:53,367 | MRR: 0.3639
2025-08-27 10:20:53,367 | HR @1|5|10: 0.2670 	 0.4874 	 0.5417 	
2025-08-27 10:20:53,367 | NDCG @5|10: 0.3852 	 0.4028
2025-08-27 10:20:53,368 | domain:Kitchen
2025-08-27 10:20:53,368 | model_moe:
2025-08-27 10:20:53,368 | MRR: 0.1145
2025-08-27 10:20:53,368 | HR @1|5|10: 0.0640 	 0.1575 	 0.2201 	
2025-08-27 10:20:53,369 | NDCG @5|10: 0.1120 	 0.1323
2025-08-27 10:20:53,369 | domain:Clothing
2025-08-27 10:20:53,369 | model_moe:
2025-08-27 10:20:53,370 | MRR: 0.0270
2025-08-27 10:20:53,370 | HR @1|5|10: 0.0134 	 0.0318 	 0.0477 	
2025-08-27 10:20:53,370 | NDCG @5|10: 0.0229 	 0.0281
2025-08-27 10:20:53,370 | domain:Beauty
2025-08-27 10:20:53,371 | model_moe:
2025-08-27 10:20:53,371 | MRR: 0.2511
2025-08-27 10:20:53,371 | HR @1|5|10: 0.1830 	 0.3385 	 0.3840 	
2025-08-27 10:20:53,371 | NDCG @5|10: 0.2631 	 0.2780
2025-08-27 10:20:53,372 | 	avg_model_moe:
2025-08-27 10:20:53,372 | MRR: 0.1891
2025-08-27 10:20:53,375 | HR @1|5|10: 0.1319 	 0.2538 	 0.2984 	
2025-08-27 10:20:53,375 | NDCG @5|10: 0.1958 	 0.2103
2025-08-27 10:20:53,375 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:21:25,373 | Epoch 32/60 - client 1 -  Training Loss: 32.099

 25%|##5       | 1/4 [00:30<01:30, 30.19s/it]2025-08-27 10:21:37,171 | Epoch 32/60 - client 3 -  Training Loss: 31.681

 50%|#####     | 2/4 [00:41<00:38, 19.37s/it]2025-08-27 10:21:49,261 | Epoch 32/60 - client 0 -  Training Loss: 30.208

 75%|#######5  | 3/4 [00:54<00:16, 16.05s/it]2025-08-27 10:22:05,526 | Epoch 32/60 - client 2 -  Training Loss: 28.901

100%|##########| 4/4 [01:10<00:00, 16.13s/it]
100%|##########| 4/4 [01:10<00:00, 17.59s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:22:09,382 | Epoch32 Valid:
2025-08-27 10:22:09,383 | domain:Food
2025-08-27 10:22:09,383 | model_moe:
2025-08-27 10:22:09,383 | MRR: 0.3630
2025-08-27 10:22:09,384 | HR @1|5|10: 0.2647 	 0.4874 	 0.5409 	
2025-08-27 10:22:09,384 | NDCG @5|10: 0.3847 	 0.4020
2025-08-27 10:22:09,384 | domain:Kitchen
2025-08-27 10:22:09,384 | model_moe:
2025-08-27 10:22:09,385 | MRR: 0.1156
2025-08-27 10:22:09,385 | HR @1|5|10: 0.0635 	 0.1611 	 0.2201 	
2025-08-27 10:22:09,385 | NDCG @5|10: 0.1139 	 0.1332
2025-08-27 10:22:09,386 | domain:Clothing
2025-08-27 10:22:09,386 | model_moe:
2025-08-27 10:22:09,386 | MRR: 0.0300
2025-08-27 10:22:09,386 | HR @1|5|10: 0.0183 	 0.0342 	 0.0489 	
2025-08-27 10:22:09,387 | NDCG @5|10: 0.0260 	 0.0306
2025-08-27 10:22:09,387 | domain:Beauty
2025-08-27 10:22:09,387 | model_moe:
2025-08-27 10:22:09,388 | MRR: 0.2462
2025-08-27 10:22:09,388 | HR @1|5|10: 0.1758 	 0.3361 	 0.3792 	
2025-08-27 10:22:09,388 | NDCG @5|10: 0.2586 	 0.2728
2025-08-27 10:22:09,388 | 	avg_model_moe:
2025-08-27 10:22:09,389 | MRR: 0.1887
2025-08-27 10:22:09,389 | HR @1|5|10: 0.1306 	 0.2547 	 0.2973 	
2025-08-27 10:22:09,389 | NDCG @5|10: 0.1958 	 0.2097
2025-08-27 10:22:09,389 | Early Stopping counter: 1 out of 10
2025-08-27 10:22:09,390 | Learning rate decay counter: 1 out of 1
2025-08-27 10:22:09,390 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:22:25,684 | Epoch 33/60 - client 2 -  Training Loss: 28.698

 25%|##5       | 1/4 [00:16<00:48, 16.29s/it]2025-08-27 10:22:37,497 | Epoch 33/60 - client 3 -  Training Loss: 31.497

 50%|#####     | 2/4 [00:28<00:27, 13.66s/it]2025-08-27 10:23:07,556 | Epoch 33/60 - client 1 -  Training Loss: 31.881

 75%|#######5  | 3/4 [00:58<00:21, 21.15s/it]2025-08-27 10:23:19,852 | Epoch 33/60 - client 0 -  Training Loss: 30.061

100%|##########| 4/4 [01:10<00:00, 17.65s/it]
100%|##########| 4/4 [01:10<00:00, 17.62s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:23:23,694 | Epoch33 Valid:
2025-08-27 10:23:23,695 | domain:Food
2025-08-27 10:23:23,695 | model_moe:
2025-08-27 10:23:23,696 | MRR: 0.3624
2025-08-27 10:23:23,696 | HR @1|5|10: 0.2655 	 0.4881 	 0.5394 	
2025-08-27 10:23:23,696 | NDCG @5|10: 0.3845 	 0.4011
2025-08-27 10:23:23,697 | domain:Kitchen
2025-08-27 10:23:23,697 | model_moe:
2025-08-27 10:23:23,697 | MRR: 0.1152
2025-08-27 10:23:23,698 | HR @1|5|10: 0.0631 	 0.1639 	 0.2215 	
2025-08-27 10:23:23,698 | NDCG @5|10: 0.1145 	 0.1332
2025-08-27 10:23:23,698 | domain:Clothing
2025-08-27 10:23:23,699 | model_moe:
2025-08-27 10:23:23,699 | MRR: 0.0274
2025-08-27 10:23:23,699 | HR @1|5|10: 0.0147 	 0.0330 	 0.0465 	
2025-08-27 10:23:23,700 | NDCG @5|10: 0.0237 	 0.0281
2025-08-27 10:23:23,701 | domain:Beauty
2025-08-27 10:23:23,701 | model_moe:
2025-08-27 10:23:23,701 | MRR: 0.2487
2025-08-27 10:23:23,702 | HR @1|5|10: 0.1782 	 0.3337 	 0.3804 	
2025-08-27 10:23:23,702 | NDCG @5|10: 0.2599 	 0.2754
2025-08-27 10:23:23,702 | 	avg_model_moe:
2025-08-27 10:23:23,702 | MRR: 0.1884
2025-08-27 10:23:23,703 | HR @1|5|10: 0.1304 	 0.2547 	 0.2969 	
2025-08-27 10:23:23,703 | NDCG @5|10: 0.1956 	 0.2094
2025-08-27 10:23:23,703 | Early Stopping counter: 2 out of 10
2025-08-27 10:23:23,704 | Learning rate decay counter: 1 out of 1
2025-08-27 10:23:23,704 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:23:53,741 | Epoch 34/60 - client 1 -  Training Loss: 31.668

 25%|##5       | 1/4 [00:30<01:30, 30.04s/it]2025-08-27 10:24:05,516 | Epoch 34/60 - client 3 -  Training Loss: 31.311

 50%|#####     | 2/4 [00:41<00:38, 19.30s/it]2025-08-27 10:24:17,623 | Epoch 34/60 - client 0 -  Training Loss: 29.921

 75%|#######5  | 3/4 [00:53<00:16, 16.01s/it]2025-08-27 10:24:33,914 | Epoch 34/60 - client 2 -  Training Loss: 28.506

100%|##########| 4/4 [01:10<00:00, 16.12s/it]
100%|##########| 4/4 [01:10<00:00, 17.55s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:24:37,759 | Epoch34 Valid:
2025-08-27 10:24:37,760 | domain:Food
2025-08-27 10:24:37,761 | model_moe:
2025-08-27 10:24:37,763 | MRR: 0.3642
2025-08-27 10:24:37,764 | HR @1|5|10: 0.2686 	 0.4858 	 0.5440 	
2025-08-27 10:24:37,765 | NDCG @5|10: 0.3849 	 0.4038
2025-08-27 10:24:37,767 | domain:Kitchen
2025-08-27 10:24:37,768 | model_moe:
2025-08-27 10:24:37,769 | MRR: 0.1155
2025-08-27 10:24:37,770 | HR @1|5|10: 0.0622 	 0.1680 	 0.2196 	
2025-08-27 10:24:37,771 | NDCG @5|10: 0.1165 	 0.1331
2025-08-27 10:24:37,772 | domain:Clothing
2025-08-27 10:24:37,773 | model_moe:
2025-08-27 10:24:37,775 | MRR: 0.0274
2025-08-27 10:24:37,776 | HR @1|5|10: 0.0147 	 0.0318 	 0.0489 	
2025-08-27 10:24:37,777 | NDCG @5|10: 0.0230 	 0.0286
2025-08-27 10:24:37,778 | domain:Beauty
2025-08-27 10:24:37,779 | model_moe:
2025-08-27 10:24:37,780 | MRR: 0.2479
2025-08-27 10:24:37,782 | HR @1|5|10: 0.1770 	 0.3373 	 0.3804 	
2025-08-27 10:24:37,783 | NDCG @5|10: 0.2605 	 0.2748
2025-08-27 10:24:37,784 | 	avg_model_moe:
2025-08-27 10:24:37,785 | MRR: 0.1887
2025-08-27 10:24:37,786 | HR @1|5|10: 0.1306 	 0.2557 	 0.2982 	
2025-08-27 10:24:37,787 | NDCG @5|10: 0.1962 	 0.2101
2025-08-27 10:24:37,788 | Early Stopping counter: 3 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:25:08,015 | Epoch 35/60 - client 1 -  Training Loss: 31.471

 25%|##5       | 1/4 [00:30<01:30, 30.23s/it]2025-08-27 10:25:20,162 | Epoch 35/60 - client 0 -  Training Loss: 29.784

 50%|#####     | 2/4 [00:42<00:39, 19.59s/it]2025-08-27 10:25:36,461 | Epoch 35/60 - client 2 -  Training Loss: 28.329

 75%|#######5  | 3/4 [00:58<00:18, 18.09s/it]2025-08-27 10:25:48,287 | Epoch 35/60 - client 3 -  Training Loss: 31.143

100%|##########| 4/4 [01:10<00:00, 15.62s/it]
100%|##########| 4/4 [01:10<00:00, 17.62s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:25:52,130 | Epoch35 Valid:
2025-08-27 10:25:52,130 | domain:Food
2025-08-27 10:25:52,131 | model_moe:
2025-08-27 10:25:52,131 | MRR: 0.3640
2025-08-27 10:25:52,131 | HR @1|5|10: 0.2678 	 0.4858 	 0.5409 	
2025-08-27 10:25:52,131 | NDCG @5|10: 0.3848 	 0.4028
2025-08-27 10:25:52,132 | domain:Kitchen
2025-08-27 10:25:52,132 | model_moe:
2025-08-27 10:25:52,132 | MRR: 0.1168
2025-08-27 10:25:52,133 | HR @1|5|10: 0.0631 	 0.1690 	 0.2242 	
2025-08-27 10:25:52,133 | NDCG @5|10: 0.1174 	 0.1351
2025-08-27 10:25:52,133 | domain:Clothing
2025-08-27 10:25:52,133 | model_moe:
2025-08-27 10:25:52,134 | MRR: 0.0275
2025-08-27 10:25:52,134 | HR @1|5|10: 0.0134 	 0.0342 	 0.0477 	
2025-08-27 10:25:52,134 | NDCG @5|10: 0.0242 	 0.0284
2025-08-27 10:25:52,134 | domain:Beauty
2025-08-27 10:25:52,135 | model_moe:
2025-08-27 10:25:52,135 | MRR: 0.2506
2025-08-27 10:25:52,135 | HR @1|5|10: 0.1818 	 0.3373 	 0.3792 	
2025-08-27 10:25:52,136 | NDCG @5|10: 0.2625 	 0.2764
2025-08-27 10:25:52,136 | 	avg_model_moe:
2025-08-27 10:25:52,136 | MRR: 0.1897
2025-08-27 10:25:52,136 | HR @1|5|10: 0.1315 	 0.2566 	 0.2980 	
2025-08-27 10:25:52,137 | NDCG @5|10: 0.1972 	 0.2107
2025-08-27 10:25:52,137 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:26:06,367 | Epoch 36/60 - client 0 -  Training Loss: 29.654

 25%|##5       | 1/4 [00:12<00:36, 12.25s/it]2025-08-27 10:26:36,723 | Epoch 36/60 - client 1 -  Training Loss: 31.280

 50%|#####     | 2/4 [00:42<00:45, 22.90s/it]2025-08-27 10:26:53,112 | Epoch 36/60 - client 2 -  Training Loss: 28.156

 75%|#######5  | 3/4 [00:58<00:19, 19.93s/it]2025-08-27 10:27:04,992 | Epoch 36/60 - client 3 -  Training Loss: 30.979

100%|##########| 4/4 [01:10<00:00, 16.75s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:27:08,820 | Epoch36 Valid:
2025-08-27 10:27:08,821 | domain:Food
2025-08-27 10:27:08,821 | model_moe:
2025-08-27 10:27:08,821 | MRR: 0.3628
2025-08-27 10:27:08,822 | HR @1|5|10: 0.2647 	 0.4866 	 0.5402 	
2025-08-27 10:27:08,822 | NDCG @5|10: 0.3845 	 0.4018
2025-08-27 10:27:08,822 | domain:Kitchen
2025-08-27 10:27:08,823 | model_moe:
2025-08-27 10:27:08,823 | MRR: 0.1186
2025-08-27 10:27:08,823 | HR @1|5|10: 0.0654 	 0.1685 	 0.2247 	
2025-08-27 10:27:08,823 | NDCG @5|10: 0.1184 	 0.1365
2025-08-27 10:27:08,824 | domain:Clothing
2025-08-27 10:27:08,824 | model_moe:
2025-08-27 10:27:08,824 | MRR: 0.0268
2025-08-27 10:27:08,824 | HR @1|5|10: 0.0134 	 0.0342 	 0.0440 	
2025-08-27 10:27:08,825 | NDCG @5|10: 0.0237 	 0.0267
2025-08-27 10:27:08,825 | domain:Beauty
2025-08-27 10:27:08,825 | model_moe:
2025-08-27 10:27:08,826 | MRR: 0.2518
2025-08-27 10:27:08,826 | HR @1|5|10: 0.1842 	 0.3325 	 0.3816 	
2025-08-27 10:27:08,826 | NDCG @5|10: 0.2617 	 0.2780
2025-08-27 10:27:08,826 | 	avg_model_moe:
2025-08-27 10:27:08,827 | MRR: 0.1900
2025-08-27 10:27:08,827 | HR @1|5|10: 0.1319 	 0.2555 	 0.2976 	
2025-08-27 10:27:08,827 | NDCG @5|10: 0.1971 	 0.2108
2025-08-27 10:27:08,828 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:27:40,708 | Epoch 37/60 - client 1 -  Training Loss: 31.093

 25%|##5       | 1/4 [00:30<01:30, 30.11s/it]2025-08-27 10:27:56,967 | Epoch 37/60 - client 2 -  Training Loss: 27.976

 50%|#####     | 2/4 [00:46<00:43, 21.96s/it]2025-08-27 10:28:09,068 | Epoch 37/60 - client 0 -  Training Loss: 29.527

 75%|#######5  | 3/4 [00:58<00:17, 17.46s/it]2025-08-27 10:28:20,980 | Epoch 37/60 - client 3 -  Training Loss: 30.813

100%|##########| 4/4 [01:10<00:00, 15.27s/it]
100%|##########| 4/4 [01:10<00:00, 17.60s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:28:24,829 | Epoch37 Valid:
2025-08-27 10:28:24,830 | domain:Food
2025-08-27 10:28:24,830 | model_moe:
2025-08-27 10:28:24,830 | MRR: 0.3647
2025-08-27 10:28:24,831 | HR @1|5|10: 0.2708 	 0.4843 	 0.5440 	
2025-08-27 10:28:24,831 | NDCG @5|10: 0.3850 	 0.4043
2025-08-27 10:28:24,831 | domain:Kitchen
2025-08-27 10:28:24,831 | model_moe:
2025-08-27 10:28:24,832 | MRR: 0.1175
2025-08-27 10:28:24,832 | HR @1|5|10: 0.0626 	 0.1690 	 0.2261 	
2025-08-27 10:28:24,832 | NDCG @5|10: 0.1178 	 0.1362
2025-08-27 10:28:24,833 | domain:Clothing
2025-08-27 10:28:24,833 | model_moe:
2025-08-27 10:28:24,833 | MRR: 0.0284
2025-08-27 10:28:24,833 | HR @1|5|10: 0.0147 	 0.0318 	 0.0489 	
2025-08-27 10:28:24,834 | NDCG @5|10: 0.0239 	 0.0294
2025-08-27 10:28:24,834 | domain:Beauty
2025-08-27 10:28:24,834 | model_moe:
2025-08-27 10:28:24,835 | MRR: 0.2503
2025-08-27 10:28:24,835 | HR @1|5|10: 0.1818 	 0.3361 	 0.3816 	
2025-08-27 10:28:24,835 | NDCG @5|10: 0.2617 	 0.2769
2025-08-27 10:28:24,835 | 	avg_model_moe:
2025-08-27 10:28:24,836 | MRR: 0.1902
2025-08-27 10:28:24,836 | HR @1|5|10: 0.1325 	 0.2553 	 0.3001 	
2025-08-27 10:28:24,836 | NDCG @5|10: 0.1971 	 0.2117
2025-08-27 10:28:24,837 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:28:39,195 | Epoch 38/60 - client 0 -  Training Loss: 29.383

 25%|##5       | 1/4 [00:12<00:36, 12.31s/it]2025-08-27 10:28:51,474 | Epoch 38/60 - client 3 -  Training Loss: 30.646

 50%|#####     | 2/4 [00:24<00:24, 12.29s/it]2025-08-27 10:29:07,976 | Epoch 38/60 - client 2 -  Training Loss: 27.803

 75%|#######5  | 3/4 [00:41<00:14, 14.21s/it]2025-08-27 10:29:38,211 | Epoch 38/60 - client 1 -  Training Loss: 30.910

100%|##########| 4/4 [01:11<00:00, 20.54s/it]
100%|##########| 4/4 [01:11<00:00, 17.83s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:29:42,051 | Epoch38 Valid:
2025-08-27 10:29:42,051 | domain:Food
2025-08-27 10:29:42,052 | model_moe:
2025-08-27 10:29:42,052 | MRR: 0.3635
2025-08-27 10:29:42,052 | HR @1|5|10: 0.2663 	 0.4904 	 0.5432 	
2025-08-27 10:29:42,052 | NDCG @5|10: 0.3861 	 0.4031
2025-08-27 10:29:42,053 | domain:Kitchen
2025-08-27 10:29:42,053 | model_moe:
2025-08-27 10:29:42,053 | MRR: 0.1178
2025-08-27 10:29:42,054 | HR @1|5|10: 0.0631 	 0.1676 	 0.2242 	
2025-08-27 10:29:42,054 | NDCG @5|10: 0.1175 	 0.1359
2025-08-27 10:29:42,054 | domain:Clothing
2025-08-27 10:29:42,054 | model_moe:
2025-08-27 10:29:42,055 | MRR: 0.0280
2025-08-27 10:29:42,055 | HR @1|5|10: 0.0134 	 0.0318 	 0.0440 	
2025-08-27 10:29:42,055 | NDCG @5|10: 0.0238 	 0.0277
2025-08-27 10:29:42,056 | domain:Beauty
2025-08-27 10:29:42,056 | model_moe:
2025-08-27 10:29:42,056 | MRR: 0.2496
2025-08-27 10:29:42,056 | HR @1|5|10: 0.1806 	 0.3313 	 0.3840 	
2025-08-27 10:29:42,057 | NDCG @5|10: 0.2595 	 0.2769
2025-08-27 10:29:42,057 | 	avg_model_moe:
2025-08-27 10:29:42,057 | MRR: 0.1897
2025-08-27 10:29:42,058 | HR @1|5|10: 0.1309 	 0.2553 	 0.2989 	
2025-08-27 10:29:42,058 | NDCG @5|10: 0.1967 	 0.2109
2025-08-27 10:29:42,058 | Early Stopping counter: 1 out of 10
2025-08-27 10:29:42,058 | Learning rate decay counter: 1 out of 1
2025-08-27 10:29:42,059 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:30:12,443 | Epoch 39/60 - client 1 -  Training Loss: 30.729

 25%|##5       | 1/4 [00:30<01:31, 30.38s/it]2025-08-27 10:30:24,340 | Epoch 39/60 - client 3 -  Training Loss: 30.490

 50%|#####     | 2/4 [00:42<00:39, 19.51s/it]2025-08-27 10:30:36,558 | Epoch 39/60 - client 0 -  Training Loss: 29.275

 75%|#######5  | 3/4 [00:54<00:16, 16.18s/it]2025-08-27 10:30:52,942 | Epoch 39/60 - client 2 -  Training Loss: 27.647

100%|##########| 4/4 [01:10<00:00, 16.26s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:30:56,809 | Epoch39 Valid:
2025-08-27 10:30:56,809 | domain:Food
2025-08-27 10:30:56,809 | model_moe:
2025-08-27 10:30:56,810 | MRR: 0.3647
2025-08-27 10:30:56,810 | HR @1|5|10: 0.2701 	 0.4843 	 0.5432 	
2025-08-27 10:30:56,810 | NDCG @5|10: 0.3849 	 0.4040
2025-08-27 10:30:56,810 | domain:Kitchen
2025-08-27 10:30:56,811 | model_moe:
2025-08-27 10:30:56,811 | MRR: 0.1177
2025-08-27 10:30:56,811 | HR @1|5|10: 0.0626 	 0.1657 	 0.2270 	
2025-08-27 10:30:56,812 | NDCG @5|10: 0.1167 	 0.1364
2025-08-27 10:30:56,812 | domain:Clothing
2025-08-27 10:30:56,812 | model_moe:
2025-08-27 10:30:56,812 | MRR: 0.0280
2025-08-27 10:30:56,813 | HR @1|5|10: 0.0134 	 0.0342 	 0.0465 	
2025-08-27 10:30:56,813 | NDCG @5|10: 0.0245 	 0.0284
2025-08-27 10:30:56,813 | domain:Beauty
2025-08-27 10:30:56,814 | model_moe:
2025-08-27 10:30:56,814 | MRR: 0.2470
2025-08-27 10:30:56,814 | HR @1|5|10: 0.1770 	 0.3289 	 0.3828 	
2025-08-27 10:30:56,814 | NDCG @5|10: 0.2567 	 0.2745
2025-08-27 10:30:56,815 | 	avg_model_moe:
2025-08-27 10:30:56,815 | MRR: 0.1893
2025-08-27 10:30:56,815 | HR @1|5|10: 0.1308 	 0.2533 	 0.2999 	
2025-08-27 10:30:56,816 | NDCG @5|10: 0.1957 	 0.2108
2025-08-27 10:30:56,816 | Early Stopping counter: 2 out of 10
2025-08-27 10:30:56,816 | Learning rate decay counter: 1 out of 1
2025-08-27 10:30:56,816 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:31:09,058 | Epoch 40/60 - client 0 -  Training Loss: 29.163

 25%|##5       | 1/4 [00:12<00:36, 12.24s/it]2025-08-27 10:31:25,438 | Epoch 40/60 - client 2 -  Training Loss: 27.508

 50%|#####     | 2/4 [00:28<00:29, 14.68s/it]2025-08-27 10:31:37,419 | Epoch 40/60 - client 3 -  Training Loss: 30.349

 75%|#######5  | 3/4 [00:40<00:13, 13.45s/it]2025-08-27 10:32:07,718 | Epoch 40/60 - client 1 -  Training Loss: 30.562

100%|##########| 4/4 [01:10<00:00, 20.10s/it]
100%|##########| 4/4 [01:10<00:00, 17.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 10:32:11,625 | Epoch40 Valid:
2025-08-27 10:32:11,626 | domain:Food
2025-08-27 10:32:11,626 | model_moe:
2025-08-27 10:32:11,626 | MRR: 0.3628
2025-08-27 10:32:11,627 | HR @1|5|10: 0.2647 	 0.4889 	 0.5409 	
2025-08-27 10:32:11,627 | NDCG @5|10: 0.3852 	 0.4021
2025-08-27 10:32:11,627 | domain:Kitchen
2025-08-27 10:32:11,628 | model_moe:
2025-08-27 10:32:11,628 | MRR: 0.1187
2025-08-27 10:32:11,628 | HR @1|5|10: 0.0635 	 0.1717 	 0.2274 	
2025-08-27 10:32:11,629 | NDCG @5|10: 0.1194 	 0.1373
2025-08-27 10:32:11,629 | domain:Clothing
2025-08-27 10:32:11,629 | model_moe:
2025-08-27 10:32:11,629 | MRR: 0.0272
2025-08-27 10:32:11,630 | HR @1|5|10: 0.0122 	 0.0379 	 0.0416 	
2025-08-27 10:32:11,630 | NDCG @5|10: 0.0254 	 0.0265
2025-08-27 10:32:11,630 | domain:Beauty
2025-08-27 10:32:11,630 | model_moe:
2025-08-27 10:32:11,631 | MRR: 0.2450
2025-08-27 10:32:11,631 | HR @1|5|10: 0.1746 	 0.3337 	 0.3816 	
2025-08-27 10:32:11,631 | NDCG @5|10: 0.2571 	 0.2728
2025-08-27 10:32:11,632 | 	avg_model_moe:
2025-08-27 10:32:11,632 | MRR: 0.1885
2025-08-27 10:32:11,632 | HR @1|5|10: 0.1288 	 0.2581 	 0.2979 	
2025-08-27 10:32:11,632 | NDCG @5|10: 0.1968 	 0.2097
2025-08-27 10:32:11,633 | Early Stopping counter: 3 out of 10
2025-08-27 10:32:11,633 | Learning rate decay counter: 1 out of 1
2025-08-27 10:32:11,633 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:32:41,929 | Epoch 41/60 - client 1 -  Training Loss: 30.397

 25%|##5       | 1/4 [00:30<01:30, 30.30s/it]2025-08-27 10:32:58,356 | Epoch 41/60 - client 2 -  Training Loss: 27.367

 50%|#####     | 2/4 [00:46<00:44, 22.14s/it]2025-08-27 10:33:10,705 | Epoch 41/60 - client 0 -  Training Loss: 29.052

 75%|#######5  | 3/4 [00:59<00:17, 17.67s/it]2025-08-27 10:33:22,658 | Epoch 41/60 - client 3 -  Training Loss: 30.213

100%|##########| 4/4 [01:11<00:00, 15.41s/it]
100%|##########| 4/4 [01:11<00:00, 17.76s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:33:26,525 | Epoch41 Valid:
2025-08-27 10:33:26,525 | domain:Food
2025-08-27 10:33:26,526 | model_moe:
2025-08-27 10:33:26,526 | MRR: 0.3630
2025-08-27 10:33:26,526 | HR @1|5|10: 0.2670 	 0.4881 	 0.5409 	
2025-08-27 10:33:26,527 | NDCG @5|10: 0.3849 	 0.4021
2025-08-27 10:33:26,527 | domain:Kitchen
2025-08-27 10:33:26,527 | model_moe:
2025-08-27 10:33:26,527 | MRR: 0.1176
2025-08-27 10:33:26,528 | HR @1|5|10: 0.0626 	 0.1713 	 0.2247 	
2025-08-27 10:33:26,528 | NDCG @5|10: 0.1185 	 0.1357
2025-08-27 10:33:26,528 | domain:Clothing
2025-08-27 10:33:26,529 | model_moe:
2025-08-27 10:33:26,529 | MRR: 0.0273
2025-08-27 10:33:26,529 | HR @1|5|10: 0.0134 	 0.0330 	 0.0428 	
2025-08-27 10:33:26,529 | NDCG @5|10: 0.0237 	 0.0268
2025-08-27 10:33:26,530 | domain:Beauty
2025-08-27 10:33:26,530 | model_moe:
2025-08-27 10:33:26,530 | MRR: 0.2486
2025-08-27 10:33:26,530 | HR @1|5|10: 0.1794 	 0.3289 	 0.3816 	
2025-08-27 10:33:26,531 | NDCG @5|10: 0.2579 	 0.2754
2025-08-27 10:33:26,531 | 	avg_model_moe:
2025-08-27 10:33:26,531 | MRR: 0.1891
2025-08-27 10:33:26,532 | HR @1|5|10: 0.1306 	 0.2553 	 0.2975 	
2025-08-27 10:33:26,532 | NDCG @5|10: 0.1962 	 0.2100
2025-08-27 10:33:26,532 | Early Stopping counter: 4 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:33:56,611 | Epoch 42/60 - client 1 -  Training Loss: 30.242

 25%|##5       | 1/4 [00:30<01:30, 30.08s/it]2025-08-27 10:34:12,874 | Epoch 42/60 - client 2 -  Training Loss: 27.229

 50%|#####     | 2/4 [00:46<00:43, 21.95s/it]2025-08-27 10:34:24,670 | Epoch 42/60 - client 3 -  Training Loss: 30.069

 75%|#######5  | 3/4 [00:58<00:17, 17.31s/it]2025-08-27 10:34:36,757 | Epoch 42/60 - client 0 -  Training Loss: 28.944

100%|##########| 4/4 [01:10<00:00, 15.25s/it]
100%|##########| 4/4 [01:10<00:00, 17.56s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:34:40,584 | Epoch42 Valid:
2025-08-27 10:34:40,584 | domain:Food
2025-08-27 10:34:40,585 | model_moe:
2025-08-27 10:34:40,585 | MRR: 0.3626
2025-08-27 10:34:40,585 | HR @1|5|10: 0.2663 	 0.4866 	 0.5409 	
2025-08-27 10:34:40,586 | NDCG @5|10: 0.3841 	 0.4018
2025-08-27 10:34:40,586 | domain:Kitchen
2025-08-27 10:34:40,586 | model_moe:
2025-08-27 10:34:40,587 | MRR: 0.1194
2025-08-27 10:34:40,587 | HR @1|5|10: 0.0654 	 0.1690 	 0.2284 	
2025-08-27 10:34:40,587 | NDCG @5|10: 0.1189 	 0.1380
2025-08-27 10:34:40,587 | domain:Clothing
2025-08-27 10:34:40,588 | model_moe:
2025-08-27 10:34:40,588 | MRR: 0.0269
2025-08-27 10:34:40,588 | HR @1|5|10: 0.0122 	 0.0342 	 0.0416 	
2025-08-27 10:34:40,589 | NDCG @5|10: 0.0238 	 0.0262
2025-08-27 10:34:40,589 | domain:Beauty
2025-08-27 10:34:40,589 | model_moe:
2025-08-27 10:34:40,589 | MRR: 0.2447
2025-08-27 10:34:40,590 | HR @1|5|10: 0.1711 	 0.3254 	 0.3840 	
2025-08-27 10:34:40,590 | NDCG @5|10: 0.2539 	 0.2733
2025-08-27 10:34:40,590 | 	avg_model_moe:
2025-08-27 10:34:40,590 | MRR: 0.1884
2025-08-27 10:34:40,591 | HR @1|5|10: 0.1287 	 0.2538 	 0.2987 	
2025-08-27 10:34:40,591 | NDCG @5|10: 0.1952 	 0.2098
2025-08-27 10:34:40,591 | Early Stopping counter: 5 out of 10
2025-08-27 10:34:40,592 | Learning rate decay counter: 1 out of 1
2025-08-27 10:34:40,592 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:35:10,687 | Epoch 43/60 - client 1 -  Training Loss: 30.090

 25%|##5       | 1/4 [00:30<01:30, 30.10s/it]2025-08-27 10:35:26,923 | Epoch 43/60 - client 2 -  Training Loss: 27.100

 50%|#####     | 2/4 [00:46<00:43, 21.94s/it]2025-08-27 10:35:38,675 | Epoch 43/60 - client 3 -  Training Loss: 29.939

 75%|#######5  | 3/4 [00:58<00:17, 17.29s/it]2025-08-27 10:35:50,727 | Epoch 43/60 - client 0 -  Training Loss: 28.843

100%|##########| 4/4 [01:10<00:00, 15.22s/it]
100%|##########| 4/4 [01:10<00:00, 17.53s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 10:35:54,574 | Epoch43 Valid:
2025-08-27 10:35:54,575 | domain:Food
2025-08-27 10:35:54,575 | model_moe:
2025-08-27 10:35:54,575 | MRR: 0.3626
2025-08-27 10:35:54,576 | HR @1|5|10: 0.2670 	 0.4866 	 0.5402 	
2025-08-27 10:35:54,576 | NDCG @5|10: 0.3844 	 0.4017
2025-08-27 10:35:54,576 | domain:Kitchen
2025-08-27 10:35:54,577 | model_moe:
2025-08-27 10:35:54,577 | MRR: 0.1190
2025-08-27 10:35:54,577 | HR @1|5|10: 0.0654 	 0.1699 	 0.2270 	
2025-08-27 10:35:54,577 | NDCG @5|10: 0.1189 	 0.1373
2025-08-27 10:35:54,578 | domain:Clothing
2025-08-27 10:35:54,578 | model_moe:
2025-08-27 10:35:54,578 | MRR: 0.0276
2025-08-27 10:35:54,579 | HR @1|5|10: 0.0134 	 0.0342 	 0.0452 	
2025-08-27 10:35:54,579 | NDCG @5|10: 0.0243 	 0.0279
2025-08-27 10:35:54,579 | domain:Beauty
2025-08-27 10:35:54,579 | model_moe:
2025-08-27 10:35:54,580 | MRR: 0.2495
2025-08-27 10:35:54,580 | HR @1|5|10: 0.1794 	 0.3301 	 0.3840 	
2025-08-27 10:35:54,580 | NDCG @5|10: 0.2589 	 0.2766
2025-08-27 10:35:54,580 | 	avg_model_moe:
2025-08-27 10:35:54,581 | MRR: 0.1897
2025-08-27 10:35:54,581 | HR @1|5|10: 0.1313 	 0.2552 	 0.2991 	
2025-08-27 10:35:54,581 | NDCG @5|10: 0.1966 	 0.2109
2025-08-27 10:35:54,582 | Early Stopping counter: 6 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:36:24,590 | Epoch 44/60 - client 1 -  Training Loss: 29.943

 25%|##5       | 1/4 [00:30<01:30, 30.01s/it]2025-08-27 10:36:36,422 | Epoch 44/60 - client 3 -  Training Loss: 29.809

 50%|#####     | 2/4 [00:41<00:38, 19.32s/it]2025-08-27 10:36:48,469 | Epoch 44/60 - client 0 -  Training Loss: 28.737

 75%|#######5  | 3/4 [00:53<00:15, 16.00s/it]2025-08-27 10:37:04,695 | Epoch 44/60 - client 2 -  Training Loss: 26.972

100%|##########| 4/4 [01:10<00:00, 16.09s/it]
100%|##########| 4/4 [01:10<00:00, 17.53s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:37:08,517 | Epoch44 Valid:
2025-08-27 10:37:08,517 | domain:Food
2025-08-27 10:37:08,518 | model_moe:
2025-08-27 10:37:08,518 | MRR: 0.3660
2025-08-27 10:37:08,518 | HR @1|5|10: 0.2708 	 0.4874 	 0.5448 	
2025-08-27 10:37:08,518 | NDCG @5|10: 0.3868 	 0.4053
2025-08-27 10:37:08,519 | domain:Kitchen
2025-08-27 10:37:08,519 | model_moe:
2025-08-27 10:37:08,519 | MRR: 0.1204
2025-08-27 10:37:08,520 | HR @1|5|10: 0.0663 	 0.1703 	 0.2261 	
2025-08-27 10:37:08,520 | NDCG @5|10: 0.1201 	 0.1380
2025-08-27 10:37:08,520 | domain:Clothing
2025-08-27 10:37:08,521 | model_moe:
2025-08-27 10:37:08,521 | MRR: 0.0275
2025-08-27 10:37:08,521 | HR @1|5|10: 0.0122 	 0.0367 	 0.0428 	
2025-08-27 10:37:08,521 | NDCG @5|10: 0.0252 	 0.0271
2025-08-27 10:37:08,522 | domain:Beauty
2025-08-27 10:37:08,522 | model_moe:
2025-08-27 10:37:08,522 | MRR: 0.2474
2025-08-27 10:37:08,523 | HR @1|5|10: 0.1770 	 0.3230 	 0.3852 	
2025-08-27 10:37:08,523 | NDCG @5|10: 0.2550 	 0.2755
2025-08-27 10:37:08,523 | 	avg_model_moe:
2025-08-27 10:37:08,523 | MRR: 0.1903
2025-08-27 10:37:08,524 | HR @1|5|10: 0.1316 	 0.2543 	 0.2997 	
2025-08-27 10:37:08,524 | NDCG @5|10: 0.1968 	 0.2115
2025-08-27 10:37:08,524 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:37:22,998 | Epoch 45/60 - client 0 -  Training Loss: 28.643

 25%|##5       | 1/4 [00:12<00:36, 12.07s/it]2025-08-27 10:37:52,988 | Epoch 45/60 - client 1 -  Training Loss: 29.804

 50%|#####     | 2/4 [00:42<00:45, 22.61s/it]2025-08-27 10:38:09,323 | Epoch 45/60 - client 2 -  Training Loss: 26.849

 75%|#######5  | 3/4 [00:58<00:19, 19.75s/it]2025-08-27 10:38:21,069 | Epoch 45/60 - client 3 -  Training Loss: 29.688

100%|##########| 4/4 [01:10<00:00, 16.59s/it]
100%|##########| 4/4 [01:10<00:00, 17.54s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:38:24,882 | Epoch45 Valid:
2025-08-27 10:38:24,882 | domain:Food
2025-08-27 10:38:24,882 | model_moe:
2025-08-27 10:38:24,883 | MRR: 0.3656
2025-08-27 10:38:24,883 | HR @1|5|10: 0.2716 	 0.4881 	 0.5471 	
2025-08-27 10:38:24,883 | NDCG @5|10: 0.3867 	 0.4057
2025-08-27 10:38:24,883 | domain:Kitchen
2025-08-27 10:38:24,884 | model_moe:
2025-08-27 10:38:24,884 | MRR: 0.1196
2025-08-27 10:38:24,884 | HR @1|5|10: 0.0663 	 0.1667 	 0.2228 	
2025-08-27 10:38:24,884 | NDCG @5|10: 0.1183 	 0.1365
2025-08-27 10:38:24,885 | domain:Clothing
2025-08-27 10:38:24,885 | model_moe:
2025-08-27 10:38:24,885 | MRR: 0.0265
2025-08-27 10:38:24,886 | HR @1|5|10: 0.0110 	 0.0342 	 0.0428 	
2025-08-27 10:38:24,886 | NDCG @5|10: 0.0235 	 0.0262
2025-08-27 10:38:24,886 | domain:Beauty
2025-08-27 10:38:24,886 | model_moe:
2025-08-27 10:38:24,887 | MRR: 0.2489
2025-08-27 10:38:24,887 | HR @1|5|10: 0.1782 	 0.3289 	 0.3876 	
2025-08-27 10:38:24,887 | NDCG @5|10: 0.2581 	 0.2772
2025-08-27 10:38:24,888 | 	avg_model_moe:
2025-08-27 10:38:24,888 | MRR: 0.1901
2025-08-27 10:38:24,888 | HR @1|5|10: 0.1318 	 0.2545 	 0.3001 	
2025-08-27 10:38:24,888 | NDCG @5|10: 0.1967 	 0.2114
2025-08-27 10:38:24,889 | Early Stopping counter: 1 out of 10
2025-08-27 10:38:24,889 | Learning rate decay counter: 1 out of 1
2025-08-27 10:38:24,889 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:38:54,848 | Epoch 46/60 - client 1 -  Training Loss: 29.661

 25%|##5       | 1/4 [00:29<01:29, 29.96s/it]2025-08-27 10:39:06,921 | Epoch 46/60 - client 0 -  Training Loss: 28.543

 50%|#####     | 2/4 [00:42<00:38, 19.44s/it]2025-08-27 10:39:18,648 | Epoch 46/60 - client 3 -  Training Loss: 29.566

 75%|#######5  | 3/4 [00:53<00:15, 15.92s/it]2025-08-27 10:39:34,861 | Epoch 46/60 - client 2 -  Training Loss: 26.733

100%|##########| 4/4 [01:09<00:00, 16.03s/it]
100%|##########| 4/4 [01:09<00:00, 17.49s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.09it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:39:38,666 | Epoch46 Valid:
2025-08-27 10:39:38,666 | domain:Food
2025-08-27 10:39:38,667 | model_moe:
2025-08-27 10:39:38,667 | MRR: 0.3639
2025-08-27 10:39:38,667 | HR @1|5|10: 0.2678 	 0.4851 	 0.5425 	
2025-08-27 10:39:38,668 | NDCG @5|10: 0.3847 	 0.4033
2025-08-27 10:39:38,668 | domain:Kitchen
2025-08-27 10:39:38,668 | model_moe:
2025-08-27 10:39:38,669 | MRR: 0.1212
2025-08-27 10:39:38,669 | HR @1|5|10: 0.0681 	 0.1713 	 0.2284 	
2025-08-27 10:39:38,669 | NDCG @5|10: 0.1209 	 0.1392
2025-08-27 10:39:38,669 | domain:Clothing
2025-08-27 10:39:38,670 | model_moe:
2025-08-27 10:39:38,670 | MRR: 0.0257
2025-08-27 10:39:38,670 | HR @1|5|10: 0.0098 	 0.0342 	 0.0465 	
2025-08-27 10:39:38,671 | NDCG @5|10: 0.0229 	 0.0267
2025-08-27 10:39:38,671 | domain:Beauty
2025-08-27 10:39:38,671 | model_moe:
2025-08-27 10:39:38,671 | MRR: 0.2482
2025-08-27 10:39:38,672 | HR @1|5|10: 0.1782 	 0.3266 	 0.3900 	
2025-08-27 10:39:38,672 | NDCG @5|10: 0.2565 	 0.2773
2025-08-27 10:39:38,672 | 	avg_model_moe:
2025-08-27 10:39:38,672 | MRR: 0.1897
2025-08-27 10:39:38,673 | HR @1|5|10: 0.1310 	 0.2543 	 0.3018 	
2025-08-27 10:39:38,673 | NDCG @5|10: 0.1962 	 0.2116
2025-08-27 10:39:38,673 | Early Stopping counter: 2 out of 10
2025-08-27 10:39:38,674 | Learning rate decay counter: 1 out of 1
2025-08-27 10:39:38,674 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:39:50,760 | Epoch 47/60 - client 0 -  Training Loss: 28.454

 25%|##5       | 1/4 [00:12<00:36, 12.09s/it]2025-08-27 10:40:02,467 | Epoch 47/60 - client 3 -  Training Loss: 29.446

 50%|#####     | 2/4 [00:23<00:23, 11.86s/it]2025-08-27 10:40:32,424 | Epoch 47/60 - client 1 -  Training Loss: 29.529

 75%|#######5  | 3/4 [00:53<00:20, 20.13s/it]2025-08-27 10:40:48,615 | Epoch 47/60 - client 2 -  Training Loss: 26.620

100%|##########| 4/4 [01:09<00:00, 18.57s/it]
100%|##########| 4/4 [01:09<00:00, 17.49s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.10it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.00s/it]
100%|##########| 4/4 [00:03<00:00,  1.16it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:40:52,404 | Epoch47 Valid:
2025-08-27 10:40:52,404 | domain:Food
2025-08-27 10:40:52,405 | model_moe:
2025-08-27 10:40:52,405 | MRR: 0.3661
2025-08-27 10:40:52,405 | HR @1|5|10: 0.2716 	 0.4881 	 0.5425 	
2025-08-27 10:40:52,406 | NDCG @5|10: 0.3873 	 0.4050
2025-08-27 10:40:52,406 | domain:Kitchen
2025-08-27 10:40:52,406 | model_moe:
2025-08-27 10:40:52,406 | MRR: 0.1210
2025-08-27 10:40:52,408 | HR @1|5|10: 0.0672 	 0.1713 	 0.2284 	
2025-08-27 10:40:52,408 | NDCG @5|10: 0.1208 	 0.1392
2025-08-27 10:40:52,409 | domain:Clothing
2025-08-27 10:40:52,409 | model_moe:
2025-08-27 10:40:52,409 | MRR: 0.0267
2025-08-27 10:40:52,409 | HR @1|5|10: 0.0122 	 0.0367 	 0.0452 	
2025-08-27 10:40:52,410 | NDCG @5|10: 0.0245 	 0.0272
2025-08-27 10:40:52,410 | domain:Beauty
2025-08-27 10:40:52,410 | model_moe:
2025-08-27 10:40:52,411 | MRR: 0.2496
2025-08-27 10:40:52,411 | HR @1|5|10: 0.1794 	 0.3301 	 0.3888 	
2025-08-27 10:40:52,411 | NDCG @5|10: 0.2590 	 0.2781
2025-08-27 10:40:52,411 | 	avg_model_moe:
2025-08-27 10:40:52,412 | MRR: 0.1908
2025-08-27 10:40:52,412 | HR @1|5|10: 0.1326 	 0.2566 	 0.3012 	
2025-08-27 10:40:52,412 | NDCG @5|10: 0.1979 	 0.2124
2025-08-27 10:40:52,413 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:41:24,212 | Epoch 48/60 - client 1 -  Training Loss: 29.407

 25%|##5       | 1/4 [00:29<01:29, 29.81s/it]2025-08-27 10:41:36,122 | Epoch 48/60 - client 0 -  Training Loss: 28.361

 50%|#####     | 2/4 [00:41<00:38, 19.28s/it]2025-08-27 10:41:47,715 | Epoch 48/60 - client 3 -  Training Loss: 29.337

 75%|#######5  | 3/4 [00:53<00:15, 15.77s/it]2025-08-27 10:42:03,801 | Epoch 48/60 - client 2 -  Training Loss: 26.512

100%|##########| 4/4 [01:09<00:00, 15.90s/it]
100%|##########| 4/4 [01:09<00:00, 17.35s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.10it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.27s/it]
 75%|#######5  | 3/4 [00:03<00:00,  1.00it/s]
100%|##########| 4/4 [00:03<00:00,  1.17it/s]
100%|##########| 4/4 [00:03<00:00,  1.07it/s]
2025-08-27 10:42:07,558 | Epoch48 Valid:
2025-08-27 10:42:07,558 | domain:Food
2025-08-27 10:42:07,559 | model_moe:
2025-08-27 10:42:07,559 | MRR: 0.3657
2025-08-27 10:42:07,559 | HR @1|5|10: 0.2724 	 0.4828 	 0.5432 	
2025-08-27 10:42:07,560 | NDCG @5|10: 0.3851 	 0.4047
2025-08-27 10:42:07,560 | domain:Kitchen
2025-08-27 10:42:07,560 | model_moe:
2025-08-27 10:42:07,561 | MRR: 0.1211
2025-08-27 10:42:07,561 | HR @1|5|10: 0.0695 	 0.1667 	 0.2238 	
2025-08-27 10:42:07,561 | NDCG @5|10: 0.1193 	 0.1379
2025-08-27 10:42:07,561 | domain:Clothing
2025-08-27 10:42:07,562 | model_moe:
2025-08-27 10:42:07,562 | MRR: 0.0279
2025-08-27 10:42:07,562 | HR @1|5|10: 0.0134 	 0.0355 	 0.0465 	
2025-08-27 10:42:07,563 | NDCG @5|10: 0.0248 	 0.0284
2025-08-27 10:42:07,563 | domain:Beauty
2025-08-27 10:42:07,563 | model_moe:
2025-08-27 10:42:07,564 | MRR: 0.2487
2025-08-27 10:42:07,564 | HR @1|5|10: 0.1794 	 0.3337 	 0.3864 	
2025-08-27 10:42:07,564 | NDCG @5|10: 0.2595 	 0.2768
2025-08-27 10:42:07,564 | 	avg_model_moe:
2025-08-27 10:42:07,565 | MRR: 0.1909
2025-08-27 10:42:07,565 | HR @1|5|10: 0.1337 	 0.2547 	 0.3000 	
2025-08-27 10:42:07,565 | NDCG @5|10: 0.1972 	 0.2120
2025-08-27 10:42:07,565 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:42:25,654 | Epoch 49/60 - client 2 -  Training Loss: 26.409

 25%|##5       | 1/4 [00:16<00:48, 16.10s/it]2025-08-27 10:42:55,412 | Epoch 49/60 - client 1 -  Training Loss: 29.281

 50%|#####     | 2/4 [00:45<00:48, 24.13s/it]2025-08-27 10:43:07,018 | Epoch 49/60 - client 3 -  Training Loss: 29.223

 75%|#######5  | 3/4 [00:57<00:18, 18.41s/it]2025-08-27 10:43:18,909 | Epoch 49/60 - client 0 -  Training Loss: 28.275

100%|##########| 4/4 [01:09<00:00, 15.84s/it]
100%|##########| 4/4 [01:09<00:00, 17.34s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.10it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:00,  1.00it/s]
100%|##########| 4/4 [00:03<00:00,  1.17it/s]
100%|##########| 4/4 [00:03<00:00,  1.07it/s]
2025-08-27 10:43:22,678 | Epoch49 Valid:
2025-08-27 10:43:22,679 | domain:Food
2025-08-27 10:43:22,679 | model_moe:
2025-08-27 10:43:22,679 | MRR: 0.3635
2025-08-27 10:43:22,680 | HR @1|5|10: 0.2708 	 0.4836 	 0.5371 	
2025-08-27 10:43:22,680 | NDCG @5|10: 0.3840 	 0.4015
2025-08-27 10:43:22,680 | domain:Kitchen
2025-08-27 10:43:22,681 | model_moe:
2025-08-27 10:43:22,681 | MRR: 0.1221
2025-08-27 10:43:22,681 | HR @1|5|10: 0.0695 	 0.1694 	 0.2279 	
2025-08-27 10:43:22,681 | NDCG @5|10: 0.1209 	 0.1398
2025-08-27 10:43:22,682 | domain:Clothing
2025-08-27 10:43:22,682 | model_moe:
2025-08-27 10:43:22,682 | MRR: 0.0261
2025-08-27 10:43:22,682 | HR @1|5|10: 0.0110 	 0.0330 	 0.0465 	
2025-08-27 10:43:22,683 | NDCG @5|10: 0.0226 	 0.0270
2025-08-27 10:43:22,683 | domain:Beauty
2025-08-27 10:43:22,683 | model_moe:
2025-08-27 10:43:22,684 | MRR: 0.2545
2025-08-27 10:43:22,684 | HR @1|5|10: 0.1878 	 0.3313 	 0.3852 	
2025-08-27 10:43:22,684 | NDCG @5|10: 0.2632 	 0.2808
2025-08-27 10:43:22,684 | 	avg_model_moe:
2025-08-27 10:43:22,685 | MRR: 0.1916
2025-08-27 10:43:22,685 | HR @1|5|10: 0.1348 	 0.2543 	 0.2992 	
2025-08-27 10:43:22,685 | NDCG @5|10: 0.1977 	 0.2122
2025-08-27 10:43:22,685 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:43:54,433 | Epoch 50/60 - client 1 -  Training Loss: 29.159

 25%|##5       | 1/4 [00:29<01:29, 29.77s/it]2025-08-27 10:44:06,029 | Epoch 50/60 - client 3 -  Training Loss: 29.136

 50%|#####     | 2/4 [00:41<00:38, 19.08s/it]2025-08-27 10:44:22,119 | Epoch 50/60 - client 2 -  Training Loss: 26.317

 75%|#######5  | 3/4 [00:57<00:17, 17.71s/it]2025-08-27 10:44:34,028 | Epoch 50/60 - client 0 -  Training Loss: 28.200

100%|##########| 4/4 [01:09<00:00, 15.42s/it]
100%|##########| 4/4 [01:09<00:00, 17.34s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.09it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.00s/it]
100%|##########| 4/4 [00:03<00:00,  1.17it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:44:37,806 | Epoch50 Valid:
2025-08-27 10:44:37,806 | domain:Food
2025-08-27 10:44:37,806 | model_moe:
2025-08-27 10:44:37,807 | MRR: 0.3665
2025-08-27 10:44:37,807 | HR @1|5|10: 0.2739 	 0.4851 	 0.5409 	
2025-08-27 10:44:37,807 | NDCG @5|10: 0.3867 	 0.4048
2025-08-27 10:44:37,807 | domain:Kitchen
2025-08-27 10:44:37,808 | model_moe:
2025-08-27 10:44:37,808 | MRR: 0.1206
2025-08-27 10:44:37,808 | HR @1|5|10: 0.0681 	 0.1680 	 0.2302 	
2025-08-27 10:44:37,809 | NDCG @5|10: 0.1193 	 0.1392
2025-08-27 10:44:37,809 | domain:Clothing
2025-08-27 10:44:37,809 | model_moe:
2025-08-27 10:44:37,809 | MRR: 0.0260
2025-08-27 10:44:37,810 | HR @1|5|10: 0.0110 	 0.0330 	 0.0465 	
2025-08-27 10:44:37,810 | NDCG @5|10: 0.0225 	 0.0269
2025-08-27 10:44:37,810 | domain:Beauty
2025-08-27 10:44:37,810 | model_moe:
2025-08-27 10:44:37,811 | MRR: 0.2507
2025-08-27 10:44:37,811 | HR @1|5|10: 0.1818 	 0.3301 	 0.3816 	
2025-08-27 10:44:37,811 | NDCG @5|10: 0.2603 	 0.2770
2025-08-27 10:44:37,812 | 	avg_model_moe:
2025-08-27 10:44:37,812 | MRR: 0.1909
2025-08-27 10:44:37,812 | HR @1|5|10: 0.1337 	 0.2541 	 0.2998 	
2025-08-27 10:44:37,812 | NDCG @5|10: 0.1972 	 0.2120
2025-08-27 10:44:37,813 | Early Stopping counter: 1 out of 10
2025-08-27 10:44:37,813 | Learning rate decay counter: 1 out of 1
2025-08-27 10:44:37,813 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:44:53,907 | Epoch 51/60 - client 2 -  Training Loss: 26.222

 25%|##5       | 1/4 [00:16<00:48, 16.10s/it]2025-08-27 10:45:23,693 | Epoch 51/60 - client 1 -  Training Loss: 29.046

 50%|#####     | 2/4 [00:45<00:48, 24.15s/it]2025-08-27 10:45:35,607 | Epoch 51/60 - client 0 -  Training Loss: 28.123

 75%|#######5  | 3/4 [00:57<00:18, 18.56s/it]2025-08-27 10:45:47,206 | Epoch 51/60 - client 3 -  Training Loss: 29.041

100%|##########| 4/4 [01:09<00:00, 15.81s/it]
100%|##########| 4/4 [01:09<00:00, 17.35s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.10it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.16it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:45:51,014 | Epoch51 Valid:
2025-08-27 10:45:51,015 | domain:Food
2025-08-27 10:45:51,015 | model_moe:
2025-08-27 10:45:51,015 | MRR: 0.3658
2025-08-27 10:45:51,015 | HR @1|5|10: 0.2724 	 0.4836 	 0.5417 	
2025-08-27 10:45:51,016 | NDCG @5|10: 0.3855 	 0.4045
2025-08-27 10:45:51,016 | domain:Kitchen
2025-08-27 10:45:51,016 | model_moe:
2025-08-27 10:45:51,018 | MRR: 0.1210
2025-08-27 10:45:51,018 | HR @1|5|10: 0.0681 	 0.1699 	 0.2302 	
2025-08-27 10:45:51,018 | NDCG @5|10: 0.1201 	 0.1395
2025-08-27 10:45:51,019 | domain:Clothing
2025-08-27 10:45:51,019 | model_moe:
2025-08-27 10:45:51,019 | MRR: 0.0256
2025-08-27 10:45:51,020 | HR @1|5|10: 0.0110 	 0.0293 	 0.0452 	
2025-08-27 10:45:51,020 | NDCG @5|10: 0.0208 	 0.0261
2025-08-27 10:45:51,020 | domain:Beauty
2025-08-27 10:45:51,020 | model_moe:
2025-08-27 10:45:51,021 | MRR: 0.2533
2025-08-27 10:45:51,021 | HR @1|5|10: 0.1866 	 0.3337 	 0.3828 	
2025-08-27 10:45:51,021 | NDCG @5|10: 0.2633 	 0.2794
2025-08-27 10:45:51,021 | 	avg_model_moe:
2025-08-27 10:45:51,022 | MRR: 0.1914
2025-08-27 10:45:51,022 | HR @1|5|10: 0.1345 	 0.2541 	 0.3000 	
2025-08-27 10:45:51,022 | NDCG @5|10: 0.1974 	 0.2124
2025-08-27 10:45:51,023 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:46:02,937 | Epoch 52/60 - client 0 -  Training Loss: 28.048

 25%|##5       | 1/4 [00:11<00:35, 11.92s/it]2025-08-27 10:46:14,543 | Epoch 52/60 - client 3 -  Training Loss: 28.934

 50%|#####     | 2/4 [00:23<00:23, 11.73s/it]2025-08-27 10:46:30,628 | Epoch 52/60 - client 2 -  Training Loss: 26.134

 75%|#######5  | 3/4 [00:39<00:13, 13.72s/it]2025-08-27 10:47:00,393 | Epoch 52/60 - client 1 -  Training Loss: 28.935

100%|##########| 4/4 [01:09<00:00, 20.05s/it]
100%|##########| 4/4 [01:09<00:00, 17.34s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.10it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.27s/it]
 75%|#######5  | 3/4 [00:03<00:00,  1.00it/s]
100%|##########| 4/4 [00:03<00:00,  1.17it/s]
100%|##########| 4/4 [00:03<00:00,  1.07it/s]
2025-08-27 10:47:04,148 | Epoch52 Valid:
2025-08-27 10:47:04,148 | domain:Food
2025-08-27 10:47:04,148 | model_moe:
2025-08-27 10:47:04,149 | MRR: 0.3640
2025-08-27 10:47:04,149 | HR @1|5|10: 0.2693 	 0.4843 	 0.5402 	
2025-08-27 10:47:04,149 | NDCG @5|10: 0.3845 	 0.4028
2025-08-27 10:47:04,150 | domain:Kitchen
2025-08-27 10:47:04,150 | model_moe:
2025-08-27 10:47:04,150 | MRR: 0.1221
2025-08-27 10:47:04,150 | HR @1|5|10: 0.0695 	 0.1676 	 0.2307 	
2025-08-27 10:47:04,151 | NDCG @5|10: 0.1201 	 0.1404
2025-08-27 10:47:04,151 | domain:Clothing
2025-08-27 10:47:04,151 | model_moe:
2025-08-27 10:47:04,152 | MRR: 0.0254
2025-08-27 10:47:04,152 | HR @1|5|10: 0.0098 	 0.0330 	 0.0452 	
2025-08-27 10:47:04,152 | NDCG @5|10: 0.0222 	 0.0261
2025-08-27 10:47:04,152 | domain:Beauty
2025-08-27 10:47:04,153 | model_moe:
2025-08-27 10:47:04,153 | MRR: 0.2514
2025-08-27 10:47:04,153 | HR @1|5|10: 0.1842 	 0.3313 	 0.3876 	
2025-08-27 10:47:04,154 | NDCG @5|10: 0.2609 	 0.2792
2025-08-27 10:47:04,154 | 	avg_model_moe:
2025-08-27 10:47:04,154 | MRR: 0.1907
2025-08-27 10:47:04,154 | HR @1|5|10: 0.1332 	 0.2541 	 0.3009 	
2025-08-27 10:47:04,155 | NDCG @5|10: 0.1969 	 0.2121
2025-08-27 10:47:04,155 | Early Stopping counter: 3 out of 10
2025-08-27 10:47:04,155 | Learning rate decay counter: 1 out of 1
2025-08-27 10:47:04,155 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:47:15,753 | Epoch 53/60 - client 3 -  Training Loss: 28.832

 25%|##5       | 1/4 [00:11<00:34, 11.60s/it]2025-08-27 10:47:31,846 | Epoch 53/60 - client 2 -  Training Loss: 26.042

 50%|#####     | 2/4 [00:27<00:28, 14.24s/it]2025-08-27 10:48:01,631 | Epoch 53/60 - client 1 -  Training Loss: 28.819

 75%|#######5  | 3/4 [00:57<00:21, 21.34s/it]2025-08-27 10:48:13,614 | Epoch 53/60 - client 0 -  Training Loss: 27.965

100%|##########| 4/4 [01:09<00:00, 17.65s/it]
100%|##########| 4/4 [01:09<00:00, 17.37s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.09it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.16it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:48:17,409 | Epoch53 Valid:
2025-08-27 10:48:17,409 | domain:Food
2025-08-27 10:48:17,409 | model_moe:
2025-08-27 10:48:17,410 | MRR: 0.3638
2025-08-27 10:48:17,410 | HR @1|5|10: 0.2686 	 0.4851 	 0.5394 	
2025-08-27 10:48:17,410 | NDCG @5|10: 0.3847 	 0.4025
2025-08-27 10:48:17,410 | domain:Kitchen
2025-08-27 10:48:17,411 | model_moe:
2025-08-27 10:48:17,411 | MRR: 0.1228
2025-08-27 10:48:17,411 | HR @1|5|10: 0.0704 	 0.1690 	 0.2302 	
2025-08-27 10:48:17,412 | NDCG @5|10: 0.1209 	 0.1408
2025-08-27 10:48:17,412 | domain:Clothing
2025-08-27 10:48:17,413 | model_moe:
2025-08-27 10:48:17,414 | MRR: 0.0258
2025-08-27 10:48:17,414 | HR @1|5|10: 0.0110 	 0.0318 	 0.0452 	
2025-08-27 10:48:17,414 | NDCG @5|10: 0.0220 	 0.0263
2025-08-27 10:48:17,414 | domain:Beauty
2025-08-27 10:48:17,415 | model_moe:
2025-08-27 10:48:17,415 | MRR: 0.2497
2025-08-27 10:48:17,416 | HR @1|5|10: 0.1806 	 0.3301 	 0.3828 	
2025-08-27 10:48:17,417 | NDCG @5|10: 0.2592 	 0.2766
2025-08-27 10:48:17,417 | 	avg_model_moe:
2025-08-27 10:48:17,417 | MRR: 0.1906
2025-08-27 10:48:17,418 | HR @1|5|10: 0.1327 	 0.2540 	 0.2994 	
2025-08-27 10:48:17,418 | NDCG @5|10: 0.1967 	 0.2116
2025-08-27 10:48:17,418 | Early Stopping counter: 4 out of 10
2025-08-27 10:48:17,418 | Learning rate decay counter: 1 out of 1
2025-08-27 10:48:17,419 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:48:47,448 | Epoch 54/60 - client 1 -  Training Loss: 28.707

 25%|##5       | 1/4 [00:30<01:30, 30.04s/it]2025-08-27 10:48:59,142 | Epoch 54/60 - client 3 -  Training Loss: 28.734

 50%|#####     | 2/4 [00:41<00:38, 19.24s/it]2025-08-27 10:49:15,352 | Epoch 54/60 - client 2 -  Training Loss: 25.951

 75%|#######5  | 3/4 [00:57<00:17, 17.86s/it]2025-08-27 10:49:27,389 | Epoch 54/60 - client 0 -  Training Loss: 27.891

100%|##########| 4/4 [01:09<00:00, 15.56s/it]
100%|##########| 4/4 [01:09<00:00, 17.49s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.10it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.00s/it]
100%|##########| 4/4 [00:03<00:00,  1.16it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:49:31,171 | Epoch54 Valid:
2025-08-27 10:49:31,171 | domain:Food
2025-08-27 10:49:31,171 | model_moe:
2025-08-27 10:49:31,172 | MRR: 0.3650
2025-08-27 10:49:31,172 | HR @1|5|10: 0.2724 	 0.4843 	 0.5379 	
2025-08-27 10:49:31,172 | NDCG @5|10: 0.3854 	 0.4030
2025-08-27 10:49:31,174 | domain:Kitchen
2025-08-27 10:49:31,174 | model_moe:
2025-08-27 10:49:31,174 | MRR: 0.1217
2025-08-27 10:49:31,175 | HR @1|5|10: 0.0691 	 0.1680 	 0.2307 	
2025-08-27 10:49:31,175 | NDCG @5|10: 0.1200 	 0.1402
2025-08-27 10:49:31,175 | domain:Clothing
2025-08-27 10:49:31,175 | model_moe:
2025-08-27 10:49:31,177 | MRR: 0.0261
2025-08-27 10:49:31,177 | HR @1|5|10: 0.0110 	 0.0330 	 0.0452 	
2025-08-27 10:49:31,177 | NDCG @5|10: 0.0225 	 0.0264
2025-08-27 10:49:31,178 | domain:Beauty
2025-08-27 10:49:31,178 | model_moe:
2025-08-27 10:49:31,178 | MRR: 0.2508
2025-08-27 10:49:31,178 | HR @1|5|10: 0.1806 	 0.3325 	 0.3840 	
2025-08-27 10:49:31,179 | NDCG @5|10: 0.2611 	 0.2779
2025-08-27 10:49:31,179 | 	avg_model_moe:
2025-08-27 10:49:31,179 | MRR: 0.1909
2025-08-27 10:49:31,180 | HR @1|5|10: 0.1333 	 0.2545 	 0.2994 	
2025-08-27 10:49:31,180 | NDCG @5|10: 0.1972 	 0.2119
2025-08-27 10:49:31,180 | Early Stopping counter: 5 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:50:01,167 | Epoch 55/60 - client 1 -  Training Loss: 28.603

 25%|##5       | 1/4 [00:29<01:29, 29.99s/it]2025-08-27 10:50:13,215 | Epoch 55/60 - client 0 -  Training Loss: 27.816

 50%|#####     | 2/4 [00:42<00:38, 19.43s/it]2025-08-27 10:50:29,418 | Epoch 55/60 - client 2 -  Training Loss: 25.877

 75%|#######5  | 3/4 [00:58<00:17, 17.96s/it]2025-08-27 10:50:41,120 | Epoch 55/60 - client 3 -  Training Loss: 28.642

100%|##########| 4/4 [01:09<00:00, 15.49s/it]
100%|##########| 4/4 [01:09<00:00, 17.49s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.09it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.00s/it]
100%|##########| 4/4 [00:03<00:00,  1.16it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:50:44,902 | Epoch55 Valid:
2025-08-27 10:50:44,902 | domain:Food
2025-08-27 10:50:44,903 | model_moe:
2025-08-27 10:50:44,903 | MRR: 0.3629
2025-08-27 10:50:44,905 | HR @1|5|10: 0.2686 	 0.4881 	 0.5363 	
2025-08-27 10:50:44,905 | NDCG @5|10: 0.3853 	 0.4010
2025-08-27 10:50:44,905 | domain:Kitchen
2025-08-27 10:50:44,905 | model_moe:
2025-08-27 10:50:44,906 | MRR: 0.1202
2025-08-27 10:50:44,906 | HR @1|5|10: 0.0672 	 0.1703 	 0.2302 	
2025-08-27 10:50:44,906 | NDCG @5|10: 0.1198 	 0.1389
2025-08-27 10:50:44,907 | domain:Clothing
2025-08-27 10:50:44,907 | model_moe:
2025-08-27 10:50:44,907 | MRR: 0.0257
2025-08-27 10:50:44,907 | HR @1|5|10: 0.0110 	 0.0318 	 0.0465 	
2025-08-27 10:50:44,908 | NDCG @5|10: 0.0217 	 0.0265
2025-08-27 10:50:44,908 | domain:Beauty
2025-08-27 10:50:44,908 | model_moe:
2025-08-27 10:50:44,910 | MRR: 0.2492
2025-08-27 10:50:44,910 | HR @1|5|10: 0.1794 	 0.3313 	 0.3792 	
2025-08-27 10:50:44,910 | NDCG @5|10: 0.2595 	 0.2754
2025-08-27 10:50:44,910 | 	avg_model_moe:
2025-08-27 10:50:44,911 | MRR: 0.1895
2025-08-27 10:50:44,911 | HR @1|5|10: 0.1316 	 0.2554 	 0.2980 	
2025-08-27 10:50:44,911 | NDCG @5|10: 0.1966 	 0.2105
2025-08-27 10:50:44,912 | Early Stopping counter: 6 out of 10
2025-08-27 10:50:44,912 | Learning rate decay counter: 1 out of 1
2025-08-27 10:50:44,912 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:51:01,126 | Epoch 56/60 - client 2 -  Training Loss: 25.792

 25%|##5       | 1/4 [00:16<00:48, 16.21s/it]2025-08-27 10:51:31,087 | Epoch 56/60 - client 1 -  Training Loss: 28.505

 50%|#####     | 2/4 [00:46<00:48, 24.30s/it]2025-08-27 10:51:43,120 | Epoch 56/60 - client 0 -  Training Loss: 27.746

 75%|#######5  | 3/4 [00:58<00:18, 18.70s/it]2025-08-27 10:51:54,846 | Epoch 56/60 - client 3 -  Training Loss: 28.557

100%|##########| 4/4 [01:09<00:00, 15.95s/it]
100%|##########| 4/4 [01:09<00:00, 17.48s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.10it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.00s/it]
100%|##########| 4/4 [00:03<00:00,  1.16it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:51:58,628 | Epoch56 Valid:
2025-08-27 10:51:58,631 | domain:Food
2025-08-27 10:51:58,631 | model_moe:
2025-08-27 10:51:58,631 | MRR: 0.3636
2025-08-27 10:51:58,632 | HR @1|5|10: 0.2708 	 0.4820 	 0.5394 	
2025-08-27 10:51:58,632 | NDCG @5|10: 0.3835 	 0.4023
2025-08-27 10:51:58,632 | domain:Kitchen
2025-08-27 10:51:58,633 | model_moe:
2025-08-27 10:51:58,633 | MRR: 0.1210
2025-08-27 10:51:58,633 | HR @1|5|10: 0.0672 	 0.1680 	 0.2307 	
2025-08-27 10:51:58,633 | NDCG @5|10: 0.1194 	 0.1395
2025-08-27 10:51:58,634 | domain:Clothing
2025-08-27 10:51:58,634 | model_moe:
2025-08-27 10:51:58,634 | MRR: 0.0274
2025-08-27 10:51:58,635 | HR @1|5|10: 0.0134 	 0.0367 	 0.0465 	
2025-08-27 10:51:58,635 | NDCG @5|10: 0.0246 	 0.0277
2025-08-27 10:51:58,635 | domain:Beauty
2025-08-27 10:51:58,635 | model_moe:
2025-08-27 10:51:58,636 | MRR: 0.2476
2025-08-27 10:51:58,636 | HR @1|5|10: 0.1758 	 0.3301 	 0.3816 	
2025-08-27 10:51:58,636 | NDCG @5|10: 0.2577 	 0.2747
2025-08-27 10:51:58,637 | 	avg_model_moe:
2025-08-27 10:51:58,639 | MRR: 0.1899
2025-08-27 10:51:58,639 | HR @1|5|10: 0.1318 	 0.2542 	 0.2995 	
2025-08-27 10:51:58,639 | NDCG @5|10: 0.1963 	 0.2111
2025-08-27 10:51:58,640 | Early Stopping counter: 7 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:52:14,839 | Epoch 57/60 - client 2 -  Training Loss: 25.716

 25%|##5       | 1/4 [00:16<00:48, 16.20s/it]2025-08-27 10:52:26,887 | Epoch 57/60 - client 0 -  Training Loss: 27.678

 50%|#####     | 2/4 [00:28<00:27, 13.76s/it]2025-08-27 10:52:56,844 | Epoch 57/60 - client 1 -  Training Loss: 28.412

 75%|#######5  | 3/4 [00:58<00:21, 21.15s/it]2025-08-27 10:53:08,541 | Epoch 57/60 - client 3 -  Training Loss: 28.468

100%|##########| 4/4 [01:09<00:00, 17.42s/it]
100%|##########| 4/4 [01:09<00:00, 17.48s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:53:12,354 | Epoch57 Valid:
2025-08-27 10:53:12,354 | domain:Food
2025-08-27 10:53:12,354 | model_moe:
2025-08-27 10:53:12,355 | MRR: 0.3627
2025-08-27 10:53:12,356 | HR @1|5|10: 0.2693 	 0.4828 	 0.5394 	
2025-08-27 10:53:12,356 | NDCG @5|10: 0.3831 	 0.4017
2025-08-27 10:53:12,357 | domain:Kitchen
2025-08-27 10:53:12,357 | model_moe:
2025-08-27 10:53:12,357 | MRR: 0.1202
2025-08-27 10:53:12,358 | HR @1|5|10: 0.0668 	 0.1676 	 0.2311 	
2025-08-27 10:53:12,358 | NDCG @5|10: 0.1188 	 0.1392
2025-08-27 10:53:12,359 | domain:Clothing
2025-08-27 10:53:12,360 | model_moe:
2025-08-27 10:53:12,360 | MRR: 0.0272
2025-08-27 10:53:12,360 | HR @1|5|10: 0.0134 	 0.0342 	 0.0489 	
2025-08-27 10:53:12,360 | NDCG @5|10: 0.0237 	 0.0283
2025-08-27 10:53:12,361 | domain:Beauty
2025-08-27 10:53:12,361 | model_moe:
2025-08-27 10:53:12,362 | MRR: 0.2496
2025-08-27 10:53:12,363 | HR @1|5|10: 0.1794 	 0.3325 	 0.3864 	
2025-08-27 10:53:12,363 | NDCG @5|10: 0.2601 	 0.2778
2025-08-27 10:53:12,363 | 	avg_model_moe:
2025-08-27 10:53:12,364 | MRR: 0.1899
2025-08-27 10:53:12,364 | HR @1|5|10: 0.1322 	 0.2543 	 0.3014 	
2025-08-27 10:53:12,364 | NDCG @5|10: 0.1964 	 0.2117
2025-08-27 10:53:12,364 | Early Stopping counter: 8 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:53:42,342 | Epoch 58/60 - client 1 -  Training Loss: 28.313

 25%|##5       | 1/4 [00:29<01:29, 29.98s/it]2025-08-27 10:53:58,592 | Epoch 58/60 - client 2 -  Training Loss: 25.642

 50%|#####     | 2/4 [00:46<00:43, 21.90s/it]2025-08-27 10:54:10,396 | Epoch 58/60 - client 3 -  Training Loss: 28.381

 75%|#######5  | 3/4 [00:58<00:17, 17.29s/it]2025-08-27 10:54:22,445 | Epoch 58/60 - client 0 -  Training Loss: 27.610

100%|##########| 4/4 [01:10<00:00, 15.22s/it]
100%|##########| 4/4 [01:10<00:00, 17.52s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.09it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.28s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.16it/s]
100%|##########| 4/4 [00:03<00:00,  1.06it/s]
2025-08-27 10:54:26,240 | Epoch58 Valid:
2025-08-27 10:54:26,240 | domain:Food
2025-08-27 10:54:26,241 | model_moe:
2025-08-27 10:54:26,241 | MRR: 0.3645
2025-08-27 10:54:26,241 | HR @1|5|10: 0.2716 	 0.4874 	 0.5379 	
2025-08-27 10:54:26,241 | NDCG @5|10: 0.3862 	 0.4027
2025-08-27 10:54:26,242 | domain:Kitchen
2025-08-27 10:54:26,242 | model_moe:
2025-08-27 10:54:26,242 | MRR: 0.1213
2025-08-27 10:54:26,243 | HR @1|5|10: 0.0686 	 0.1671 	 0.2274 	
2025-08-27 10:54:26,243 | NDCG @5|10: 0.1196 	 0.1389
2025-08-27 10:54:26,243 | domain:Clothing
2025-08-27 10:54:26,244 | model_moe:
2025-08-27 10:54:26,244 | MRR: 0.0265
2025-08-27 10:54:26,244 | HR @1|5|10: 0.0122 	 0.0355 	 0.0465 	
2025-08-27 10:54:26,244 | NDCG @5|10: 0.0236 	 0.0270
2025-08-27 10:54:26,245 | domain:Beauty
2025-08-27 10:54:26,245 | model_moe:
2025-08-27 10:54:26,245 | MRR: 0.2504
2025-08-27 10:54:26,246 | HR @1|5|10: 0.1782 	 0.3361 	 0.3828 	
2025-08-27 10:54:26,246 | NDCG @5|10: 0.2620 	 0.2774
2025-08-27 10:54:26,246 | 	avg_model_moe:
2025-08-27 10:54:26,246 | MRR: 0.1907
2025-08-27 10:54:26,247 | HR @1|5|10: 0.1327 	 0.2565 	 0.2986 	
2025-08-27 10:54:26,247 | NDCG @5|10: 0.1979 	 0.2115
2025-08-27 10:54:26,247 | Early Stopping counter: 9 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 10:54:56,202 | Epoch 59/60 - client 1 -  Training Loss: 28.214

 25%|##5       | 1/4 [00:29<01:29, 29.96s/it]2025-08-27 10:55:12,416 | Epoch 59/60 - client 2 -  Training Loss: 25.568

 50%|#####     | 2/4 [00:46<00:43, 21.87s/it]2025-08-27 10:55:24,176 | Epoch 59/60 - client 3 -  Training Loss: 28.300

 75%|#######5  | 3/4 [00:57<00:17, 17.25s/it]2025-08-27 10:55:36,254 | Epoch 59/60 - client 0 -  Training Loss: 27.550

100%|##########| 4/4 [01:10<00:00, 15.21s/it]
100%|##########| 4/4 [01:10<00:00, 17.50s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.09it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 10:55:40,063 | Epoch59 Valid:
2025-08-27 10:55:40,064 | domain:Food
2025-08-27 10:55:40,064 | model_moe:
2025-08-27 10:55:40,065 | MRR: 0.3630
2025-08-27 10:55:40,065 | HR @1|5|10: 0.2686 	 0.4836 	 0.5425 	
2025-08-27 10:55:40,065 | NDCG @5|10: 0.3836 	 0.4028
2025-08-27 10:55:40,065 | domain:Kitchen
2025-08-27 10:55:40,066 | model_moe:
2025-08-27 10:55:40,066 | MRR: 0.1201
2025-08-27 10:55:40,066 | HR @1|5|10: 0.0668 	 0.1644 	 0.2293 	
2025-08-27 10:55:40,067 | NDCG @5|10: 0.1176 	 0.1385
2025-08-27 10:55:40,067 | domain:Clothing
2025-08-27 10:55:40,067 | model_moe:
2025-08-27 10:55:40,068 | MRR: 0.0257
2025-08-27 10:55:40,068 | HR @1|5|10: 0.0110 	 0.0330 	 0.0440 	
2025-08-27 10:55:40,068 | NDCG @5|10: 0.0222 	 0.0259
2025-08-27 10:55:40,068 | domain:Beauty
2025-08-27 10:55:40,069 | model_moe:
2025-08-27 10:55:40,069 | MRR: 0.2504
2025-08-27 10:55:40,069 | HR @1|5|10: 0.1794 	 0.3313 	 0.3828 	
2025-08-27 10:55:40,069 | NDCG @5|10: 0.2603 	 0.2773
2025-08-27 10:55:40,070 | 	avg_model_moe:
2025-08-27 10:55:40,070 | MRR: 0.1898
2025-08-27 10:55:40,070 | HR @1|5|10: 0.1314 	 0.2531 	 0.2996 	
2025-08-27 10:55:40,071 | NDCG @5|10: 0.1959 	 0.2111
2025-08-27 10:55:40,071 | Early Stopping counter: 10 out of 10
2025-08-27 10:55:40,071 | Early stopping

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:04,  1.66s/it]
 50%|#####     | 2/4 [00:05<00:05,  2.78s/it]
 75%|#######5  | 3/4 [00:07<00:02,  2.49s/it]
100%|##########| 4/4 [00:08<00:00,  2.15s/it]
100%|##########| 4/4 [00:08<00:00,  2.25s/it]
2025-08-27 10:55:49,065 | Test:
2025-08-27 10:55:49,066 | domain:Food
2025-08-27 10:55:49,066 | model_moe:
2025-08-27 10:55:49,067 | MRR: 0.3034
2025-08-27 10:55:49,067 | HR @1|5|10: 0.2125 	 0.4114 	 0.4812 	
2025-08-27 10:55:49,067 | NDCG @5|10: 0.3180 	 0.3407
2025-08-27 10:55:49,067 | domain:Kitchen
2025-08-27 10:55:49,068 | model_moe:
2025-08-27 10:55:49,068 | MRR: 0.1224
2025-08-27 10:55:49,068 | HR @1|5|10: 0.0701 	 0.1690 	 0.2356 	
2025-08-27 10:55:49,069 | NDCG @5|10: 0.1204 	 0.1419
2025-08-27 10:55:49,069 | domain:Clothing
2025-08-27 10:55:49,069 | model_moe:
2025-08-27 10:55:49,070 | MRR: 0.0275
2025-08-27 10:55:49,070 | HR @1|5|10: 0.0139 	 0.0346 	 0.0462 	
2025-08-27 10:55:49,070 | NDCG @5|10: 0.0240 	 0.0276
2025-08-27 10:55:49,070 | domain:Beauty
2025-08-27 10:55:49,071 | model_moe:
2025-08-27 10:55:49,071 | MRR: 0.1960
2025-08-27 10:55:49,071 | HR @1|5|10: 0.1158 	 0.2901 	 0.3591 	
2025-08-27 10:55:49,071 | NDCG @5|10: 0.2065 	 0.2289
2025-08-27 10:55:49,072 | 	avg_model_moe:
2025-08-27 10:55:49,072 | MRR: 0.1623
2025-08-27 10:55:49,072 | HR @1|5|10: 0.1031 	 0.2263 	 0.2805 	
2025-08-27 10:55:49,073 | NDCG @5|10: 0.1672 	 0.1848
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 10:58:34,306 | Running with the following configs:
	domains : ['Movies', 'Books', 'Games']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 10:58:54,514 | Epoch 1/40 - client 2 -  Training Loss: 31.975

 33%|###3      | 1/3 [00:20<00:40, 20.17s/it]2025-08-27 11:02:08,771 | Epoch 1/40 - client 1 -  Training Loss: 34.977

 67%|######6   | 2/3 [03:34<02:02, 122.57s/it]2025-08-27 11:04:23,471 | Epoch 1/40 - client 0 -  Training Loss: 36.579

100%|##########| 3/3 [05:49<00:00, 128.11s/it]
100%|##########| 3/3 [05:49<00:00, 116.37s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.55s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.09s/it]
100%|##########| 3/3 [00:15<00:00,  4.39s/it]
100%|##########| 3/3 [00:15<00:00,  5.07s/it]
2025-08-27 11:04:38,690 | Epoch1 Valid:
2025-08-27 11:04:38,691 | domain:Movies
2025-08-27 11:04:38,691 | model_moe:
2025-08-27 11:04:38,692 | MRR: 0.0334
2025-08-27 11:04:38,692 | HR @1|5|10: 0.0192 	 0.0364 	 0.0511 	
2025-08-27 11:04:38,692 | NDCG @5|10: 0.0278 	 0.0325
2025-08-27 11:04:38,693 | domain:Books
2025-08-27 11:04:38,693 | model_moe:
2025-08-27 11:04:38,693 | MRR: 0.0201
2025-08-27 11:04:38,693 | HR @1|5|10: 0.0134 	 0.0200 	 0.0252 	
2025-08-27 11:04:38,694 | NDCG @5|10: 0.0168 	 0.0185
2025-08-27 11:04:38,694 | domain:Games
2025-08-27 11:04:38,694 | model_moe:
2025-08-27 11:04:38,695 | MRR: 0.0611
2025-08-27 11:04:38,695 | HR @1|5|10: 0.0393 	 0.0750 	 0.0983 	
2025-08-27 11:04:38,695 | NDCG @5|10: 0.0576 	 0.0651
2025-08-27 11:04:38,695 | 	avg_model_moe:
2025-08-27 11:04:38,696 | MRR: 0.0382
2025-08-27 11:04:38,696 | HR @1|5|10: 0.0240 	 0.0438 	 0.0582 	
2025-08-27 11:04:38,696 | NDCG @5|10: 0.0341 	 0.0387
2025-08-27 11:04:38,697 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:06:55,389 | Epoch 2/40 - client 0 -  Training Loss: 34.292

 33%|###3      | 1/3 [02:14<04:29, 134.87s/it]2025-08-27 11:07:08,361 | Epoch 2/40 - client 2 -  Training Loss: 30.127

 67%|######6   | 2/3 [02:27<01:03, 63.17s/it] 2025-08-27 11:10:22,204 | Epoch 2/40 - client 1 -  Training Loss: 32.819

100%|##########| 3/3 [05:41<00:00, 122.84s/it]
100%|##########| 3/3 [05:41<00:00, 113.90s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.47s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.03s/it]
100%|##########| 3/3 [00:15<00:00,  4.38s/it]
100%|##########| 3/3 [00:15<00:00,  5.04s/it]
2025-08-27 11:10:37,340 | Epoch2 Valid:
2025-08-27 11:10:37,340 | domain:Movies
2025-08-27 11:10:37,340 | model_moe:
2025-08-27 11:10:37,341 | MRR: 0.0971
2025-08-27 11:10:37,341 | HR @1|5|10: 0.0547 	 0.1231 	 0.1743 	
2025-08-27 11:10:37,341 | NDCG @5|10: 0.0897 	 0.1062
2025-08-27 11:10:37,341 | domain:Books
2025-08-27 11:10:37,342 | model_moe:
2025-08-27 11:10:37,342 | MRR: 0.0709
2025-08-27 11:10:37,342 | HR @1|5|10: 0.0412 	 0.0849 	 0.1207 	
2025-08-27 11:10:37,343 | NDCG @5|10: 0.0636 	 0.0750
2025-08-27 11:10:37,343 | domain:Games
2025-08-27 11:10:37,343 | model_moe:
2025-08-27 11:10:37,344 | MRR: 0.0628
2025-08-27 11:10:37,344 | HR @1|5|10: 0.0386 	 0.0786 	 0.1048 	
2025-08-27 11:10:37,344 | NDCG @5|10: 0.0590 	 0.0675
2025-08-27 11:10:37,344 | 	avg_model_moe:
2025-08-27 11:10:37,345 | MRR: 0.0770
2025-08-27 11:10:37,346 | HR @1|5|10: 0.0448 	 0.0955 	 0.1333 	
2025-08-27 11:10:37,347 | NDCG @5|10: 0.0708 	 0.0829
2025-08-27 11:10:37,347 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:12:54,325 | Epoch 3/40 - client 0 -  Training Loss: 33.236

 33%|###3      | 1/3 [02:15<04:30, 135.26s/it]2025-08-27 11:16:09,031 | Epoch 3/40 - client 1 -  Training Loss: 31.579

 67%|######6   | 2/3 [05:29<02:50, 170.23s/it]2025-08-27 11:16:22,022 | Epoch 3/40 - client 2 -  Training Loss: 29.062

100%|##########| 3/3 [05:42<00:00, 98.43s/it] 
100%|##########| 3/3 [05:42<00:00, 114.32s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.68s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.27s/it]
100%|##########| 3/3 [00:15<00:00,  4.49s/it]
100%|##########| 3/3 [00:15<00:00,  5.19s/it]
2025-08-27 11:16:37,595 | Epoch3 Valid:
2025-08-27 11:16:37,595 | domain:Movies
2025-08-27 11:16:37,595 | model_moe:
2025-08-27 11:16:37,596 | MRR: 0.1238
2025-08-27 11:16:37,596 | HR @1|5|10: 0.0730 	 0.1626 	 0.2208 	
2025-08-27 11:16:37,596 | NDCG @5|10: 0.1186 	 0.1374
2025-08-27 11:16:37,597 | domain:Books
2025-08-27 11:16:37,597 | model_moe:
2025-08-27 11:16:37,597 | MRR: 0.0939
2025-08-27 11:16:37,598 | HR @1|5|10: 0.0551 	 0.1195 	 0.1626 	
2025-08-27 11:16:37,598 | NDCG @5|10: 0.0880 	 0.1018
2025-08-27 11:16:37,598 | domain:Games
2025-08-27 11:16:37,598 | model_moe:
2025-08-27 11:16:37,599 | MRR: 0.0739
2025-08-27 11:16:37,599 | HR @1|5|10: 0.0488 	 0.0932 	 0.1150 	
2025-08-27 11:16:37,599 | NDCG @5|10: 0.0712 	 0.0781
2025-08-27 11:16:37,600 | 	avg_model_moe:
2025-08-27 11:16:37,600 | MRR: 0.0972
2025-08-27 11:16:37,600 | HR @1|5|10: 0.0589 	 0.1251 	 0.1661 	
2025-08-27 11:16:37,600 | NDCG @5|10: 0.0926 	 0.1058
2025-08-27 11:16:37,601 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:19:53,932 | Epoch 4/40 - client 1 -  Training Loss: 30.446

 33%|###3      | 1/3 [03:14<06:29, 194.60s/it]2025-08-27 11:22:09,141 | Epoch 4/40 - client 0 -  Training Loss: 32.287

 67%|######6   | 2/3 [05:29<02:39, 159.66s/it]2025-08-27 11:22:22,338 | Epoch 4/40 - client 2 -  Training Loss: 28.111

100%|##########| 3/3 [05:43<00:00, 92.78s/it] 
100%|##########| 3/3 [05:43<00:00, 114.33s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.75s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.13s/it]
100%|##########| 3/3 [00:15<00:00,  4.42s/it]
100%|##########| 3/3 [00:15<00:00,  5.11s/it]
2025-08-27 11:22:37,695 | Epoch4 Valid:
2025-08-27 11:22:37,695 | domain:Movies
2025-08-27 11:22:37,696 | model_moe:
2025-08-27 11:22:37,696 | MRR: 0.1403
2025-08-27 11:22:37,696 | HR @1|5|10: 0.0846 	 0.1849 	 0.2456 	
2025-08-27 11:22:37,697 | NDCG @5|10: 0.1366 	 0.1562
2025-08-27 11:22:37,697 | domain:Books
2025-08-27 11:22:37,697 | model_moe:
2025-08-27 11:22:37,697 | MRR: 0.1118
2025-08-27 11:22:37,698 | HR @1|5|10: 0.0648 	 0.1473 	 0.1989 	
2025-08-27 11:22:37,698 | NDCG @5|10: 0.1070 	 0.1235
2025-08-27 11:22:37,698 | domain:Games
2025-08-27 11:22:37,699 | model_moe:
2025-08-27 11:22:37,699 | MRR: 0.0877
2025-08-27 11:22:37,699 | HR @1|5|10: 0.0633 	 0.1026 	 0.1288 	
2025-08-27 11:22:37,700 | NDCG @5|10: 0.0836 	 0.0920
2025-08-27 11:22:37,700 | 	avg_model_moe:
2025-08-27 11:22:37,700 | MRR: 0.1133
2025-08-27 11:22:37,700 | HR @1|5|10: 0.0709 	 0.1450 	 0.1911 	
2025-08-27 11:22:37,701 | NDCG @5|10: 0.1091 	 0.1239
2025-08-27 11:22:37,701 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:25:53,875 | Epoch 5/40 - client 1 -  Training Loss: 29.213

 33%|###3      | 1/3 [03:14<06:28, 194.38s/it]2025-08-27 11:26:06,953 | Epoch 5/40 - client 2 -  Training Loss: 27.122

 67%|######6   | 2/3 [03:27<01:27, 87.73s/it] 2025-08-27 11:28:21,922 | Epoch 5/40 - client 0 -  Training Loss: 31.309

100%|##########| 3/3 [05:42<00:00, 109.30s/it]
100%|##########| 3/3 [05:42<00:00, 114.14s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.61s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.10s/it]
100%|##########| 3/3 [00:15<00:00,  4.40s/it]
100%|##########| 3/3 [00:15<00:00,  5.08s/it]
2025-08-27 11:28:37,174 | Epoch5 Valid:
2025-08-27 11:28:37,174 | domain:Movies
2025-08-27 11:28:37,175 | model_moe:
2025-08-27 11:28:37,175 | MRR: 0.1500
2025-08-27 11:28:37,175 | HR @1|5|10: 0.0910 	 0.2011 	 0.2626 	
2025-08-27 11:28:37,176 | NDCG @5|10: 0.1478 	 0.1676
2025-08-27 11:28:37,176 | domain:Books
2025-08-27 11:28:37,176 | model_moe:
2025-08-27 11:28:37,176 | MRR: 0.1254
2025-08-27 11:28:37,177 | HR @1|5|10: 0.0746 	 0.1650 	 0.2205 	
2025-08-27 11:28:37,177 | NDCG @5|10: 0.1210 	 0.1389
2025-08-27 11:28:37,177 | domain:Games
2025-08-27 11:28:37,178 | model_moe:
2025-08-27 11:28:37,178 | MRR: 0.0993
2025-08-27 11:28:37,178 | HR @1|5|10: 0.0742 	 0.1186 	 0.1412 	
2025-08-27 11:28:37,179 | NDCG @5|10: 0.0964 	 0.1038
2025-08-27 11:28:37,179 | 	avg_model_moe:
2025-08-27 11:28:37,179 | MRR: 0.1249
2025-08-27 11:28:37,179 | HR @1|5|10: 0.0799 	 0.1616 	 0.2081 	
2025-08-27 11:28:37,180 | NDCG @5|10: 0.1217 	 0.1368
2025-08-27 11:28:37,180 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:31:53,988 | Epoch 6/40 - client 1 -  Training Loss: 28.005

 33%|###3      | 1/3 [03:14<06:29, 194.79s/it]2025-08-27 11:34:09,799 | Epoch 6/40 - client 0 -  Training Loss: 30.391

 67%|######6   | 2/3 [05:30<02:40, 160.10s/it]2025-08-27 11:34:22,750 | Epoch 6/40 - client 2 -  Training Loss: 26.112

100%|##########| 3/3 [05:43<00:00, 92.91s/it] 
100%|##########| 3/3 [05:43<00:00, 114.52s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.54s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.03s/it]
100%|##########| 3/3 [00:15<00:00,  4.36s/it]
100%|##########| 3/3 [00:15<00:00,  5.04s/it]
2025-08-27 11:34:37,869 | Epoch6 Valid:
2025-08-27 11:34:37,869 | domain:Movies
2025-08-27 11:34:37,870 | model_moe:
2025-08-27 11:34:37,870 | MRR: 0.1578
2025-08-27 11:34:37,870 | HR @1|5|10: 0.0970 	 0.2105 	 0.2756 	
2025-08-27 11:34:37,871 | NDCG @5|10: 0.1555 	 0.1764
2025-08-27 11:34:37,871 | domain:Books
2025-08-27 11:34:37,871 | model_moe:
2025-08-27 11:34:37,872 | MRR: 0.1300
2025-08-27 11:34:37,872 | HR @1|5|10: 0.0779 	 0.1710 	 0.2308 	
2025-08-27 11:34:37,872 | NDCG @5|10: 0.1257 	 0.1450
2025-08-27 11:34:37,872 | domain:Games
2025-08-27 11:34:37,873 | model_moe:
2025-08-27 11:34:37,873 | MRR: 0.1103
2025-08-27 11:34:37,873 | HR @1|5|10: 0.0830 	 0.1288 	 0.1579 	
2025-08-27 11:34:37,874 | NDCG @5|10: 0.1070 	 0.1164
2025-08-27 11:34:37,874 | 	avg_model_moe:
2025-08-27 11:34:37,874 | MRR: 0.1327
2025-08-27 11:34:37,874 | HR @1|5|10: 0.0860 	 0.1701 	 0.2215 	
2025-08-27 11:34:37,875 | NDCG @5|10: 0.1294 	 0.1459
2025-08-27 11:34:37,875 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:36:54,799 | Epoch 7/40 - client 0 -  Training Loss: 29.627

 33%|###3      | 1/3 [02:15<04:30, 135.14s/it]2025-08-27 11:40:09,296 | Epoch 7/40 - client 1 -  Training Loss: 27.009

 67%|######6   | 2/3 [05:29<02:50, 170.06s/it]2025-08-27 11:40:22,275 | Epoch 7/40 - client 2 -  Training Loss: 25.219

100%|##########| 3/3 [05:42<00:00, 98.33s/it] 
100%|##########| 3/3 [05:42<00:00, 114.21s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.76s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.21s/it]
100%|##########| 3/3 [00:15<00:00,  4.46s/it]
100%|##########| 3/3 [00:15<00:00,  5.16s/it]
2025-08-27 11:40:37,765 | Epoch7 Valid:
2025-08-27 11:40:37,766 | domain:Movies
2025-08-27 11:40:37,766 | model_moe:
2025-08-27 11:40:37,766 | MRR: 0.1632
2025-08-27 11:40:37,767 | HR @1|5|10: 0.1009 	 0.2180 	 0.2812 	
2025-08-27 11:40:37,767 | NDCG @5|10: 0.1614 	 0.1818
2025-08-27 11:40:37,767 | domain:Books
2025-08-27 11:40:37,768 | model_moe:
2025-08-27 11:40:37,768 | MRR: 0.1336
2025-08-27 11:40:37,769 | HR @1|5|10: 0.0805 	 0.1768 	 0.2366 	
2025-08-27 11:40:37,769 | NDCG @5|10: 0.1297 	 0.1490
2025-08-27 11:40:37,770 | domain:Games
2025-08-27 11:40:37,770 | model_moe:
2025-08-27 11:40:37,770 | MRR: 0.1160
2025-08-27 11:40:37,770 | HR @1|5|10: 0.0895 	 0.1368 	 0.1594 	
2025-08-27 11:40:37,771 | NDCG @5|10: 0.1136 	 0.1206
2025-08-27 11:40:37,771 | 	avg_model_moe:
2025-08-27 11:40:37,771 | MRR: 0.1376
2025-08-27 11:40:37,772 | HR @1|5|10: 0.0903 	 0.1772 	 0.2257 	
2025-08-27 11:40:37,772 | NDCG @5|10: 0.1349 	 0.1505
2025-08-27 11:40:37,772 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:42:54,457 | Epoch 8/40 - client 0 -  Training Loss: 29.006

 33%|###3      | 1/3 [02:14<04:29, 134.94s/it]2025-08-27 11:43:07,364 | Epoch 8/40 - client 2 -  Training Loss: 24.489

 67%|######6   | 2/3 [02:27<01:03, 63.15s/it] 2025-08-27 11:46:22,195 | Epoch 8/40 - client 1 -  Training Loss: 26.239

100%|##########| 3/3 [05:42<00:00, 123.28s/it]
100%|##########| 3/3 [05:42<00:00, 114.23s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.57s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.06s/it]
100%|##########| 3/3 [00:15<00:00,  4.38s/it]
100%|##########| 3/3 [00:15<00:00,  5.05s/it]
2025-08-27 11:46:37,363 | Epoch8 Valid:
2025-08-27 11:46:37,365 | domain:Movies
2025-08-27 11:46:37,365 | model_moe:
2025-08-27 11:46:37,365 | MRR: 0.1652
2025-08-27 11:46:37,366 | HR @1|5|10: 0.1015 	 0.2234 	 0.2868 	
2025-08-27 11:46:37,366 | NDCG @5|10: 0.1641 	 0.1846
2025-08-27 11:46:37,366 | domain:Books
2025-08-27 11:46:37,369 | model_moe:
2025-08-27 11:46:37,369 | MRR: 0.1399
2025-08-27 11:46:37,369 | HR @1|5|10: 0.0850 	 0.1844 	 0.2447 	
2025-08-27 11:46:37,370 | NDCG @5|10: 0.1362 	 0.1556
2025-08-27 11:46:37,370 | domain:Games
2025-08-27 11:46:37,370 | model_moe:
2025-08-27 11:46:37,371 | MRR: 0.1222
2025-08-27 11:46:37,371 | HR @1|5|10: 0.0946 	 0.1426 	 0.1667 	
2025-08-27 11:46:37,371 | NDCG @5|10: 0.1196 	 0.1272
2025-08-27 11:46:37,371 | 	avg_model_moe:
2025-08-27 11:46:37,372 | MRR: 0.1424
2025-08-27 11:46:37,372 | HR @1|5|10: 0.0937 	 0.1835 	 0.2327 	
2025-08-27 11:46:37,372 | NDCG @5|10: 0.1400 	 0.1558
2025-08-27 11:46:37,372 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:46:52,247 | Epoch 9/40 - client 2 -  Training Loss: 23.911

 33%|###3      | 1/3 [00:12<00:25, 12.83s/it]2025-08-27 11:49:07,271 | Epoch 9/40 - client 0 -  Training Loss: 28.475

 67%|######6   | 2/3 [02:27<01:24, 84.72s/it]2025-08-27 11:52:21,679 | Epoch 9/40 - client 1 -  Training Loss: 25.631

100%|##########| 3/3 [05:42<00:00, 134.80s/it]
100%|##########| 3/3 [05:42<00:00, 114.09s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.82s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.27s/it]
100%|##########| 3/3 [00:15<00:00,  4.50s/it]
100%|##########| 3/3 [00:15<00:00,  5.20s/it]
2025-08-27 11:52:37,315 | Epoch9 Valid:
2025-08-27 11:52:37,317 | domain:Movies
2025-08-27 11:52:37,317 | model_moe:
2025-08-27 11:52:37,318 | MRR: 0.1684
2025-08-27 11:52:37,318 | HR @1|5|10: 0.1031 	 0.2281 	 0.2938 	
2025-08-27 11:52:37,318 | NDCG @5|10: 0.1675 	 0.1887
2025-08-27 11:52:37,318 | domain:Books
2025-08-27 11:52:37,319 | model_moe:
2025-08-27 11:52:37,319 | MRR: 0.1460
2025-08-27 11:52:37,319 | HR @1|5|10: 0.0888 	 0.1934 	 0.2563 	
2025-08-27 11:52:37,320 | NDCG @5|10: 0.1427 	 0.1631
2025-08-27 11:52:37,320 | domain:Games
2025-08-27 11:52:37,320 | model_moe:
2025-08-27 11:52:37,321 | MRR: 0.1252
2025-08-27 11:52:37,321 | HR @1|5|10: 0.0975 	 0.1477 	 0.1732 	
2025-08-27 11:52:37,322 | NDCG @5|10: 0.1230 	 0.1311
2025-08-27 11:52:37,322 | 	avg_model_moe:
2025-08-27 11:52:37,323 | MRR: 0.1465
2025-08-27 11:52:37,323 | HR @1|5|10: 0.0965 	 0.1897 	 0.2411 	
2025-08-27 11:52:37,323 | NDCG @5|10: 0.1444 	 0.1610
2025-08-27 11:52:37,324 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:55:53,138 | Epoch 10/40 - client 1 -  Training Loss: 25.119

 33%|###3      | 1/3 [03:14<06:28, 194.03s/it]2025-08-27 11:58:07,314 | Epoch 10/40 - client 0 -  Training Loss: 28.007

 67%|######6   | 2/3 [05:28<02:38, 158.82s/it]2025-08-27 11:58:20,028 | Epoch 10/40 - client 2 -  Training Loss: 23.410

100%|##########| 3/3 [05:40<00:00, 92.10s/it] 
100%|##########| 3/3 [05:40<00:00, 113.64s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.52s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.01s/it]
100%|##########| 3/3 [00:15<00:00,  4.35s/it]
100%|##########| 3/3 [00:15<00:00,  5.02s/it]
2025-08-27 11:58:35,096 | Epoch10 Valid:
2025-08-27 11:58:35,096 | domain:Movies
2025-08-27 11:58:35,096 | model_moe:
2025-08-27 11:58:35,097 | MRR: 0.1741
2025-08-27 11:58:35,097 | HR @1|5|10: 0.1075 	 0.2347 	 0.3021 	
2025-08-27 11:58:35,097 | NDCG @5|10: 0.1733 	 0.1951
2025-08-27 11:58:35,098 | domain:Books
2025-08-27 11:58:35,098 | model_moe:
2025-08-27 11:58:35,098 | MRR: 0.1486
2025-08-27 11:58:35,099 | HR @1|5|10: 0.0896 	 0.1989 	 0.2611 	
2025-08-27 11:58:35,102 | NDCG @5|10: 0.1460 	 0.1662
2025-08-27 11:58:35,103 | domain:Games
2025-08-27 11:58:35,103 | model_moe:
2025-08-27 11:58:35,103 | MRR: 0.1281
2025-08-27 11:58:35,104 | HR @1|5|10: 0.0990 	 0.1521 	 0.1761 	
2025-08-27 11:58:35,104 | NDCG @5|10: 0.1263 	 0.1340
2025-08-27 11:58:35,104 | 	avg_model_moe:
2025-08-27 11:58:35,105 | MRR: 0.1502
2025-08-27 11:58:35,106 | HR @1|5|10: 0.0987 	 0.1952 	 0.2464 	
2025-08-27 11:58:35,106 | NDCG @5|10: 0.1485 	 0.1651
2025-08-27 11:58:35,106 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 11:58:49,602 | Epoch 11/40 - client 2 -  Training Loss: 22.977

 33%|###3      | 1/3 [00:12<00:25, 12.75s/it]2025-08-27 12:01:04,730 | Epoch 11/40 - client 0 -  Training Loss: 27.580

 67%|######6   | 2/3 [02:27<01:24, 84.74s/it]2025-08-27 12:04:18,092 | Epoch 11/40 - client 1 -  Training Loss: 24.657

100%|##########| 3/3 [05:41<00:00, 134.34s/it]
100%|##########| 3/3 [05:41<00:00, 113.75s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.70s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.07s/it]
100%|##########| 3/3 [00:15<00:00,  4.38s/it]
100%|##########| 3/3 [00:15<00:00,  5.07s/it]
2025-08-27 12:04:33,312 | Epoch11 Valid:
2025-08-27 12:04:33,312 | domain:Movies
2025-08-27 12:04:33,313 | model_moe:
2025-08-27 12:04:33,313 | MRR: 0.1764
2025-08-27 12:04:33,313 | HR @1|5|10: 0.1101 	 0.2374 	 0.3068 	
2025-08-27 12:04:33,314 | NDCG @5|10: 0.1755 	 0.1979
2025-08-27 12:04:33,314 | domain:Books
2025-08-27 12:04:33,314 | model_moe:
2025-08-27 12:04:33,314 | MRR: 0.1533
2025-08-27 12:04:33,315 | HR @1|5|10: 0.0950 	 0.2023 	 0.2658 	
2025-08-27 12:04:33,315 | NDCG @5|10: 0.1502 	 0.1708
2025-08-27 12:04:33,315 | domain:Games
2025-08-27 12:04:33,315 | model_moe:
2025-08-27 12:04:33,316 | MRR: 0.1266
2025-08-27 12:04:33,316 | HR @1|5|10: 0.0975 	 0.1514 	 0.1761 	
2025-08-27 12:04:33,316 | NDCG @5|10: 0.1249 	 0.1328
2025-08-27 12:04:33,317 | 	avg_model_moe:
2025-08-27 12:04:33,317 | MRR: 0.1521
2025-08-27 12:04:33,317 | HR @1|5|10: 0.1009 	 0.1970 	 0.2496 	
2025-08-27 12:04:33,317 | NDCG @5|10: 0.1502 	 0.1672
2025-08-27 12:04:33,318 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:04:48,012 | Epoch 12/40 - client 2 -  Training Loss: 22.604

 33%|###3      | 1/3 [00:12<00:25, 12.73s/it]2025-08-27 12:08:01,461 | Epoch 12/40 - client 1 -  Training Loss: 24.248

 67%|######6   | 2/3 [03:26<01:59, 119.04s/it]2025-08-27 12:10:15,486 | Epoch 12/40 - client 0 -  Training Loss: 27.194

100%|##########| 3/3 [05:40<00:00, 125.88s/it]
100%|##########| 3/3 [05:40<00:00, 113.40s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.49s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.97s/it]
100%|##########| 3/3 [00:14<00:00,  4.32s/it]
100%|##########| 3/3 [00:14<00:00,  4.99s/it]
2025-08-27 12:10:30,456 | Epoch12 Valid:
2025-08-27 12:10:30,457 | domain:Movies
2025-08-27 12:10:30,457 | model_moe:
2025-08-27 12:10:30,457 | MRR: 0.1797
2025-08-27 12:10:30,457 | HR @1|5|10: 0.1124 	 0.2410 	 0.3124 	
2025-08-27 12:10:30,458 | NDCG @5|10: 0.1786 	 0.2017
2025-08-27 12:10:30,458 | domain:Books
2025-08-27 12:10:30,458 | model_moe:
2025-08-27 12:10:30,459 | MRR: 0.1551
2025-08-27 12:10:30,459 | HR @1|5|10: 0.0946 	 0.2069 	 0.2698 	
2025-08-27 12:10:30,459 | NDCG @5|10: 0.1527 	 0.1730
2025-08-27 12:10:30,460 | domain:Games
2025-08-27 12:10:30,460 | model_moe:
2025-08-27 12:10:30,460 | MRR: 0.1254
2025-08-27 12:10:30,460 | HR @1|5|10: 0.0961 	 0.1485 	 0.1769 	
2025-08-27 12:10:30,461 | NDCG @5|10: 0.1230 	 0.1320
2025-08-27 12:10:30,461 | 	avg_model_moe:
2025-08-27 12:10:30,461 | MRR: 0.1534
2025-08-27 12:10:30,462 | HR @1|5|10: 0.1010 	 0.1988 	 0.2530 	
2025-08-27 12:10:30,462 | NDCG @5|10: 0.1514 	 0.1689
2025-08-27 12:10:30,462 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:12:45,586 | Epoch 13/40 - client 0 -  Training Loss: 26.832

 33%|###3      | 1/3 [02:13<04:26, 133.19s/it]2025-08-27 12:12:58,130 | Epoch 13/40 - client 2 -  Training Loss: 22.268

 67%|######6   | 2/3 [02:25<01:02, 62.22s/it] 2025-08-27 12:16:10,357 | Epoch 13/40 - client 1 -  Training Loss: 23.877

100%|##########| 3/3 [05:37<00:00, 121.59s/it]
100%|##########| 3/3 [05:37<00:00, 112.66s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.42s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.91s/it]
100%|##########| 3/3 [00:14<00:00,  4.27s/it]
100%|##########| 3/3 [00:14<00:00,  4.94s/it]
2025-08-27 12:16:25,186 | Epoch13 Valid:
2025-08-27 12:16:25,187 | domain:Movies
2025-08-27 12:16:25,187 | model_moe:
2025-08-27 12:16:25,187 | MRR: 0.1814
2025-08-27 12:16:25,188 | HR @1|5|10: 0.1126 	 0.2455 	 0.3146 	
2025-08-27 12:16:25,188 | NDCG @5|10: 0.1812 	 0.2035
2025-08-27 12:16:25,188 | domain:Books
2025-08-27 12:16:25,189 | model_moe:
2025-08-27 12:16:25,189 | MRR: 0.1582
2025-08-27 12:16:25,189 | HR @1|5|10: 0.0967 	 0.2110 	 0.2731 	
2025-08-27 12:16:25,191 | NDCG @5|10: 0.1559 	 0.1761
2025-08-27 12:16:25,191 | domain:Games
2025-08-27 12:16:25,191 | model_moe:
2025-08-27 12:16:25,191 | MRR: 0.1281
2025-08-27 12:16:25,192 | HR @1|5|10: 0.0983 	 0.1528 	 0.1812 	
2025-08-27 12:16:25,192 | NDCG @5|10: 0.1261 	 0.1351
2025-08-27 12:16:25,192 | 	avg_model_moe:
2025-08-27 12:16:25,193 | MRR: 0.1559
2025-08-27 12:16:25,193 | HR @1|5|10: 0.1025 	 0.2031 	 0.2563 	
2025-08-27 12:16:25,193 | NDCG @5|10: 0.1544 	 0.1716
2025-08-27 12:16:25,194 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:16:39,411 | Epoch 14/40 - client 2 -  Training Loss: 21.954

 33%|###3      | 1/3 [00:12<00:24, 12.46s/it]2025-08-27 12:18:52,331 | Epoch 14/40 - client 0 -  Training Loss: 26.502

 67%|######6   | 2/3 [02:25<01:23, 83.32s/it]2025-08-27 12:22:04,431 | Epoch 14/40 - client 1 -  Training Loss: 23.531

100%|##########| 3/3 [05:37<00:00, 132.99s/it]
100%|##########| 3/3 [05:37<00:00, 112.50s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.42s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.91s/it]
100%|##########| 3/3 [00:14<00:00,  4.27s/it]
100%|##########| 3/3 [00:14<00:00,  4.93s/it]
2025-08-27 12:22:19,258 | Epoch14 Valid:
2025-08-27 12:22:19,259 | domain:Movies
2025-08-27 12:22:19,259 | model_moe:
2025-08-27 12:22:19,259 | MRR: 0.1841
2025-08-27 12:22:19,260 | HR @1|5|10: 0.1149 	 0.2490 	 0.3167 	
2025-08-27 12:22:19,261 | NDCG @5|10: 0.1844 	 0.2061
2025-08-27 12:22:19,261 | domain:Books
2025-08-27 12:22:19,262 | model_moe:
2025-08-27 12:22:19,262 | MRR: 0.1592
2025-08-27 12:22:19,262 | HR @1|5|10: 0.0980 	 0.2124 	 0.2774 	
2025-08-27 12:22:19,262 | NDCG @5|10: 0.1570 	 0.1780
2025-08-27 12:22:19,263 | domain:Games
2025-08-27 12:22:19,263 | model_moe:
2025-08-27 12:22:19,263 | MRR: 0.1269
2025-08-27 12:22:19,264 | HR @1|5|10: 0.0968 	 0.1536 	 0.1805 	
2025-08-27 12:22:19,264 | NDCG @5|10: 0.1250 	 0.1338
2025-08-27 12:22:19,264 | 	avg_model_moe:
2025-08-27 12:22:19,265 | MRR: 0.1567
2025-08-27 12:22:19,266 | HR @1|5|10: 0.1032 	 0.2050 	 0.2582 	
2025-08-27 12:22:19,266 | NDCG @5|10: 0.1555 	 0.1726
2025-08-27 12:22:19,266 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:24:34,375 | Epoch 15/40 - client 0 -  Training Loss: 26.193

 33%|###3      | 1/3 [02:13<04:26, 133.40s/it]2025-08-27 12:24:47,017 | Epoch 15/40 - client 2 -  Training Loss: 21.697

 67%|######6   | 2/3 [02:26<01:02, 62.36s/it] 2025-08-27 12:27:59,853 | Epoch 15/40 - client 1 -  Training Loss: 23.214

100%|##########| 3/3 [05:38<00:00, 121.94s/it]
100%|##########| 3/3 [05:38<00:00, 112.96s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.47s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.95s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.97s/it]
2025-08-27 12:28:14,778 | Epoch15 Valid:
2025-08-27 12:28:14,778 | domain:Movies
2025-08-27 12:28:14,779 | model_moe:
2025-08-27 12:28:14,779 | MRR: 0.1852
2025-08-27 12:28:14,779 | HR @1|5|10: 0.1161 	 0.2467 	 0.3167 	
2025-08-27 12:28:14,780 | NDCG @5|10: 0.1842 	 0.2068
2025-08-27 12:28:14,780 | domain:Books
2025-08-27 12:28:14,780 | model_moe:
2025-08-27 12:28:14,780 | MRR: 0.1585
2025-08-27 12:28:14,781 | HR @1|5|10: 0.0969 	 0.2138 	 0.2779 	
2025-08-27 12:28:14,781 | NDCG @5|10: 0.1569 	 0.1777
2025-08-27 12:28:14,781 | domain:Games
2025-08-27 12:28:14,781 | model_moe:
2025-08-27 12:28:14,782 | MRR: 0.1292
2025-08-27 12:28:14,782 | HR @1|5|10: 0.0990 	 0.1521 	 0.1834 	
2025-08-27 12:28:14,782 | NDCG @5|10: 0.1261 	 0.1363
2025-08-27 12:28:14,783 | 	avg_model_moe:
2025-08-27 12:28:14,784 | MRR: 0.1576
2025-08-27 12:28:14,784 | HR @1|5|10: 0.1040 	 0.2042 	 0.2593 	
2025-08-27 12:28:14,785 | NDCG @5|10: 0.1557 	 0.1736
2025-08-27 12:28:14,785 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:28:29,175 | Epoch 16/40 - client 2 -  Training Loss: 21.451

 33%|###3      | 1/3 [00:12<00:25, 12.63s/it]2025-08-27 12:31:41,967 | Epoch 16/40 - client 1 -  Training Loss: 22.930

 67%|######6   | 2/3 [03:25<01:58, 118.61s/it]2025-08-27 12:33:55,487 | Epoch 16/40 - client 0 -  Training Loss: 25.911

100%|##########| 3/3 [05:38<00:00, 125.42s/it]
100%|##########| 3/3 [05:38<00:00, 112.98s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.49s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.98s/it]
100%|##########| 3/3 [00:14<00:00,  4.32s/it]
100%|##########| 3/3 [00:14<00:00,  4.99s/it]
2025-08-27 12:34:10,470 | Epoch16 Valid:
2025-08-27 12:34:10,471 | domain:Movies
2025-08-27 12:34:10,471 | model_moe:
2025-08-27 12:34:10,471 | MRR: 0.1856
2025-08-27 12:34:10,472 | HR @1|5|10: 0.1159 	 0.2492 	 0.3204 	
2025-08-27 12:34:10,472 | NDCG @5|10: 0.1851 	 0.2081
2025-08-27 12:34:10,472 | domain:Books
2025-08-27 12:34:10,473 | model_moe:
2025-08-27 12:34:10,473 | MRR: 0.1605
2025-08-27 12:34:10,473 | HR @1|5|10: 0.0985 	 0.2132 	 0.2828 	
2025-08-27 12:34:10,474 | NDCG @5|10: 0.1580 	 0.1804
2025-08-27 12:34:10,474 | domain:Games
2025-08-27 12:34:10,474 | model_moe:
2025-08-27 12:34:10,474 | MRR: 0.1247
2025-08-27 12:34:10,475 | HR @1|5|10: 0.0932 	 0.1528 	 0.1805 	
2025-08-27 12:34:10,475 | NDCG @5|10: 0.1232 	 0.1321
2025-08-27 12:34:10,475 | 	avg_model_moe:
2025-08-27 12:34:10,475 | MRR: 0.1569
2025-08-27 12:34:10,476 | HR @1|5|10: 0.1025 	 0.2051 	 0.2612 	
2025-08-27 12:34:10,476 | NDCG @5|10: 0.1554 	 0.1735
2025-08-27 12:34:10,476 | Early Stopping counter: 1 out of 5
2025-08-27 12:34:10,477 | Learning rate decay counter: 1 out of 1
2025-08-27 12:34:10,477 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:34:23,119 | Epoch 17/40 - client 2 -  Training Loss: 21.224

 33%|###3      | 1/3 [00:12<00:25, 12.64s/it]2025-08-27 12:37:35,833 | Epoch 17/40 - client 1 -  Training Loss: 22.658

 67%|######6   | 2/3 [03:25<01:58, 118.57s/it]2025-08-27 12:39:49,358 | Epoch 17/40 - client 0 -  Training Loss: 25.639

100%|##########| 3/3 [05:38<00:00, 125.40s/it]
100%|##########| 3/3 [05:38<00:00, 112.96s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.47s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.95s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.97s/it]
2025-08-27 12:40:04,270 | Epoch17 Valid:
2025-08-27 12:40:04,271 | domain:Movies
2025-08-27 12:40:04,271 | model_moe:
2025-08-27 12:40:04,271 | MRR: 0.1870
2025-08-27 12:40:04,272 | HR @1|5|10: 0.1172 	 0.2499 	 0.3223 	
2025-08-27 12:40:04,272 | NDCG @5|10: 0.1862 	 0.2096
2025-08-27 12:40:04,272 | domain:Books
2025-08-27 12:40:04,273 | model_moe:
2025-08-27 12:40:04,273 | MRR: 0.1610
2025-08-27 12:40:04,273 | HR @1|5|10: 0.0988 	 0.2172 	 0.2795 	
2025-08-27 12:40:04,274 | NDCG @5|10: 0.1597 	 0.1798
2025-08-27 12:40:04,274 | domain:Games
2025-08-27 12:40:04,274 | model_moe:
2025-08-27 12:40:04,274 | MRR: 0.1261
2025-08-27 12:40:04,275 | HR @1|5|10: 0.0932 	 0.1507 	 0.1820 	
2025-08-27 12:40:04,275 | NDCG @5|10: 0.1230 	 0.1333
2025-08-27 12:40:04,275 | 	avg_model_moe:
2025-08-27 12:40:04,275 | MRR: 0.1580
2025-08-27 12:40:04,276 | HR @1|5|10: 0.1031 	 0.2059 	 0.2613 	
2025-08-27 12:40:04,276 | NDCG @5|10: 0.1563 	 0.1742
2025-08-27 12:40:04,276 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:42:19,471 | Epoch 18/40 - client 0 -  Training Loss: 25.391

 33%|###3      | 1/3 [02:13<04:26, 133.42s/it]2025-08-27 12:45:32,397 | Epoch 18/40 - client 1 -  Training Loss: 22.409

 67%|######6   | 2/3 [05:26<02:48, 168.43s/it]2025-08-27 12:45:45,047 | Epoch 18/40 - client 2 -  Training Loss: 21.025

100%|##########| 3/3 [05:39<00:00, 97.30s/it] 
100%|##########| 3/3 [05:39<00:00, 113.00s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.45s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.93s/it]
100%|##########| 3/3 [00:14<00:00,  4.29s/it]
100%|##########| 3/3 [00:14<00:00,  4.95s/it]
2025-08-27 12:45:59,920 | Epoch18 Valid:
2025-08-27 12:45:59,921 | domain:Movies
2025-08-27 12:45:59,921 | model_moe:
2025-08-27 12:45:59,921 | MRR: 0.1864
2025-08-27 12:45:59,922 | HR @1|5|10: 0.1171 	 0.2494 	 0.3217 	
2025-08-27 12:45:59,922 | NDCG @5|10: 0.1856 	 0.2090
2025-08-27 12:45:59,922 | domain:Books
2025-08-27 12:45:59,923 | model_moe:
2025-08-27 12:45:59,923 | MRR: 0.1610
2025-08-27 12:45:59,923 | HR @1|5|10: 0.0986 	 0.2148 	 0.2817 	
2025-08-27 12:45:59,923 | NDCG @5|10: 0.1587 	 0.1803
2025-08-27 12:45:59,924 | domain:Games
2025-08-27 12:45:59,924 | model_moe:
2025-08-27 12:45:59,924 | MRR: 0.1218
2025-08-27 12:45:59,924 | HR @1|5|10: 0.0881 	 0.1521 	 0.1798 	
2025-08-27 12:45:59,925 | NDCG @5|10: 0.1204 	 0.1294
2025-08-27 12:45:59,925 | 	avg_model_moe:
2025-08-27 12:45:59,925 | MRR: 0.1564
2025-08-27 12:45:59,926 | HR @1|5|10: 0.1012 	 0.2054 	 0.2611 	
2025-08-27 12:45:59,926 | NDCG @5|10: 0.1549 	 0.1729
2025-08-27 12:45:59,926 | Early Stopping counter: 1 out of 5
2025-08-27 12:45:59,926 | Learning rate decay counter: 1 out of 1
2025-08-27 12:45:59,927 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:46:12,564 | Epoch 19/40 - client 2 -  Training Loss: 20.832

 33%|###3      | 1/3 [00:12<00:25, 12.64s/it]2025-08-27 12:49:25,163 | Epoch 19/40 - client 1 -  Training Loss: 22.186

 67%|######6   | 2/3 [03:25<01:58, 118.50s/it]2025-08-27 12:51:38,564 | Epoch 19/40 - client 0 -  Training Loss: 25.154

100%|##########| 3/3 [05:38<00:00, 125.30s/it]
100%|##########| 3/3 [05:38<00:00, 112.88s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.45s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.94s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-27 12:51:53,470 | Epoch19 Valid:
2025-08-27 12:51:53,470 | domain:Movies
2025-08-27 12:51:53,470 | model_moe:
2025-08-27 12:51:53,471 | MRR: 0.1884
2025-08-27 12:51:53,471 | HR @1|5|10: 0.1198 	 0.2485 	 0.3221 	
2025-08-27 12:51:53,471 | NDCG @5|10: 0.1867 	 0.2106
2025-08-27 12:51:53,472 | domain:Books
2025-08-27 12:51:53,472 | model_moe:
2025-08-27 12:51:53,472 | MRR: 0.1605
2025-08-27 12:51:53,472 | HR @1|5|10: 0.0985 	 0.2151 	 0.2801 	
2025-08-27 12:51:53,473 | NDCG @5|10: 0.1586 	 0.1796
2025-08-27 12:51:53,473 | domain:Games
2025-08-27 12:51:53,473 | model_moe:
2025-08-27 12:51:53,474 | MRR: 0.1196
2025-08-27 12:51:53,474 | HR @1|5|10: 0.0837 	 0.1499 	 0.1849 	
2025-08-27 12:51:53,474 | NDCG @5|10: 0.1179 	 0.1292
2025-08-27 12:51:53,474 | 	avg_model_moe:
2025-08-27 12:51:53,475 | MRR: 0.1562
2025-08-27 12:51:53,475 | HR @1|5|10: 0.1007 	 0.2045 	 0.2623 	
2025-08-27 12:51:53,475 | NDCG @5|10: 0.1544 	 0.1731
2025-08-27 12:51:53,476 | Early Stopping counter: 2 out of 5
2025-08-27 12:51:53,476 | Learning rate decay counter: 1 out of 1
2025-08-27 12:51:53,476 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:52:06,069 | Epoch 20/40 - client 2 -  Training Loss: 20.654

 33%|###3      | 1/3 [00:12<00:25, 12.59s/it]2025-08-27 12:54:19,548 | Epoch 20/40 - client 0 -  Training Loss: 24.925

 67%|######6   | 2/3 [02:26<01:23, 83.71s/it]2025-08-27 12:57:32,398 | Epoch 20/40 - client 1 -  Training Loss: 21.968

100%|##########| 3/3 [05:38<00:00, 133.54s/it]
100%|##########| 3/3 [05:38<00:00, 112.98s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.45s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.94s/it]
100%|##########| 3/3 [00:14<00:00,  4.29s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-27 12:57:47,302 | Epoch20 Valid:
2025-08-27 12:57:47,303 | domain:Movies
2025-08-27 12:57:47,303 | model_moe:
2025-08-27 12:57:47,304 | MRR: 0.1882
2025-08-27 12:57:47,306 | HR @1|5|10: 0.1189 	 0.2497 	 0.3209 	
2025-08-27 12:57:47,306 | NDCG @5|10: 0.1870 	 0.2101
2025-08-27 12:57:47,307 | domain:Books
2025-08-27 12:57:47,307 | model_moe:
2025-08-27 12:57:47,307 | MRR: 0.1602
2025-08-27 12:57:47,308 | HR @1|5|10: 0.0974 	 0.2139 	 0.2807 	
2025-08-27 12:57:47,308 | NDCG @5|10: 0.1579 	 0.1796
2025-08-27 12:57:47,308 | domain:Games
2025-08-27 12:57:47,308 | model_moe:
2025-08-27 12:57:47,309 | MRR: 0.1176
2025-08-27 12:57:47,309 | HR @1|5|10: 0.0822 	 0.1470 	 0.1805 	
2025-08-27 12:57:47,309 | NDCG @5|10: 0.1154 	 0.1263
2025-08-27 12:57:47,310 | 	avg_model_moe:
2025-08-27 12:57:47,310 | MRR: 0.1553
2025-08-27 12:57:47,310 | HR @1|5|10: 0.0995 	 0.2036 	 0.2607 	
2025-08-27 12:57:47,310 | NDCG @5|10: 0.1535 	 0.1720
2025-08-27 12:57:47,311 | Early Stopping counter: 3 out of 5
2025-08-27 12:57:47,311 | Learning rate decay counter: 1 out of 1
2025-08-27 12:57:47,311 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 12:57:59,955 | Epoch 21/40 - client 2 -  Training Loss: 20.490

 33%|###3      | 1/3 [00:12<00:25, 12.64s/it]2025-08-27 13:00:13,533 | Epoch 21/40 - client 0 -  Training Loss: 24.716

 67%|######6   | 2/3 [02:26<01:23, 83.78s/it]2025-08-27 13:03:26,443 | Epoch 21/40 - client 1 -  Training Loss: 21.770

100%|##########| 3/3 [05:39<00:00, 133.61s/it]
100%|##########| 3/3 [05:39<00:00, 113.05s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.47s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.96s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.97s/it]
2025-08-27 13:03:41,384 | Epoch21 Valid:
2025-08-27 13:03:41,388 | domain:Movies
2025-08-27 13:03:41,388 | model_moe:
2025-08-27 13:03:41,389 | MRR: 0.1883
2025-08-27 13:03:41,389 | HR @1|5|10: 0.1196 	 0.2495 	 0.3205 	
2025-08-27 13:03:41,389 | NDCG @5|10: 0.1870 	 0.2100
2025-08-27 13:03:41,389 | domain:Books
2025-08-27 13:03:41,390 | model_moe:
2025-08-27 13:03:41,393 | MRR: 0.1601
2025-08-27 13:03:41,393 | HR @1|5|10: 0.0980 	 0.2147 	 0.2801 	
2025-08-27 13:03:41,394 | NDCG @5|10: 0.1583 	 0.1793
2025-08-27 13:03:41,394 | domain:Games
2025-08-27 13:03:41,394 | model_moe:
2025-08-27 13:03:41,394 | MRR: 0.1182
2025-08-27 13:03:41,395 | HR @1|5|10: 0.0837 	 0.1470 	 0.1739 	
2025-08-27 13:03:41,397 | NDCG @5|10: 0.1161 	 0.1249
2025-08-27 13:03:41,397 | 	avg_model_moe:
2025-08-27 13:03:41,398 | MRR: 0.1555
2025-08-27 13:03:41,398 | HR @1|5|10: 0.1004 	 0.2037 	 0.2582 	
2025-08-27 13:03:41,398 | NDCG @5|10: 0.1538 	 0.1714
2025-08-27 13:03:41,398 | Early Stopping counter: 4 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:05:54,953 | Epoch 22/40 - client 0 -  Training Loss: 24.517

 33%|###3      | 1/3 [02:13<04:27, 133.55s/it]2025-08-27 13:06:07,583 | Epoch 22/40 - client 2 -  Training Loss: 20.330

 67%|######6   | 2/3 [02:26<01:02, 62.42s/it] 2025-08-27 13:09:20,543 | Epoch 22/40 - client 1 -  Training Loss: 21.587

100%|##########| 3/3 [05:39<00:00, 122.03s/it]
100%|##########| 3/3 [05:39<00:00, 113.05s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.45s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.94s/it]
100%|##########| 3/3 [00:14<00:00,  4.29s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-27 13:09:35,436 | Epoch22 Valid:
2025-08-27 13:09:35,436 | domain:Movies
2025-08-27 13:09:35,437 | model_moe:
2025-08-27 13:09:35,437 | MRR: 0.1858
2025-08-27 13:09:35,437 | HR @1|5|10: 0.1159 	 0.2492 	 0.3193 	
2025-08-27 13:09:35,438 | NDCG @5|10: 0.1851 	 0.2078
2025-08-27 13:09:35,438 | domain:Books
2025-08-27 13:09:35,438 | model_moe:
2025-08-27 13:09:35,438 | MRR: 0.1601
2025-08-27 13:09:35,439 | HR @1|5|10: 0.0973 	 0.2158 	 0.2817 	
2025-08-27 13:09:35,439 | NDCG @5|10: 0.1585 	 0.1796
2025-08-27 13:09:35,439 | domain:Games
2025-08-27 13:09:35,441 | model_moe:
2025-08-27 13:09:35,441 | MRR: 0.1188
2025-08-27 13:09:35,441 | HR @1|5|10: 0.0844 	 0.1470 	 0.1783 	
2025-08-27 13:09:35,441 | NDCG @5|10: 0.1163 	 0.1266
2025-08-27 13:09:35,442 | 	avg_model_moe:
2025-08-27 13:09:35,442 | MRR: 0.1549
2025-08-27 13:09:35,442 | HR @1|5|10: 0.0992 	 0.2040 	 0.2598 	
2025-08-27 13:09:35,442 | NDCG @5|10: 0.1533 	 0.1714
2025-08-27 13:09:35,443 | Early Stopping counter: 5 out of 5
2025-08-27 13:09:35,443 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.57s/it]
 67%|######6   | 2/3 [00:21<00:10, 10.79s/it]
100%|##########| 3/3 [00:23<00:00,  6.74s/it]
100%|##########| 3/3 [00:23<00:00,  7.71s/it]
2025-08-27 13:09:58,577 | Test:
2025-08-27 13:09:58,577 | domain:Movies
2025-08-27 13:09:58,578 | model_moe:
2025-08-27 13:09:58,578 | MRR: 0.1900
2025-08-27 13:09:58,578 | HR @1|5|10: 0.1198 	 0.2541 	 0.3232 	
2025-08-27 13:09:58,579 | NDCG @5|10: 0.1904 	 0.2127
2025-08-27 13:09:58,579 | domain:Books
2025-08-27 13:09:58,579 | model_moe:
2025-08-27 13:09:58,580 | MRR: 0.1347
2025-08-27 13:09:58,580 | HR @1|5|10: 0.0845 	 0.1752 	 0.2319 	
2025-08-27 13:09:58,580 | NDCG @5|10: 0.1312 	 0.1495
2025-08-27 13:09:58,580 | domain:Games
2025-08-27 13:09:58,581 | model_moe:
2025-08-27 13:09:58,581 | MRR: 0.0802
2025-08-27 13:09:58,581 | HR @1|5|10: 0.0492 	 0.1011 	 0.1274 	
2025-08-27 13:09:58,582 | NDCG @5|10: 0.0771 	 0.0856
2025-08-27 13:09:58,582 | 	avg_model_moe:
2025-08-27 13:09:58,582 | MRR: 0.1349
2025-08-27 13:09:58,582 | HR @1|5|10: 0.0845 	 0.1768 	 0.2275 	
2025-08-27 13:09:58,583 | NDCG @5|10: 0.1329 	 0.1493
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 13:12:56,281 | Running with the following configs:
	domains : ['Sports', 'Garden', 'Home']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 0.1
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 13:13:29,341 | Epoch 1/40 - client 1 -  Training Loss: 23.166

 33%|###3      | 1/3 [00:33<01:06, 33.05s/it]2025-08-27 13:15:15,839 | Epoch 1/40 - client 2 -  Training Loss: 27.569

 67%|######6   | 2/3 [02:19<01:16, 76.25s/it]2025-08-27 13:18:19,260 | Epoch 1/40 - client 0 -  Training Loss: 28.831

100%|##########| 3/3 [05:22<00:00, 125.19s/it]
100%|##########| 3/3 [05:22<00:00, 107.66s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.55s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.17s/it]
100%|##########| 3/3 [00:18<00:00,  5.80s/it]
100%|##########| 3/3 [00:18<00:00,  6.07s/it]
2025-08-27 13:18:37,479 | Epoch1 Valid:
2025-08-27 13:18:37,479 | domain:Sports
2025-08-27 13:18:37,480 | model_moe:
2025-08-27 13:18:37,480 | MRR: 0.0360
2025-08-27 13:18:37,480 | HR @1|5|10: 0.0210 	 0.0402 	 0.0558 	
2025-08-27 13:18:37,481 | NDCG @5|10: 0.0308 	 0.0358
2025-08-27 13:18:37,481 | domain:Garden
2025-08-27 13:18:37,481 | model_moe:
2025-08-27 13:18:37,481 | MRR: 0.0438
2025-08-27 13:18:37,482 | HR @1|5|10: 0.0293 	 0.0481 	 0.0615 	
2025-08-27 13:18:37,482 | NDCG @5|10: 0.0392 	 0.0435
2025-08-27 13:18:37,482 | domain:Home
2025-08-27 13:18:37,482 | model_moe:
2025-08-27 13:18:37,483 | MRR: 0.0387
2025-08-27 13:18:37,483 | HR @1|5|10: 0.0231 	 0.0455 	 0.0591 	
2025-08-27 13:18:37,483 | NDCG @5|10: 0.0344 	 0.0388
2025-08-27 13:18:37,484 | 	avg_model_moe:
2025-08-27 13:18:37,484 | MRR: 0.0395
2025-08-27 13:18:37,484 | HR @1|5|10: 0.0244 	 0.0446 	 0.0588 	
2025-08-27 13:18:37,484 | NDCG @5|10: 0.0348 	 0.0394
2025-08-27 13:18:37,485 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:20:25,619 | Epoch 2/40 - client 2 -  Training Loss: 23.632

 33%|###3      | 1/3 [01:45<03:31, 105.70s/it]2025-08-27 13:23:27,926 | Epoch 2/40 - client 0 -  Training Loss: 24.362

 67%|######6   | 2/3 [04:48<02:30, 150.76s/it]2025-08-27 13:23:48,746 | Epoch 2/40 - client 1 -  Training Loss: 20.166

100%|##########| 3/3 [05:08<00:00, 91.43s/it] 
100%|##########| 3/3 [05:08<00:00, 102.94s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.42s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.11s/it]
100%|##########| 3/3 [00:17<00:00,  5.72s/it]
100%|##########| 3/3 [00:17<00:00,  5.99s/it]
2025-08-27 13:24:06,717 | Epoch2 Valid:
2025-08-27 13:24:06,718 | domain:Sports
2025-08-27 13:24:06,718 | model_moe:
2025-08-27 13:24:06,718 | MRR: 0.0568
2025-08-27 13:24:06,719 | HR @1|5|10: 0.0421 	 0.0629 	 0.0751 	
2025-08-27 13:24:06,719 | NDCG @5|10: 0.0527 	 0.0567
2025-08-27 13:24:06,719 | domain:Garden
2025-08-27 13:24:06,719 | model_moe:
2025-08-27 13:24:06,720 | MRR: 0.0560
2025-08-27 13:24:06,720 | HR @1|5|10: 0.0410 	 0.0625 	 0.0758 	
2025-08-27 13:24:06,720 | NDCG @5|10: 0.0520 	 0.0562
2025-08-27 13:24:06,720 | domain:Home
2025-08-27 13:24:06,721 | model_moe:
2025-08-27 13:24:06,721 | MRR: 0.0571
2025-08-27 13:24:06,721 | HR @1|5|10: 0.0428 	 0.0621 	 0.0749 	
2025-08-27 13:24:06,721 | NDCG @5|10: 0.0527 	 0.0568
2025-08-27 13:24:06,722 | 	avg_model_moe:
2025-08-27 13:24:06,722 | MRR: 0.0566
2025-08-27 13:24:06,722 | HR @1|5|10: 0.0419 	 0.0625 	 0.0753 	
2025-08-27 13:24:06,722 | NDCG @5|10: 0.0525 	 0.0566
2025-08-27 13:24:06,723 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:25:55,005 | Epoch 3/40 - client 2 -  Training Loss: 19.621

 33%|###3      | 1/3 [01:45<03:31, 105.80s/it]2025-08-27 13:28:57,269 | Epoch 3/40 - client 0 -  Training Loss: 20.152

 67%|######6   | 2/3 [04:48<02:30, 150.78s/it]2025-08-27 13:29:18,162 | Epoch 3/40 - client 1 -  Training Loss: 17.526

100%|##########| 3/3 [05:08<00:00, 91.47s/it] 
100%|##########| 3/3 [05:08<00:00, 102.99s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.49s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.13s/it]
100%|##########| 3/3 [00:18<00:00,  5.74s/it]
100%|##########| 3/3 [00:18<00:00,  6.01s/it]
2025-08-27 13:29:36,204 | Epoch3 Valid:
2025-08-27 13:29:36,205 | domain:Sports
2025-08-27 13:29:36,205 | model_moe:
2025-08-27 13:29:36,205 | MRR: 0.0687
2025-08-27 13:29:36,206 | HR @1|5|10: 0.0555 	 0.0727 	 0.0845 	
2025-08-27 13:29:36,206 | NDCG @5|10: 0.0643 	 0.0681
2025-08-27 13:29:36,206 | domain:Garden
2025-08-27 13:29:36,206 | model_moe:
2025-08-27 13:29:36,207 | MRR: 0.0743
2025-08-27 13:29:36,207 | HR @1|5|10: 0.0579 	 0.0817 	 0.0956 	
2025-08-27 13:29:36,207 | NDCG @5|10: 0.0706 	 0.0750
2025-08-27 13:29:36,208 | domain:Home
2025-08-27 13:29:36,208 | model_moe:
2025-08-27 13:29:36,208 | MRR: 0.0643
2025-08-27 13:29:36,208 | HR @1|5|10: 0.0512 	 0.0669 	 0.0793 	
2025-08-27 13:29:36,209 | NDCG @5|10: 0.0593 	 0.0633
2025-08-27 13:29:36,209 | 	avg_model_moe:
2025-08-27 13:29:36,209 | MRR: 0.0691
2025-08-27 13:29:36,209 | HR @1|5|10: 0.0549 	 0.0738 	 0.0865 	
2025-08-27 13:29:36,210 | NDCG @5|10: 0.0647 	 0.0688
2025-08-27 13:29:36,210 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:31:24,590 | Epoch 4/40 - client 2 -  Training Loss: 16.286

 33%|###3      | 1/3 [01:45<03:31, 105.88s/it]2025-08-27 13:31:45,121 | Epoch 4/40 - client 1 -  Training Loss: 14.462

 67%|######6   | 2/3 [02:06<00:55, 55.68s/it] 2025-08-27 13:34:47,405 | Epoch 4/40 - client 0 -  Training Loss: 16.728

100%|##########| 3/3 [05:08<00:00, 113.49s/it]
100%|##########| 3/3 [05:08<00:00, 102.90s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.61s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.17s/it]
100%|##########| 3/3 [00:18<00:00,  5.76s/it]
100%|##########| 3/3 [00:18<00:00,  6.04s/it]
2025-08-27 13:35:05,556 | Epoch4 Valid:
2025-08-27 13:35:05,556 | domain:Sports
2025-08-27 13:35:05,556 | model_moe:
2025-08-27 13:35:05,557 | MRR: 0.0783
2025-08-27 13:35:05,557 | HR @1|5|10: 0.0646 	 0.0827 	 0.0944 	
2025-08-27 13:35:05,557 | NDCG @5|10: 0.0739 	 0.0777
2025-08-27 13:35:05,557 | domain:Garden
2025-08-27 13:35:05,558 | model_moe:
2025-08-27 13:35:05,558 | MRR: 0.0832
2025-08-27 13:35:05,558 | HR @1|5|10: 0.0651 	 0.0937 	 0.1080 	
2025-08-27 13:35:05,559 | NDCG @5|10: 0.0803 	 0.0849
2025-08-27 13:35:05,561 | domain:Home
2025-08-27 13:35:05,561 | model_moe:
2025-08-27 13:35:05,562 | MRR: 0.0706
2025-08-27 13:35:05,562 | HR @1|5|10: 0.0562 	 0.0752 	 0.0886 	
2025-08-27 13:35:05,562 | NDCG @5|10: 0.0662 	 0.0705
2025-08-27 13:35:05,562 | 	avg_model_moe:
2025-08-27 13:35:05,563 | MRR: 0.0774
2025-08-27 13:35:05,563 | HR @1|5|10: 0.0619 	 0.0838 	 0.0970 	
2025-08-27 13:35:05,563 | NDCG @5|10: 0.0735 	 0.0777
2025-08-27 13:35:05,564 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:38:10,559 | Epoch 5/40 - client 0 -  Training Loss: 14.534

 33%|###3      | 1/3 [03:02<06:05, 182.70s/it]2025-08-27 13:38:31,702 | Epoch 5/40 - client 1 -  Training Loss: 12.120

 67%|######6   | 2/3 [03:23<01:27, 87.67s/it] 2025-08-27 13:40:17,885 | Epoch 5/40 - client 2 -  Training Loss: 14.060

100%|##########| 3/3 [05:10<00:00, 96.12s/it]
100%|##########| 3/3 [05:10<00:00, 103.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.59s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.18s/it]
100%|##########| 3/3 [00:18<00:00,  5.79s/it]
100%|##########| 3/3 [00:18<00:00,  6.06s/it]
2025-08-27 13:40:36,091 | Epoch5 Valid:
2025-08-27 13:40:36,091 | domain:Sports
2025-08-27 13:40:36,091 | model_moe:
2025-08-27 13:40:36,092 | MRR: 0.0831
2025-08-27 13:40:36,092 | HR @1|5|10: 0.0686 	 0.0883 	 0.1006 	
2025-08-27 13:40:36,092 | NDCG @5|10: 0.0788 	 0.0827
2025-08-27 13:40:36,093 | domain:Garden
2025-08-27 13:40:36,093 | model_moe:
2025-08-27 13:40:36,093 | MRR: 0.0879
2025-08-27 13:40:36,093 | HR @1|5|10: 0.0699 	 0.0973 	 0.1106 	
2025-08-27 13:40:36,094 | NDCG @5|10: 0.0847 	 0.0890
2025-08-27 13:40:36,094 | domain:Home
2025-08-27 13:40:36,094 | model_moe:
2025-08-27 13:40:36,094 | MRR: 0.0744
2025-08-27 13:40:36,095 | HR @1|5|10: 0.0590 	 0.0803 	 0.0952 	
2025-08-27 13:40:36,095 | NDCG @5|10: 0.0703 	 0.0750
2025-08-27 13:40:36,095 | 	avg_model_moe:
2025-08-27 13:40:36,096 | MRR: 0.0818
2025-08-27 13:40:36,096 | HR @1|5|10: 0.0658 	 0.0886 	 0.1021 	
2025-08-27 13:40:36,096 | NDCG @5|10: 0.0779 	 0.0822
2025-08-27 13:40:36,096 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:43:41,345 | Epoch 6/40 - client 0 -  Training Loss: 13.106

 33%|###3      | 1/3 [03:02<06:05, 182.95s/it]2025-08-27 13:44:02,388 | Epoch 6/40 - client 1 -  Training Loss: 10.556

 67%|######6   | 2/3 [03:23<01:27, 87.71s/it] 2025-08-27 13:45:48,940 | Epoch 6/40 - client 2 -  Training Loss: 12.573

100%|##########| 3/3 [05:10<00:00, 96.31s/it]
100%|##########| 3/3 [05:10<00:00, 103.52s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.57s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.18s/it]
100%|##########| 3/3 [00:18<00:00,  5.81s/it]
100%|##########| 3/3 [00:18<00:00,  6.08s/it]
2025-08-27 13:46:07,199 | Epoch6 Valid:
2025-08-27 13:46:07,202 | domain:Sports
2025-08-27 13:46:07,203 | model_moe:
2025-08-27 13:46:07,203 | MRR: 0.0859
2025-08-27 13:46:07,203 | HR @1|5|10: 0.0715 	 0.0901 	 0.1036 	
2025-08-27 13:46:07,204 | NDCG @5|10: 0.0812 	 0.0855
2025-08-27 13:46:07,204 | domain:Garden
2025-08-27 13:46:07,204 | model_moe:
2025-08-27 13:46:07,204 | MRR: 0.0901
2025-08-27 13:46:07,205 | HR @1|5|10: 0.0719 	 0.0992 	 0.1145 	
2025-08-27 13:46:07,205 | NDCG @5|10: 0.0866 	 0.0915
2025-08-27 13:46:07,205 | domain:Home
2025-08-27 13:46:07,206 | model_moe:
2025-08-27 13:46:07,206 | MRR: 0.0764
2025-08-27 13:46:07,206 | HR @1|5|10: 0.0604 	 0.0824 	 0.0969 	
2025-08-27 13:46:07,208 | NDCG @5|10: 0.0723 	 0.0769
2025-08-27 13:46:07,208 | 	avg_model_moe:
2025-08-27 13:46:07,208 | MRR: 0.0841
2025-08-27 13:46:07,208 | HR @1|5|10: 0.0679 	 0.0906 	 0.1050 	
2025-08-27 13:46:07,209 | NDCG @5|10: 0.0800 	 0.0847
2025-08-27 13:46:07,209 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:47:56,132 | Epoch 7/40 - client 2 -  Training Loss: 11.576

 33%|###3      | 1/3 [01:46<03:32, 106.02s/it]2025-08-27 13:50:58,980 | Epoch 7/40 - client 0 -  Training Loss: 12.091

 67%|######6   | 2/3 [04:48<02:31, 151.21s/it]2025-08-27 13:51:19,650 | Epoch 7/40 - client 1 -  Training Loss: 9.488

100%|##########| 3/3 [05:09<00:00, 91.60s/it] 
100%|##########| 3/3 [05:09<00:00, 103.18s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.50s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.14s/it]
100%|##########| 3/3 [00:18<00:00,  5.76s/it]
100%|##########| 3/3 [00:18<00:00,  6.03s/it]
2025-08-27 13:51:37,757 | Epoch7 Valid:
2025-08-27 13:51:37,758 | domain:Sports
2025-08-27 13:51:37,758 | model_moe:
2025-08-27 13:51:37,758 | MRR: 0.0864
2025-08-27 13:51:37,758 | HR @1|5|10: 0.0711 	 0.0923 	 0.1047 	
2025-08-27 13:51:37,759 | NDCG @5|10: 0.0822 	 0.0861
2025-08-27 13:51:37,759 | domain:Garden
2025-08-27 13:51:37,759 | model_moe:
2025-08-27 13:51:37,760 | MRR: 0.0902
2025-08-27 13:51:37,760 | HR @1|5|10: 0.0716 	 0.0992 	 0.1155 	
2025-08-27 13:51:37,760 | NDCG @5|10: 0.0866 	 0.0918
2025-08-27 13:51:37,760 | domain:Home
2025-08-27 13:51:37,761 | model_moe:
2025-08-27 13:51:37,761 | MRR: 0.0770
2025-08-27 13:51:37,761 | HR @1|5|10: 0.0614 	 0.0827 	 0.0967 	
2025-08-27 13:51:37,761 | NDCG @5|10: 0.0729 	 0.0774
2025-08-27 13:51:37,762 | 	avg_model_moe:
2025-08-27 13:51:37,762 | MRR: 0.0845
2025-08-27 13:51:37,762 | HR @1|5|10: 0.0680 	 0.0914 	 0.1057 	
2025-08-27 13:51:37,762 | NDCG @5|10: 0.0805 	 0.0851
2025-08-27 13:51:37,763 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:53:26,010 | Epoch 8/40 - client 2 -  Training Loss: 10.768

 33%|###3      | 1/3 [01:45<03:31, 105.97s/it]2025-08-27 13:53:46,707 | Epoch 8/40 - client 1 -  Training Loss: 8.690

 67%|######6   | 2/3 [02:06<00:55, 55.81s/it] 2025-08-27 13:56:49,962 | Epoch 8/40 - client 0 -  Training Loss: 11.293

100%|##########| 3/3 [05:09<00:00, 114.00s/it]
100%|##########| 3/3 [05:09<00:00, 103.31s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.48s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.13s/it]
100%|##########| 3/3 [00:18<00:00,  5.81s/it]
100%|##########| 3/3 [00:18<00:00,  6.06s/it]
2025-08-27 13:57:08,170 | Epoch8 Valid:
2025-08-27 13:57:08,170 | domain:Sports
2025-08-27 13:57:08,171 | model_moe:
2025-08-27 13:57:08,171 | MRR: 0.0862
2025-08-27 13:57:08,171 | HR @1|5|10: 0.0704 	 0.0921 	 0.1065 	
2025-08-27 13:57:08,171 | NDCG @5|10: 0.0818 	 0.0864
2025-08-27 13:57:08,172 | domain:Garden
2025-08-27 13:57:08,172 | model_moe:
2025-08-27 13:57:08,172 | MRR: 0.0899
2025-08-27 13:57:08,173 | HR @1|5|10: 0.0706 	 0.0989 	 0.1168 	
2025-08-27 13:57:08,173 | NDCG @5|10: 0.0861 	 0.0919
2025-08-27 13:57:08,173 | domain:Home
2025-08-27 13:57:08,173 | model_moe:
2025-08-27 13:57:08,174 | MRR: 0.0767
2025-08-27 13:57:08,174 | HR @1|5|10: 0.0608 	 0.0833 	 0.0960 	
2025-08-27 13:57:08,174 | NDCG @5|10: 0.0729 	 0.0770
2025-08-27 13:57:08,175 | 	avg_model_moe:
2025-08-27 13:57:08,175 | MRR: 0.0843
2025-08-27 13:57:08,175 | HR @1|5|10: 0.0673 	 0.0914 	 0.1064 	
2025-08-27 13:57:08,176 | NDCG @5|10: 0.0803 	 0.0851
2025-08-27 13:57:08,176 | Early Stopping counter: 1 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 13:57:29,066 | Epoch 9/40 - client 1 -  Training Loss: 8.053

 33%|###3      | 1/3 [00:20<00:41, 20.89s/it]2025-08-27 13:59:15,063 | Epoch 9/40 - client 2 -  Training Loss: 10.091

 67%|######6   | 2/3 [02:06<01:10, 70.95s/it]2025-08-27 14:02:17,385 | Epoch 9/40 - client 0 -  Training Loss: 10.585

100%|##########| 3/3 [05:09<00:00, 121.81s/it]
100%|##########| 3/3 [05:09<00:00, 103.07s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.88s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.34s/it]
100%|##########| 3/3 [00:18<00:00,  5.88s/it]
100%|##########| 3/3 [00:18<00:00,  6.19s/it]
2025-08-27 14:02:35,958 | Epoch9 Valid:
2025-08-27 14:02:35,959 | domain:Sports
2025-08-27 14:02:35,959 | model_moe:
2025-08-27 14:02:35,959 | MRR: 0.0863
2025-08-27 14:02:35,960 | HR @1|5|10: 0.0698 	 0.0929 	 0.1077 	
2025-08-27 14:02:35,960 | NDCG @5|10: 0.0820 	 0.0868
2025-08-27 14:02:35,960 | domain:Garden
2025-08-27 14:02:35,961 | model_moe:
2025-08-27 14:02:35,961 | MRR: 0.0897
2025-08-27 14:02:35,961 | HR @1|5|10: 0.0703 	 0.1012 	 0.1155 	
2025-08-27 14:02:35,962 | NDCG @5|10: 0.0868 	 0.0913
2025-08-27 14:02:35,962 | domain:Home
2025-08-27 14:02:35,962 | model_moe:
2025-08-27 14:02:35,962 | MRR: 0.0762
2025-08-27 14:02:35,963 | HR @1|5|10: 0.0601 	 0.0834 	 0.0949 	
2025-08-27 14:02:35,963 | NDCG @5|10: 0.0726 	 0.0763
2025-08-27 14:02:35,963 | 	avg_model_moe:
2025-08-27 14:02:35,963 | MRR: 0.0841
2025-08-27 14:02:35,964 | HR @1|5|10: 0.0667 	 0.0925 	 0.1061 	
2025-08-27 14:02:35,964 | NDCG @5|10: 0.0805 	 0.0848
2025-08-27 14:02:35,964 | Early Stopping counter: 2 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 14:04:21,975 | Epoch 10/40 - client 2 -  Training Loss: 9.493

 33%|###3      | 1/3 [01:46<03:32, 106.01s/it]2025-08-27 14:04:42,546 | Epoch 10/40 - client 1 -  Training Loss: 7.542

 67%|######6   | 2/3 [02:06<00:55, 55.75s/it] 2025-08-27 14:07:45,274 | Epoch 10/40 - client 0 -  Training Loss: 9.957

100%|##########| 3/3 [05:09<00:00, 113.73s/it]
100%|##########| 3/3 [05:09<00:00, 103.11s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.54s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.16s/it]
100%|##########| 3/3 [00:18<00:00,  5.79s/it]
100%|##########| 3/3 [00:18<00:00,  6.06s/it]
2025-08-27 14:08:03,459 | Epoch10 Valid:
2025-08-27 14:08:03,459 | domain:Sports
2025-08-27 14:08:03,460 | model_moe:
2025-08-27 14:08:03,460 | MRR: 0.0860
2025-08-27 14:08:03,460 | HR @1|5|10: 0.0695 	 0.0930 	 0.1079 	
2025-08-27 14:08:03,460 | NDCG @5|10: 0.0817 	 0.0865
2025-08-27 14:08:03,461 | domain:Garden
2025-08-27 14:08:03,461 | model_moe:
2025-08-27 14:08:03,461 | MRR: 0.0897
2025-08-27 14:08:03,462 | HR @1|5|10: 0.0690 	 0.0992 	 0.1174 	
2025-08-27 14:08:03,462 | NDCG @5|10: 0.0859 	 0.0917
2025-08-27 14:08:03,462 | domain:Home
2025-08-27 14:08:03,462 | model_moe:
2025-08-27 14:08:03,463 | MRR: 0.0759
2025-08-27 14:08:03,463 | HR @1|5|10: 0.0597 	 0.0829 	 0.0955 	
2025-08-27 14:08:03,463 | NDCG @5|10: 0.0722 	 0.0763
2025-08-27 14:08:03,463 | 	avg_model_moe:
2025-08-27 14:08:03,464 | MRR: 0.0839
2025-08-27 14:08:03,464 | HR @1|5|10: 0.0661 	 0.0917 	 0.1070 	
2025-08-27 14:08:03,464 | NDCG @5|10: 0.0799 	 0.0848
2025-08-27 14:08:03,464 | Early Stopping counter: 3 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 14:11:05,908 | Epoch 11/40 - client 0 -  Training Loss: 9.413

 33%|###3      | 1/3 [03:02<06:04, 182.45s/it]2025-08-27 14:11:26,287 | Epoch 11/40 - client 1 -  Training Loss: 7.093

 67%|######6   | 2/3 [03:22<01:27, 87.11s/it] 2025-08-27 14:13:11,949 | Epoch 11/40 - client 2 -  Training Loss: 8.966

100%|##########| 3/3 [05:08<00:00, 95.58s/it]
100%|##########| 3/3 [05:08<00:00, 102.83s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.39s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.08s/it]
100%|##########| 3/3 [00:17<00:00,  5.69s/it]
100%|##########| 3/3 [00:17<00:00,  5.96s/it]
2025-08-27 14:13:29,839 | Epoch11 Valid:
2025-08-27 14:13:29,840 | domain:Sports
2025-08-27 14:13:29,840 | model_moe:
2025-08-27 14:13:29,840 | MRR: 0.0857
2025-08-27 14:13:29,841 | HR @1|5|10: 0.0687 	 0.0931 	 0.1082 	
2025-08-27 14:13:29,841 | NDCG @5|10: 0.0815 	 0.0863
2025-08-27 14:13:29,841 | domain:Garden
2025-08-27 14:13:29,842 | model_moe:
2025-08-27 14:13:29,842 | MRR: 0.0898
2025-08-27 14:13:29,842 | HR @1|5|10: 0.0703 	 0.0992 	 0.1165 	
2025-08-27 14:13:29,844 | NDCG @5|10: 0.0858 	 0.0914
2025-08-27 14:13:29,844 | domain:Home
2025-08-27 14:13:29,844 | model_moe:
2025-08-27 14:13:29,845 | MRR: 0.0757
2025-08-27 14:13:29,845 | HR @1|5|10: 0.0596 	 0.0819 	 0.0944 	
2025-08-27 14:13:29,845 | NDCG @5|10: 0.0717 	 0.0758
2025-08-27 14:13:29,845 | 	avg_model_moe:
2025-08-27 14:13:29,846 | MRR: 0.0838
2025-08-27 14:13:29,846 | HR @1|5|10: 0.0662 	 0.0914 	 0.1063 	
2025-08-27 14:13:29,846 | NDCG @5|10: 0.0797 	 0.0845
2025-08-27 14:13:29,847 | Early Stopping counter: 4 out of 5
2025-08-27 14:13:29,847 | Learning rate decay counter: 1 out of 1
2025-08-27 14:13:29,847 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 14:13:50,604 | Epoch 12/40 - client 1 -  Training Loss: 6.717

 33%|###3      | 1/3 [00:20<00:41, 20.76s/it]2025-08-27 14:15:36,143 | Epoch 12/40 - client 2 -  Training Loss: 8.484

 67%|######6   | 2/3 [02:06<01:10, 70.63s/it]2025-08-27 14:18:37,794 | Epoch 12/40 - client 0 -  Training Loss: 8.908

100%|##########| 3/3 [05:07<00:00, 121.33s/it]
100%|##########| 3/3 [05:07<00:00, 102.65s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.67s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.23s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.08s/it]
2025-08-27 14:18:56,058 | Epoch12 Valid:
2025-08-27 14:18:56,059 | domain:Sports
2025-08-27 14:18:56,061 | model_moe:
2025-08-27 14:18:56,062 | MRR: 0.0862
2025-08-27 14:18:56,062 | HR @1|5|10: 0.0689 	 0.0937 	 0.1087 	
2025-08-27 14:18:56,062 | NDCG @5|10: 0.0819 	 0.0868
2025-08-27 14:18:56,063 | domain:Garden
2025-08-27 14:18:56,063 | model_moe:
2025-08-27 14:18:56,063 | MRR: 0.0892
2025-08-27 14:18:56,065 | HR @1|5|10: 0.0690 	 0.1012 	 0.1165 	
2025-08-27 14:18:56,065 | NDCG @5|10: 0.0861 	 0.0909
2025-08-27 14:18:56,065 | domain:Home
2025-08-27 14:18:56,065 | model_moe:
2025-08-27 14:18:56,066 | MRR: 0.0749
2025-08-27 14:18:56,066 | HR @1|5|10: 0.0585 	 0.0819 	 0.0949 	
2025-08-27 14:18:56,066 | NDCG @5|10: 0.0712 	 0.0754
2025-08-27 14:18:56,067 | 	avg_model_moe:
2025-08-27 14:18:56,067 | MRR: 0.0834
2025-08-27 14:18:56,067 | HR @1|5|10: 0.0654 	 0.0923 	 0.1067 	
2025-08-27 14:18:56,067 | NDCG @5|10: 0.0797 	 0.0844
2025-08-27 14:18:56,068 | Early Stopping counter: 5 out of 5
2025-08-27 14:18:56,068 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:13<00:27, 13.58s/it]
 67%|######6   | 2/3 [00:16<00:07,  7.44s/it]
100%|##########| 3/3 [00:26<00:00,  8.30s/it]
100%|##########| 3/3 [00:26<00:00,  8.68s/it]
2025-08-27 14:19:22,119 | Test:
2025-08-27 14:19:22,119 | domain:Sports
2025-08-27 14:19:22,119 | model_moe:
2025-08-27 14:19:22,120 | MRR: 0.0646
2025-08-27 14:19:22,120 | HR @1|5|10: 0.0514 	 0.0704 	 0.0807 	
2025-08-27 14:19:22,120 | NDCG @5|10: 0.0611 	 0.0645
2025-08-27 14:19:22,121 | domain:Garden
2025-08-27 14:19:22,121 | model_moe:
2025-08-27 14:19:22,121 | MRR: 0.0754
2025-08-27 14:19:22,122 | HR @1|5|10: 0.0617 	 0.0806 	 0.0938 	
2025-08-27 14:19:22,122 | NDCG @5|10: 0.0717 	 0.0759
2025-08-27 14:19:22,122 | domain:Home
2025-08-27 14:19:22,122 | model_moe:
2025-08-27 14:19:22,123 | MRR: 0.0571
2025-08-27 14:19:22,123 | HR @1|5|10: 0.0440 	 0.0629 	 0.0721 	
2025-08-27 14:19:22,123 | NDCG @5|10: 0.0539 	 0.0569
2025-08-27 14:19:22,124 | 	avg_model_moe:
2025-08-27 14:19:22,124 | MRR: 0.0657
2025-08-27 14:19:22,124 | HR @1|5|10: 0.0524 	 0.0713 	 0.0822 	
2025-08-27 14:19:22,124 | NDCG @5|10: 0.0623 	 0.0658
