origin
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-26 17:39:22,004 | Running with the following configs:
	domains : ['Food', 'Kitchen', 'Clothing', 'Beauty']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 60
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 10
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	anneal_cap : 1.0
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:40:11,393 | Epoch 1/60 - client 1 -  Training Loss: 48.806

 25%|##5       | 1/4 [00:49<02:28, 49.38s/it]2025-08-26 17:40:23,903 | Epoch 1/60 - client 0 -  Training Loss: 44.507

 50%|#####     | 2/4 [01:01<00:55, 27.69s/it]2025-08-26 17:40:40,588 | Epoch 1/60 - client 2 -  Training Loss: 50.627

 75%|#######5  | 3/4 [01:18<00:22, 22.67s/it]2025-08-26 17:40:53,014 | Epoch 1/60 - client 3 -  Training Loss: 50.216

100%|##########| 4/4 [01:31<00:00, 18.62s/it]
100%|##########| 4/4 [01:31<00:00, 22.75s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.04s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.44s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.16s/it]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
100%|##########| 4/4 [00:04<00:00,  1.10s/it]
2025-08-26 17:40:57,439 | Epoch1 Valid:
2025-08-26 17:40:57,439 | domain:Food
2025-08-26 17:40:57,440 | model_moe:
2025-08-26 17:40:57,440 | MRR: 0.2704
2025-08-26 17:40:57,440 | HR @1|5|10: 0.1729 	 0.3879 	 0.4751 	
2025-08-26 17:40:57,441 | NDCG @5|10: 0.2853 	 0.3137
2025-08-26 17:40:57,441 | domain:Kitchen
2025-08-26 17:40:57,441 | model_moe:
2025-08-26 17:40:57,441 | MRR: 0.0390
2025-08-26 17:40:57,442 | HR @1|5|10: 0.0147 	 0.0460 	 0.0750 	
2025-08-26 17:40:57,442 | NDCG @5|10: 0.0310 	 0.0404
2025-08-26 17:40:57,442 | domain:Clothing
2025-08-26 17:40:57,443 | model_moe:
2025-08-26 17:40:57,443 | MRR: 0.0106
2025-08-26 17:40:57,443 | HR @1|5|10: 0.0037 	 0.0086 	 0.0159 	
2025-08-26 17:40:57,444 | NDCG @5|10: 0.0059 	 0.0082
2025-08-26 17:40:57,444 | domain:Beauty
2025-08-26 17:40:57,444 | model_moe:
2025-08-26 17:40:57,445 | MRR: 0.1363
2025-08-26 17:40:57,445 | HR @1|5|10: 0.0789 	 0.1830 	 0.2656 	
2025-08-26 17:40:57,445 | NDCG @5|10: 0.1330 	 0.1593
2025-08-26 17:40:57,446 | 	avg_model_moe:
2025-08-26 17:40:57,446 | MRR: 0.1141
2025-08-26 17:40:57,446 | HR @1|5|10: 0.0676 	 0.1564 	 0.2079 	
2025-08-26 17:40:57,447 | NDCG @5|10: 0.1138 	 0.1304
2025-08-26 17:40:57,447 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:41:16,881 | Epoch 2/60 - client 2 -  Training Loss: 48.534

 25%|##5       | 1/4 [00:17<00:51, 17.08s/it]2025-08-26 17:41:29,694 | Epoch 2/60 - client 3 -  Training Loss: 47.877

 50%|#####     | 2/4 [00:29<00:29, 14.57s/it]2025-08-26 17:42:00,917 | Epoch 2/60 - client 1 -  Training Loss: 48.083

 75%|#######5  | 3/4 [01:01<00:22, 22.18s/it]2025-08-26 17:42:13,697 | Epoch 2/60 - client 0 -  Training Loss: 42.597

100%|##########| 4/4 [01:13<00:00, 18.47s/it]
100%|##########| 4/4 [01:13<00:00, 18.48s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.41s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.12s/it]
100%|##########| 4/4 [00:04<00:00,  1.04it/s]
100%|##########| 4/4 [00:04<00:00,  1.05s/it]
2025-08-26 17:42:17,912 | Epoch2 Valid:
2025-08-26 17:42:17,912 | domain:Food
2025-08-26 17:42:17,913 | model_moe:
2025-08-26 17:42:17,913 | MRR: 0.3065
2025-08-26 17:42:17,913 | HR @1|5|10: 0.2073 	 0.4231 	 0.5103 	
2025-08-26 17:42:17,914 | NDCG @5|10: 0.3219 	 0.3502
2025-08-26 17:42:17,914 | domain:Kitchen
2025-08-26 17:42:17,914 | model_moe:
2025-08-26 17:42:17,914 | MRR: 0.0610
2025-08-26 17:42:17,915 | HR @1|5|10: 0.0253 	 0.0810 	 0.1243 	
2025-08-26 17:42:17,915 | NDCG @5|10: 0.0533 	 0.0674
2025-08-26 17:42:17,915 | domain:Clothing
2025-08-26 17:42:17,915 | model_moe:
2025-08-26 17:42:17,916 | MRR: 0.0216
2025-08-26 17:42:17,916 | HR @1|5|10: 0.0110 	 0.0208 	 0.0379 	
2025-08-26 17:42:17,916 | NDCG @5|10: 0.0159 	 0.0212
2025-08-26 17:42:17,917 | domain:Beauty
2025-08-26 17:42:17,917 | model_moe:
2025-08-26 17:42:17,917 | MRR: 0.1803
2025-08-26 17:42:17,917 | HR @1|5|10: 0.1124 	 0.2548 	 0.3218 	
2025-08-26 17:42:17,918 | NDCG @5|10: 0.1857 	 0.2072
2025-08-26 17:42:17,918 | 	avg_model_moe:
2025-08-26 17:42:17,918 | MRR: 0.1424
2025-08-26 17:42:17,918 | HR @1|5|10: 0.0890 	 0.1949 	 0.2486 	
2025-08-26 17:42:17,919 | NDCG @5|10: 0.1442 	 0.1615
2025-08-26 17:42:17,919 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:42:36,830 | Epoch 3/60 - client 2 -  Training Loss: 46.749

 25%|##5       | 1/4 [00:16<00:50, 16.86s/it]2025-08-26 17:43:07,916 | Epoch 3/60 - client 1 -  Training Loss: 47.301

 50%|#####     | 2/4 [00:47<00:50, 25.23s/it]2025-08-26 17:43:20,810 | Epoch 3/60 - client 0 -  Training Loss: 41.291

 75%|#######5  | 3/4 [01:00<00:19, 19.60s/it]2025-08-26 17:43:33,252 | Epoch 3/60 - client 3 -  Training Loss: 46.172

100%|##########| 4/4 [01:13<00:00, 16.77s/it]
100%|##########| 4/4 [01:13<00:00, 18.32s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.02s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.41s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.11s/it]
100%|##########| 4/4 [00:04<00:00,  1.04it/s]
100%|##########| 4/4 [00:04<00:00,  1.05s/it]
2025-08-26 17:43:37,460 | Epoch3 Valid:
2025-08-26 17:43:37,460 | domain:Food
2025-08-26 17:43:37,460 | model_moe:
2025-08-26 17:43:37,461 | MRR: 0.3205
2025-08-26 17:43:37,461 | HR @1|5|10: 0.2188 	 0.4461 	 0.5233 	
2025-08-26 17:43:37,461 | NDCG @5|10: 0.3393 	 0.3649
2025-08-26 17:43:37,461 | domain:Kitchen
2025-08-26 17:43:37,462 | model_moe:
2025-08-26 17:43:37,462 | MRR: 0.0737
2025-08-26 17:43:37,462 | HR @1|5|10: 0.0350 	 0.0985 	 0.1446 	
2025-08-26 17:43:37,463 | NDCG @5|10: 0.0673 	 0.0821
2025-08-26 17:43:37,463 | domain:Clothing
2025-08-26 17:43:37,463 | model_moe:
2025-08-26 17:43:37,463 | MRR: 0.0236
2025-08-26 17:43:37,464 | HR @1|5|10: 0.0134 	 0.0244 	 0.0379 	
2025-08-26 17:43:37,464 | NDCG @5|10: 0.0185 	 0.0229
2025-08-26 17:43:37,464 | domain:Beauty
2025-08-26 17:43:37,464 | model_moe:
2025-08-26 17:43:37,465 | MRR: 0.2040
2025-08-26 17:43:37,465 | HR @1|5|10: 0.1340 	 0.2751 	 0.3469 	
2025-08-26 17:43:37,465 | NDCG @5|10: 0.2078 	 0.2316
2025-08-26 17:43:37,465 | 	avg_model_moe:
2025-08-26 17:43:37,466 | MRR: 0.1555
2025-08-26 17:43:37,466 | HR @1|5|10: 0.1003 	 0.2110 	 0.2632 	
2025-08-26 17:43:37,466 | NDCG @5|10: 0.1582 	 0.1753
2025-08-26 17:43:37,466 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:43:57,307 | Epoch 4/60 - client 2 -  Training Loss: 45.218

 25%|##5       | 1/4 [00:16<00:50, 16.96s/it]2025-08-26 17:44:09,904 | Epoch 4/60 - client 3 -  Training Loss: 44.881

 50%|#####     | 2/4 [00:29<00:28, 14.39s/it]2025-08-26 17:44:22,456 | Epoch 4/60 - client 0 -  Training Loss: 40.254

 75%|#######5  | 3/4 [00:42<00:13, 13.55s/it]2025-08-26 17:44:52,979 | Epoch 4/60 - client 1 -  Training Loss: 46.292

100%|##########| 4/4 [01:12<00:00, 20.25s/it]
100%|##########| 4/4 [01:12<00:00, 18.16s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 17:44:57,061 | Epoch4 Valid:
2025-08-26 17:44:57,062 | domain:Food
2025-08-26 17:44:57,062 | model_moe:
2025-08-26 17:44:57,062 | MRR: 0.3261
2025-08-26 17:44:57,062 | HR @1|5|10: 0.2226 	 0.4552 	 0.5210 	
2025-08-26 17:44:57,063 | NDCG @5|10: 0.3468 	 0.3686
2025-08-26 17:44:57,063 | domain:Kitchen
2025-08-26 17:44:57,063 | model_moe:
2025-08-26 17:44:57,064 | MRR: 0.0799
2025-08-26 17:44:57,064 | HR @1|5|10: 0.0419 	 0.1041 	 0.1515 	
2025-08-26 17:44:57,064 | NDCG @5|10: 0.0733 	 0.0886
2025-08-26 17:44:57,065 | domain:Clothing
2025-08-26 17:44:57,065 | model_moe:
2025-08-26 17:44:57,065 | MRR: 0.0231
2025-08-26 17:44:57,065 | HR @1|5|10: 0.0122 	 0.0257 	 0.0416 	
2025-08-26 17:44:57,066 | NDCG @5|10: 0.0188 	 0.0240
2025-08-26 17:44:57,066 | domain:Beauty
2025-08-26 17:44:57,066 | model_moe:
2025-08-26 17:44:57,066 | MRR: 0.2144
2025-08-26 17:44:57,067 | HR @1|5|10: 0.1435 	 0.2978 	 0.3600 	
2025-08-26 17:44:57,067 | NDCG @5|10: 0.2234 	 0.2441
2025-08-26 17:44:57,067 | 	avg_model_moe:
2025-08-26 17:44:57,068 | MRR: 0.1609
2025-08-26 17:44:57,068 | HR @1|5|10: 0.1051 	 0.2207 	 0.2685 	
2025-08-26 17:44:57,068 | NDCG @5|10: 0.1656 	 0.1813
2025-08-26 17:44:57,068 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:45:11,531 | Epoch 5/60 - client 0 -  Training Loss: 39.425

 25%|##5       | 1/4 [00:12<00:37, 12.45s/it]2025-08-26 17:45:28,015 | Epoch 5/60 - client 2 -  Training Loss: 43.928

 50%|#####     | 2/4 [00:28<00:29, 14.82s/it]2025-08-26 17:45:58,309 | Epoch 5/60 - client 1 -  Training Loss: 45.322

 75%|#######5  | 3/4 [00:59<00:21, 21.89s/it]2025-08-26 17:46:10,358 | Epoch 5/60 - client 3 -  Training Loss: 43.817

100%|##########| 4/4 [01:11<00:00, 18.00s/it]
100%|##########| 4/4 [01:11<00:00, 17.82s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 17:46:14,444 | Epoch5 Valid:
2025-08-26 17:46:14,444 | domain:Food
2025-08-26 17:46:14,445 | model_moe:
2025-08-26 17:46:14,445 | MRR: 0.3313
2025-08-26 17:46:14,445 | HR @1|5|10: 0.2272 	 0.4621 	 0.5249 	
2025-08-26 17:46:14,446 | NDCG @5|10: 0.3529 	 0.3737
2025-08-26 17:46:14,446 | domain:Kitchen
2025-08-26 17:46:14,446 | model_moe:
2025-08-26 17:46:14,446 | MRR: 0.0828
2025-08-26 17:46:14,447 | HR @1|5|10: 0.0428 	 0.1096 	 0.1556 	
2025-08-26 17:46:14,447 | NDCG @5|10: 0.0772 	 0.0918
2025-08-26 17:46:14,447 | domain:Clothing
2025-08-26 17:46:14,447 | model_moe:
2025-08-26 17:46:14,448 | MRR: 0.0217
2025-08-26 17:46:14,448 | HR @1|5|10: 0.0110 	 0.0232 	 0.0403 	
2025-08-26 17:46:14,448 | NDCG @5|10: 0.0170 	 0.0226
2025-08-26 17:46:14,448 | domain:Beauty
2025-08-26 17:46:14,449 | model_moe:
2025-08-26 17:46:14,449 | MRR: 0.2188
2025-08-26 17:46:14,449 | HR @1|5|10: 0.1459 	 0.3002 	 0.3648 	
2025-08-26 17:46:14,449 | NDCG @5|10: 0.2269 	 0.2482
2025-08-26 17:46:14,450 | 	avg_model_moe:
2025-08-26 17:46:14,450 | MRR: 0.1637
2025-08-26 17:46:14,450 | HR @1|5|10: 0.1067 	 0.2238 	 0.2714 	
2025-08-26 17:46:14,450 | NDCG @5|10: 0.1685 	 0.1841
2025-08-26 17:46:14,451 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:46:46,873 | Epoch 6/60 - client 1 -  Training Loss: 44.251

 25%|##5       | 1/4 [00:30<01:31, 30.56s/it]2025-08-26 17:47:03,664 | Epoch 6/60 - client 2 -  Training Loss: 42.661

 50%|#####     | 2/4 [00:47<00:44, 22.43s/it]2025-08-26 17:47:16,304 | Epoch 6/60 - client 0 -  Training Loss: 38.647

 75%|#######5  | 3/4 [00:59<00:17, 17.95s/it]2025-08-26 17:47:28,636 | Epoch 6/60 - client 3 -  Training Loss: 42.770

100%|##########| 4/4 [01:12<00:00, 15.72s/it]
100%|##########| 4/4 [01:12<00:00, 18.10s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.42s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.19s/it]
100%|##########| 4/4 [00:04<00:00,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.17s/it]
2025-08-26 17:47:34,064 | Epoch6 Valid:
2025-08-26 17:47:34,176 | domain:Food
2025-08-26 17:47:34,275 | model_moe:
2025-08-26 17:47:34,381 | MRR: 0.3320
2025-08-26 17:47:34,499 | HR @1|5|10: 0.2272 	 0.4644 	 0.5226 	
2025-08-26 17:47:34,597 | NDCG @5|10: 0.3546 	 0.3738
2025-08-26 17:47:34,693 | domain:Kitchen
2025-08-26 17:47:34,799 | model_moe:
2025-08-26 17:47:34,909 | MRR: 0.0874
2025-08-26 17:47:35,022 | HR @1|5|10: 0.0460 	 0.1137 	 0.1552 	
2025-08-26 17:47:35,114 | NDCG @5|10: 0.0815 	 0.0949
2025-08-26 17:47:35,208 | domain:Clothing
2025-08-26 17:47:35,320 | model_moe:
2025-08-26 17:47:35,425 | MRR: 0.0216
2025-08-26 17:47:35,527 | HR @1|5|10: 0.0110 	 0.0257 	 0.0342 	
2025-08-26 17:47:35,611 | NDCG @5|10: 0.0182 	 0.0209
2025-08-26 17:47:35,711 | domain:Beauty
2025-08-26 17:47:35,831 | model_moe:
2025-08-26 17:47:35,952 | MRR: 0.2239
2025-08-26 17:47:36,078 | HR @1|5|10: 0.1507 	 0.3158 	 0.3696 	
2025-08-26 17:47:36,180 | NDCG @5|10: 0.2358 	 0.2534
2025-08-26 17:47:36,298 | 	avg_model_moe:
2025-08-26 17:47:36,425 | MRR: 0.1662
2025-08-26 17:47:36,535 | HR @1|5|10: 0.1087 	 0.2299 	 0.2704 	
2025-08-26 17:47:36,633 | NDCG @5|10: 0.1725 	 0.1858
2025-08-26 17:47:36,748 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:47:59,725 | Epoch 7/60 - client 0 -  Training Loss: 37.948

 25%|##5       | 1/4 [00:12<00:37, 12.42s/it]2025-08-26 17:48:11,808 | Epoch 7/60 - client 3 -  Training Loss: 41.861

 50%|#####     | 2/4 [00:24<00:24, 12.22s/it]2025-08-26 17:48:28,244 | Epoch 7/60 - client 2 -  Training Loss: 41.483

 75%|#######5  | 3/4 [00:40<00:14, 14.15s/it]2025-08-26 17:48:58,632 | Epoch 7/60 - client 1 -  Training Loss: 43.231

100%|##########| 4/4 [01:11<00:00, 20.56s/it]
100%|##########| 4/4 [01:11<00:00, 17.83s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 17:49:02,744 | Epoch7 Valid:
2025-08-26 17:49:02,745 | domain:Food
2025-08-26 17:49:02,745 | model_moe:
2025-08-26 17:49:02,745 | MRR: 0.3319
2025-08-26 17:49:02,746 | HR @1|5|10: 0.2288 	 0.4652 	 0.5218 	
2025-08-26 17:49:02,746 | NDCG @5|10: 0.3553 	 0.3738
2025-08-26 17:49:02,746 | domain:Kitchen
2025-08-26 17:49:02,746 | model_moe:
2025-08-26 17:49:02,747 | MRR: 0.0891
2025-08-26 17:49:02,747 | HR @1|5|10: 0.0470 	 0.1220 	 0.1607 	
2025-08-26 17:49:02,747 | NDCG @5|10: 0.0854 	 0.0980
2025-08-26 17:49:02,747 | domain:Clothing
2025-08-26 17:49:02,748 | model_moe:
2025-08-26 17:49:02,748 | MRR: 0.0230
2025-08-26 17:49:02,748 | HR @1|5|10: 0.0098 	 0.0257 	 0.0391 	
2025-08-26 17:49:02,748 | NDCG @5|10: 0.0190 	 0.0233
2025-08-26 17:49:02,749 | domain:Beauty
2025-08-26 17:49:02,749 | model_moe:
2025-08-26 17:49:02,749 | MRR: 0.2284
2025-08-26 17:49:02,750 | HR @1|5|10: 0.1579 	 0.3230 	 0.3720 	
2025-08-26 17:49:02,750 | NDCG @5|10: 0.2414 	 0.2575
2025-08-26 17:49:02,750 | 	avg_model_moe:
2025-08-26 17:49:02,750 | MRR: 0.1681
2025-08-26 17:49:02,751 | HR @1|5|10: 0.1109 	 0.2340 	 0.2734 	
2025-08-26 17:49:02,751 | NDCG @5|10: 0.1753 	 0.1881
2025-08-26 17:49:02,751 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:49:17,225 | Epoch 8/60 - client 0 -  Training Loss: 37.334

 25%|##5       | 1/4 [00:12<00:37, 12.41s/it]2025-08-26 17:49:29,321 | Epoch 8/60 - client 3 -  Training Loss: 41.018

 50%|#####     | 2/4 [00:24<00:24, 12.22s/it]2025-08-26 17:49:59,649 | Epoch 8/60 - client 1 -  Training Loss: 42.284

 75%|#######5  | 3/4 [00:54<00:20, 20.49s/it]2025-08-26 17:50:16,119 | Epoch 8/60 - client 2 -  Training Loss: 40.413

100%|##########| 4/4 [01:11<00:00, 18.90s/it]
100%|##########| 4/4 [01:11<00:00, 17.82s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 17:50:20,207 | Epoch8 Valid:
2025-08-26 17:50:20,207 | domain:Food
2025-08-26 17:50:20,208 | model_moe:
2025-08-26 17:50:20,208 | MRR: 0.3349
2025-08-26 17:50:20,208 | HR @1|5|10: 0.2349 	 0.4682 	 0.5226 	
2025-08-26 17:50:20,209 | NDCG @5|10: 0.3586 	 0.3764
2025-08-26 17:50:20,209 | domain:Kitchen
2025-08-26 17:50:20,209 | model_moe:
2025-08-26 17:50:20,209 | MRR: 0.0911
2025-08-26 17:50:20,210 | HR @1|5|10: 0.0516 	 0.1211 	 0.1607 	
2025-08-26 17:50:20,210 | NDCG @5|10: 0.0868 	 0.0996
2025-08-26 17:50:20,210 | domain:Clothing
2025-08-26 17:50:20,211 | model_moe:
2025-08-26 17:50:20,211 | MRR: 0.0226
2025-08-26 17:50:20,211 | HR @1|5|10: 0.0098 	 0.0269 	 0.0379 	
2025-08-26 17:50:20,211 | NDCG @5|10: 0.0191 	 0.0225
2025-08-26 17:50:20,212 | domain:Beauty
2025-08-26 17:50:20,212 | model_moe:
2025-08-26 17:50:20,212 | MRR: 0.2285
2025-08-26 17:50:20,212 | HR @1|5|10: 0.1567 	 0.3086 	 0.3768 	
2025-08-26 17:50:20,213 | NDCG @5|10: 0.2364 	 0.2588
2025-08-26 17:50:20,213 | 	avg_model_moe:
2025-08-26 17:50:20,213 | MRR: 0.1693
2025-08-26 17:50:20,213 | HR @1|5|10: 0.1132 	 0.2312 	 0.2745 	
2025-08-26 17:50:20,214 | NDCG @5|10: 0.1752 	 0.1893
2025-08-26 17:50:20,214 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:50:52,980 | Epoch 9/60 - client 1 -  Training Loss: 41.441

 25%|##5       | 1/4 [00:30<01:30, 30.30s/it]2025-08-26 17:51:09,511 | Epoch 9/60 - client 2 -  Training Loss: 39.429

 50%|#####     | 2/4 [00:46<00:44, 22.20s/it]2025-08-26 17:51:21,898 | Epoch 9/60 - client 0 -  Training Loss: 36.755

 75%|#######5  | 3/4 [00:59<00:17, 17.72s/it]2025-08-26 17:51:33,960 | Epoch 9/60 - client 3 -  Training Loss: 40.248

100%|##########| 4/4 [01:11<00:00, 15.49s/it]
100%|##########| 4/4 [01:11<00:00, 17.82s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 17:51:38,039 | Epoch9 Valid:
2025-08-26 17:51:38,039 | domain:Food
2025-08-26 17:51:38,039 | model_moe:
2025-08-26 17:51:38,040 | MRR: 0.3359
2025-08-26 17:51:38,040 | HR @1|5|10: 0.2364 	 0.4660 	 0.5195 	
2025-08-26 17:51:38,040 | NDCG @5|10: 0.3587 	 0.3763
2025-08-26 17:51:38,041 | domain:Kitchen
2025-08-26 17:51:38,041 | model_moe:
2025-08-26 17:51:38,041 | MRR: 0.0902
2025-08-26 17:51:38,041 | HR @1|5|10: 0.0483 	 0.1229 	 0.1639 	
2025-08-26 17:51:38,042 | NDCG @5|10: 0.0866 	 0.0998
2025-08-26 17:51:38,042 | domain:Clothing
2025-08-26 17:51:38,042 | model_moe:
2025-08-26 17:51:38,042 | MRR: 0.0203
2025-08-26 17:51:38,043 | HR @1|5|10: 0.0073 	 0.0232 	 0.0367 	
2025-08-26 17:51:38,043 | NDCG @5|10: 0.0160 	 0.0205
2025-08-26 17:51:38,043 | domain:Beauty
2025-08-26 17:51:38,043 | model_moe:
2025-08-26 17:51:38,044 | MRR: 0.2307
2025-08-26 17:51:38,044 | HR @1|5|10: 0.1627 	 0.3098 	 0.3732 	
2025-08-26 17:51:38,044 | NDCG @5|10: 0.2386 	 0.2592
2025-08-26 17:51:38,045 | 	avg_model_moe:
2025-08-26 17:51:38,045 | MRR: 0.1693
2025-08-26 17:51:38,045 | HR @1|5|10: 0.1137 	 0.2305 	 0.2733 	
2025-08-26 17:51:38,045 | NDCG @5|10: 0.1750 	 0.1889
2025-08-26 17:51:38,046 | Early Stopping counter: 1 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:52:08,314 | Epoch 10/60 - client 1 -  Training Loss: 40.691

 25%|##5       | 1/4 [00:30<01:30, 30.27s/it]2025-08-26 17:52:20,681 | Epoch 10/60 - client 0 -  Training Loss: 36.224

 50%|#####     | 2/4 [00:42<00:39, 19.74s/it]2025-08-26 17:52:32,732 | Epoch 10/60 - client 3 -  Training Loss: 39.535

 75%|#######5  | 3/4 [00:54<00:16, 16.23s/it]2025-08-26 17:52:49,172 | Epoch 10/60 - client 2 -  Training Loss: 38.515

100%|##########| 4/4 [01:11<00:00, 16.31s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.11s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-26 17:52:53,321 | Epoch10 Valid:
2025-08-26 17:52:53,322 | domain:Food
2025-08-26 17:52:53,322 | model_moe:
2025-08-26 17:52:53,322 | MRR: 0.3340
2025-08-26 17:52:53,323 | HR @1|5|10: 0.2326 	 0.4690 	 0.5218 	
2025-08-26 17:52:53,323 | NDCG @5|10: 0.3581 	 0.3755
2025-08-26 17:52:53,323 | domain:Kitchen
2025-08-26 17:52:53,324 | model_moe:
2025-08-26 17:52:53,324 | MRR: 0.0933
2025-08-26 17:52:53,324 | HR @1|5|10: 0.0525 	 0.1238 	 0.1602 	
2025-08-26 17:52:53,324 | NDCG @5|10: 0.0895 	 0.1012
2025-08-26 17:52:53,325 | domain:Clothing
2025-08-26 17:52:53,325 | model_moe:
2025-08-26 17:52:53,325 | MRR: 0.0225
2025-08-26 17:52:53,325 | HR @1|5|10: 0.0122 	 0.0269 	 0.0379 	
2025-08-26 17:52:53,326 | NDCG @5|10: 0.0191 	 0.0226
2025-08-26 17:52:53,326 | domain:Beauty
2025-08-26 17:52:53,326 | model_moe:
2025-08-26 17:52:53,326 | MRR: 0.2316
2025-08-26 17:52:53,327 | HR @1|5|10: 0.1591 	 0.3158 	 0.3792 	
2025-08-26 17:52:53,327 | NDCG @5|10: 0.2410 	 0.2617
2025-08-26 17:52:53,327 | 	avg_model_moe:
2025-08-26 17:52:53,327 | MRR: 0.1703
2025-08-26 17:52:53,328 | HR @1|5|10: 0.1141 	 0.2339 	 0.2748 	
2025-08-26 17:52:53,328 | NDCG @5|10: 0.1769 	 0.1902
2025-08-26 17:52:53,328 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:53:07,656 | Epoch 11/60 - client 0 -  Training Loss: 35.732

 25%|##5       | 1/4 [00:12<00:37, 12.41s/it]2025-08-26 17:53:19,696 | Epoch 11/60 - client 3 -  Training Loss: 38.859

 50%|#####     | 2/4 [00:24<00:24, 12.19s/it]2025-08-26 17:53:36,121 | Epoch 11/60 - client 2 -  Training Loss: 37.640

 75%|#######5  | 3/4 [00:40<00:14, 14.13s/it]2025-08-26 17:54:06,377 | Epoch 11/60 - client 1 -  Training Loss: 40.005

100%|##########| 4/4 [01:11<00:00, 20.49s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 17:54:10,449 | Epoch11 Valid:
2025-08-26 17:54:10,450 | domain:Food
2025-08-26 17:54:10,450 | model_moe:
2025-08-26 17:54:10,450 | MRR: 0.3400
2025-08-26 17:54:10,450 | HR @1|5|10: 0.2402 	 0.4705 	 0.5287 	
2025-08-26 17:54:10,451 | NDCG @5|10: 0.3629 	 0.3820
2025-08-26 17:54:10,451 | domain:Kitchen
2025-08-26 17:54:10,451 | model_moe:
2025-08-26 17:54:10,452 | MRR: 0.0932
2025-08-26 17:54:10,452 | HR @1|5|10: 0.0516 	 0.1262 	 0.1662 	
2025-08-26 17:54:10,452 | NDCG @5|10: 0.0900 	 0.1029
2025-08-26 17:54:10,452 | domain:Clothing
2025-08-26 17:54:10,453 | model_moe:
2025-08-26 17:54:10,453 | MRR: 0.0233
2025-08-26 17:54:10,453 | HR @1|5|10: 0.0122 	 0.0244 	 0.0367 	
2025-08-26 17:54:10,453 | NDCG @5|10: 0.0186 	 0.0224
2025-08-26 17:54:10,454 | domain:Beauty
2025-08-26 17:54:10,454 | model_moe:
2025-08-26 17:54:10,454 | MRR: 0.2347
2025-08-26 17:54:10,454 | HR @1|5|10: 0.1663 	 0.3194 	 0.3720 	
2025-08-26 17:54:10,455 | NDCG @5|10: 0.2447 	 0.2621
2025-08-26 17:54:10,455 | 	avg_model_moe:
2025-08-26 17:54:10,455 | MRR: 0.1728
2025-08-26 17:54:10,455 | HR @1|5|10: 0.1176 	 0.2351 	 0.2759 	
2025-08-26 17:54:10,456 | NDCG @5|10: 0.1791 	 0.1923
2025-08-26 17:54:10,456 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:54:24,594 | Epoch 12/60 - client 3 -  Training Loss: 38.224

 25%|##5       | 1/4 [00:12<00:36, 12.06s/it]2025-08-26 17:54:36,968 | Epoch 12/60 - client 0 -  Training Loss: 35.258

 50%|#####     | 2/4 [00:24<00:24, 12.24s/it]2025-08-26 17:54:53,495 | Epoch 12/60 - client 2 -  Training Loss: 36.841

 75%|#######5  | 3/4 [00:40<00:14, 14.20s/it]2025-08-26 17:55:23,800 | Epoch 12/60 - client 1 -  Training Loss: 39.343

100%|##########| 4/4 [01:11<00:00, 20.56s/it]
100%|##########| 4/4 [01:11<00:00, 17.82s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 17:55:27,857 | Epoch12 Valid:
2025-08-26 17:55:27,858 | domain:Food
2025-08-26 17:55:27,858 | model_moe:
2025-08-26 17:55:27,858 | MRR: 0.3461
2025-08-26 17:55:27,859 | HR @1|5|10: 0.2510 	 0.4744 	 0.5287 	
2025-08-26 17:55:27,859 | NDCG @5|10: 0.3686 	 0.3865
2025-08-26 17:55:27,859 | domain:Kitchen
2025-08-26 17:55:27,860 | model_moe:
2025-08-26 17:55:27,860 | MRR: 0.0933
2025-08-26 17:55:27,860 | HR @1|5|10: 0.0506 	 0.1257 	 0.1667 	
2025-08-26 17:55:27,860 | NDCG @5|10: 0.0899 	 0.1030
2025-08-26 17:55:27,861 | domain:Clothing
2025-08-26 17:55:27,861 | model_moe:
2025-08-26 17:55:27,861 | MRR: 0.0203
2025-08-26 17:55:27,861 | HR @1|5|10: 0.0098 	 0.0244 	 0.0391 	
2025-08-26 17:55:27,862 | NDCG @5|10: 0.0165 	 0.0210
2025-08-26 17:55:27,862 | domain:Beauty
2025-08-26 17:55:27,862 | model_moe:
2025-08-26 17:55:27,863 | MRR: 0.2355
2025-08-26 17:55:27,863 | HR @1|5|10: 0.1639 	 0.3218 	 0.3804 	
2025-08-26 17:55:27,863 | NDCG @5|10: 0.2458 	 0.2649
2025-08-26 17:55:27,863 | 	avg_model_moe:
2025-08-26 17:55:27,864 | MRR: 0.1738
2025-08-26 17:55:27,864 | HR @1|5|10: 0.1188 	 0.2366 	 0.2787 	
2025-08-26 17:55:27,864 | NDCG @5|10: 0.1802 	 0.1939
2025-08-26 17:55:27,864 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:56:00,012 | Epoch 13/60 - client 1 -  Training Loss: 38.719

 25%|##5       | 1/4 [00:30<01:30, 30.25s/it]2025-08-26 17:56:12,048 | Epoch 13/60 - client 3 -  Training Loss: 37.623

 50%|#####     | 2/4 [00:42<00:39, 19.54s/it]2025-08-26 17:56:24,424 | Epoch 13/60 - client 0 -  Training Loss: 34.826

 75%|#######5  | 3/4 [00:54<00:16, 16.27s/it]2025-08-26 17:56:40,849 | Epoch 13/60 - client 2 -  Training Loss: 36.095

100%|##########| 4/4 [01:11<00:00, 16.33s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 17:56:44,936 | Epoch13 Valid:
2025-08-26 17:56:44,936 | domain:Food
2025-08-26 17:56:44,936 | model_moe:
2025-08-26 17:56:44,937 | MRR: 0.3536
2025-08-26 17:56:44,937 | HR @1|5|10: 0.2594 	 0.4751 	 0.5333 	
2025-08-26 17:56:44,937 | NDCG @5|10: 0.3740 	 0.3930
2025-08-26 17:56:44,938 | domain:Kitchen
2025-08-26 17:56:44,938 | model_moe:
2025-08-26 17:56:44,938 | MRR: 0.0968
2025-08-26 17:56:44,938 | HR @1|5|10: 0.0543 	 0.1275 	 0.1713 	
2025-08-26 17:56:44,939 | NDCG @5|10: 0.0926 	 0.1066
2025-08-26 17:56:44,939 | domain:Clothing
2025-08-26 17:56:44,939 | model_moe:
2025-08-26 17:56:44,939 | MRR: 0.0206
2025-08-26 17:56:44,940 | HR @1|5|10: 0.0098 	 0.0232 	 0.0342 	
2025-08-26 17:56:44,940 | NDCG @5|10: 0.0164 	 0.0200
2025-08-26 17:56:44,940 | domain:Beauty
2025-08-26 17:56:44,940 | model_moe:
2025-08-26 17:56:44,941 | MRR: 0.2405
2025-08-26 17:56:44,941 | HR @1|5|10: 0.1699 	 0.3254 	 0.3744 	
2025-08-26 17:56:44,941 | NDCG @5|10: 0.2512 	 0.2671
2025-08-26 17:56:44,942 | 	avg_model_moe:
2025-08-26 17:56:44,942 | MRR: 0.1779
2025-08-26 17:56:44,942 | HR @1|5|10: 0.1233 	 0.2378 	 0.2783 	
2025-08-26 17:56:44,942 | NDCG @5|10: 0.1835 	 0.1967
2025-08-26 17:56:44,943 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:56:58,968 | Epoch 14/60 - client 3 -  Training Loss: 37.097

 25%|##5       | 1/4 [00:12<00:36, 12.15s/it]2025-08-26 17:57:11,350 | Epoch 14/60 - client 0 -  Training Loss: 34.423

 50%|#####     | 2/4 [00:24<00:24, 12.29s/it]2025-08-26 17:57:27,777 | Epoch 14/60 - client 2 -  Training Loss: 35.422

 75%|#######5  | 3/4 [00:40<00:14, 14.18s/it]2025-08-26 17:57:58,044 | Epoch 14/60 - client 1 -  Training Loss: 38.172

100%|##########| 4/4 [01:11<00:00, 20.53s/it]
100%|##########| 4/4 [01:11<00:00, 17.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 17:58:02,113 | Epoch14 Valid:
2025-08-26 17:58:02,114 | domain:Food
2025-08-26 17:58:02,114 | model_moe:
2025-08-26 17:58:02,114 | MRR: 0.3547
2025-08-26 17:58:02,114 | HR @1|5|10: 0.2586 	 0.4759 	 0.5333 	
2025-08-26 17:58:02,115 | NDCG @5|10: 0.3749 	 0.3940
2025-08-26 17:58:02,115 | domain:Kitchen
2025-08-26 17:58:02,115 | model_moe:
2025-08-26 17:58:02,116 | MRR: 0.0976
2025-08-26 17:58:02,116 | HR @1|5|10: 0.0557 	 0.1289 	 0.1740 	
2025-08-26 17:58:02,116 | NDCG @5|10: 0.0934 	 0.1078
2025-08-26 17:58:02,116 | domain:Clothing
2025-08-26 17:58:02,117 | model_moe:
2025-08-26 17:58:02,117 | MRR: 0.0204
2025-08-26 17:58:02,117 | HR @1|5|10: 0.0086 	 0.0244 	 0.0403 	
2025-08-26 17:58:02,117 | NDCG @5|10: 0.0166 	 0.0215
2025-08-26 17:58:02,118 | domain:Beauty
2025-08-26 17:58:02,118 | model_moe:
2025-08-26 17:58:02,118 | MRR: 0.2421
2025-08-26 17:58:02,119 | HR @1|5|10: 0.1722 	 0.3337 	 0.3816 	
2025-08-26 17:58:02,119 | NDCG @5|10: 0.2550 	 0.2703
2025-08-26 17:58:02,119 | 	avg_model_moe:
2025-08-26 17:58:02,119 | MRR: 0.1787
2025-08-26 17:58:02,120 | HR @1|5|10: 0.1238 	 0.2407 	 0.2823 	
2025-08-26 17:58:02,120 | NDCG @5|10: 0.1850 	 0.1984
2025-08-26 17:58:02,120 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:58:17,192 | Epoch 15/60 - client 0 -  Training Loss: 34.056

 25%|##5       | 1/4 [00:12<00:37, 12.37s/it]2025-08-26 17:58:29,258 | Epoch 15/60 - client 3 -  Training Loss: 36.617

 50%|#####     | 2/4 [00:24<00:24, 12.19s/it]2025-08-26 17:58:45,782 | Epoch 15/60 - client 2 -  Training Loss: 34.806

 75%|#######5  | 3/4 [00:40<00:14, 14.17s/it]2025-08-26 17:59:16,053 | Epoch 15/60 - client 1 -  Training Loss: 37.661

100%|##########| 4/4 [01:11<00:00, 20.53s/it]
100%|##########| 4/4 [01:11<00:00, 17.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 17:59:20,102 | Epoch15 Valid:
2025-08-26 17:59:20,103 | domain:Food
2025-08-26 17:59:20,103 | model_moe:
2025-08-26 17:59:20,103 | MRR: 0.3615
2025-08-26 17:59:20,104 | HR @1|5|10: 0.2686 	 0.4828 	 0.5356 	
2025-08-26 17:59:20,104 | NDCG @5|10: 0.3821 	 0.3996
2025-08-26 17:59:20,104 | domain:Kitchen
2025-08-26 17:59:20,104 | model_moe:
2025-08-26 17:59:20,105 | MRR: 0.1000
2025-08-26 17:59:20,105 | HR @1|5|10: 0.0576 	 0.1285 	 0.1763 	
2025-08-26 17:59:20,105 | NDCG @5|10: 0.0946 	 0.1102
2025-08-26 17:59:20,105 | domain:Clothing
2025-08-26 17:59:20,106 | model_moe:
2025-08-26 17:59:20,106 | MRR: 0.0208
2025-08-26 17:59:20,106 | HR @1|5|10: 0.0098 	 0.0220 	 0.0330 	
2025-08-26 17:59:20,106 | NDCG @5|10: 0.0161 	 0.0197
2025-08-26 17:59:20,107 | domain:Beauty
2025-08-26 17:59:20,107 | model_moe:
2025-08-26 17:59:20,107 | MRR: 0.2481
2025-08-26 17:59:20,107 | HR @1|5|10: 0.1782 	 0.3361 	 0.3840 	
2025-08-26 17:59:20,108 | NDCG @5|10: 0.2600 	 0.2756
2025-08-26 17:59:20,108 | 	avg_model_moe:
2025-08-26 17:59:20,108 | MRR: 0.1826
2025-08-26 17:59:20,109 | HR @1|5|10: 0.1285 	 0.2423 	 0.2822 	
2025-08-26 17:59:20,109 | NDCG @5|10: 0.1882 	 0.2013
2025-08-26 17:59:20,109 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 17:59:38,840 | Epoch 16/60 - client 2 -  Training Loss: 34.247

 25%|##5       | 1/4 [00:16<00:49, 16.42s/it]2025-08-26 18:00:09,045 | Epoch 16/60 - client 1 -  Training Loss: 37.176

 50%|#####     | 2/4 [00:46<00:49, 24.53s/it]2025-08-26 18:00:21,103 | Epoch 16/60 - client 3 -  Training Loss: 36.179

 75%|#######5  | 3/4 [00:58<00:18, 18.83s/it]2025-08-26 18:00:33,532 | Epoch 16/60 - client 0 -  Training Loss: 33.708

100%|##########| 4/4 [01:11<00:00, 16.31s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.41s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-26 18:00:37,691 | Epoch16 Valid:
2025-08-26 18:00:37,691 | domain:Food
2025-08-26 18:00:37,691 | model_moe:
2025-08-26 18:00:37,692 | MRR: 0.3609
2025-08-26 18:00:37,692 | HR @1|5|10: 0.2663 	 0.4820 	 0.5363 	
2025-08-26 18:00:37,692 | NDCG @5|10: 0.3814 	 0.3993
2025-08-26 18:00:37,692 | domain:Kitchen
2025-08-26 18:00:37,693 | model_moe:
2025-08-26 18:00:37,693 | MRR: 0.0990
2025-08-26 18:00:37,693 | HR @1|5|10: 0.0552 	 0.1289 	 0.1759 	
2025-08-26 18:00:37,693 | NDCG @5|10: 0.0943 	 0.1095
2025-08-26 18:00:37,694 | domain:Clothing
2025-08-26 18:00:37,694 | model_moe:
2025-08-26 18:00:37,694 | MRR: 0.0199
2025-08-26 18:00:37,695 | HR @1|5|10: 0.0086 	 0.0232 	 0.0379 	
2025-08-26 18:00:37,695 | NDCG @5|10: 0.0157 	 0.0204
2025-08-26 18:00:37,695 | domain:Beauty
2025-08-26 18:00:37,695 | model_moe:
2025-08-26 18:00:37,696 | MRR: 0.2483
2025-08-26 18:00:37,696 | HR @1|5|10: 0.1806 	 0.3361 	 0.3828 	
2025-08-26 18:00:37,696 | NDCG @5|10: 0.2602 	 0.2753
2025-08-26 18:00:37,696 | 	avg_model_moe:
2025-08-26 18:00:37,697 | MRR: 0.1820
2025-08-26 18:00:37,697 | HR @1|5|10: 0.1277 	 0.2426 	 0.2832 	
2025-08-26 18:00:37,697 | NDCG @5|10: 0.1879 	 0.2011
2025-08-26 18:00:37,698 | Early Stopping counter: 1 out of 10
2025-08-26 18:00:37,698 | Learning rate decay counter: 1 out of 1
2025-08-26 18:00:37,698 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:00:54,168 | Epoch 17/60 - client 2 -  Training Loss: 33.736

 25%|##5       | 1/4 [00:16<00:49, 16.47s/it]2025-08-26 18:01:24,468 | Epoch 17/60 - client 1 -  Training Loss: 36.730

 50%|#####     | 2/4 [00:46<00:49, 24.61s/it]2025-08-26 18:01:36,864 | Epoch 17/60 - client 0 -  Training Loss: 33.387

 75%|#######5  | 3/4 [00:59<00:19, 19.03s/it]2025-08-26 18:01:48,929 | Epoch 17/60 - client 3 -  Training Loss: 35.769

100%|##########| 4/4 [01:11<00:00, 16.28s/it]
100%|##########| 4/4 [01:11<00:00, 17.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:01:53,019 | Epoch17 Valid:
2025-08-26 18:01:53,019 | domain:Food
2025-08-26 18:01:53,019 | model_moe:
2025-08-26 18:01:53,020 | MRR: 0.3611
2025-08-26 18:01:53,020 | HR @1|5|10: 0.2655 	 0.4843 	 0.5379 	
2025-08-26 18:01:53,020 | NDCG @5|10: 0.3825 	 0.3999
2025-08-26 18:01:53,020 | domain:Kitchen
2025-08-26 18:01:53,021 | model_moe:
2025-08-26 18:01:53,021 | MRR: 0.0991
2025-08-26 18:01:53,021 | HR @1|5|10: 0.0543 	 0.1312 	 0.1837 	
2025-08-26 18:01:53,021 | NDCG @5|10: 0.0948 	 0.1116
2025-08-26 18:01:53,022 | domain:Clothing
2025-08-26 18:01:53,022 | model_moe:
2025-08-26 18:01:53,022 | MRR: 0.0199
2025-08-26 18:01:53,022 | HR @1|5|10: 0.0086 	 0.0244 	 0.0367 	
2025-08-26 18:01:53,023 | NDCG @5|10: 0.0161 	 0.0201
2025-08-26 18:01:53,023 | domain:Beauty
2025-08-26 18:01:53,023 | model_moe:
2025-08-26 18:01:53,023 | MRR: 0.2494
2025-08-26 18:01:53,024 | HR @1|5|10: 0.1806 	 0.3361 	 0.3864 	
2025-08-26 18:01:53,024 | NDCG @5|10: 0.2611 	 0.2773
2025-08-26 18:01:53,024 | 	avg_model_moe:
2025-08-26 18:01:53,025 | MRR: 0.1824
2025-08-26 18:01:53,025 | HR @1|5|10: 0.1273 	 0.2440 	 0.2862 	
2025-08-26 18:01:53,025 | NDCG @5|10: 0.1886 	 0.2022
2025-08-26 18:01:53,025 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:02:05,082 | Epoch 18/60 - client 3 -  Training Loss: 35.393

 25%|##5       | 1/4 [00:12<00:36, 12.06s/it]2025-08-26 18:02:17,462 | Epoch 18/60 - client 0 -  Training Loss: 33.097

 50%|#####     | 2/4 [00:24<00:24, 12.25s/it]2025-08-26 18:02:33,962 | Epoch 18/60 - client 2 -  Training Loss: 33.277

 75%|#######5  | 3/4 [00:40<00:14, 14.19s/it]2025-08-26 18:03:04,162 | Epoch 18/60 - client 1 -  Training Loss: 36.322

100%|##########| 4/4 [01:11<00:00, 20.51s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:03:08,242 | Epoch18 Valid:
2025-08-26 18:03:08,243 | domain:Food
2025-08-26 18:03:08,243 | model_moe:
2025-08-26 18:03:08,243 | MRR: 0.3631
2025-08-26 18:03:08,244 | HR @1|5|10: 0.2686 	 0.4836 	 0.5402 	
2025-08-26 18:03:08,244 | NDCG @5|10: 0.3833 	 0.4019
2025-08-26 18:03:08,244 | domain:Kitchen
2025-08-26 18:03:08,245 | model_moe:
2025-08-26 18:03:08,245 | MRR: 0.0998
2025-08-26 18:03:08,245 | HR @1|5|10: 0.0548 	 0.1340 	 0.1809 	
2025-08-26 18:03:08,246 | NDCG @5|10: 0.0960 	 0.1113
2025-08-26 18:03:08,246 | domain:Clothing
2025-08-26 18:03:08,246 | model_moe:
2025-08-26 18:03:08,246 | MRR: 0.0199
2025-08-26 18:03:08,247 | HR @1|5|10: 0.0073 	 0.0244 	 0.0391 	
2025-08-26 18:03:08,247 | NDCG @5|10: 0.0161 	 0.0207
2025-08-26 18:03:08,247 | domain:Beauty
2025-08-26 18:03:08,248 | model_moe:
2025-08-26 18:03:08,248 | MRR: 0.2505
2025-08-26 18:03:08,248 | HR @1|5|10: 0.1842 	 0.3337 	 0.3852 	
2025-08-26 18:03:08,248 | NDCG @5|10: 0.2609 	 0.2776
2025-08-26 18:03:08,249 | 	avg_model_moe:
2025-08-26 18:03:08,249 | MRR: 0.1833
2025-08-26 18:03:08,249 | HR @1|5|10: 0.1287 	 0.2439 	 0.2863 	
2025-08-26 18:03:08,250 | NDCG @5|10: 0.1891 	 0.2029
2025-08-26 18:03:08,250 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:03:22,849 | Epoch 19/60 - client 3 -  Training Loss: 35.030

 25%|##5       | 1/4 [00:12<00:36, 12.03s/it]2025-08-26 18:03:39,259 | Epoch 19/60 - client 2 -  Training Loss: 32.829

 50%|#####     | 2/4 [00:28<00:29, 14.61s/it]2025-08-26 18:04:09,454 | Epoch 19/60 - client 1 -  Training Loss: 35.918

 75%|#######5  | 3/4 [00:58<00:21, 21.72s/it]2025-08-26 18:04:21,869 | Epoch 19/60 - client 0 -  Training Loss: 32.817

100%|##########| 4/4 [01:11<00:00, 18.05s/it]
100%|##########| 4/4 [01:11<00:00, 17.76s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:04:26,178 | Epoch19 Valid:
2025-08-26 18:04:26,179 | domain:Food
2025-08-26 18:04:26,179 | model_moe:
2025-08-26 18:04:26,179 | MRR: 0.3638
2025-08-26 18:04:26,179 | HR @1|5|10: 0.2693 	 0.4836 	 0.5402 	
2025-08-26 18:04:26,180 | NDCG @5|10: 0.3838 	 0.4024
2025-08-26 18:04:26,180 | domain:Kitchen
2025-08-26 18:04:26,180 | model_moe:
2025-08-26 18:04:26,181 | MRR: 0.1006
2025-08-26 18:04:26,181 | HR @1|5|10: 0.0566 	 0.1308 	 0.1823 	
2025-08-26 18:04:26,181 | NDCG @5|10: 0.0958 	 0.1124
2025-08-26 18:04:26,181 | domain:Clothing
2025-08-26 18:04:26,182 | model_moe:
2025-08-26 18:04:26,182 | MRR: 0.0196
2025-08-26 18:04:26,182 | HR @1|5|10: 0.0073 	 0.0269 	 0.0416 	
2025-08-26 18:04:26,182 | NDCG @5|10: 0.0166 	 0.0212
2025-08-26 18:04:26,183 | domain:Beauty
2025-08-26 18:04:26,183 | model_moe:
2025-08-26 18:04:26,183 | MRR: 0.2485
2025-08-26 18:04:26,184 | HR @1|5|10: 0.1770 	 0.3373 	 0.3816 	
2025-08-26 18:04:26,184 | NDCG @5|10: 0.2608 	 0.2752
2025-08-26 18:04:26,184 | 	avg_model_moe:
2025-08-26 18:04:26,185 | MRR: 0.1831
2025-08-26 18:04:26,185 | HR @1|5|10: 0.1276 	 0.2446 	 0.2864 	
2025-08-26 18:04:26,185 | NDCG @5|10: 0.1893 	 0.2028
2025-08-26 18:04:26,185 | Early Stopping counter: 1 out of 10
2025-08-26 18:04:26,186 | Learning rate decay counter: 1 out of 1
2025-08-26 18:04:26,186 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:04:56,389 | Epoch 20/60 - client 1 -  Training Loss: 35.532

 25%|##5       | 1/4 [00:30<01:30, 30.20s/it]2025-08-26 18:05:12,785 | Epoch 20/60 - client 2 -  Training Loss: 32.413

 50%|#####     | 2/4 [00:46<00:44, 22.08s/it]2025-08-26 18:05:24,802 | Epoch 20/60 - client 3 -  Training Loss: 34.684

 75%|#######5  | 3/4 [00:58<00:17, 17.49s/it]2025-08-26 18:05:37,130 | Epoch 20/60 - client 0 -  Training Loss: 32.555

100%|##########| 4/4 [01:10<00:00, 15.45s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:05:41,178 | Epoch20 Valid:
2025-08-26 18:05:41,179 | domain:Food
2025-08-26 18:05:41,179 | model_moe:
2025-08-26 18:05:41,179 | MRR: 0.3659
2025-08-26 18:05:41,180 | HR @1|5|10: 0.2716 	 0.4843 	 0.5432 	
2025-08-26 18:05:41,180 | NDCG @5|10: 0.3857 	 0.4048
2025-08-26 18:05:41,180 | domain:Kitchen
2025-08-26 18:05:41,180 | model_moe:
2025-08-26 18:05:41,181 | MRR: 0.1008
2025-08-26 18:05:41,181 | HR @1|5|10: 0.0552 	 0.1358 	 0.1888 	
2025-08-26 18:05:41,181 | NDCG @5|10: 0.0973 	 0.1144
2025-08-26 18:05:41,181 | domain:Clothing
2025-08-26 18:05:41,182 | model_moe:
2025-08-26 18:05:41,182 | MRR: 0.0192
2025-08-26 18:05:41,182 | HR @1|5|10: 0.0073 	 0.0232 	 0.0391 	
2025-08-26 18:05:41,182 | NDCG @5|10: 0.0151 	 0.0202
2025-08-26 18:05:41,183 | domain:Beauty
2025-08-26 18:05:41,183 | model_moe:
2025-08-26 18:05:41,183 | MRR: 0.2497
2025-08-26 18:05:41,184 | HR @1|5|10: 0.1782 	 0.3373 	 0.3816 	
2025-08-26 18:05:41,184 | NDCG @5|10: 0.2616 	 0.2763
2025-08-26 18:05:41,184 | 	avg_model_moe:
2025-08-26 18:05:41,184 | MRR: 0.1839
2025-08-26 18:05:41,185 | HR @1|5|10: 0.1281 	 0.2452 	 0.2882 	
2025-08-26 18:05:41,185 | NDCG @5|10: 0.1899 	 0.2039
2025-08-26 18:05:41,185 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:05:55,489 | Epoch 21/60 - client 3 -  Training Loss: 34.366

 25%|##5       | 1/4 [00:12<00:36, 12.19s/it]2025-08-26 18:06:12,022 | Epoch 21/60 - client 2 -  Training Loss: 32.033

 50%|#####     | 2/4 [00:28<00:29, 14.75s/it]2025-08-26 18:06:42,600 | Epoch 21/60 - client 1 -  Training Loss: 35.175

 75%|#######5  | 3/4 [00:59<00:21, 21.98s/it]2025-08-26 18:06:55,137 | Epoch 21/60 - client 0 -  Training Loss: 32.306

100%|##########| 4/4 [01:11<00:00, 18.25s/it]
100%|##########| 4/4 [01:11<00:00, 17.96s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:06:59,226 | Epoch21 Valid:
2025-08-26 18:06:59,227 | domain:Food
2025-08-26 18:06:59,227 | model_moe:
2025-08-26 18:06:59,227 | MRR: 0.3668
2025-08-26 18:06:59,228 | HR @1|5|10: 0.2731 	 0.4843 	 0.5409 	
2025-08-26 18:06:59,228 | NDCG @5|10: 0.3863 	 0.4049
2025-08-26 18:06:59,228 | domain:Kitchen
2025-08-26 18:06:59,228 | model_moe:
2025-08-26 18:06:59,229 | MRR: 0.1011
2025-08-26 18:06:59,229 | HR @1|5|10: 0.0548 	 0.1349 	 0.1901 	
2025-08-26 18:06:59,229 | NDCG @5|10: 0.0970 	 0.1149
2025-08-26 18:06:59,229 | domain:Clothing
2025-08-26 18:06:59,230 | model_moe:
2025-08-26 18:06:59,230 | MRR: 0.0197
2025-08-26 18:06:59,230 | HR @1|5|10: 0.0086 	 0.0220 	 0.0367 	
2025-08-26 18:06:59,230 | NDCG @5|10: 0.0152 	 0.0198
2025-08-26 18:06:59,231 | domain:Beauty
2025-08-26 18:06:59,231 | model_moe:
2025-08-26 18:06:59,231 | MRR: 0.2500
2025-08-26 18:06:59,231 | HR @1|5|10: 0.1806 	 0.3361 	 0.3780 	
2025-08-26 18:06:59,232 | NDCG @5|10: 0.2614 	 0.2755
2025-08-26 18:06:59,232 | 	avg_model_moe:
2025-08-26 18:06:59,232 | MRR: 0.1844
2025-08-26 18:06:59,232 | HR @1|5|10: 0.1293 	 0.2443 	 0.2864 	
2025-08-26 18:06:59,233 | NDCG @5|10: 0.1900 	 0.2038
2025-08-26 18:06:59,233 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:07:13,621 | Epoch 22/60 - client 0 -  Training Loss: 32.073

 25%|##5       | 1/4 [00:12<00:37, 12.49s/it]2025-08-26 18:07:30,139 | Epoch 22/60 - client 2 -  Training Loss: 31.673

 50%|#####     | 2/4 [00:29<00:29, 14.86s/it]2025-08-26 18:07:42,281 | Epoch 22/60 - client 3 -  Training Loss: 34.063

 75%|#######5  | 3/4 [00:41<00:13, 13.62s/it]2025-08-26 18:08:12,842 | Epoch 22/60 - client 1 -  Training Loss: 34.829

100%|##########| 4/4 [01:11<00:00, 20.31s/it]
100%|##########| 4/4 [01:11<00:00, 17.93s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:08:16,945 | Epoch22 Valid:
2025-08-26 18:08:16,946 | domain:Food
2025-08-26 18:08:16,946 | model_moe:
2025-08-26 18:08:16,946 | MRR: 0.3652
2025-08-26 18:08:16,947 | HR @1|5|10: 0.2708 	 0.4858 	 0.5448 	
2025-08-26 18:08:16,947 | NDCG @5|10: 0.3854 	 0.4046
2025-08-26 18:08:16,947 | domain:Kitchen
2025-08-26 18:08:16,947 | model_moe:
2025-08-26 18:08:16,948 | MRR: 0.1039
2025-08-26 18:08:16,948 | HR @1|5|10: 0.0580 	 0.1386 	 0.1924 	
2025-08-26 18:08:16,948 | NDCG @5|10: 0.1001 	 0.1174
2025-08-26 18:08:16,948 | domain:Clothing
2025-08-26 18:08:16,949 | model_moe:
2025-08-26 18:08:16,949 | MRR: 0.0192
2025-08-26 18:08:16,949 | HR @1|5|10: 0.0073 	 0.0220 	 0.0355 	
2025-08-26 18:08:16,950 | NDCG @5|10: 0.0147 	 0.0190
2025-08-26 18:08:16,950 | domain:Beauty
2025-08-26 18:08:16,950 | model_moe:
2025-08-26 18:08:16,950 | MRR: 0.2485
2025-08-26 18:08:16,951 | HR @1|5|10: 0.1794 	 0.3421 	 0.3828 	
2025-08-26 18:08:16,951 | NDCG @5|10: 0.2624 	 0.2756
2025-08-26 18:08:16,951 | 	avg_model_moe:
2025-08-26 18:08:16,951 | MRR: 0.1842
2025-08-26 18:08:16,952 | HR @1|5|10: 0.1289 	 0.2471 	 0.2889 	
2025-08-26 18:08:16,952 | NDCG @5|10: 0.1907 	 0.2042
2025-08-26 18:08:16,952 | Early Stopping counter: 1 out of 10
2025-08-26 18:08:16,952 | Learning rate decay counter: 1 out of 1
2025-08-26 18:08:16,953 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:08:29,101 | Epoch 23/60 - client 3 -  Training Loss: 33.774

 25%|##5       | 1/4 [00:12<00:36, 12.15s/it]2025-08-26 18:08:41,580 | Epoch 23/60 - client 0 -  Training Loss: 31.842

 50%|#####     | 2/4 [00:24<00:24, 12.34s/it]2025-08-26 18:09:12,013 | Epoch 23/60 - client 1 -  Training Loss: 34.500

 75%|#######5  | 3/4 [00:55<00:20, 20.60s/it]2025-08-26 18:09:28,534 | Epoch 23/60 - client 2 -  Training Loss: 31.331

100%|##########| 4/4 [01:11<00:00, 18.99s/it]
100%|##########| 4/4 [01:11<00:00, 17.90s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:09:32,616 | Epoch23 Valid:
2025-08-26 18:09:32,616 | domain:Food
2025-08-26 18:09:32,616 | model_moe:
2025-08-26 18:09:32,617 | MRR: 0.3661
2025-08-26 18:09:32,617 | HR @1|5|10: 0.2716 	 0.4836 	 0.5448 	
2025-08-26 18:09:32,617 | NDCG @5|10: 0.3853 	 0.4053
2025-08-26 18:09:32,617 | domain:Kitchen
2025-08-26 18:09:32,618 | model_moe:
2025-08-26 18:09:32,618 | MRR: 0.1012
2025-08-26 18:09:32,618 | HR @1|5|10: 0.0539 	 0.1358 	 0.1943 	
2025-08-26 18:09:32,618 | NDCG @5|10: 0.0973 	 0.1160
2025-08-26 18:09:32,619 | domain:Clothing
2025-08-26 18:09:32,619 | model_moe:
2025-08-26 18:09:32,619 | MRR: 0.0211
2025-08-26 18:09:32,620 | HR @1|5|10: 0.0098 	 0.0244 	 0.0379 	
2025-08-26 18:09:32,620 | NDCG @5|10: 0.0171 	 0.0213
2025-08-26 18:09:32,620 | domain:Beauty
2025-08-26 18:09:32,620 | model_moe:
2025-08-26 18:09:32,621 | MRR: 0.2486
2025-08-26 18:09:32,621 | HR @1|5|10: 0.1794 	 0.3337 	 0.3816 	
2025-08-26 18:09:32,621 | NDCG @5|10: 0.2597 	 0.2754
2025-08-26 18:09:32,621 | 	avg_model_moe:
2025-08-26 18:09:32,622 | MRR: 0.1842
2025-08-26 18:09:32,622 | HR @1|5|10: 0.1287 	 0.2444 	 0.2896 	
2025-08-26 18:09:32,622 | NDCG @5|10: 0.1899 	 0.2045
2025-08-26 18:09:32,622 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:09:44,753 | Epoch 24/60 - client 3 -  Training Loss: 33.496

 25%|##5       | 1/4 [00:12<00:36, 12.13s/it]2025-08-26 18:10:01,349 | Epoch 24/60 - client 2 -  Training Loss: 30.998

 50%|#####     | 2/4 [00:28<00:29, 14.76s/it]2025-08-26 18:10:31,724 | Epoch 24/60 - client 1 -  Training Loss: 34.187

 75%|#######5  | 3/4 [00:59<00:21, 21.89s/it]2025-08-26 18:10:44,168 | Epoch 24/60 - client 0 -  Training Loss: 31.626

100%|##########| 4/4 [01:11<00:00, 18.16s/it]
100%|##########| 4/4 [01:11<00:00, 17.89s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:10:48,252 | Epoch24 Valid:
2025-08-26 18:10:48,252 | domain:Food
2025-08-26 18:10:48,253 | model_moe:
2025-08-26 18:10:48,253 | MRR: 0.3667
2025-08-26 18:10:48,253 | HR @1|5|10: 0.2724 	 0.4858 	 0.5425 	
2025-08-26 18:10:48,253 | NDCG @5|10: 0.3868 	 0.4052
2025-08-26 18:10:48,458 | domain:Kitchen
2025-08-26 18:10:48,458 | model_moe:
2025-08-26 18:10:48,458 | MRR: 0.1008
2025-08-26 18:10:48,459 | HR @1|5|10: 0.0529 	 0.1381 	 0.1952 	
2025-08-26 18:10:48,459 | NDCG @5|10: 0.0976 	 0.1160
2025-08-26 18:10:48,459 | domain:Clothing
2025-08-26 18:10:48,460 | model_moe:
2025-08-26 18:10:48,460 | MRR: 0.0207
2025-08-26 18:10:48,460 | HR @1|5|10: 0.0098 	 0.0220 	 0.0403 	
2025-08-26 18:10:48,460 | NDCG @5|10: 0.0157 	 0.0215
2025-08-26 18:10:48,461 | domain:Beauty
2025-08-26 18:10:48,461 | model_moe:
2025-08-26 18:10:48,461 | MRR: 0.2493
2025-08-26 18:10:48,461 | HR @1|5|10: 0.1794 	 0.3301 	 0.3816 	
2025-08-26 18:10:48,462 | NDCG @5|10: 0.2590 	 0.2760
2025-08-26 18:10:48,462 | 	avg_model_moe:
2025-08-26 18:10:48,462 | MRR: 0.1844
2025-08-26 18:10:48,463 | HR @1|5|10: 0.1286 	 0.2440 	 0.2899 	
2025-08-26 18:10:48,463 | NDCG @5|10: 0.1898 	 0.2047
2025-08-26 18:10:48,463 | Early Stopping counter: 3 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:11:18,847 | Epoch 25/60 - client 1 -  Training Loss: 33.901

 25%|##5       | 1/4 [00:30<01:31, 30.39s/it]2025-08-26 18:11:35,378 | Epoch 25/60 - client 2 -  Training Loss: 30.656

 50%|#####     | 2/4 [00:46<00:44, 22.24s/it]2025-08-26 18:11:47,611 | Epoch 25/60 - client 3 -  Training Loss: 33.237

 75%|#######5  | 3/4 [00:59<00:17, 17.67s/it]2025-08-26 18:12:00,071 | Epoch 25/60 - client 0 -  Training Loss: 31.421

100%|##########| 4/4 [01:11<00:00, 15.61s/it]
100%|##########| 4/4 [01:11<00:00, 17.90s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:12:04,157 | Epoch25 Valid:
2025-08-26 18:12:04,157 | domain:Food
2025-08-26 18:12:04,158 | model_moe:
2025-08-26 18:12:04,158 | MRR: 0.3656
2025-08-26 18:12:04,158 | HR @1|5|10: 0.2708 	 0.4866 	 0.5409 	
2025-08-26 18:12:04,158 | NDCG @5|10: 0.3863 	 0.4040
2025-08-26 18:12:04,159 | domain:Kitchen
2025-08-26 18:12:04,159 | model_moe:
2025-08-26 18:12:04,159 | MRR: 0.1015
2025-08-26 18:12:04,160 | HR @1|5|10: 0.0529 	 0.1409 	 0.1948 	
2025-08-26 18:12:04,160 | NDCG @5|10: 0.0989 	 0.1163
2025-08-26 18:12:04,160 | domain:Clothing
2025-08-26 18:12:04,160 | model_moe:
2025-08-26 18:12:04,161 | MRR: 0.0227
2025-08-26 18:12:04,161 | HR @1|5|10: 0.0110 	 0.0269 	 0.0391 	
2025-08-26 18:12:04,161 | NDCG @5|10: 0.0188 	 0.0226
2025-08-26 18:12:04,161 | domain:Beauty
2025-08-26 18:12:04,162 | model_moe:
2025-08-26 18:12:04,162 | MRR: 0.2485
2025-08-26 18:12:04,162 | HR @1|5|10: 0.1806 	 0.3337 	 0.3828 	
2025-08-26 18:12:04,162 | NDCG @5|10: 0.2596 	 0.2757
2025-08-26 18:12:04,163 | 	avg_model_moe:
2025-08-26 18:12:04,163 | MRR: 0.1846
2025-08-26 18:12:04,163 | HR @1|5|10: 0.1289 	 0.2470 	 0.2894 	
2025-08-26 18:12:04,164 | NDCG @5|10: 0.1909 	 0.2047
2025-08-26 18:12:04,164 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:12:38,138 | Epoch 26/60 - client 1 -  Training Loss: 33.607

 25%|##5       | 1/4 [00:30<01:31, 30.41s/it]2025-08-26 18:12:50,272 | Epoch 26/60 - client 3 -  Training Loss: 32.986

 50%|#####     | 2/4 [00:42<00:39, 19.66s/it]2025-08-26 18:13:02,747 | Epoch 26/60 - client 0 -  Training Loss: 31.232

 75%|#######5  | 3/4 [00:55<00:16, 16.38s/it]2025-08-26 18:13:19,266 | Epoch 26/60 - client 2 -  Training Loss: 30.373

100%|##########| 4/4 [01:11<00:00, 16.43s/it]
100%|##########| 4/4 [01:11<00:00, 17.88s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.00it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-26 18:13:23,401 | Epoch26 Valid:
2025-08-26 18:13:23,402 | domain:Food
2025-08-26 18:13:23,402 | model_moe:
2025-08-26 18:13:23,402 | MRR: 0.3661
2025-08-26 18:13:23,402 | HR @1|5|10: 0.2724 	 0.4836 	 0.5440 	
2025-08-26 18:13:23,403 | NDCG @5|10: 0.3855 	 0.4051
2025-08-26 18:13:23,403 | domain:Kitchen
2025-08-26 18:13:23,403 | model_moe:
2025-08-26 18:13:23,403 | MRR: 0.1034
2025-08-26 18:13:23,404 | HR @1|5|10: 0.0548 	 0.1432 	 0.2021 	
2025-08-26 18:13:23,404 | NDCG @5|10: 0.1010 	 0.1198
2025-08-26 18:13:23,404 | domain:Clothing
2025-08-26 18:13:23,404 | model_moe:
2025-08-26 18:13:23,405 | MRR: 0.0243
2025-08-26 18:13:23,405 | HR @1|5|10: 0.0134 	 0.0281 	 0.0367 	
2025-08-26 18:13:23,405 | NDCG @5|10: 0.0204 	 0.0232
2025-08-26 18:13:23,406 | domain:Beauty
2025-08-26 18:13:23,406 | model_moe:
2025-08-26 18:13:23,406 | MRR: 0.2501
2025-08-26 18:13:23,406 | HR @1|5|10: 0.1830 	 0.3385 	 0.3780 	
2025-08-26 18:13:23,407 | NDCG @5|10: 0.2626 	 0.2756
2025-08-26 18:13:23,407 | 	avg_model_moe:
2025-08-26 18:13:23,407 | MRR: 0.1860
2025-08-26 18:13:23,407 | HR @1|5|10: 0.1309 	 0.2483 	 0.2902 	
2025-08-26 18:13:23,408 | NDCG @5|10: 0.1924 	 0.2059
2025-08-26 18:13:23,408 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:13:42,087 | Epoch 27/60 - client 2 -  Training Loss: 30.090

 25%|##5       | 1/4 [00:16<00:49, 16.58s/it]2025-08-26 18:14:12,458 | Epoch 27/60 - client 1 -  Training Loss: 33.322

 50%|#####     | 2/4 [00:46<00:49, 24.69s/it]2025-08-26 18:14:24,936 | Epoch 27/60 - client 0 -  Training Loss: 31.033

 75%|#######5  | 3/4 [00:59<00:19, 19.12s/it]2025-08-26 18:14:37,087 | Epoch 27/60 - client 3 -  Training Loss: 32.750

100%|##########| 4/4 [01:11<00:00, 16.37s/it]
100%|##########| 4/4 [01:11<00:00, 17.90s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:14:41,162 | Epoch27 Valid:
2025-08-26 18:14:41,162 | domain:Food
2025-08-26 18:14:41,162 | model_moe:
2025-08-26 18:14:41,163 | MRR: 0.3682
2025-08-26 18:14:41,163 | HR @1|5|10: 0.2754 	 0.4874 	 0.5448 	
2025-08-26 18:14:41,163 | NDCG @5|10: 0.3882 	 0.4069
2025-08-26 18:14:41,163 | domain:Kitchen
2025-08-26 18:14:41,164 | model_moe:
2025-08-26 18:14:41,164 | MRR: 0.1060
2025-08-26 18:14:41,164 | HR @1|5|10: 0.0566 	 0.1483 	 0.2040 	
2025-08-26 18:14:41,164 | NDCG @5|10: 0.1040 	 0.1219
2025-08-26 18:14:41,165 | domain:Clothing
2025-08-26 18:14:41,165 | model_moe:
2025-08-26 18:14:41,165 | MRR: 0.0272
2025-08-26 18:14:41,165 | HR @1|5|10: 0.0159 	 0.0318 	 0.0428 	
2025-08-26 18:14:41,166 | NDCG @5|10: 0.0233 	 0.0269
2025-08-26 18:14:41,166 | domain:Beauty
2025-08-26 18:14:41,166 | model_moe:
2025-08-26 18:14:41,167 | MRR: 0.2478
2025-08-26 18:14:41,167 | HR @1|5|10: 0.1794 	 0.3349 	 0.3828 	
2025-08-26 18:14:41,167 | NDCG @5|10: 0.2595 	 0.2753
2025-08-26 18:14:41,167 | 	avg_model_moe:
2025-08-26 18:14:41,168 | MRR: 0.1873
2025-08-26 18:14:41,168 | HR @1|5|10: 0.1318 	 0.2506 	 0.2936 	
2025-08-26 18:14:41,168 | NDCG @5|10: 0.1938 	 0.2077
2025-08-26 18:14:41,169 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:14:55,735 | Epoch 28/60 - client 0 -  Training Loss: 30.858

 25%|##5       | 1/4 [00:12<00:37, 12.48s/it]2025-08-26 18:15:12,242 | Epoch 28/60 - client 2 -  Training Loss: 29.820

 50%|#####     | 2/4 [00:28<00:29, 14.85s/it]2025-08-26 18:15:42,715 | Epoch 28/60 - client 1 -  Training Loss: 33.055

 75%|#######5  | 3/4 [00:59<00:21, 21.98s/it]2025-08-26 18:15:54,846 | Epoch 28/60 - client 3 -  Training Loss: 32.514

100%|##########| 4/4 [01:11<00:00, 18.09s/it]
100%|##########| 4/4 [01:11<00:00, 17.90s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:15:58,931 | Epoch28 Valid:
2025-08-26 18:15:58,931 | domain:Food
2025-08-26 18:15:58,932 | model_moe:
2025-08-26 18:15:58,932 | MRR: 0.3644
2025-08-26 18:15:58,932 | HR @1|5|10: 0.2686 	 0.4897 	 0.5448 	
2025-08-26 18:15:58,932 | NDCG @5|10: 0.3862 	 0.4041
2025-08-26 18:15:58,933 | domain:Kitchen
2025-08-26 18:15:58,933 | model_moe:
2025-08-26 18:15:58,933 | MRR: 0.1070
2025-08-26 18:15:58,934 | HR @1|5|10: 0.0566 	 0.1515 	 0.2104 	
2025-08-26 18:15:58,934 | NDCG @5|10: 0.1054 	 0.1244
2025-08-26 18:15:58,934 | domain:Clothing
2025-08-26 18:15:58,934 | model_moe:
2025-08-26 18:15:58,935 | MRR: 0.0249
2025-08-26 18:15:58,935 | HR @1|5|10: 0.0134 	 0.0306 	 0.0428 	
2025-08-26 18:15:58,935 | NDCG @5|10: 0.0213 	 0.0252
2025-08-26 18:15:58,935 | domain:Beauty
2025-08-26 18:15:58,936 | model_moe:
2025-08-26 18:15:58,936 | MRR: 0.2479
2025-08-26 18:15:58,936 | HR @1|5|10: 0.1794 	 0.3349 	 0.3816 	
2025-08-26 18:15:58,937 | NDCG @5|10: 0.2597 	 0.2750
2025-08-26 18:15:58,937 | 	avg_model_moe:
2025-08-26 18:15:58,937 | MRR: 0.1861
2025-08-26 18:15:58,937 | HR @1|5|10: 0.1295 	 0.2517 	 0.2949 	
2025-08-26 18:15:58,938 | NDCG @5|10: 0.1932 	 0.2072
2025-08-26 18:15:58,938 | Early Stopping counter: 1 out of 10
2025-08-26 18:15:58,938 | Learning rate decay counter: 1 out of 1
2025-08-26 18:15:58,938 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:16:15,425 | Epoch 29/60 - client 2 -  Training Loss: 29.575

 25%|##5       | 1/4 [00:16<00:49, 16.49s/it]2025-08-26 18:16:27,556 | Epoch 29/60 - client 3 -  Training Loss: 32.287

 50%|#####     | 2/4 [00:28<00:27, 13.92s/it]2025-08-26 18:16:40,004 | Epoch 29/60 - client 0 -  Training Loss: 30.687

 75%|#######5  | 3/4 [00:41<00:13, 13.25s/it]2025-08-26 18:17:10,499 | Epoch 29/60 - client 1 -  Training Loss: 32.795

100%|##########| 4/4 [01:11<00:00, 20.06s/it]
100%|##########| 4/4 [01:11<00:00, 17.89s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:17:14,592 | Epoch29 Valid:
2025-08-26 18:17:14,592 | domain:Food
2025-08-26 18:17:14,593 | model_moe:
2025-08-26 18:17:14,593 | MRR: 0.3626
2025-08-26 18:17:14,593 | HR @1|5|10: 0.2647 	 0.4843 	 0.5463 	
2025-08-26 18:17:14,593 | NDCG @5|10: 0.3831 	 0.4033
2025-08-26 18:17:14,594 | domain:Kitchen
2025-08-26 18:17:14,594 | model_moe:
2025-08-26 18:17:14,594 | MRR: 0.1092
2025-08-26 18:17:14,594 | HR @1|5|10: 0.0580 	 0.1565 	 0.2104 	
2025-08-26 18:17:14,595 | NDCG @5|10: 0.1087 	 0.1261
2025-08-26 18:17:14,595 | domain:Clothing
2025-08-26 18:17:14,595 | model_moe:
2025-08-26 18:17:14,596 | MRR: 0.0261
2025-08-26 18:17:14,596 | HR @1|5|10: 0.0134 	 0.0342 	 0.0465 	
2025-08-26 18:17:14,596 | NDCG @5|10: 0.0233 	 0.0272
2025-08-26 18:17:14,596 | domain:Beauty
2025-08-26 18:17:14,597 | model_moe:
2025-08-26 18:17:14,597 | MRR: 0.2466
2025-08-26 18:17:14,597 | HR @1|5|10: 0.1746 	 0.3361 	 0.3792 	
2025-08-26 18:17:14,597 | NDCG @5|10: 0.2594 	 0.2736
2025-08-26 18:17:14,598 | 	avg_model_moe:
2025-08-26 18:17:14,598 | MRR: 0.1861
2025-08-26 18:17:14,598 | HR @1|5|10: 0.1277 	 0.2528 	 0.2956 	
2025-08-26 18:17:14,598 | NDCG @5|10: 0.1936 	 0.2076
2025-08-26 18:17:14,599 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:17:26,730 | Epoch 30/60 - client 3 -  Training Loss: 32.074

 25%|##5       | 1/4 [00:12<00:36, 12.13s/it]2025-08-26 18:17:39,187 | Epoch 30/60 - client 0 -  Training Loss: 30.519

 50%|#####     | 2/4 [00:24<00:24, 12.32s/it]2025-08-26 18:18:09,590 | Epoch 30/60 - client 1 -  Training Loss: 32.554

 75%|#######5  | 3/4 [00:54<00:20, 20.58s/it]2025-08-26 18:18:26,100 | Epoch 30/60 - client 2 -  Training Loss: 29.332

100%|##########| 4/4 [01:11<00:00, 18.97s/it]
100%|##########| 4/4 [01:11<00:00, 17.88s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:18:30,180 | Epoch30 Valid:
2025-08-26 18:18:30,181 | domain:Food
2025-08-26 18:18:30,181 | model_moe:
2025-08-26 18:18:30,181 | MRR: 0.3639
2025-08-26 18:18:30,181 | HR @1|5|10: 0.2655 	 0.4866 	 0.5409 	
2025-08-26 18:18:30,182 | NDCG @5|10: 0.3853 	 0.4029
2025-08-26 18:18:30,182 | domain:Kitchen
2025-08-26 18:18:30,182 | model_moe:
2025-08-26 18:18:30,182 | MRR: 0.1100
2025-08-26 18:18:30,183 | HR @1|5|10: 0.0585 	 0.1593 	 0.2109 	
2025-08-26 18:18:30,183 | NDCG @5|10: 0.1101 	 0.1268
2025-08-26 18:18:30,183 | domain:Clothing
2025-08-26 18:18:30,184 | model_moe:
2025-08-26 18:18:30,184 | MRR: 0.0257
2025-08-26 18:18:30,184 | HR @1|5|10: 0.0122 	 0.0342 	 0.0452 	
2025-08-26 18:18:30,184 | NDCG @5|10: 0.0229 	 0.0265
2025-08-26 18:18:30,185 | domain:Beauty
2025-08-26 18:18:30,185 | model_moe:
2025-08-26 18:18:30,185 | MRR: 0.2474
2025-08-26 18:18:30,185 | HR @1|5|10: 0.1770 	 0.3373 	 0.3768 	
2025-08-26 18:18:30,186 | NDCG @5|10: 0.2605 	 0.2735
2025-08-26 18:18:30,186 | 	avg_model_moe:
2025-08-26 18:18:30,186 | MRR: 0.1867
2025-08-26 18:18:30,187 | HR @1|5|10: 0.1283 	 0.2544 	 0.2935 	
2025-08-26 18:18:30,187 | NDCG @5|10: 0.1947 	 0.2074
2025-08-26 18:18:30,187 | Early Stopping counter: 3 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:19:00,681 | Epoch 31/60 - client 1 -  Training Loss: 32.315

 25%|##5       | 1/4 [00:30<01:31, 30.50s/it]2025-08-26 18:19:12,808 | Epoch 31/60 - client 3 -  Training Loss: 31.880

 50%|#####     | 2/4 [00:42<00:39, 19.69s/it]2025-08-26 18:19:25,269 | Epoch 31/60 - client 0 -  Training Loss: 30.355

 75%|#######5  | 3/4 [00:55<00:16, 16.39s/it]2025-08-26 18:19:41,759 | Epoch 31/60 - client 2 -  Training Loss: 29.108

100%|##########| 4/4 [01:11<00:00, 16.43s/it]
100%|##########| 4/4 [01:11<00:00, 17.89s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:19:45,843 | Epoch31 Valid:
2025-08-26 18:19:45,843 | domain:Food
2025-08-26 18:19:45,843 | model_moe:
2025-08-26 18:19:45,844 | MRR: 0.3636
2025-08-26 18:19:45,844 | HR @1|5|10: 0.2670 	 0.4889 	 0.5425 	
2025-08-26 18:19:45,844 | NDCG @5|10: 0.3856 	 0.4029
2025-08-26 18:19:45,845 | domain:Kitchen
2025-08-26 18:19:45,845 | model_moe:
2025-08-26 18:19:45,845 | MRR: 0.1116
2025-08-26 18:19:45,845 | HR @1|5|10: 0.0603 	 0.1565 	 0.2127 	
2025-08-26 18:19:45,846 | NDCG @5|10: 0.1101 	 0.1283
2025-08-26 18:19:45,846 | domain:Clothing
2025-08-26 18:19:45,846 | model_moe:
2025-08-26 18:19:45,846 | MRR: 0.0268
2025-08-26 18:19:45,847 | HR @1|5|10: 0.0122 	 0.0330 	 0.0465 	
2025-08-26 18:19:45,847 | NDCG @5|10: 0.0233 	 0.0276
2025-08-26 18:19:45,847 | domain:Beauty
2025-08-26 18:19:45,847 | model_moe:
2025-08-26 18:19:45,848 | MRR: 0.2477
2025-08-26 18:19:45,848 | HR @1|5|10: 0.1782 	 0.3361 	 0.3816 	
2025-08-26 18:19:45,848 | NDCG @5|10: 0.2600 	 0.2749
2025-08-26 18:19:45,849 | 	avg_model_moe:
2025-08-26 18:19:45,849 | MRR: 0.1874
2025-08-26 18:19:45,849 | HR @1|5|10: 0.1294 	 0.2536 	 0.2958 	
2025-08-26 18:19:45,849 | NDCG @5|10: 0.1947 	 0.2084
2025-08-26 18:19:45,850 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:20:18,033 | Epoch 32/60 - client 1 -  Training Loss: 32.096

 25%|##5       | 1/4 [00:30<01:30, 30.20s/it]2025-08-26 18:20:30,127 | Epoch 32/60 - client 3 -  Training Loss: 31.673

 50%|#####     | 2/4 [00:42<00:39, 19.55s/it]2025-08-26 18:20:42,458 | Epoch 32/60 - client 0 -  Training Loss: 30.199

 75%|#######5  | 3/4 [00:54<00:16, 16.25s/it]2025-08-26 18:20:58,847 | Epoch 32/60 - client 2 -  Training Loss: 28.900

100%|##########| 4/4 [01:11<00:00, 16.31s/it]
100%|##########| 4/4 [01:11<00:00, 17.75s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:21:02,917 | Epoch32 Valid:
2025-08-26 18:21:02,917 | domain:Food
2025-08-26 18:21:02,918 | model_moe:
2025-08-26 18:21:02,918 | MRR: 0.3627
2025-08-26 18:21:02,918 | HR @1|5|10: 0.2655 	 0.4874 	 0.5409 	
2025-08-26 18:21:02,919 | NDCG @5|10: 0.3845 	 0.4019
2025-08-26 18:21:02,919 | domain:Kitchen
2025-08-26 18:21:02,919 | model_moe:
2025-08-26 18:21:02,919 | MRR: 0.1129
2025-08-26 18:21:02,920 | HR @1|5|10: 0.0612 	 0.1621 	 0.2150 	
2025-08-26 18:21:02,920 | NDCG @5|10: 0.1128 	 0.1298
2025-08-26 18:21:02,920 | domain:Clothing
2025-08-26 18:21:02,920 | model_moe:
2025-08-26 18:21:02,921 | MRR: 0.0268
2025-08-26 18:21:02,921 | HR @1|5|10: 0.0134 	 0.0330 	 0.0440 	
2025-08-26 18:21:02,921 | NDCG @5|10: 0.0235 	 0.0271
2025-08-26 18:21:02,922 | domain:Beauty
2025-08-26 18:21:02,922 | model_moe:
2025-08-26 18:21:02,922 | MRR: 0.2463
2025-08-26 18:21:02,922 | HR @1|5|10: 0.1758 	 0.3361 	 0.3744 	
2025-08-26 18:21:02,923 | NDCG @5|10: 0.2592 	 0.2718
2025-08-26 18:21:02,923 | 	avg_model_moe:
2025-08-26 18:21:02,923 | MRR: 0.1872
2025-08-26 18:21:02,923 | HR @1|5|10: 0.1290 	 0.2546 	 0.2936 	
2025-08-26 18:21:02,924 | NDCG @5|10: 0.1950 	 0.2077
2025-08-26 18:21:02,924 | Early Stopping counter: 1 out of 10
2025-08-26 18:21:02,924 | Learning rate decay counter: 1 out of 1
2025-08-26 18:21:02,925 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:21:19,407 | Epoch 33/60 - client 2 -  Training Loss: 28.683

 25%|##5       | 1/4 [00:16<00:49, 16.48s/it]2025-08-26 18:21:31,512 | Epoch 33/60 - client 3 -  Training Loss: 31.484

 50%|#####     | 2/4 [00:28<00:27, 13.91s/it]2025-08-26 18:22:01,885 | Epoch 33/60 - client 1 -  Training Loss: 31.880

 75%|#######5  | 3/4 [00:58<00:21, 21.43s/it]2025-08-26 18:22:14,421 | Epoch 33/60 - client 0 -  Training Loss: 30.049

100%|##########| 4/4 [01:11<00:00, 17.92s/it]
100%|##########| 4/4 [01:11<00:00, 17.87s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:22:18,512 | Epoch33 Valid:
2025-08-26 18:22:18,513 | domain:Food
2025-08-26 18:22:18,513 | model_moe:
2025-08-26 18:22:18,513 | MRR: 0.3615
2025-08-26 18:22:18,514 | HR @1|5|10: 0.2655 	 0.4866 	 0.5417 	
2025-08-26 18:22:18,514 | NDCG @5|10: 0.3834 	 0.4012
2025-08-26 18:22:18,514 | domain:Kitchen
2025-08-26 18:22:18,515 | model_moe:
2025-08-26 18:22:18,515 | MRR: 0.1136
2025-08-26 18:22:18,515 | HR @1|5|10: 0.0608 	 0.1644 	 0.2178 	
2025-08-26 18:22:18,515 | NDCG @5|10: 0.1141 	 0.1312
2025-08-26 18:22:18,516 | domain:Clothing
2025-08-26 18:22:18,516 | model_moe:
2025-08-26 18:22:18,516 | MRR: 0.0273
2025-08-26 18:22:18,516 | HR @1|5|10: 0.0147 	 0.0355 	 0.0465 	
2025-08-26 18:22:18,517 | NDCG @5|10: 0.0246 	 0.0280
2025-08-26 18:22:18,517 | domain:Beauty
2025-08-26 18:22:18,517 | model_moe:
2025-08-26 18:22:18,517 | MRR: 0.2463
2025-08-26 18:22:18,518 | HR @1|5|10: 0.1746 	 0.3325 	 0.3780 	
2025-08-26 18:22:18,518 | NDCG @5|10: 0.2580 	 0.2731
2025-08-26 18:22:18,518 | 	avg_model_moe:
2025-08-26 18:22:18,519 | MRR: 0.1872
2025-08-26 18:22:18,519 | HR @1|5|10: 0.1289 	 0.2547 	 0.2960 	
2025-08-26 18:22:18,519 | NDCG @5|10: 0.1950 	 0.2084
2025-08-26 18:22:18,519 | Early Stopping counter: 2 out of 10
2025-08-26 18:22:18,520 | Learning rate decay counter: 1 out of 1
2025-08-26 18:22:18,520 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:22:48,876 | Epoch 34/60 - client 1 -  Training Loss: 31.665

 25%|##5       | 1/4 [00:30<01:31, 30.36s/it]2025-08-26 18:23:00,986 | Epoch 34/60 - client 3 -  Training Loss: 31.291

 50%|#####     | 2/4 [00:42<00:39, 19.62s/it]2025-08-26 18:23:13,421 | Epoch 34/60 - client 0 -  Training Loss: 29.903

 75%|#######5  | 3/4 [00:54<00:16, 16.34s/it]2025-08-26 18:23:29,901 | Epoch 34/60 - client 2 -  Training Loss: 28.479

100%|##########| 4/4 [01:11<00:00, 16.40s/it]
100%|##########| 4/4 [01:11<00:00, 17.85s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:23:33,988 | Epoch34 Valid:
2025-08-26 18:23:33,988 | domain:Food
2025-08-26 18:23:33,988 | model_moe:
2025-08-26 18:23:33,989 | MRR: 0.3633
2025-08-26 18:23:33,989 | HR @1|5|10: 0.2670 	 0.4858 	 0.5471 	
2025-08-26 18:23:33,989 | NDCG @5|10: 0.3842 	 0.4041
2025-08-26 18:23:33,989 | domain:Kitchen
2025-08-26 18:23:33,990 | model_moe:
2025-08-26 18:23:33,990 | MRR: 0.1129
2025-08-26 18:23:33,990 | HR @1|5|10: 0.0608 	 0.1639 	 0.2136 	
2025-08-26 18:23:33,991 | NDCG @5|10: 0.1139 	 0.1299
2025-08-26 18:23:33,991 | domain:Clothing
2025-08-26 18:23:33,991 | model_moe:
2025-08-26 18:23:33,991 | MRR: 0.0261
2025-08-26 18:23:33,992 | HR @1|5|10: 0.0110 	 0.0355 	 0.0477 	
2025-08-26 18:23:33,992 | NDCG @5|10: 0.0235 	 0.0275
2025-08-26 18:23:33,992 | domain:Beauty
2025-08-26 18:23:33,992 | model_moe:
2025-08-26 18:23:33,993 | MRR: 0.2458
2025-08-26 18:23:33,993 | HR @1|5|10: 0.1746 	 0.3373 	 0.3804 	
2025-08-26 18:23:33,993 | NDCG @5|10: 0.2592 	 0.2734
2025-08-26 18:23:33,993 | 	avg_model_moe:
2025-08-26 18:23:33,994 | MRR: 0.1870
2025-08-26 18:23:33,994 | HR @1|5|10: 0.1284 	 0.2556 	 0.2972 	
2025-08-26 18:23:33,994 | NDCG @5|10: 0.1952 	 0.2087
2025-08-26 18:23:33,995 | Early Stopping counter: 3 out of 10
2025-08-26 18:23:33,995 | Learning rate decay counter: 1 out of 1
2025-08-26 18:23:33,995 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:24:04,459 | Epoch 35/60 - client 1 -  Training Loss: 31.467

 25%|##5       | 1/4 [00:30<01:31, 30.47s/it]2025-08-26 18:24:16,880 | Epoch 35/60 - client 0 -  Training Loss: 29.763

 50%|#####     | 2/4 [00:42<00:39, 19.85s/it]2025-08-26 18:24:33,356 | Epoch 35/60 - client 2 -  Training Loss: 28.295

 75%|#######5  | 3/4 [00:59<00:18, 18.31s/it]2025-08-26 18:24:45,470 | Epoch 35/60 - client 3 -  Training Loss: 31.117

100%|##########| 4/4 [01:11<00:00, 15.86s/it]
100%|##########| 4/4 [01:11<00:00, 17.87s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:24:49,558 | Epoch35 Valid:
2025-08-26 18:24:49,558 | domain:Food
2025-08-26 18:24:49,558 | model_moe:
2025-08-26 18:24:49,559 | MRR: 0.3629
2025-08-26 18:24:49,559 | HR @1|5|10: 0.2663 	 0.4866 	 0.5425 	
2025-08-26 18:24:49,559 | NDCG @5|10: 0.3843 	 0.4025
2025-08-26 18:24:49,559 | domain:Kitchen
2025-08-26 18:24:49,560 | model_moe:
2025-08-26 18:24:49,560 | MRR: 0.1152
2025-08-26 18:24:49,560 | HR @1|5|10: 0.0622 	 0.1653 	 0.2196 	
2025-08-26 18:24:49,561 | NDCG @5|10: 0.1153 	 0.1329
2025-08-26 18:24:49,561 | domain:Clothing
2025-08-26 18:24:49,561 | model_moe:
2025-08-26 18:24:49,561 | MRR: 0.0276
2025-08-26 18:24:49,562 | HR @1|5|10: 0.0134 	 0.0330 	 0.0489 	
2025-08-26 18:24:49,562 | NDCG @5|10: 0.0238 	 0.0290
2025-08-26 18:24:49,562 | domain:Beauty
2025-08-26 18:24:49,563 | model_moe:
2025-08-26 18:24:49,563 | MRR: 0.2498
2025-08-26 18:24:49,563 | HR @1|5|10: 0.1794 	 0.3361 	 0.3780 	
2025-08-26 18:24:49,563 | NDCG @5|10: 0.2618 	 0.2756
2025-08-26 18:24:49,564 | 	avg_model_moe:
2025-08-26 18:24:49,564 | MRR: 0.1889
2025-08-26 18:24:49,564 | HR @1|5|10: 0.1303 	 0.2553 	 0.2972 	
2025-08-26 18:24:49,565 | NDCG @5|10: 0.1963 	 0.2100
2025-08-26 18:24:49,565 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:25:04,178 | Epoch 36/60 - client 0 -  Training Loss: 29.634

 25%|##5       | 1/4 [00:12<00:36, 12.30s/it]2025-08-26 18:25:34,388 | Epoch 36/60 - client 1 -  Training Loss: 31.267

 50%|#####     | 2/4 [00:42<00:45, 22.84s/it]2025-08-26 18:25:50,782 | Epoch 36/60 - client 2 -  Training Loss: 28.122

 75%|#######5  | 3/4 [00:58<00:19, 19.90s/it]2025-08-26 18:26:02,760 | Epoch 36/60 - client 3 -  Training Loss: 30.951

100%|##########| 4/4 [01:10<00:00, 16.77s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:26:06,809 | Epoch36 Valid:
2025-08-26 18:26:06,810 | domain:Food
2025-08-26 18:26:06,810 | model_moe:
2025-08-26 18:26:06,810 | MRR: 0.3633
2025-08-26 18:26:06,811 | HR @1|5|10: 0.2670 	 0.4889 	 0.5417 	
2025-08-26 18:26:06,811 | NDCG @5|10: 0.3855 	 0.4026
2025-08-26 18:26:06,811 | domain:Kitchen
2025-08-26 18:26:06,811 | model_moe:
2025-08-26 18:26:06,812 | MRR: 0.1151
2025-08-26 18:26:06,812 | HR @1|5|10: 0.0617 	 0.1648 	 0.2205 	
2025-08-26 18:26:06,812 | NDCG @5|10: 0.1152 	 0.1331
2025-08-26 18:26:06,812 | domain:Clothing
2025-08-26 18:26:06,813 | model_moe:
2025-08-26 18:26:06,813 | MRR: 0.0283
2025-08-26 18:26:06,813 | HR @1|5|10: 0.0147 	 0.0367 	 0.0465 	
2025-08-26 18:26:06,813 | NDCG @5|10: 0.0257 	 0.0288
2025-08-26 18:26:06,814 | domain:Beauty
2025-08-26 18:26:06,814 | model_moe:
2025-08-26 18:26:06,814 | MRR: 0.2466
2025-08-26 18:26:06,815 | HR @1|5|10: 0.1746 	 0.3361 	 0.3792 	
2025-08-26 18:26:06,815 | NDCG @5|10: 0.2593 	 0.2735
2025-08-26 18:26:06,815 | 	avg_model_moe:
2025-08-26 18:26:06,815 | MRR: 0.1883
2025-08-26 18:26:06,816 | HR @1|5|10: 0.1295 	 0.2566 	 0.2970 	
2025-08-26 18:26:06,816 | NDCG @5|10: 0.1964 	 0.2095
2025-08-26 18:26:06,816 | Early Stopping counter: 1 out of 10
2025-08-26 18:26:06,816 | Learning rate decay counter: 1 out of 1
2025-08-26 18:26:06,817 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:26:37,038 | Epoch 37/60 - client 1 -  Training Loss: 31.080

 25%|##5       | 1/4 [00:30<01:30, 30.22s/it]2025-08-26 18:26:53,435 | Epoch 37/60 - client 2 -  Training Loss: 27.954

 50%|#####     | 2/4 [00:46<00:44, 22.09s/it]2025-08-26 18:27:05,743 | Epoch 37/60 - client 0 -  Training Loss: 29.510

 75%|#######5  | 3/4 [00:58<00:17, 17.62s/it]2025-08-26 18:27:17,801 | Epoch 37/60 - client 3 -  Training Loss: 30.790

100%|##########| 4/4 [01:10<00:00, 15.43s/it]
100%|##########| 4/4 [01:10<00:00, 17.75s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:27:21,878 | Epoch37 Valid:
2025-08-26 18:27:21,879 | domain:Food
2025-08-26 18:27:21,879 | model_moe:
2025-08-26 18:27:21,879 | MRR: 0.3650
2025-08-26 18:27:21,880 | HR @1|5|10: 0.2708 	 0.4874 	 0.5417 	
2025-08-26 18:27:21,880 | NDCG @5|10: 0.3863 	 0.4039
2025-08-26 18:27:21,880 | domain:Kitchen
2025-08-26 18:27:21,880 | model_moe:
2025-08-26 18:27:21,881 | MRR: 0.1170
2025-08-26 18:27:21,881 | HR @1|5|10: 0.0626 	 0.1676 	 0.2228 	
2025-08-26 18:27:21,881 | NDCG @5|10: 0.1172 	 0.1350
2025-08-26 18:27:21,881 | domain:Clothing
2025-08-26 18:27:21,882 | model_moe:
2025-08-26 18:27:21,882 | MRR: 0.0277
2025-08-26 18:27:21,882 | HR @1|5|10: 0.0134 	 0.0355 	 0.0477 	
2025-08-26 18:27:21,882 | NDCG @5|10: 0.0248 	 0.0286
2025-08-26 18:27:21,883 | domain:Beauty
2025-08-26 18:27:21,883 | model_moe:
2025-08-26 18:27:21,883 | MRR: 0.2486
2025-08-26 18:27:21,884 | HR @1|5|10: 0.1794 	 0.3349 	 0.3804 	
2025-08-26 18:27:21,884 | NDCG @5|10: 0.2602 	 0.2753
2025-08-26 18:27:21,884 | 	avg_model_moe:
2025-08-26 18:27:21,884 | MRR: 0.1896
2025-08-26 18:27:21,885 | HR @1|5|10: 0.1316 	 0.2563 	 0.2981 	
2025-08-26 18:27:21,885 | NDCG @5|10: 0.1971 	 0.2107
2025-08-26 18:27:21,885 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:27:36,283 | Epoch 38/60 - client 0 -  Training Loss: 29.376

 25%|##5       | 1/4 [00:12<00:36, 12.28s/it]2025-08-26 18:27:48,241 | Epoch 38/60 - client 3 -  Training Loss: 30.638

 50%|#####     | 2/4 [00:24<00:24, 12.09s/it]2025-08-26 18:28:04,637 | Epoch 38/60 - client 2 -  Training Loss: 27.799

 75%|#######5  | 3/4 [00:40<00:14, 14.06s/it]2025-08-26 18:28:34,775 | Epoch 38/60 - client 1 -  Training Loss: 30.898

100%|##########| 4/4 [01:10<00:00, 20.41s/it]
100%|##########| 4/4 [01:10<00:00, 17.69s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:28:38,847 | Epoch38 Valid:
2025-08-26 18:28:38,848 | domain:Food
2025-08-26 18:28:38,848 | model_moe:
2025-08-26 18:28:38,848 | MRR: 0.3637
2025-08-26 18:28:38,848 | HR @1|5|10: 0.2663 	 0.4889 	 0.5432 	
2025-08-26 18:28:38,849 | NDCG @5|10: 0.3859 	 0.4034
2025-08-26 18:28:38,849 | domain:Kitchen
2025-08-26 18:28:38,849 | model_moe:
2025-08-26 18:28:38,849 | MRR: 0.1157
2025-08-26 18:28:38,850 | HR @1|5|10: 0.0617 	 0.1671 	 0.2205 	
2025-08-26 18:28:38,850 | NDCG @5|10: 0.1162 	 0.1334
2025-08-26 18:28:38,850 | domain:Clothing
2025-08-26 18:28:38,850 | model_moe:
2025-08-26 18:28:38,851 | MRR: 0.0277
2025-08-26 18:28:38,851 | HR @1|5|10: 0.0134 	 0.0330 	 0.0440 	
2025-08-26 18:28:38,851 | NDCG @5|10: 0.0242 	 0.0276
2025-08-26 18:28:38,851 | domain:Beauty
2025-08-26 18:28:38,852 | model_moe:
2025-08-26 18:28:38,852 | MRR: 0.2444
2025-08-26 18:28:38,852 | HR @1|5|10: 0.1722 	 0.3313 	 0.3816 	
2025-08-26 18:28:38,852 | NDCG @5|10: 0.2560 	 0.2725
2025-08-26 18:28:38,853 | 	avg_model_moe:
2025-08-26 18:28:38,853 | MRR: 0.1879
2025-08-26 18:28:38,853 | HR @1|5|10: 0.1284 	 0.2551 	 0.2973 	
2025-08-26 18:28:38,853 | NDCG @5|10: 0.1956 	 0.2092
2025-08-26 18:28:38,854 | Early Stopping counter: 1 out of 10
2025-08-26 18:28:39,058 | Learning rate decay counter: 1 out of 1
2025-08-26 18:28:39,058 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:29:09,303 | Epoch 39/60 - client 1 -  Training Loss: 30.724

 25%|##5       | 1/4 [00:30<01:30, 30.25s/it]2025-08-26 18:29:21,299 | Epoch 39/60 - client 3 -  Training Loss: 30.480

 50%|#####     | 2/4 [00:42<00:39, 19.51s/it]2025-08-26 18:29:33,625 | Epoch 39/60 - client 0 -  Training Loss: 29.266

 75%|#######5  | 3/4 [00:54<00:16, 16.23s/it]2025-08-26 18:29:50,014 | Epoch 39/60 - client 2 -  Training Loss: 27.640

100%|##########| 4/4 [01:10<00:00, 16.29s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:29:54,086 | Epoch39 Valid:
2025-08-26 18:29:54,087 | domain:Food
2025-08-26 18:29:54,087 | model_moe:
2025-08-26 18:29:54,087 | MRR: 0.3640
2025-08-26 18:29:54,088 | HR @1|5|10: 0.2686 	 0.4874 	 0.5425 	
2025-08-26 18:29:54,088 | NDCG @5|10: 0.3855 	 0.4033
2025-08-26 18:29:54,088 | domain:Kitchen
2025-08-26 18:29:54,088 | model_moe:
2025-08-26 18:29:54,089 | MRR: 0.1154
2025-08-26 18:29:54,089 | HR @1|5|10: 0.0612 	 0.1648 	 0.2215 	
2025-08-26 18:29:54,089 | NDCG @5|10: 0.1150 	 0.1333
2025-08-26 18:29:54,090 | domain:Clothing
2025-08-26 18:29:54,090 | model_moe:
2025-08-26 18:29:54,090 | MRR: 0.0281
2025-08-26 18:29:54,090 | HR @1|5|10: 0.0134 	 0.0355 	 0.0465 	
2025-08-26 18:29:54,091 | NDCG @5|10: 0.0251 	 0.0286
2025-08-26 18:29:54,091 | domain:Beauty
2025-08-26 18:29:54,091 | model_moe:
2025-08-26 18:29:54,091 | MRR: 0.2465
2025-08-26 18:29:54,092 | HR @1|5|10: 0.1782 	 0.3289 	 0.3780 	
2025-08-26 18:29:54,092 | NDCG @5|10: 0.2565 	 0.2728
2025-08-26 18:29:54,092 | 	avg_model_moe:
2025-08-26 18:29:54,093 | MRR: 0.1885
2025-08-26 18:29:54,093 | HR @1|5|10: 0.1304 	 0.2542 	 0.2971 	
2025-08-26 18:29:54,093 | NDCG @5|10: 0.1955 	 0.2095
2025-08-26 18:29:54,093 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:30:06,414 | Epoch 40/60 - client 0 -  Training Loss: 29.155

 25%|##5       | 1/4 [00:12<00:36, 12.32s/it]2025-08-26 18:30:22,794 | Epoch 40/60 - client 2 -  Training Loss: 27.499

 50%|#####     | 2/4 [00:28<00:29, 14.71s/it]2025-08-26 18:30:34,809 | Epoch 40/60 - client 3 -  Training Loss: 30.340

 75%|#######5  | 3/4 [00:40<00:13, 13.48s/it]2025-08-26 18:31:05,086 | Epoch 40/60 - client 1 -  Training Loss: 30.557

100%|##########| 4/4 [01:10<00:00, 20.11s/it]
100%|##########| 4/4 [01:10<00:00, 17.75s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:31:09,141 | Epoch40 Valid:
2025-08-26 18:31:09,142 | domain:Food
2025-08-26 18:31:09,142 | model_moe:
2025-08-26 18:31:09,142 | MRR: 0.3631
2025-08-26 18:31:09,142 | HR @1|5|10: 0.2655 	 0.4889 	 0.5425 	
2025-08-26 18:31:09,143 | NDCG @5|10: 0.3854 	 0.4027
2025-08-26 18:31:09,143 | domain:Kitchen
2025-08-26 18:31:09,143 | model_moe:
2025-08-26 18:31:09,144 | MRR: 0.1167
2025-08-26 18:31:09,144 | HR @1|5|10: 0.0626 	 0.1694 	 0.2219 	
2025-08-26 18:31:09,144 | NDCG @5|10: 0.1175 	 0.1344
2025-08-26 18:31:09,145 | domain:Clothing
2025-08-26 18:31:09,145 | model_moe:
2025-08-26 18:31:09,145 | MRR: 0.0276
2025-08-26 18:31:09,145 | HR @1|5|10: 0.0122 	 0.0367 	 0.0440 	
2025-08-26 18:31:09,146 | NDCG @5|10: 0.0253 	 0.0276
2025-08-26 18:31:09,146 | domain:Beauty
2025-08-26 18:31:09,146 | model_moe:
2025-08-26 18:31:09,146 | MRR: 0.2442
2025-08-26 18:31:09,147 | HR @1|5|10: 0.1734 	 0.3325 	 0.3792 	
2025-08-26 18:31:09,147 | NDCG @5|10: 0.2563 	 0.2715
2025-08-26 18:31:09,147 | 	avg_model_moe:
2025-08-26 18:31:09,148 | MRR: 0.1879
2025-08-26 18:31:09,148 | HR @1|5|10: 0.1284 	 0.2569 	 0.2969 	
2025-08-26 18:31:09,148 | NDCG @5|10: 0.1961 	 0.2091
2025-08-26 18:31:09,148 | Early Stopping counter: 3 out of 10
2025-08-26 18:31:09,149 | Learning rate decay counter: 1 out of 1
2025-08-26 18:31:09,149 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:31:39,331 | Epoch 41/60 - client 1 -  Training Loss: 30.391

 25%|##5       | 1/4 [00:30<01:30, 30.18s/it]2025-08-26 18:31:55,718 | Epoch 41/60 - client 2 -  Training Loss: 27.352

 50%|#####     | 2/4 [00:46<00:44, 22.07s/it]2025-08-26 18:32:08,030 | Epoch 41/60 - client 0 -  Training Loss: 29.038

 75%|#######5  | 3/4 [00:58<00:17, 17.61s/it]2025-08-26 18:32:20,120 | Epoch 41/60 - client 3 -  Training Loss: 30.196

100%|##########| 4/4 [01:10<00:00, 15.43s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:32:24,216 | Epoch41 Valid:
2025-08-26 18:32:24,216 | domain:Food
2025-08-26 18:32:24,217 | model_moe:
2025-08-26 18:32:24,217 | MRR: 0.3617
2025-08-26 18:32:24,217 | HR @1|5|10: 0.2655 	 0.4874 	 0.5417 	
2025-08-26 18:32:24,218 | NDCG @5|10: 0.3837 	 0.4014
2025-08-26 18:32:24,218 | domain:Kitchen
2025-08-26 18:32:24,218 | model_moe:
2025-08-26 18:32:24,218 | MRR: 0.1178
2025-08-26 18:32:24,219 | HR @1|5|10: 0.0640 	 0.1694 	 0.2215 	
2025-08-26 18:32:24,219 | NDCG @5|10: 0.1182 	 0.1350
2025-08-26 18:32:24,219 | domain:Clothing
2025-08-26 18:32:24,220 | model_moe:
2025-08-26 18:32:24,220 | MRR: 0.0282
2025-08-26 18:32:24,220 | HR @1|5|10: 0.0147 	 0.0342 	 0.0428 	
2025-08-26 18:32:24,220 | NDCG @5|10: 0.0251 	 0.0277
2025-08-26 18:32:24,221 | domain:Beauty
2025-08-26 18:32:24,221 | model_moe:
2025-08-26 18:32:24,221 | MRR: 0.2465
2025-08-26 18:32:24,221 | HR @1|5|10: 0.1770 	 0.3266 	 0.3828 	
2025-08-26 18:32:24,222 | NDCG @5|10: 0.2557 	 0.2743
2025-08-26 18:32:24,222 | 	avg_model_moe:
2025-08-26 18:32:24,222 | MRR: 0.1885
2025-08-26 18:32:24,223 | HR @1|5|10: 0.1303 	 0.2544 	 0.2972 	
2025-08-26 18:32:24,223 | NDCG @5|10: 0.1956 	 0.2096
2025-08-26 18:32:24,223 | Early Stopping counter: 4 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:32:54,413 | Epoch 42/60 - client 1 -  Training Loss: 30.236

 25%|##5       | 1/4 [00:30<01:30, 30.19s/it]2025-08-26 18:33:10,805 | Epoch 42/60 - client 2 -  Training Loss: 27.216

 50%|#####     | 2/4 [00:46<00:44, 22.07s/it]2025-08-26 18:33:22,806 | Epoch 42/60 - client 3 -  Training Loss: 30.054

 75%|#######5  | 3/4 [00:58<00:17, 17.47s/it]2025-08-26 18:33:35,126 | Epoch 42/60 - client 0 -  Training Loss: 28.933

100%|##########| 4/4 [01:10<00:00, 15.44s/it]
100%|##########| 4/4 [01:10<00:00, 17.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:33:39,190 | Epoch42 Valid:
2025-08-26 18:33:39,191 | domain:Food
2025-08-26 18:33:39,191 | model_moe:
2025-08-26 18:33:39,191 | MRR: 0.3644
2025-08-26 18:33:39,191 | HR @1|5|10: 0.2701 	 0.4889 	 0.5394 	
2025-08-26 18:33:39,192 | NDCG @5|10: 0.3864 	 0.4028
2025-08-26 18:33:39,192 | domain:Kitchen
2025-08-26 18:33:39,192 | model_moe:
2025-08-26 18:33:39,192 | MRR: 0.1177
2025-08-26 18:33:39,193 | HR @1|5|10: 0.0640 	 0.1662 	 0.2219 	
2025-08-26 18:33:39,193 | NDCG @5|10: 0.1171 	 0.1351
2025-08-26 18:33:39,193 | domain:Clothing
2025-08-26 18:33:39,194 | model_moe:
2025-08-26 18:33:39,194 | MRR: 0.0264
2025-08-26 18:33:39,194 | HR @1|5|10: 0.0110 	 0.0355 	 0.0416 	
2025-08-26 18:33:39,194 | NDCG @5|10: 0.0241 	 0.0260
2025-08-26 18:33:39,195 | domain:Beauty
2025-08-26 18:33:39,195 | model_moe:
2025-08-26 18:33:39,195 | MRR: 0.2445
2025-08-26 18:33:39,195 | HR @1|5|10: 0.1722 	 0.3266 	 0.3816 	
2025-08-26 18:33:39,196 | NDCG @5|10: 0.2544 	 0.2725
2025-08-26 18:33:39,196 | 	avg_model_moe:
2025-08-26 18:33:39,196 | MRR: 0.1883
2025-08-26 18:33:39,196 | HR @1|5|10: 0.1293 	 0.2543 	 0.2961 	
2025-08-26 18:33:39,197 | NDCG @5|10: 0.1955 	 0.2091
2025-08-26 18:33:39,197 | Early Stopping counter: 5 out of 10
2025-08-26 18:33:39,197 | Learning rate decay counter: 1 out of 1
2025-08-26 18:33:39,198 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:34:09,479 | Epoch 43/60 - client 1 -  Training Loss: 30.081

 25%|##5       | 1/4 [00:30<01:30, 30.28s/it]2025-08-26 18:34:25,863 | Epoch 43/60 - client 2 -  Training Loss: 27.087

 50%|#####     | 2/4 [00:46<00:44, 22.11s/it]2025-08-26 18:34:37,852 | Epoch 43/60 - client 3 -  Training Loss: 29.927

 75%|#######5  | 3/4 [00:58<00:17, 17.49s/it]2025-08-26 18:34:50,164 | Epoch 43/60 - client 0 -  Training Loss: 28.830

100%|##########| 4/4 [01:10<00:00, 15.44s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-26 18:34:54,241 | Epoch43 Valid:
2025-08-26 18:34:54,241 | domain:Food
2025-08-26 18:34:54,242 | model_moe:
2025-08-26 18:34:54,242 | MRR: 0.3612
2025-08-26 18:34:54,242 | HR @1|5|10: 0.2655 	 0.4843 	 0.5394 	
2025-08-26 18:34:54,243 | NDCG @5|10: 0.3825 	 0.4004
2025-08-26 18:34:54,243 | domain:Kitchen
2025-08-26 18:34:54,243 | model_moe:
2025-08-26 18:34:54,243 | MRR: 0.1170
2025-08-26 18:34:54,244 | HR @1|5|10: 0.0645 	 0.1671 	 0.2224 	
2025-08-26 18:34:54,244 | NDCG @5|10: 0.1169 	 0.1346
2025-08-26 18:34:54,244 | domain:Clothing
2025-08-26 18:34:54,245 | model_moe:
2025-08-26 18:34:54,245 | MRR: 0.0282
2025-08-26 18:34:54,245 | HR @1|5|10: 0.0134 	 0.0355 	 0.0391 	
2025-08-26 18:34:54,245 | NDCG @5|10: 0.0255 	 0.0267
2025-08-26 18:34:54,246 | domain:Beauty
2025-08-26 18:34:54,246 | model_moe:
2025-08-26 18:34:54,246 | MRR: 0.2481
2025-08-26 18:34:54,246 | HR @1|5|10: 0.1794 	 0.3301 	 0.3840 	
2025-08-26 18:34:54,247 | NDCG @5|10: 0.2578 	 0.2756
2025-08-26 18:34:54,247 | 	avg_model_moe:
2025-08-26 18:34:54,247 | MRR: 0.1886
2025-08-26 18:34:54,248 | HR @1|5|10: 0.1307 	 0.2543 	 0.2962 	
2025-08-26 18:34:54,248 | NDCG @5|10: 0.1957 	 0.2093
2025-08-26 18:34:54,248 | Early Stopping counter: 6 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:35:24,405 | Epoch 44/60 - client 1 -  Training Loss: 29.940

 25%|##5       | 1/4 [00:30<01:30, 30.16s/it]2025-08-26 18:35:36,517 | Epoch 44/60 - client 3 -  Training Loss: 29.799

 50%|#####     | 2/4 [00:42<00:39, 19.54s/it]2025-08-26 18:35:48,834 | Epoch 44/60 - client 0 -  Training Loss: 28.729

 75%|#######5  | 3/4 [00:54<00:16, 16.24s/it]2025-08-26 18:36:05,208 | Epoch 44/60 - client 2 -  Training Loss: 26.963

100%|##########| 4/4 [01:10<00:00, 16.30s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:36:09,270 | Epoch44 Valid:
2025-08-26 18:36:09,271 | domain:Food
2025-08-26 18:36:09,271 | model_moe:
2025-08-26 18:36:09,271 | MRR: 0.3638
2025-08-26 18:36:09,272 | HR @1|5|10: 0.2678 	 0.4881 	 0.5425 	
2025-08-26 18:36:09,272 | NDCG @5|10: 0.3856 	 0.4032
2025-08-26 18:36:09,272 | domain:Kitchen
2025-08-26 18:36:09,272 | model_moe:
2025-08-26 18:36:09,273 | MRR: 0.1198
2025-08-26 18:36:09,273 | HR @1|5|10: 0.0677 	 0.1648 	 0.2224 	
2025-08-26 18:36:09,273 | NDCG @5|10: 0.1181 	 0.1368
2025-08-26 18:36:09,273 | domain:Clothing
2025-08-26 18:36:09,274 | model_moe:
2025-08-26 18:36:09,274 | MRR: 0.0279
2025-08-26 18:36:09,274 | HR @1|5|10: 0.0134 	 0.0367 	 0.0416 	
2025-08-26 18:36:09,275 | NDCG @5|10: 0.0256 	 0.0272
2025-08-26 18:36:09,275 | domain:Beauty
2025-08-26 18:36:09,275 | model_moe:
2025-08-26 18:36:09,275 | MRR: 0.2463
2025-08-26 18:36:09,276 | HR @1|5|10: 0.1758 	 0.3266 	 0.3816 	
2025-08-26 18:36:09,276 | NDCG @5|10: 0.2556 	 0.2737
2025-08-26 18:36:09,276 | 	avg_model_moe:
2025-08-26 18:36:09,276 | MRR: 0.1895
2025-08-26 18:36:09,277 | HR @1|5|10: 0.1312 	 0.2540 	 0.2970 	
2025-08-26 18:36:09,277 | NDCG @5|10: 0.1962 	 0.2102
2025-08-26 18:36:09,277 | Early Stopping counter: 7 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:36:21,585 | Epoch 45/60 - client 0 -  Training Loss: 28.637

 25%|##5       | 1/4 [00:12<00:36, 12.31s/it]2025-08-26 18:36:51,752 | Epoch 45/60 - client 1 -  Training Loss: 29.798

 50%|#####     | 2/4 [00:42<00:45, 22.81s/it]2025-08-26 18:37:08,153 | Epoch 45/60 - client 2 -  Training Loss: 26.841

 75%|#######5  | 3/4 [00:58<00:19, 19.89s/it]2025-08-26 18:37:20,216 | Epoch 45/60 - client 3 -  Training Loss: 29.679

100%|##########| 4/4 [01:10<00:00, 16.80s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.35s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-26 18:37:24,257 | Epoch45 Valid:
2025-08-26 18:37:24,257 | domain:Food
2025-08-26 18:37:24,258 | model_moe:
2025-08-26 18:37:24,258 | MRR: 0.3640
2025-08-26 18:37:24,258 | HR @1|5|10: 0.2701 	 0.4858 	 0.5409 	
2025-08-26 18:37:24,259 | NDCG @5|10: 0.3850 	 0.4030
2025-08-26 18:37:24,259 | domain:Kitchen
2025-08-26 18:37:24,259 | model_moe:
2025-08-26 18:37:24,259 | MRR: 0.1190
2025-08-26 18:37:24,260 | HR @1|5|10: 0.0663 	 0.1639 	 0.2224 	
2025-08-26 18:37:24,260 | NDCG @5|10: 0.1171 	 0.1361
2025-08-26 18:37:24,260 | domain:Clothing
2025-08-26 18:37:24,261 | model_moe:
2025-08-26 18:37:24,261 | MRR: 0.0262
2025-08-26 18:37:24,261 | HR @1|5|10: 0.0110 	 0.0342 	 0.0403 	
2025-08-26 18:37:24,261 | NDCG @5|10: 0.0235 	 0.0255
2025-08-26 18:37:24,262 | domain:Beauty
2025-08-26 18:37:24,262 | model_moe:
2025-08-26 18:37:24,262 | MRR: 0.2484
2025-08-26 18:37:24,263 | HR @1|5|10: 0.1770 	 0.3266 	 0.3852 	
2025-08-26 18:37:24,263 | NDCG @5|10: 0.2571 	 0.2762
2025-08-26 18:37:24,263 | 	avg_model_moe:
2025-08-26 18:37:24,263 | MRR: 0.1894
2025-08-26 18:37:24,264 | HR @1|5|10: 0.1311 	 0.2526 	 0.2972 	
2025-08-26 18:37:24,264 | NDCG @5|10: 0.1957 	 0.2102
2025-08-26 18:37:24,264 | Early Stopping counter: 8 out of 10
2025-08-26 18:37:24,265 | Learning rate decay counter: 1 out of 1
2025-08-26 18:37:24,265 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:37:54,176 | Epoch 46/60 - client 1 -  Training Loss: 29.655

 25%|##5       | 1/4 [00:29<01:29, 29.91s/it]2025-08-26 18:38:06,349 | Epoch 46/60 - client 0 -  Training Loss: 28.536

 50%|#####     | 2/4 [00:42<00:38, 19.48s/it]2025-08-26 18:38:18,208 | Epoch 46/60 - client 3 -  Training Loss: 29.556

 75%|#######5  | 3/4 [00:53<00:15, 16.00s/it]2025-08-26 18:38:34,459 | Epoch 46/60 - client 2 -  Training Loss: 26.723

100%|##########| 4/4 [01:10<00:00, 16.10s/it]
100%|##########| 4/4 [01:10<00:00, 17.55s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.03it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.09it/s]
100%|##########| 4/4 [00:04<00:00,  1.00s/it]
2025-08-26 18:38:38,481 | Epoch46 Valid:
2025-08-26 18:38:38,481 | domain:Food
2025-08-26 18:38:38,482 | model_moe:
2025-08-26 18:38:38,482 | MRR: 0.3607
2025-08-26 18:38:38,482 | HR @1|5|10: 0.2632 	 0.4866 	 0.5402 	
2025-08-26 18:38:38,483 | NDCG @5|10: 0.3829 	 0.4004
2025-08-26 18:38:38,483 | domain:Kitchen
2025-08-26 18:38:38,483 | model_moe:
2025-08-26 18:38:38,483 | MRR: 0.1208
2025-08-26 18:38:38,484 | HR @1|5|10: 0.0677 	 0.1667 	 0.2224 	
2025-08-26 18:38:38,484 | NDCG @5|10: 0.1193 	 0.1374
2025-08-26 18:38:38,484 | domain:Clothing
2025-08-26 18:38:38,484 | model_moe:
2025-08-26 18:38:38,485 | MRR: 0.0266
2025-08-26 18:38:38,485 | HR @1|5|10: 0.0110 	 0.0355 	 0.0440 	
2025-08-26 18:38:38,485 | NDCG @5|10: 0.0243 	 0.0269
2025-08-26 18:38:38,485 | domain:Beauty
2025-08-26 18:38:38,486 | model_moe:
2025-08-26 18:38:38,486 | MRR: 0.2489
2025-08-26 18:38:38,486 | HR @1|5|10: 0.1806 	 0.3278 	 0.3864 	
2025-08-26 18:38:38,486 | NDCG @5|10: 0.2578 	 0.2769
2025-08-26 18:38:38,487 | 	avg_model_moe:
2025-08-26 18:38:38,487 | MRR: 0.1892
2025-08-26 18:38:38,487 | HR @1|5|10: 0.1306 	 0.2541 	 0.2982 	
2025-08-26 18:38:38,487 | NDCG @5|10: 0.1961 	 0.2104
2025-08-26 18:38:38,488 | Early Stopping counter: 9 out of 10
2025-08-26 18:38:38,488 | Learning rate decay counter: 1 out of 1
2025-08-26 18:38:38,488 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-26 18:38:50,729 | Epoch 47/60 - client 0 -  Training Loss: 28.447

 25%|##5       | 1/4 [00:12<00:36, 12.24s/it]2025-08-26 18:39:02,615 | Epoch 47/60 - client 3 -  Training Loss: 29.439

 50%|#####     | 2/4 [00:24<00:24, 12.03s/it]2025-08-26 18:39:32,505 | Epoch 47/60 - client 1 -  Training Loss: 29.522

 75%|#######5  | 3/4 [00:54<00:20, 20.19s/it]2025-08-26 18:39:48,731 | Epoch 47/60 - client 2 -  Training Loss: 26.616

100%|##########| 4/4 [01:10<00:00, 18.62s/it]
100%|##########| 4/4 [01:10<00:00, 17.56s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.03it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.35s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.09it/s]
100%|##########| 4/4 [00:04<00:00,  1.00s/it]
2025-08-26 18:39:52,758 | Epoch47 Valid:
2025-08-26 18:39:52,759 | domain:Food
2025-08-26 18:39:52,759 | model_moe:
2025-08-26 18:39:52,759 | MRR: 0.3636
2025-08-26 18:39:52,759 | HR @1|5|10: 0.2693 	 0.4858 	 0.5386 	
2025-08-26 18:39:52,760 | NDCG @5|10: 0.3848 	 0.4021
2025-08-26 18:39:52,760 | domain:Kitchen
2025-08-26 18:39:52,760 | model_moe:
2025-08-26 18:39:52,761 | MRR: 0.1188
2025-08-26 18:39:52,761 | HR @1|5|10: 0.0649 	 0.1667 	 0.2228 	
2025-08-26 18:39:52,761 | NDCG @5|10: 0.1179 	 0.1361
2025-08-26 18:39:52,762 | domain:Clothing
2025-08-26 18:39:52,762 | model_moe:
2025-08-26 18:39:52,762 | MRR: 0.0265
2025-08-26 18:39:52,762 | HR @1|5|10: 0.0110 	 0.0342 	 0.0416 	
2025-08-26 18:39:52,763 | NDCG @5|10: 0.0238 	 0.0263
2025-08-26 18:39:52,763 | domain:Beauty
2025-08-26 18:39:52,763 | model_moe:
2025-08-26 18:39:52,764 | MRR: 0.2476
2025-08-26 18:39:52,764 | HR @1|5|10: 0.1770 	 0.3289 	 0.3852 	
2025-08-26 18:39:52,764 | NDCG @5|10: 0.2576 	 0.2757
2025-08-26 18:39:52,764 | 	avg_model_moe:
2025-08-26 18:39:52,765 | MRR: 0.1891
2025-08-26 18:39:52,765 | HR @1|5|10: 0.1306 	 0.2539 	 0.2971 	
2025-08-26 18:39:52,765 | NDCG @5|10: 0.1960 	 0.2101
2025-08-26 18:39:52,766 | Early Stopping counter: 10 out of 10
2025-08-26 18:39:52,766 | Early stopping

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:05,  1.90s/it]
 50%|#####     | 2/4 [00:05<00:05,  2.83s/it]
 75%|#######5  | 3/4 [00:08<00:02,  2.79s/it]
100%|##########| 4/4 [00:09<00:00,  2.40s/it]
100%|##########| 4/4 [00:09<00:00,  2.48s/it]
2025-08-26 18:40:02,698 | Test:
2025-08-26 18:40:02,699 | domain:Food
2025-08-26 18:40:02,699 | model_moe:
2025-08-26 18:40:02,699 | MRR: 0.3008
2025-08-26 18:40:02,700 | HR @1|5|10: 0.2117 	 0.4032 	 0.4812 	
2025-08-26 18:40:02,700 | NDCG @5|10: 0.3133 	 0.3386
2025-08-26 18:40:02,700 | domain:Kitchen
2025-08-26 18:40:02,700 | model_moe:
2025-08-26 18:40:02,701 | MRR: 0.1166
2025-08-26 18:40:02,701 | HR @1|5|10: 0.0626 	 0.1695 	 0.2298 	
2025-08-26 18:40:02,701 | NDCG @5|10: 0.1169 	 0.1363
2025-08-26 18:40:02,701 | domain:Clothing
2025-08-26 18:40:02,702 | model_moe:
2025-08-26 18:40:02,702 | MRR: 0.0282
2025-08-26 18:40:02,702 | HR @1|5|10: 0.0150 	 0.0335 	 0.0450 	
2025-08-26 18:40:02,702 | NDCG @5|10: 0.0241 	 0.0278
2025-08-26 18:40:02,703 | domain:Beauty
2025-08-26 18:40:02,703 | model_moe:
2025-08-26 18:40:02,703 | MRR: 0.1984
2025-08-26 18:40:02,704 | HR @1|5|10: 0.1216 	 0.2889 	 0.3532 	
2025-08-26 18:40:02,704 | NDCG @5|10: 0.2082 	 0.2293
2025-08-26 18:40:02,704 | 	avg_model_moe:
2025-08-26 18:40:02,704 | MRR: 0.1610
2025-08-26 18:40:02,705 | HR @1|5|10: 0.1027 	 0.2238 	 0.2773 	
2025-08-26 18:40:02,705 | NDCG @5|10: 0.1656 	 0.1830
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-26 18:42:55,140 | Running with the following configs:
	domains : ['Movies', 'Books', 'Games']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 10
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 18:43:23,313 | Epoch 1/40 - client 2 -  Training Loss: 31.973

 33%|###3      | 1/3 [00:28<00:56, 28.12s/it]2025-08-26 18:46:35,994 | Epoch 1/40 - client 1 -  Training Loss: 34.957

 67%|######6   | 2/3 [03:40<02:04, 124.92s/it]2025-08-26 18:48:49,955 | Epoch 1/40 - client 0 -  Training Loss: 36.559

100%|##########| 3/3 [05:54<00:00, 129.05s/it]
100%|##########| 3/3 [05:54<00:00, 118.26s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.80s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.29s/it]
100%|##########| 3/3 [00:15<00:00,  4.58s/it]
100%|##########| 3/3 [00:15<00:00,  5.27s/it]
2025-08-26 18:49:05,791 | Epoch1 Valid:
2025-08-26 18:49:05,792 | domain:Movies
2025-08-26 18:49:05,792 | model_moe:
2025-08-26 18:49:05,792 | MRR: 0.0301
2025-08-26 18:49:05,793 | HR @1|5|10: 0.0177 	 0.0318 	 0.0455 	
2025-08-26 18:49:05,793 | NDCG @5|10: 0.0247 	 0.0291
2025-08-26 18:49:05,793 | domain:Books
2025-08-26 18:49:05,794 | model_moe:
2025-08-26 18:49:05,794 | MRR: 0.0184
2025-08-26 18:49:05,794 | HR @1|5|10: 0.0122 	 0.0177 	 0.0218 	
2025-08-26 18:49:05,794 | NDCG @5|10: 0.0151 	 0.0164
2025-08-26 18:49:05,795 | domain:Games
2025-08-26 18:49:05,795 | model_moe:
2025-08-26 18:49:05,795 | MRR: 0.0598
2025-08-26 18:49:05,795 | HR @1|5|10: 0.0386 	 0.0750 	 0.0866 	
2025-08-26 18:49:05,796 | NDCG @5|10: 0.0574 	 0.0612
2025-08-26 18:49:05,796 | 	avg_model_moe:
2025-08-26 18:49:05,796 | MRR: 0.0361
2025-08-26 18:49:05,797 | HR @1|5|10: 0.0228 	 0.0415 	 0.0513 	
2025-08-26 18:49:05,797 | NDCG @5|10: 0.0324 	 0.0356
2025-08-26 18:49:05,797 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 18:51:21,857 | Epoch 2/40 - client 0 -  Training Loss: 34.251

 33%|###3      | 1/3 [02:13<04:27, 133.98s/it]2025-08-26 18:51:35,219 | Epoch 2/40 - client 2 -  Training Loss: 30.076

 67%|######6   | 2/3 [02:27<01:03, 63.03s/it] 2025-08-26 18:54:47,697 | Epoch 2/40 - client 1 -  Training Loss: 32.786

100%|##########| 3/3 [05:39<00:00, 122.14s/it]
100%|##########| 3/3 [05:39<00:00, 113.27s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.76s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.25s/it]
100%|##########| 3/3 [00:15<00:00,  4.56s/it]
100%|##########| 3/3 [00:15<00:00,  5.24s/it]
2025-08-26 18:55:03,420 | Epoch2 Valid:
2025-08-26 18:55:03,420 | domain:Movies
2025-08-26 18:55:03,421 | model_moe:
2025-08-26 18:55:03,421 | MRR: 0.0947
2025-08-26 18:55:03,421 | HR @1|5|10: 0.0533 	 0.1198 	 0.1676 	
2025-08-26 18:55:03,421 | NDCG @5|10: 0.0874 	 0.1027
2025-08-26 18:55:03,422 | domain:Books
2025-08-26 18:55:03,422 | model_moe:
2025-08-26 18:55:03,422 | MRR: 0.0638
2025-08-26 18:55:03,422 | HR @1|5|10: 0.0370 	 0.0755 	 0.1062 	
2025-08-26 18:55:03,423 | NDCG @5|10: 0.0565 	 0.0664
2025-08-26 18:55:03,423 | domain:Games
2025-08-26 18:55:03,423 | model_moe:
2025-08-26 18:55:03,423 | MRR: 0.0624
2025-08-26 18:55:03,424 | HR @1|5|10: 0.0378 	 0.0779 	 0.1048 	
2025-08-26 18:55:03,424 | NDCG @5|10: 0.0585 	 0.0673
2025-08-26 18:55:03,424 | 	avg_model_moe:
2025-08-26 18:55:03,425 | MRR: 0.0736
2025-08-26 18:55:03,425 | HR @1|5|10: 0.0427 	 0.0911 	 0.1262 	
2025-08-26 18:55:03,425 | NDCG @5|10: 0.0675 	 0.0788
2025-08-26 18:55:03,425 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 18:57:19,613 | Epoch 3/40 - client 0 -  Training Loss: 33.196

 33%|###3      | 1/3 [02:13<04:27, 133.83s/it]2025-08-26 19:00:32,135 | Epoch 3/40 - client 1 -  Training Loss: 31.557

 67%|######6   | 2/3 [05:26<02:48, 168.36s/it]2025-08-26 19:00:45,518 | Epoch 3/40 - client 2 -  Training Loss: 29.015

100%|##########| 3/3 [05:39<00:00, 97.59s/it] 
100%|##########| 3/3 [05:39<00:00, 113.25s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.81s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.28s/it]
100%|##########| 3/3 [00:15<00:00,  4.58s/it]
100%|##########| 3/3 [00:15<00:00,  5.26s/it]
2025-08-26 19:01:01,307 | Epoch3 Valid:
2025-08-26 19:01:01,308 | domain:Movies
2025-08-26 19:01:01,308 | model_moe:
2025-08-26 19:01:01,308 | MRR: 0.1195
2025-08-26 19:01:01,309 | HR @1|5|10: 0.0696 	 0.1569 	 0.2138 	
2025-08-26 19:01:01,309 | NDCG @5|10: 0.1142 	 0.1326
2025-08-26 19:01:01,309 | domain:Books
2025-08-26 19:01:01,309 | model_moe:
2025-08-26 19:01:01,310 | MRR: 0.0887
2025-08-26 19:01:01,310 | HR @1|5|10: 0.0527 	 0.1101 	 0.1513 	
2025-08-26 19:01:01,310 | NDCG @5|10: 0.0821 	 0.0953
2025-08-26 19:01:01,311 | domain:Games
2025-08-26 19:01:01,311 | model_moe:
2025-08-26 19:01:01,311 | MRR: 0.0723
2025-08-26 19:01:01,311 | HR @1|5|10: 0.0466 	 0.0910 	 0.1150 	
2025-08-26 19:01:01,312 | NDCG @5|10: 0.0693 	 0.0770
2025-08-26 19:01:01,312 | 	avg_model_moe:
2025-08-26 19:01:01,312 | MRR: 0.0935
2025-08-26 19:01:01,312 | HR @1|5|10: 0.0563 	 0.1193 	 0.1600 	
2025-08-26 19:01:01,313 | NDCG @5|10: 0.0885 	 0.1016
2025-08-26 19:01:01,313 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:04:15,938 | Epoch 4/40 - client 1 -  Training Loss: 30.428

 33%|###3      | 1/3 [03:12<06:24, 192.39s/it]2025-08-26 19:06:29,627 | Epoch 4/40 - client 0 -  Training Loss: 32.261

 67%|######6   | 2/3 [05:26<02:37, 157.86s/it]2025-08-26 19:06:42,955 | Epoch 4/40 - client 2 -  Training Loss: 28.063

100%|##########| 3/3 [05:39<00:00, 91.86s/it] 
100%|##########| 3/3 [05:39<00:00, 113.13s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.75s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.24s/it]
100%|##########| 3/3 [00:15<00:00,  4.58s/it]
100%|##########| 3/3 [00:15<00:00,  5.25s/it]
2025-08-26 19:06:58,720 | Epoch4 Valid:
2025-08-26 19:06:58,720 | domain:Movies
2025-08-26 19:06:58,720 | model_moe:
2025-08-26 19:06:58,721 | MRR: 0.1359
2025-08-26 19:06:58,721 | HR @1|5|10: 0.0820 	 0.1780 	 0.2352 	
2025-08-26 19:06:58,721 | NDCG @5|10: 0.1318 	 0.1503
2025-08-26 19:06:58,722 | domain:Books
2025-08-26 19:06:58,722 | model_moe:
2025-08-26 19:06:58,722 | MRR: 0.1115
2025-08-26 19:06:58,723 | HR @1|5|10: 0.0653 	 0.1456 	 0.1970 	
2025-08-26 19:06:58,723 | NDCG @5|10: 0.1063 	 0.1228
2025-08-26 19:06:58,723 | domain:Games
2025-08-26 19:06:58,723 | model_moe:
2025-08-26 19:06:58,724 | MRR: 0.0852
2025-08-26 19:06:58,724 | HR @1|5|10: 0.0597 	 0.0997 	 0.1274 	
2025-08-26 19:06:58,724 | NDCG @5|10: 0.0808 	 0.0897
2025-08-26 19:06:58,725 | 	avg_model_moe:
2025-08-26 19:06:58,725 | MRR: 0.1109
2025-08-26 19:06:58,725 | HR @1|5|10: 0.0690 	 0.1411 	 0.1865 	
2025-08-26 19:06:58,725 | NDCG @5|10: 0.1063 	 0.1209
2025-08-26 19:06:58,726 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:10:13,249 | Epoch 5/40 - client 1 -  Training Loss: 29.207

 33%|###3      | 1/3 [03:12<06:24, 192.13s/it]2025-08-26 19:10:26,574 | Epoch 5/40 - client 2 -  Training Loss: 27.089

 67%|######6   | 2/3 [03:25<01:26, 86.95s/it] 2025-08-26 19:12:40,299 | Epoch 5/40 - client 0 -  Training Loss: 31.299

100%|##########| 3/3 [05:39<00:00, 108.31s/it]
100%|##########| 3/3 [05:39<00:00, 113.06s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.97s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.41s/it]
100%|##########| 3/3 [00:16<00:00,  4.65s/it]
100%|##########| 3/3 [00:16<00:00,  5.35s/it]
2025-08-26 19:12:56,370 | Epoch5 Valid:
2025-08-26 19:12:56,370 | domain:Movies
2025-08-26 19:12:56,371 | model_moe:
2025-08-26 19:12:56,371 | MRR: 0.1458
2025-08-26 19:12:56,371 | HR @1|5|10: 0.0883 	 0.1958 	 0.2551 	
2025-08-26 19:12:56,372 | NDCG @5|10: 0.1437 	 0.1628
2025-08-26 19:12:56,372 | domain:Books
2025-08-26 19:12:56,372 | model_moe:
2025-08-26 19:12:56,373 | MRR: 0.1230
2025-08-26 19:12:56,373 | HR @1|5|10: 0.0739 	 0.1601 	 0.2155 	
2025-08-26 19:12:56,373 | NDCG @5|10: 0.1180 	 0.1360
2025-08-26 19:12:56,373 | domain:Games
2025-08-26 19:12:56,374 | model_moe:
2025-08-26 19:12:56,374 | MRR: 0.0965
2025-08-26 19:12:56,374 | HR @1|5|10: 0.0713 	 0.1172 	 0.1397 	
2025-08-26 19:12:56,375 | NDCG @5|10: 0.0941 	 0.1013
2025-08-26 19:12:56,375 | 	avg_model_moe:
2025-08-26 19:12:56,375 | MRR: 0.1218
2025-08-26 19:12:56,375 | HR @1|5|10: 0.0778 	 0.1577 	 0.2035 	
2025-08-26 19:12:56,376 | NDCG @5|10: 0.1186 	 0.1334
2025-08-26 19:12:56,376 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:16:10,443 | Epoch 6/40 - client 1 -  Training Loss: 28.003

 33%|###3      | 1/3 [03:11<06:23, 191.84s/it]2025-08-26 19:18:24,321 | Epoch 6/40 - client 0 -  Training Loss: 30.378

 67%|######6   | 2/3 [05:25<02:37, 157.75s/it]2025-08-26 19:18:37,652 | Epoch 6/40 - client 2 -  Training Loss: 26.099

100%|##########| 3/3 [05:39<00:00, 91.80s/it] 
100%|##########| 3/3 [05:39<00:00, 113.02s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.77s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.25s/it]
100%|##########| 3/3 [00:15<00:00,  4.56s/it]
100%|##########| 3/3 [00:15<00:00,  5.24s/it]
2025-08-26 19:18:53,389 | Epoch6 Valid:
2025-08-26 19:18:53,389 | domain:Movies
2025-08-26 19:18:53,390 | model_moe:
2025-08-26 19:18:53,390 | MRR: 0.1545
2025-08-26 19:18:53,390 | HR @1|5|10: 0.0948 	 0.2063 	 0.2677 	
2025-08-26 19:18:53,390 | NDCG @5|10: 0.1522 	 0.1721
2025-08-26 19:18:53,391 | domain:Books
2025-08-26 19:18:53,391 | model_moe:
2025-08-26 19:18:53,391 | MRR: 0.1294
2025-08-26 19:18:53,392 | HR @1|5|10: 0.0779 	 0.1712 	 0.2265 	
2025-08-26 19:18:53,392 | NDCG @5|10: 0.1255 	 0.1434
2025-08-26 19:18:53,392 | domain:Games
2025-08-26 19:18:53,392 | model_moe:
2025-08-26 19:18:53,393 | MRR: 0.1039
2025-08-26 19:18:53,393 | HR @1|5|10: 0.0757 	 0.1245 	 0.1485 	
2025-08-26 19:18:53,393 | NDCG @5|10: 0.1012 	 0.1090
2025-08-26 19:18:53,394 | 	avg_model_moe:
2025-08-26 19:18:53,394 | MRR: 0.1292
2025-08-26 19:18:53,394 | HR @1|5|10: 0.0828 	 0.1673 	 0.2142 	
2025-08-26 19:18:53,395 | NDCG @5|10: 0.1263 	 0.1415
2025-08-26 19:18:53,395 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:21:08,905 | Epoch 7/40 - client 0 -  Training Loss: 29.621

 33%|###3      | 1/3 [02:13<04:27, 133.51s/it]2025-08-26 19:24:20,973 | Epoch 7/40 - client 1 -  Training Loss: 26.999

 67%|######6   | 2/3 [05:25<02:47, 167.96s/it]2025-08-26 19:24:34,252 | Epoch 7/40 - client 2 -  Training Loss: 25.218

100%|##########| 3/3 [05:38<00:00, 97.33s/it] 
100%|##########| 3/3 [05:38<00:00, 112.95s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.86s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.44s/it]
100%|##########| 3/3 [00:16<00:00,  4.66s/it]
100%|##########| 3/3 [00:16<00:00,  5.35s/it]
2025-08-26 19:24:50,322 | Epoch7 Valid:
2025-08-26 19:24:50,323 | domain:Movies
2025-08-26 19:24:50,323 | model_moe:
2025-08-26 19:24:50,323 | MRR: 0.1617
2025-08-26 19:24:50,324 | HR @1|5|10: 0.1003 	 0.2140 	 0.2781 	
2025-08-26 19:24:50,324 | NDCG @5|10: 0.1593 	 0.1800
2025-08-26 19:24:50,324 | domain:Books
2025-08-26 19:24:50,325 | model_moe:
2025-08-26 19:24:50,325 | MRR: 0.1322
2025-08-26 19:24:50,325 | HR @1|5|10: 0.0799 	 0.1748 	 0.2343 	
2025-08-26 19:24:50,326 | NDCG @5|10: 0.1282 	 0.1474
2025-08-26 19:24:50,326 | domain:Games
2025-08-26 19:24:50,326 | model_moe:
2025-08-26 19:24:50,327 | MRR: 0.1136
2025-08-26 19:24:50,327 | HR @1|5|10: 0.0859 	 0.1354 	 0.1587 	
2025-08-26 19:24:50,327 | NDCG @5|10: 0.1114 	 0.1188
2025-08-26 19:24:50,327 | 	avg_model_moe:
2025-08-26 19:24:50,328 | MRR: 0.1358
2025-08-26 19:24:50,328 | HR @1|5|10: 0.0887 	 0.1747 	 0.2237 	
2025-08-26 19:24:50,328 | NDCG @5|10: 0.1329 	 0.1487
2025-08-26 19:24:50,329 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:27:06,165 | Epoch 8/40 - client 0 -  Training Loss: 29.004

 33%|###3      | 1/3 [02:13<04:27, 133.64s/it]2025-08-26 19:27:19,455 | Epoch 8/40 - client 2 -  Training Loss: 24.503

 67%|######6   | 2/3 [02:26<01:02, 62.85s/it] 2025-08-26 19:30:31,615 | Epoch 8/40 - client 1 -  Training Loss: 26.230

100%|##########| 3/3 [05:39<00:00, 121.89s/it]
100%|##########| 3/3 [05:39<00:00, 113.03s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.74s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.22s/it]
100%|##########| 3/3 [00:15<00:00,  4.54s/it]
100%|##########| 3/3 [00:15<00:00,  5.21s/it]
2025-08-26 19:30:47,268 | Epoch8 Valid:
2025-08-26 19:30:47,268 | domain:Movies
2025-08-26 19:30:47,269 | model_moe:
2025-08-26 19:30:47,269 | MRR: 0.1634
2025-08-26 19:30:47,269 | HR @1|5|10: 0.1013 	 0.2168 	 0.2840 	
2025-08-26 19:30:47,270 | NDCG @5|10: 0.1609 	 0.1827
2025-08-26 19:30:47,270 | domain:Books
2025-08-26 19:30:47,270 | model_moe:
2025-08-26 19:30:47,270 | MRR: 0.1384
2025-08-26 19:30:47,271 | HR @1|5|10: 0.0838 	 0.1825 	 0.2438 	
2025-08-26 19:30:47,271 | NDCG @5|10: 0.1346 	 0.1543
2025-08-26 19:30:47,271 | domain:Games
2025-08-26 19:30:47,272 | model_moe:
2025-08-26 19:30:47,272 | MRR: 0.1090
2025-08-26 19:30:47,272 | HR @1|5|10: 0.0808 	 0.1259 	 0.1579 	
2025-08-26 19:30:47,273 | NDCG @5|10: 0.1046 	 0.1150
2025-08-26 19:30:47,273 | 	avg_model_moe:
2025-08-26 19:30:47,273 | MRR: 0.1369
2025-08-26 19:30:47,273 | HR @1|5|10: 0.0886 	 0.1751 	 0.2286 	
2025-08-26 19:30:47,274 | NDCG @5|10: 0.1334 	 0.1507
2025-08-26 19:30:47,274 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:31:02,601 | Epoch 9/40 - client 2 -  Training Loss: 23.932

 33%|###3      | 1/3 [00:13<00:26, 13.30s/it]2025-08-26 19:33:16,194 | Epoch 9/40 - client 0 -  Training Loss: 28.472

 67%|######6   | 2/3 [02:26<01:24, 84.06s/it]2025-08-26 19:36:28,345 | Epoch 9/40 - client 1 -  Training Loss: 25.624

100%|##########| 3/3 [05:39<00:00, 133.42s/it]
100%|##########| 3/3 [05:39<00:00, 113.01s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.75s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.40s/it]
100%|##########| 3/3 [00:16<00:00,  4.67s/it]
100%|##########| 3/3 [00:16<00:00,  5.34s/it]
2025-08-26 19:36:44,380 | Epoch9 Valid:
2025-08-26 19:36:44,380 | domain:Movies
2025-08-26 19:36:44,380 | model_moe:
2025-08-26 19:36:44,381 | MRR: 0.1669
2025-08-26 19:36:44,381 | HR @1|5|10: 0.1026 	 0.2262 	 0.2896 	
2025-08-26 19:36:44,381 | NDCG @5|10: 0.1662 	 0.1866
2025-08-26 19:36:44,382 | domain:Books
2025-08-26 19:36:44,382 | model_moe:
2025-08-26 19:36:44,382 | MRR: 0.1454
2025-08-26 19:36:44,383 | HR @1|5|10: 0.0895 	 0.1928 	 0.2534 	
2025-08-26 19:36:44,383 | NDCG @5|10: 0.1425 	 0.1620
2025-08-26 19:36:44,383 | domain:Games
2025-08-26 19:36:44,383 | model_moe:
2025-08-26 19:36:44,384 | MRR: 0.1102
2025-08-26 19:36:44,384 | HR @1|5|10: 0.0808 	 0.1346 	 0.1652 	
2025-08-26 19:36:44,384 | NDCG @5|10: 0.1081 	 0.1179
2025-08-26 19:36:44,385 | 	avg_model_moe:
2025-08-26 19:36:44,385 | MRR: 0.1408
2025-08-26 19:36:44,385 | HR @1|5|10: 0.0910 	 0.1845 	 0.2361 	
2025-08-26 19:36:44,385 | NDCG @5|10: 0.1389 	 0.1555
2025-08-26 19:36:44,386 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:39:58,328 | Epoch 10/40 - client 1 -  Training Loss: 25.105

 33%|###3      | 1/3 [03:11<06:23, 191.90s/it]2025-08-26 19:42:12,069 | Epoch 10/40 - client 0 -  Training Loss: 27.996

 67%|######6   | 2/3 [05:25<02:37, 157.69s/it]2025-08-26 19:42:24,884 | Epoch 10/40 - client 2 -  Training Loss: 23.434

100%|##########| 3/3 [05:38<00:00, 91.54s/it] 
100%|##########| 3/3 [05:38<00:00, 112.82s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.62s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.10s/it]
100%|##########| 3/3 [00:15<00:00,  4.40s/it]
100%|##########| 3/3 [00:15<00:00,  5.08s/it]
2025-08-26 19:42:40,144 | Epoch10 Valid:
2025-08-26 19:42:40,144 | domain:Movies
2025-08-26 19:42:40,144 | model_moe:
2025-08-26 19:42:40,145 | MRR: 0.1726
2025-08-26 19:42:40,145 | HR @1|5|10: 0.1075 	 0.2321 	 0.2972 	
2025-08-26 19:42:40,145 | NDCG @5|10: 0.1716 	 0.1927
2025-08-26 19:42:40,146 | domain:Books
2025-08-26 19:42:40,146 | model_moe:
2025-08-26 19:42:40,146 | MRR: 0.1475
2025-08-26 19:42:40,146 | HR @1|5|10: 0.0890 	 0.1976 	 0.2580 	
2025-08-26 19:42:40,147 | NDCG @5|10: 0.1451 	 0.1646
2025-08-26 19:42:40,147 | domain:Games
2025-08-26 19:42:40,147 | model_moe:
2025-08-26 19:42:40,148 | MRR: 0.1134
2025-08-26 19:42:40,148 | HR @1|5|10: 0.0822 	 0.1405 	 0.1616 	
2025-08-26 19:42:40,148 | NDCG @5|10: 0.1125 	 0.1195
2025-08-26 19:42:40,148 | 	avg_model_moe:
2025-08-26 19:42:40,149 | MRR: 0.1445
2025-08-26 19:42:40,149 | HR @1|5|10: 0.0929 	 0.1901 	 0.2389 	
2025-08-26 19:42:40,149 | NDCG @5|10: 0.1431 	 0.1590
2025-08-26 19:42:40,149 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:42:55,665 | Epoch 11/40 - client 2 -  Training Loss: 23.007

 33%|###3      | 1/3 [00:12<00:25, 12.80s/it]2025-08-26 19:45:08,974 | Epoch 11/40 - client 0 -  Training Loss: 27.572

 67%|######6   | 2/3 [02:26<01:23, 83.69s/it]2025-08-26 19:48:20,660 | Epoch 11/40 - client 1 -  Training Loss: 24.645

100%|##########| 3/3 [05:37<00:00, 133.00s/it]
100%|##########| 3/3 [05:37<00:00, 112.60s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.65s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.10s/it]
100%|##########| 3/3 [00:15<00:00,  4.40s/it]
100%|##########| 3/3 [00:15<00:00,  5.08s/it]
2025-08-26 19:48:35,918 | Epoch11 Valid:
2025-08-26 19:48:35,919 | domain:Movies
2025-08-26 19:48:35,919 | model_moe:
2025-08-26 19:48:35,919 | MRR: 0.1741
2025-08-26 19:48:35,920 | HR @1|5|10: 0.1081 	 0.2338 	 0.3024 	
2025-08-26 19:48:35,920 | NDCG @5|10: 0.1730 	 0.1951
2025-08-26 19:48:35,920 | domain:Books
2025-08-26 19:48:35,920 | model_moe:
2025-08-26 19:48:35,921 | MRR: 0.1507
2025-08-26 19:48:35,921 | HR @1|5|10: 0.0933 	 0.1994 	 0.2610 	
2025-08-26 19:48:35,921 | NDCG @5|10: 0.1478 	 0.1677
2025-08-26 19:48:35,922 | domain:Games
2025-08-26 19:48:35,922 | model_moe:
2025-08-26 19:48:35,922 | MRR: 0.1108
2025-08-26 19:48:35,922 | HR @1|5|10: 0.0801 	 0.1368 	 0.1652 	
2025-08-26 19:48:35,923 | NDCG @5|10: 0.1092 	 0.1183
2025-08-26 19:48:35,923 | 	avg_model_moe:
2025-08-26 19:48:35,923 | MRR: 0.1452
2025-08-26 19:48:35,924 | HR @1|5|10: 0.0938 	 0.1900 	 0.2429 	
2025-08-26 19:48:35,924 | NDCG @5|10: 0.1433 	 0.1604
2025-08-26 19:48:35,924 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:48:50,843 | Epoch 12/40 - client 2 -  Training Loss: 22.636

 33%|###3      | 1/3 [00:12<00:25, 12.77s/it]2025-08-26 19:52:02,176 | Epoch 12/40 - client 1 -  Training Loss: 24.237

 67%|######6   | 2/3 [03:24<01:57, 117.81s/it]2025-08-26 19:54:14,907 | Epoch 12/40 - client 0 -  Training Loss: 27.188

100%|##########| 3/3 [05:36<00:00, 124.62s/it]
100%|##########| 3/3 [05:36<00:00, 112.28s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.57s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.05s/it]
100%|##########| 3/3 [00:15<00:00,  4.37s/it]
100%|##########| 3/3 [00:15<00:00,  5.04s/it]
2025-08-26 19:54:30,053 | Epoch12 Valid:
2025-08-26 19:54:30,054 | domain:Movies
2025-08-26 19:54:30,054 | model_moe:
2025-08-26 19:54:30,054 | MRR: 0.1780
2025-08-26 19:54:30,055 | HR @1|5|10: 0.1106 	 0.2407 	 0.3076 	
2025-08-26 19:54:30,055 | NDCG @5|10: 0.1776 	 0.1992
2025-08-26 19:54:30,055 | domain:Books
2025-08-26 19:54:30,055 | model_moe:
2025-08-26 19:54:30,056 | MRR: 0.1526
2025-08-26 19:54:30,056 | HR @1|5|10: 0.0929 	 0.2036 	 0.2656 	
2025-08-26 19:54:30,056 | NDCG @5|10: 0.1502 	 0.1703
2025-08-26 19:54:30,056 | domain:Games
2025-08-26 19:54:30,057 | model_moe:
2025-08-26 19:54:30,057 | MRR: 0.1075
2025-08-26 19:54:30,057 | HR @1|5|10: 0.0771 	 0.1310 	 0.1638 	
2025-08-26 19:54:30,058 | NDCG @5|10: 0.1046 	 0.1152
2025-08-26 19:54:30,058 | 	avg_model_moe:
2025-08-26 19:54:30,058 | MRR: 0.1461
2025-08-26 19:54:30,058 | HR @1|5|10: 0.0936 	 0.1918 	 0.2456 	
2025-08-26 19:54:30,059 | NDCG @5|10: 0.1441 	 0.1616
2025-08-26 19:54:30,059 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 19:56:45,369 | Epoch 13/40 - client 0 -  Training Loss: 26.833

 33%|###3      | 1/3 [02:12<04:25, 132.79s/it]2025-08-26 19:56:58,055 | Epoch 13/40 - client 2 -  Training Loss: 22.306

 67%|######6   | 2/3 [02:25<01:02, 62.14s/it] 2025-08-26 20:00:08,893 | Epoch 13/40 - client 1 -  Training Loss: 23.869

100%|##########| 3/3 [05:36<00:00, 120.91s/it]
100%|##########| 3/3 [05:36<00:00, 112.11s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.57s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.05s/it]
100%|##########| 3/3 [00:15<00:00,  4.36s/it]
100%|##########| 3/3 [00:15<00:00,  5.04s/it]
2025-08-26 20:00:24,022 | Epoch13 Valid:
2025-08-26 20:00:24,023 | domain:Movies
2025-08-26 20:00:24,023 | model_moe:
2025-08-26 20:00:24,023 | MRR: 0.1812
2025-08-26 20:00:24,024 | HR @1|5|10: 0.1125 	 0.2444 	 0.3147 	
2025-08-26 20:00:24,024 | NDCG @5|10: 0.1808 	 0.2035
2025-08-26 20:00:24,024 | domain:Books
2025-08-26 20:00:24,024 | model_moe:
2025-08-26 20:00:24,025 | MRR: 0.1563
2025-08-26 20:00:24,025 | HR @1|5|10: 0.0963 	 0.2094 	 0.2691 	
2025-08-26 20:00:24,025 | NDCG @5|10: 0.1545 	 0.1738
2025-08-26 20:00:24,026 | domain:Games
2025-08-26 20:00:24,026 | model_moe:
2025-08-26 20:00:24,026 | MRR: 0.1026
2025-08-26 20:00:24,026 | HR @1|5|10: 0.0706 	 0.1281 	 0.1601 	
2025-08-26 20:00:24,027 | NDCG @5|10: 0.1000 	 0.1105
2025-08-26 20:00:24,027 | 	avg_model_moe:
2025-08-26 20:00:24,027 | MRR: 0.1467
2025-08-26 20:00:24,027 | HR @1|5|10: 0.0931 	 0.1940 	 0.2480 	
2025-08-26 20:00:24,028 | NDCG @5|10: 0.1451 	 0.1626
2025-08-26 20:00:24,028 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:00:38,441 | Epoch 14/40 - client 2 -  Training Loss: 21.978

 33%|###3      | 1/3 [00:12<00:25, 12.52s/it]2025-08-26 20:02:50,110 | Epoch 14/40 - client 0 -  Training Loss: 26.503

 67%|######6   | 2/3 [02:24<01:22, 82.61s/it]2025-08-26 20:05:59,936 | Epoch 14/40 - client 1 -  Training Loss: 23.526

100%|##########| 3/3 [05:34<00:00, 131.57s/it]
100%|##########| 3/3 [05:34<00:00, 111.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.46s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.94s/it]
100%|##########| 3/3 [00:14<00:00,  4.29s/it]
100%|##########| 3/3 [00:14<00:00,  4.95s/it]
2025-08-26 20:06:14,811 | Epoch14 Valid:
2025-08-26 20:06:14,812 | domain:Movies
2025-08-26 20:06:14,812 | model_moe:
2025-08-26 20:06:14,812 | MRR: 0.1834
2025-08-26 20:06:14,813 | HR @1|5|10: 0.1142 	 0.2463 	 0.3169 	
2025-08-26 20:06:14,813 | NDCG @5|10: 0.1829 	 0.2057
2025-08-26 20:06:14,813 | domain:Books
2025-08-26 20:06:14,814 | model_moe:
2025-08-26 20:06:14,814 | MRR: 0.1555
2025-08-26 20:06:14,814 | HR @1|5|10: 0.0947 	 0.2093 	 0.2710 	
2025-08-26 20:06:14,814 | NDCG @5|10: 0.1538 	 0.1737
2025-08-26 20:06:14,815 | domain:Games
2025-08-26 20:06:14,815 | model_moe:
2025-08-26 20:06:14,815 | MRR: 0.1023
2025-08-26 20:06:14,815 | HR @1|5|10: 0.0691 	 0.1259 	 0.1638 	
2025-08-26 20:06:14,816 | NDCG @5|10: 0.0988 	 0.1111
2025-08-26 20:06:14,816 | 	avg_model_moe:
2025-08-26 20:06:14,816 | MRR: 0.1471
2025-08-26 20:06:14,816 | HR @1|5|10: 0.0927 	 0.1938 	 0.2505 	
2025-08-26 20:06:14,817 | NDCG @5|10: 0.1452 	 0.1635
2025-08-26 20:06:14,817 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:08:29,646 | Epoch 15/40 - client 0 -  Training Loss: 26.198

 33%|###3      | 1/3 [02:12<04:24, 132.31s/it]2025-08-26 20:08:42,261 | Epoch 15/40 - client 2 -  Training Loss: 21.710

 67%|######6   | 2/3 [02:24<01:01, 61.90s/it] 2025-08-26 20:11:52,799 | Epoch 15/40 - client 1 -  Training Loss: 23.214

100%|##########| 3/3 [05:35<00:00, 120.64s/it]
100%|##########| 3/3 [05:35<00:00, 111.82s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.54s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.02s/it]
100%|##########| 3/3 [00:15<00:00,  4.34s/it]
100%|##########| 3/3 [00:15<00:00,  5.02s/it]
2025-08-26 20:12:07,863 | Epoch15 Valid:
2025-08-26 20:12:07,864 | domain:Movies
2025-08-26 20:12:07,864 | model_moe:
2025-08-26 20:12:07,864 | MRR: 0.1852
2025-08-26 20:12:07,864 | HR @1|5|10: 0.1166 	 0.2490 	 0.3172 	
2025-08-26 20:12:07,865 | NDCG @5|10: 0.1851 	 0.2070
2025-08-26 20:12:07,865 | domain:Books
2025-08-26 20:12:07,865 | model_moe:
2025-08-26 20:12:07,865 | MRR: 0.1584
2025-08-26 20:12:07,866 | HR @1|5|10: 0.0973 	 0.2091 	 0.2791 	
2025-08-26 20:12:07,866 | NDCG @5|10: 0.1553 	 0.1779
2025-08-26 20:12:07,866 | domain:Games
2025-08-26 20:12:07,867 | model_moe:
2025-08-26 20:12:07,867 | MRR: 0.1166
2025-08-26 20:12:07,867 | HR @1|5|10: 0.0837 	 0.1419 	 0.1739 	
2025-08-26 20:12:07,867 | NDCG @5|10: 0.1141 	 0.1244
2025-08-26 20:12:07,868 | 	avg_model_moe:
2025-08-26 20:12:07,868 | MRR: 0.1534
2025-08-26 20:12:07,868 | HR @1|5|10: 0.0992 	 0.2000 	 0.2567 	
2025-08-26 20:12:07,868 | NDCG @5|10: 0.1515 	 0.1698
2025-08-26 20:12:07,869 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:12:22,900 | Epoch 16/40 - client 2 -  Training Loss: 21.460

 33%|###3      | 1/3 [00:12<00:25, 12.53s/it]2025-08-26 20:15:32,763 | Epoch 16/40 - client 1 -  Training Loss: 22.930

 67%|######6   | 2/3 [03:22<01:56, 116.84s/it]2025-08-26 20:17:44,397 | Epoch 16/40 - client 0 -  Training Loss: 25.916

100%|##########| 3/3 [05:34<00:00, 123.60s/it]
100%|##########| 3/3 [05:34<00:00, 111.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.48s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.96s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.97s/it]
2025-08-26 20:17:59,316 | Epoch16 Valid:
2025-08-26 20:17:59,317 | domain:Movies
2025-08-26 20:17:59,317 | model_moe:
2025-08-26 20:17:59,317 | MRR: 0.1861
2025-08-26 20:17:59,319 | HR @1|5|10: 0.1169 	 0.2500 	 0.3212 	
2025-08-26 20:17:59,319 | NDCG @5|10: 0.1858 	 0.2086
2025-08-26 20:17:59,319 | domain:Books
2025-08-26 20:17:59,320 | model_moe:
2025-08-26 20:17:59,320 | MRR: 0.1594
2025-08-26 20:17:59,320 | HR @1|5|10: 0.0979 	 0.2131 	 0.2771 	
2025-08-26 20:17:59,320 | NDCG @5|10: 0.1573 	 0.1780
2025-08-26 20:17:59,321 | domain:Games
2025-08-26 20:17:59,321 | model_moe:
2025-08-26 20:17:59,321 | MRR: 0.1149
2025-08-26 20:17:59,322 | HR @1|5|10: 0.0830 	 0.1405 	 0.1725 	
2025-08-26 20:17:59,322 | NDCG @5|10: 0.1125 	 0.1228
2025-08-26 20:17:59,322 | 	avg_model_moe:
2025-08-26 20:17:59,322 | MRR: 0.1535
2025-08-26 20:17:59,323 | HR @1|5|10: 0.0992 	 0.2012 	 0.2569 	
2025-08-26 20:17:59,323 | NDCG @5|10: 0.1519 	 0.1698
2025-08-26 20:17:59,323 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:18:13,928 | Epoch 17/40 - client 2 -  Training Loss: 21.249

 33%|###3      | 1/3 [00:12<00:24, 12.49s/it]2025-08-26 20:21:23,690 | Epoch 17/40 - client 1 -  Training Loss: 22.660

 67%|######6   | 2/3 [03:22<01:56, 116.77s/it]2025-08-26 20:23:35,376 | Epoch 17/40 - client 0 -  Training Loss: 25.644

100%|##########| 3/3 [05:33<00:00, 123.58s/it]
100%|##########| 3/3 [05:33<00:00, 111.31s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.52s/it]
 67%|######6   | 2/3 [00:13<00:06,  7.00s/it]
100%|##########| 3/3 [00:15<00:00,  4.33s/it]
100%|##########| 3/3 [00:15<00:00,  5.00s/it]
2025-08-26 20:23:50,394 | Epoch17 Valid:
2025-08-26 20:23:50,395 | domain:Movies
2025-08-26 20:23:50,395 | model_moe:
2025-08-26 20:23:50,396 | MRR: 0.1871
2025-08-26 20:23:50,396 | HR @1|5|10: 0.1181 	 0.2497 	 0.3213 	
2025-08-26 20:23:50,396 | NDCG @5|10: 0.1863 	 0.2094
2025-08-26 20:23:50,396 | domain:Books
2025-08-26 20:23:50,397 | model_moe:
2025-08-26 20:23:50,397 | MRR: 0.1601
2025-08-26 20:23:50,397 | HR @1|5|10: 0.0989 	 0.2131 	 0.2778 	
2025-08-26 20:23:50,397 | NDCG @5|10: 0.1578 	 0.1787
2025-08-26 20:23:50,398 | domain:Games
2025-08-26 20:23:50,398 | model_moe:
2025-08-26 20:23:50,398 | MRR: 0.1115
2025-08-26 20:23:50,399 | HR @1|5|10: 0.0764 	 0.1419 	 0.1710 	
2025-08-26 20:23:50,399 | NDCG @5|10: 0.1103 	 0.1197
2025-08-26 20:23:50,399 | 	avg_model_moe:
2025-08-26 20:23:50,399 | MRR: 0.1529
2025-08-26 20:23:50,400 | HR @1|5|10: 0.0978 	 0.2016 	 0.2567 	
2025-08-26 20:23:50,400 | NDCG @5|10: 0.1515 	 0.1693
2025-08-26 20:23:50,400 | Early Stopping counter: 1 out of 10
2025-08-26 20:23:50,400 | Learning rate decay counter: 1 out of 1
2025-08-26 20:23:50,401 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:26:02,045 | Epoch 18/40 - client 0 -  Training Loss: 25.394

 33%|###3      | 1/3 [02:11<04:23, 131.64s/it]2025-08-26 20:29:11,930 | Epoch 18/40 - client 1 -  Training Loss: 22.414

 67%|######6   | 2/3 [05:21<02:45, 165.90s/it]2025-08-26 20:29:24,439 | Epoch 18/40 - client 2 -  Training Loss: 21.028

100%|##########| 3/3 [05:34<00:00, 95.86s/it] 
100%|##########| 3/3 [05:34<00:00, 111.35s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.50s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.98s/it]
100%|##########| 3/3 [00:14<00:00,  4.31s/it]
100%|##########| 3/3 [00:14<00:00,  4.98s/it]
2025-08-26 20:29:39,394 | Epoch18 Valid:
2025-08-26 20:29:39,395 | domain:Movies
2025-08-26 20:29:39,395 | model_moe:
2025-08-26 20:29:39,395 | MRR: 0.1875
2025-08-26 20:29:39,396 | HR @1|5|10: 0.1192 	 0.2484 	 0.3188 	
2025-08-26 20:29:39,396 | NDCG @5|10: 0.1862 	 0.2090
2025-08-26 20:29:39,396 | domain:Books
2025-08-26 20:29:39,397 | model_moe:
2025-08-26 20:29:39,397 | MRR: 0.1592
2025-08-26 20:29:39,397 | HR @1|5|10: 0.0975 	 0.2142 	 0.2784 	
2025-08-26 20:29:39,397 | NDCG @5|10: 0.1575 	 0.1781
2025-08-26 20:29:39,398 | domain:Games
2025-08-26 20:29:39,398 | model_moe:
2025-08-26 20:29:39,398 | MRR: 0.1163
2025-08-26 20:29:39,399 | HR @1|5|10: 0.0822 	 0.1477 	 0.1732 	
2025-08-26 20:29:39,399 | NDCG @5|10: 0.1154 	 0.1237
2025-08-26 20:29:39,399 | 	avg_model_moe:
2025-08-26 20:29:39,399 | MRR: 0.1543
2025-08-26 20:29:39,400 | HR @1|5|10: 0.0997 	 0.2035 	 0.2568 	
2025-08-26 20:29:39,400 | NDCG @5|10: 0.1530 	 0.1703
2025-08-26 20:29:39,400 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:29:53,961 | Epoch 19/40 - client 2 -  Training Loss: 20.842

 33%|###3      | 1/3 [00:12<00:24, 12.49s/it]2025-08-26 20:33:03,888 | Epoch 19/40 - client 1 -  Training Loss: 22.191

 67%|######6   | 2/3 [03:22<01:56, 116.87s/it]2025-08-26 20:35:15,503 | Epoch 19/40 - client 0 -  Training Loss: 25.159

100%|##########| 3/3 [05:34<00:00, 123.60s/it]
100%|##########| 3/3 [05:34<00:00, 111.35s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.53s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.99s/it]
100%|##########| 3/3 [00:14<00:00,  4.32s/it]
100%|##########| 3/3 [00:14<00:00,  4.99s/it]
2025-08-26 20:35:30,499 | Epoch19 Valid:
2025-08-26 20:35:30,500 | domain:Movies
2025-08-26 20:35:30,500 | model_moe:
2025-08-26 20:35:30,500 | MRR: 0.1879
2025-08-26 20:35:30,500 | HR @1|5|10: 0.1192 	 0.2498 	 0.3216 	
2025-08-26 20:35:30,501 | NDCG @5|10: 0.1869 	 0.2101
2025-08-26 20:35:30,501 | domain:Books
2025-08-26 20:35:30,501 | model_moe:
2025-08-26 20:35:30,502 | MRR: 0.1595
2025-08-26 20:35:30,502 | HR @1|5|10: 0.0981 	 0.2131 	 0.2795 	
2025-08-26 20:35:30,502 | NDCG @5|10: 0.1575 	 0.1788
2025-08-26 20:35:30,502 | domain:Games
2025-08-26 20:35:30,503 | model_moe:
2025-08-26 20:35:30,503 | MRR: 0.1129
2025-08-26 20:35:30,503 | HR @1|5|10: 0.0764 	 0.1463 	 0.1739 	
2025-08-26 20:35:30,504 | NDCG @5|10: 0.1125 	 0.1214
2025-08-26 20:35:30,504 | 	avg_model_moe:
2025-08-26 20:35:30,504 | MRR: 0.1535
2025-08-26 20:35:30,504 | HR @1|5|10: 0.0979 	 0.2031 	 0.2584 	
2025-08-26 20:35:30,505 | NDCG @5|10: 0.1523 	 0.1701
2025-08-26 20:35:30,505 | Early Stopping counter: 1 out of 10
2025-08-26 20:35:30,505 | Learning rate decay counter: 1 out of 1
2025-08-26 20:35:30,506 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:35:43,004 | Epoch 20/40 - client 2 -  Training Loss: 20.655

 33%|###3      | 1/3 [00:12<00:24, 12.50s/it]2025-08-26 20:37:54,723 | Epoch 20/40 - client 0 -  Training Loss: 24.926

 67%|######6   | 2/3 [02:24<01:22, 82.63s/it]2025-08-26 20:41:04,654 | Epoch 20/40 - client 1 -  Training Loss: 21.973

100%|##########| 3/3 [05:34<00:00, 131.62s/it]
100%|##########| 3/3 [05:34<00:00, 111.38s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.47s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.95s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-26 20:41:19,560 | Epoch20 Valid:
2025-08-26 20:41:19,561 | domain:Movies
2025-08-26 20:41:19,561 | model_moe:
2025-08-26 20:41:19,561 | MRR: 0.1883
2025-08-26 20:41:19,562 | HR @1|5|10: 0.1188 	 0.2495 	 0.3226 	
2025-08-26 20:41:19,562 | NDCG @5|10: 0.1872 	 0.2107
2025-08-26 20:41:19,562 | domain:Books
2025-08-26 20:41:19,563 | model_moe:
2025-08-26 20:41:19,563 | MRR: 0.1577
2025-08-26 20:41:19,563 | HR @1|5|10: 0.0953 	 0.2126 	 0.2793 	
2025-08-26 20:41:19,564 | NDCG @5|10: 0.1559 	 0.1773
2025-08-26 20:41:19,564 | domain:Games
2025-08-26 20:41:19,564 | model_moe:
2025-08-26 20:41:19,564 | MRR: 0.1095
2025-08-26 20:41:19,565 | HR @1|5|10: 0.0721 	 0.1390 	 0.1718 	
2025-08-26 20:41:19,565 | NDCG @5|10: 0.1074 	 0.1181
2025-08-26 20:41:19,565 | 	avg_model_moe:
2025-08-26 20:41:19,566 | MRR: 0.1518
2025-08-26 20:41:19,566 | HR @1|5|10: 0.0954 	 0.2004 	 0.2579 	
2025-08-26 20:41:19,566 | NDCG @5|10: 0.1501 	 0.1687
2025-08-26 20:41:19,566 | Early Stopping counter: 2 out of 10
2025-08-26 20:41:19,567 | Learning rate decay counter: 1 out of 1
2025-08-26 20:41:19,567 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:41:32,051 | Epoch 21/40 - client 2 -  Training Loss: 20.480

 33%|###3      | 1/3 [00:12<00:24, 12.48s/it]2025-08-26 20:43:43,750 | Epoch 21/40 - client 0 -  Training Loss: 24.716

 67%|######6   | 2/3 [02:24<01:22, 82.61s/it]2025-08-26 20:46:53,529 | Epoch 21/40 - client 1 -  Training Loss: 21.774

100%|##########| 3/3 [05:34<00:00, 131.58s/it]
100%|##########| 3/3 [05:34<00:00, 111.35s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.51s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.96s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.98s/it]
2025-08-26 20:47:08,556 | Epoch21 Valid:
2025-08-26 20:47:08,558 | domain:Movies
2025-08-26 20:47:08,559 | model_moe:
2025-08-26 20:47:08,560 | MRR: 0.1871
2025-08-26 20:47:08,561 | HR @1|5|10: 0.1175 	 0.2492 	 0.3193 	
2025-08-26 20:47:08,561 | NDCG @5|10: 0.1861 	 0.2088
2025-08-26 20:47:08,562 | domain:Books
2025-08-26 20:47:08,563 | model_moe:
2025-08-26 20:47:08,564 | MRR: 0.1578
2025-08-26 20:47:08,565 | HR @1|5|10: 0.0960 	 0.2120 	 0.2774 	
2025-08-26 20:47:08,566 | NDCG @5|10: 0.1558 	 0.1769
2025-08-26 20:47:08,567 | domain:Games
2025-08-26 20:47:08,567 | model_moe:
2025-08-26 20:47:08,568 | MRR: 0.1116
2025-08-26 20:47:08,569 | HR @1|5|10: 0.0742 	 0.1463 	 0.1754 	
2025-08-26 20:47:08,570 | NDCG @5|10: 0.1114 	 0.1207
2025-08-26 20:47:08,571 | 	avg_model_moe:
2025-08-26 20:47:08,572 | MRR: 0.1522
2025-08-26 20:47:08,573 | HR @1|5|10: 0.0959 	 0.2025 	 0.2574 	
2025-08-26 20:47:08,573 | NDCG @5|10: 0.1511 	 0.1688
2025-08-26 20:47:08,574 | Early Stopping counter: 3 out of 10

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:49:20,172 | Epoch 22/40 - client 0 -  Training Loss: 24.519

 33%|###3      | 1/3 [02:11<04:23, 131.60s/it]2025-08-26 20:49:32,686 | Epoch 22/40 - client 2 -  Training Loss: 20.321

 67%|######6   | 2/3 [02:24<01:01, 61.55s/it] 2025-08-26 20:52:42,683 | Epoch 22/40 - client 1 -  Training Loss: 21.589

100%|##########| 3/3 [05:34<00:00, 120.21s/it]
100%|##########| 3/3 [05:34<00:00, 111.38s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.49s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.95s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.97s/it]
2025-08-26 20:52:57,624 | Epoch22 Valid:
2025-08-26 20:52:57,625 | domain:Movies
2025-08-26 20:52:57,625 | model_moe:
2025-08-26 20:52:57,625 | MRR: 0.1865
2025-08-26 20:52:57,626 | HR @1|5|10: 0.1161 	 0.2515 	 0.3183 	
2025-08-26 20:52:57,626 | NDCG @5|10: 0.1865 	 0.2082
2025-08-26 20:52:57,626 | domain:Books
2025-08-26 20:52:57,627 | model_moe:
2025-08-26 20:52:57,627 | MRR: 0.1585
2025-08-26 20:52:57,627 | HR @1|5|10: 0.0964 	 0.2123 	 0.2786 	
2025-08-26 20:52:57,627 | NDCG @5|10: 0.1564 	 0.1777
2025-08-26 20:52:57,628 | domain:Games
2025-08-26 20:52:57,628 | model_moe:
2025-08-26 20:52:57,628 | MRR: 0.1163
2025-08-26 20:52:57,629 | HR @1|5|10: 0.0801 	 0.1448 	 0.1790 	
2025-08-26 20:52:57,629 | NDCG @5|10: 0.1140 	 0.1251
2025-08-26 20:52:57,629 | 	avg_model_moe:
2025-08-26 20:52:57,630 | MRR: 0.1537
2025-08-26 20:52:57,630 | HR @1|5|10: 0.0975 	 0.2029 	 0.2586 	
2025-08-26 20:52:57,630 | NDCG @5|10: 0.1523 	 0.1703
2025-08-26 20:52:57,630 | Early Stopping counter: 4 out of 10

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 20:53:10,126 | Epoch 23/40 - client 2 -  Training Loss: 20.166

 33%|###3      | 1/3 [00:12<00:24, 12.50s/it]2025-08-26 20:56:19,968 | Epoch 23/40 - client 1 -  Training Loss: 21.415

 67%|######6   | 2/3 [03:22<01:56, 116.82s/it]2025-08-26 20:58:31,635 | Epoch 23/40 - client 0 -  Training Loss: 24.327

100%|##########| 3/3 [05:34<00:00, 123.60s/it]
100%|##########| 3/3 [05:34<00:00, 111.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.51s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.99s/it]
100%|##########| 3/3 [00:14<00:00,  4.32s/it]
100%|##########| 3/3 [00:14<00:00,  4.99s/it]
2025-08-26 20:58:46,632 | Epoch23 Valid:
2025-08-26 20:58:46,633 | domain:Movies
2025-08-26 20:58:46,633 | model_moe:
2025-08-26 20:58:46,633 | MRR: 0.1869
2025-08-26 20:58:46,633 | HR @1|5|10: 0.1173 	 0.2502 	 0.3210 	
2025-08-26 20:58:46,634 | NDCG @5|10: 0.1863 	 0.2092
2025-08-26 20:58:46,634 | domain:Books
2025-08-26 20:58:46,634 | model_moe:
2025-08-26 20:58:46,634 | MRR: 0.1588
2025-08-26 20:58:46,635 | HR @1|5|10: 0.0970 	 0.2110 	 0.2784 	
2025-08-26 20:58:46,635 | NDCG @5|10: 0.1562 	 0.1779
2025-08-26 20:58:46,635 | domain:Games
2025-08-26 20:58:46,636 | model_moe:
2025-08-26 20:58:46,636 | MRR: 0.1134
2025-08-26 20:58:46,639 | HR @1|5|10: 0.0764 	 0.1463 	 0.1769 	
2025-08-26 20:58:46,639 | NDCG @5|10: 0.1123 	 0.1223
2025-08-26 20:58:46,639 | 	avg_model_moe:
2025-08-26 20:58:46,639 | MRR: 0.1530
2025-08-26 20:58:46,640 | HR @1|5|10: 0.0969 	 0.2025 	 0.2587 	
2025-08-26 20:58:46,640 | NDCG @5|10: 0.1516 	 0.1698
2025-08-26 20:58:46,640 | Early Stopping counter: 5 out of 10
2025-08-26 20:58:46,642 | Learning rate decay counter: 1 out of 1
2025-08-26 20:58:46,642 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:01:56,432 | Epoch 24/40 - client 1 -  Training Loss: 21.251

 33%|###3      | 1/3 [03:09<06:19, 189.80s/it]2025-08-26 21:04:08,068 | Epoch 24/40 - client 0 -  Training Loss: 24.152

 67%|######6   | 2/3 [05:21<02:35, 155.58s/it]2025-08-26 21:04:20,589 | Epoch 24/40 - client 2 -  Training Loss: 20.026

100%|##########| 3/3 [05:33<00:00, 90.26s/it] 
100%|##########| 3/3 [05:33<00:00, 111.32s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.51s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.00s/it]
100%|##########| 3/3 [00:15<00:00,  4.33s/it]
100%|##########| 3/3 [00:15<00:00,  5.00s/it]
2025-08-26 21:04:35,612 | Epoch24 Valid:
2025-08-26 21:04:35,612 | domain:Movies
2025-08-26 21:04:35,613 | model_moe:
2025-08-26 21:04:35,613 | MRR: 0.1859
2025-08-26 21:04:35,613 | HR @1|5|10: 0.1151 	 0.2488 	 0.3209 	
2025-08-26 21:04:35,614 | NDCG @5|10: 0.1852 	 0.2085
2025-08-26 21:04:35,614 | domain:Books
2025-08-26 21:04:35,614 | model_moe:
2025-08-26 21:04:35,615 | MRR: 0.1579
2025-08-26 21:04:35,615 | HR @1|5|10: 0.0958 	 0.2128 	 0.2785 	
2025-08-26 21:04:35,616 | NDCG @5|10: 0.1561 	 0.1773
2025-08-26 21:04:35,617 | domain:Games
2025-08-26 21:04:35,617 | model_moe:
2025-08-26 21:04:35,617 | MRR: 0.1124
2025-08-26 21:04:35,617 | HR @1|5|10: 0.0742 	 0.1426 	 0.1725 	
2025-08-26 21:04:35,618 | NDCG @5|10: 0.1105 	 0.1203
2025-08-26 21:04:35,618 | 	avg_model_moe:
2025-08-26 21:04:35,618 | MRR: 0.1521
2025-08-26 21:04:35,619 | HR @1|5|10: 0.0951 	 0.2014 	 0.2573 	
2025-08-26 21:04:35,619 | NDCG @5|10: 0.1506 	 0.1687
2025-08-26 21:04:35,619 | Early Stopping counter: 6 out of 10
2025-08-26 21:04:35,619 | Learning rate decay counter: 1 out of 1
2025-08-26 21:04:35,620 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:07:45,521 | Epoch 25/40 - client 1 -  Training Loss: 21.100

 33%|###3      | 1/3 [03:09<06:19, 189.90s/it]2025-08-26 21:09:57,229 | Epoch 25/40 - client 0 -  Training Loss: 23.976

 67%|######6   | 2/3 [05:21<02:35, 155.67s/it]2025-08-26 21:10:09,747 | Epoch 25/40 - client 2 -  Training Loss: 19.887

100%|##########| 3/3 [05:34<00:00, 90.30s/it] 
100%|##########| 3/3 [05:34<00:00, 111.38s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.52s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.00s/it]
100%|##########| 3/3 [00:15<00:00,  4.33s/it]
100%|##########| 3/3 [00:15<00:00,  5.00s/it]
2025-08-26 21:10:24,765 | Epoch25 Valid:
2025-08-26 21:10:24,766 | domain:Movies
2025-08-26 21:10:24,766 | model_moe:
2025-08-26 21:10:24,766 | MRR: 0.1850
2025-08-26 21:10:24,767 | HR @1|5|10: 0.1147 	 0.2498 	 0.3194 	
2025-08-26 21:10:24,767 | NDCG @5|10: 0.1850 	 0.2075
2025-08-26 21:10:24,767 | domain:Books
2025-08-26 21:10:24,768 | model_moe:
2025-08-26 21:10:24,768 | MRR: 0.1570
2025-08-26 21:10:24,768 | HR @1|5|10: 0.0955 	 0.2116 	 0.2764 	
2025-08-26 21:10:24,769 | NDCG @5|10: 0.1554 	 0.1762
2025-08-26 21:10:24,770 | domain:Games
2025-08-26 21:10:24,770 | model_moe:
2025-08-26 21:10:24,770 | MRR: 0.1149
2025-08-26 21:10:24,771 | HR @1|5|10: 0.0801 	 0.1426 	 0.1798 	
2025-08-26 21:10:24,771 | NDCG @5|10: 0.1120 	 0.1239
2025-08-26 21:10:24,771 | 	avg_model_moe:
2025-08-26 21:10:24,772 | MRR: 0.1523
2025-08-26 21:10:24,773 | HR @1|5|10: 0.0968 	 0.2014 	 0.2585 	
2025-08-26 21:10:24,773 | NDCG @5|10: 0.1508 	 0.1692
2025-08-26 21:10:24,773 | Early Stopping counter: 7 out of 10

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:10:37,293 | Epoch 26/40 - client 2 -  Training Loss: 19.760

 33%|###3      | 1/3 [00:12<00:25, 12.52s/it]2025-08-26 21:12:49,013 | Epoch 26/40 - client 0 -  Training Loss: 23.809

 67%|######6   | 2/3 [02:24<01:22, 82.64s/it]2025-08-26 21:15:58,784 | Epoch 26/40 - client 1 -  Training Loss: 20.953

100%|##########| 3/3 [05:34<00:00, 131.56s/it]
100%|##########| 3/3 [05:34<00:00, 111.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.53s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.00s/it]
100%|##########| 3/3 [00:15<00:00,  4.33s/it]
100%|##########| 3/3 [00:15<00:00,  5.00s/it]
2025-08-26 21:16:13,800 | Epoch26 Valid:
2025-08-26 21:16:13,801 | domain:Movies
2025-08-26 21:16:13,801 | model_moe:
2025-08-26 21:16:13,801 | MRR: 0.1839
2025-08-26 21:16:13,801 | HR @1|5|10: 0.1137 	 0.2484 	 0.3182 	
2025-08-26 21:16:13,802 | NDCG @5|10: 0.1837 	 0.2063
2025-08-26 21:16:13,802 | domain:Books
2025-08-26 21:16:13,802 | model_moe:
2025-08-26 21:16:13,803 | MRR: 0.1572
2025-08-26 21:16:13,803 | HR @1|5|10: 0.0950 	 0.2104 	 0.2761 	
2025-08-26 21:16:13,804 | NDCG @5|10: 0.1550 	 0.1762
2025-08-26 21:16:13,805 | domain:Games
2025-08-26 21:16:13,805 | model_moe:
2025-08-26 21:16:13,805 | MRR: 0.1141
2025-08-26 21:16:13,805 | HR @1|5|10: 0.0771 	 0.1405 	 0.1805 	
2025-08-26 21:16:13,806 | NDCG @5|10: 0.1107 	 0.1237
2025-08-26 21:16:13,806 | 	avg_model_moe:
2025-08-26 21:16:13,808 | MRR: 0.1517
2025-08-26 21:16:13,808 | HR @1|5|10: 0.0953 	 0.1998 	 0.2583 	
2025-08-26 21:16:13,808 | NDCG @5|10: 0.1498 	 0.1687
2025-08-26 21:16:13,808 | Early Stopping counter: 8 out of 10
2025-08-26 21:16:13,809 | Learning rate decay counter: 1 out of 1
2025-08-26 21:16:13,809 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:18:25,716 | Epoch 27/40 - client 0 -  Training Loss: 23.658

 33%|###3      | 1/3 [02:11<04:23, 131.91s/it]2025-08-26 21:18:38,287 | Epoch 27/40 - client 2 -  Training Loss: 19.648

 67%|######6   | 2/3 [02:24<01:01, 61.71s/it] 2025-08-26 21:21:48,797 | Epoch 27/40 - client 1 -  Training Loss: 20.816

100%|##########| 3/3 [05:34<00:00, 120.52s/it]
100%|##########| 3/3 [05:34<00:00, 111.66s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.55s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.03s/it]
100%|##########| 3/3 [00:15<00:00,  4.35s/it]
100%|##########| 3/3 [00:15<00:00,  5.03s/it]
2025-08-26 21:22:03,889 | Epoch27 Valid:
2025-08-26 21:22:03,890 | domain:Movies
2025-08-26 21:22:03,890 | model_moe:
2025-08-26 21:22:03,890 | MRR: 0.1840
2025-08-26 21:22:03,890 | HR @1|5|10: 0.1133 	 0.2488 	 0.3188 	
2025-08-26 21:22:03,891 | NDCG @5|10: 0.1839 	 0.2066
2025-08-26 21:22:03,891 | domain:Books
2025-08-26 21:22:03,891 | model_moe:
2025-08-26 21:22:03,892 | MRR: 0.1568
2025-08-26 21:22:03,892 | HR @1|5|10: 0.0960 	 0.2092 	 0.2757 	
2025-08-26 21:22:03,892 | NDCG @5|10: 0.1545 	 0.1758
2025-08-26 21:22:03,893 | domain:Games
2025-08-26 21:22:03,893 | model_moe:
2025-08-26 21:22:03,893 | MRR: 0.1098
2025-08-26 21:22:03,893 | HR @1|5|10: 0.0721 	 0.1397 	 0.1747 	
2025-08-26 21:22:03,894 | NDCG @5|10: 0.1075 	 0.1189
2025-08-26 21:22:03,894 | 	avg_model_moe:
2025-08-26 21:22:03,894 | MRR: 0.1502
2025-08-26 21:22:03,895 | HR @1|5|10: 0.0938 	 0.1992 	 0.2564 	
2025-08-26 21:22:03,895 | NDCG @5|10: 0.1486 	 0.1671
2025-08-26 21:22:03,895 | Early Stopping counter: 9 out of 10
2025-08-26 21:22:03,895 | Learning rate decay counter: 1 out of 1
2025-08-26 21:22:03,896 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:22:16,488 | Epoch 28/40 - client 2 -  Training Loss: 19.540

 33%|###3      | 1/3 [00:12<00:25, 12.59s/it]2025-08-26 21:25:27,009 | Epoch 28/40 - client 1 -  Training Loss: 20.687

 67%|######6   | 2/3 [03:23<01:57, 117.26s/it]2025-08-26 21:27:39,183 | Epoch 28/40 - client 0 -  Training Loss: 23.508

100%|##########| 3/3 [05:35<00:00, 124.07s/it]
100%|##########| 3/3 [05:35<00:00, 111.76s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.53s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.03s/it]
100%|##########| 3/3 [00:15<00:00,  4.34s/it]
100%|##########| 3/3 [00:15<00:00,  5.02s/it]
2025-08-26 21:27:54,249 | Epoch28 Valid:
2025-08-26 21:27:54,249 | domain:Movies
2025-08-26 21:27:54,249 | model_moe:
2025-08-26 21:27:54,250 | MRR: 0.1834
2025-08-26 21:27:54,250 | HR @1|5|10: 0.1139 	 0.2472 	 0.3157 	
2025-08-26 21:27:54,250 | NDCG @5|10: 0.1832 	 0.2052
2025-08-26 21:27:54,251 | domain:Books
2025-08-26 21:27:54,251 | model_moe:
2025-08-26 21:27:54,251 | MRR: 0.1562
2025-08-26 21:27:54,252 | HR @1|5|10: 0.0959 	 0.2096 	 0.2722 	
2025-08-26 21:27:54,252 | NDCG @5|10: 0.1544 	 0.1745
2025-08-26 21:27:54,252 | domain:Games
2025-08-26 21:27:54,252 | model_moe:
2025-08-26 21:27:54,253 | MRR: 0.1119
2025-08-26 21:27:54,253 | HR @1|5|10: 0.0713 	 0.1470 	 0.1805 	
2025-08-26 21:27:54,253 | NDCG @5|10: 0.1114 	 0.1222
2025-08-26 21:27:54,254 | 	avg_model_moe:
2025-08-26 21:27:54,254 | MRR: 0.1505
2025-08-26 21:27:54,254 | HR @1|5|10: 0.0937 	 0.2013 	 0.2561 	
2025-08-26 21:27:54,254 | NDCG @5|10: 0.1496 	 0.1673
2025-08-26 21:27:54,255 | Early Stopping counter: 10 out of 10
2025-08-26 21:27:54,255 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:08<00:17,  8.93s/it]
 67%|######6   | 2/3 [00:19<00:10, 10.04s/it]
100%|##########| 3/3 [00:21<00:00,  6.36s/it]
100%|##########| 3/3 [00:21<00:00,  7.24s/it]
2025-08-26 21:28:15,980 | Test:
2025-08-26 21:28:15,981 | domain:Movies
2025-08-26 21:28:15,981 | model_moe:
2025-08-26 21:28:15,981 | MRR: 0.1883
2025-08-26 21:28:15,982 | HR @1|5|10: 0.1188 	 0.2506 	 0.3217 	
2025-08-26 21:28:15,982 | NDCG @5|10: 0.1880 	 0.2110
2025-08-26 21:28:15,982 | domain:Books
2025-08-26 21:28:15,983 | model_moe:
2025-08-26 21:28:15,983 | MRR: 0.1340
2025-08-26 21:28:15,983 | HR @1|5|10: 0.0826 	 0.1755 	 0.2349 	
2025-08-26 21:28:15,984 | NDCG @5|10: 0.1307 	 0.1499
2025-08-26 21:28:15,984 | domain:Games
2025-08-26 21:28:15,984 | model_moe:
2025-08-26 21:28:15,984 | MRR: 0.0762
2025-08-26 21:28:15,985 | HR @1|5|10: 0.0464 	 0.0942 	 0.1198 	
2025-08-26 21:28:15,985 | NDCG @5|10: 0.0723 	 0.0807
2025-08-26 21:28:15,985 | 	avg_model_moe:
2025-08-26 21:28:15,986 | MRR: 0.1328
2025-08-26 21:28:15,986 | HR @1|5|10: 0.0826 	 0.1734 	 0.2255 	
2025-08-26 21:28:15,986 | NDCG @5|10: 0.1304 	 0.1472
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-26 21:31:26,510 | Running with the following configs:
	domains : ['Sports', 'Garden', 'Home']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 10
	ld_patience : 1
	alpha : 1.0
	beta : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:31:59,505 | Epoch 1/40 - client 1 -  Training Loss: 23.166

 33%|###3      | 1/3 [00:32<01:05, 32.92s/it]2025-08-26 21:33:44,841 | Epoch 1/40 - client 2 -  Training Loss: 27.556

 67%|######6   | 2/3 [02:18<01:15, 75.52s/it]2025-08-26 21:36:46,054 | Epoch 1/40 - client 0 -  Training Loss: 28.815

100%|##########| 3/3 [05:19<00:00, 123.78s/it]
100%|##########| 3/3 [05:19<00:00, 106.49s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.52s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.16s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.05s/it]
2025-08-26 21:37:04,246 | Epoch1 Valid:
2025-08-26 21:37:04,247 | domain:Sports
2025-08-26 21:37:04,247 | model_moe:
2025-08-26 21:37:04,247 | MRR: 0.0335
2025-08-26 21:37:04,248 | HR @1|5|10: 0.0188 	 0.0376 	 0.0517 	
2025-08-26 21:37:04,248 | NDCG @5|10: 0.0284 	 0.0329
2025-08-26 21:37:04,248 | domain:Garden
2025-08-26 21:37:04,248 | model_moe:
2025-08-26 21:37:04,249 | MRR: 0.0414
2025-08-26 21:37:04,249 | HR @1|5|10: 0.0270 	 0.0485 	 0.0595 	
2025-08-26 21:37:04,249 | NDCG @5|10: 0.0378 	 0.0415
2025-08-26 21:37:04,250 | domain:Home
2025-08-26 21:37:04,250 | model_moe:
2025-08-26 21:37:04,250 | MRR: 0.0457
2025-08-26 21:37:04,251 | HR @1|5|10: 0.0326 	 0.0503 	 0.0603 	
2025-08-26 21:37:04,251 | NDCG @5|10: 0.0418 	 0.0450
2025-08-26 21:37:04,251 | 	avg_model_moe:
2025-08-26 21:37:04,252 | MRR: 0.0402
2025-08-26 21:37:04,252 | HR @1|5|10: 0.0261 	 0.0455 	 0.0572 	
2025-08-26 21:37:04,252 | NDCG @5|10: 0.0360 	 0.0398
2025-08-26 21:37:04,252 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:38:52,044 | Epoch 2/40 - client 2 -  Training Loss: 23.607

 33%|###3      | 1/3 [01:44<03:29, 104.94s/it]2025-08-26 21:41:52,297 | Epoch 2/40 - client 0 -  Training Loss: 24.332

 67%|######6   | 2/3 [04:45<02:29, 149.24s/it]2025-08-26 21:42:13,321 | Epoch 2/40 - client 1 -  Training Loss: 20.116

100%|##########| 3/3 [05:06<00:00, 90.69s/it] 
100%|##########| 3/3 [05:06<00:00, 102.07s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.51s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.16s/it]
100%|##########| 3/3 [00:18<00:00,  5.80s/it]
100%|##########| 3/3 [00:18<00:00,  6.06s/it]
2025-08-26 21:42:31,528 | Epoch2 Valid:
2025-08-26 21:42:31,530 | domain:Sports
2025-08-26 21:42:31,531 | model_moe:
2025-08-26 21:42:31,532 | MRR: 0.0568
2025-08-26 21:42:31,533 | HR @1|5|10: 0.0418 	 0.0625 	 0.0751 	
2025-08-26 21:42:31,534 | NDCG @5|10: 0.0525 	 0.0566
2025-08-26 21:42:31,534 | domain:Garden
2025-08-26 21:42:31,536 | model_moe:
2025-08-26 21:42:31,537 | MRR: 0.0547
2025-08-26 21:42:31,538 | HR @1|5|10: 0.0394 	 0.0608 	 0.0732 	
2025-08-26 21:42:31,539 | NDCG @5|10: 0.0507 	 0.0546
2025-08-26 21:42:31,540 | domain:Home
2025-08-26 21:42:31,541 | model_moe:
2025-08-26 21:42:31,542 | MRR: 0.0560
2025-08-26 21:42:31,542 | HR @1|5|10: 0.0417 	 0.0618 	 0.0742 	
2025-08-26 21:42:31,543 | NDCG @5|10: 0.0519 	 0.0559
2025-08-26 21:42:31,544 | 	avg_model_moe:
2025-08-26 21:42:31,545 | MRR: 0.0558
2025-08-26 21:42:31,546 | HR @1|5|10: 0.0410 	 0.0617 	 0.0742 	
2025-08-26 21:42:31,547 | NDCG @5|10: 0.0517 	 0.0557
2025-08-26 21:42:31,548 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:44:30,589 | Epoch 3/40 - client 2 -  Training Loss: 19.639

 33%|###3      | 1/3 [01:44<03:29, 104.89s/it]2025-08-26 21:47:30,690 | Epoch 3/40 - client 0 -  Training Loss: 20.146

 67%|######6   | 2/3 [04:44<02:29, 149.13s/it]2025-08-26 21:47:51,519 | Epoch 3/40 - client 1 -  Training Loss: 17.552

100%|##########| 3/3 [05:05<00:00, 90.54s/it] 
100%|##########| 3/3 [05:05<00:00, 101.94s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.76s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.28s/it]
100%|##########| 3/3 [00:18<00:00,  5.85s/it]
100%|##########| 3/3 [00:18<00:00,  6.14s/it]
2025-08-26 21:48:09,961 | Epoch3 Valid:
2025-08-26 21:48:09,961 | domain:Sports
2025-08-26 21:48:09,962 | model_moe:
2025-08-26 21:48:09,962 | MRR: 0.0653
2025-08-26 21:48:09,962 | HR @1|5|10: 0.0523 	 0.0686 	 0.0809 	
2025-08-26 21:48:09,963 | NDCG @5|10: 0.0607 	 0.0647
2025-08-26 21:48:09,963 | domain:Garden
2025-08-26 21:48:09,963 | model_moe:
2025-08-26 21:48:09,964 | MRR: 0.0672
2025-08-26 21:48:09,964 | HR @1|5|10: 0.0514 	 0.0735 	 0.0872 	
2025-08-26 21:48:09,964 | NDCG @5|10: 0.0632 	 0.0676
2025-08-26 21:48:09,965 | domain:Home
2025-08-26 21:48:09,965 | model_moe:
2025-08-26 21:48:09,965 | MRR: 0.0574
2025-08-26 21:48:09,966 | HR @1|5|10: 0.0446 	 0.0603 	 0.0715 	
2025-08-26 21:48:09,966 | NDCG @5|10: 0.0528 	 0.0564
2025-08-26 21:48:09,966 | 	avg_model_moe:
2025-08-26 21:48:09,966 | MRR: 0.0633
2025-08-26 21:48:09,967 | HR @1|5|10: 0.0495 	 0.0675 	 0.0799 	
2025-08-26 21:48:09,968 | NDCG @5|10: 0.0589 	 0.0629
2025-08-26 21:48:09,969 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:49:57,600 | Epoch 4/40 - client 2 -  Training Loss: 16.275

 33%|###3      | 1/3 [01:45<03:30, 105.17s/it]2025-08-26 21:50:18,469 | Epoch 4/40 - client 1 -  Training Loss: 14.501

 67%|######6   | 2/3 [02:06<00:55, 55.58s/it] 2025-08-26 21:53:19,115 | Epoch 4/40 - client 0 -  Training Loss: 16.725

100%|##########| 3/3 [05:06<00:00, 112.69s/it]
100%|##########| 3/3 [05:06<00:00, 102.23s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.84s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.34s/it]
100%|##########| 3/3 [00:18<00:00,  5.96s/it]
100%|##########| 3/3 [00:18<00:00,  6.24s/it]
2025-08-26 21:53:37,853 | Epoch4 Valid:
2025-08-26 21:53:37,853 | domain:Sports
2025-08-26 21:53:37,854 | model_moe:
2025-08-26 21:53:37,855 | MRR: 0.0774
2025-08-26 21:53:37,855 | HR @1|5|10: 0.0643 	 0.0808 	 0.0937 	
2025-08-26 21:53:37,856 | NDCG @5|10: 0.0727 	 0.0769
2025-08-26 21:53:37,856 | domain:Garden
2025-08-26 21:53:37,856 | model_moe:
2025-08-26 21:53:37,857 | MRR: 0.0771
2025-08-26 21:53:37,857 | HR @1|5|10: 0.0615 	 0.0846 	 0.0982 	
2025-08-26 21:53:37,857 | NDCG @5|10: 0.0735 	 0.0780
2025-08-26 21:53:37,857 | domain:Home
2025-08-26 21:53:37,858 | model_moe:
2025-08-26 21:53:37,858 | MRR: 0.0696
2025-08-26 21:53:37,858 | HR @1|5|10: 0.0550 	 0.0743 	 0.0879 	
2025-08-26 21:53:37,859 | NDCG @5|10: 0.0652 	 0.0696
2025-08-26 21:53:37,859 | 	avg_model_moe:
2025-08-26 21:53:37,859 | MRR: 0.0747
2025-08-26 21:53:37,859 | HR @1|5|10: 0.0603 	 0.0799 	 0.0933 	
2025-08-26 21:53:37,860 | NDCG @5|10: 0.0705 	 0.0748
2025-08-26 21:53:37,860 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 21:56:41,214 | Epoch 5/40 - client 0 -  Training Loss: 14.534

 33%|###3      | 1/3 [03:00<06:01, 180.72s/it]2025-08-26 21:57:02,078 | Epoch 5/40 - client 1 -  Training Loss: 12.135

 67%|######6   | 2/3 [03:21<01:26, 86.69s/it] 2025-08-26 21:58:47,427 | Epoch 5/40 - client 2 -  Training Loss: 14.062

100%|##########| 3/3 [05:06<00:00, 95.21s/it]
100%|##########| 3/3 [05:06<00:00, 102.31s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.68s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.25s/it]
100%|##########| 3/3 [00:18<00:00,  5.90s/it]
100%|##########| 3/3 [00:18<00:00,  6.17s/it]
2025-08-26 21:59:05,946 | Epoch5 Valid:
2025-08-26 21:59:05,947 | domain:Sports
2025-08-26 21:59:05,947 | model_moe:
2025-08-26 21:59:05,947 | MRR: 0.0829
2025-08-26 21:59:05,948 | HR @1|5|10: 0.0685 	 0.0873 	 0.1015 	
2025-08-26 21:59:05,948 | NDCG @5|10: 0.0784 	 0.0829
2025-08-26 21:59:05,948 | domain:Garden
2025-08-26 21:59:05,948 | model_moe:
2025-08-26 21:59:05,949 | MRR: 0.0878
2025-08-26 21:59:05,949 | HR @1|5|10: 0.0703 	 0.0976 	 0.1106 	
2025-08-26 21:59:05,949 | NDCG @5|10: 0.0848 	 0.0889
2025-08-26 21:59:05,950 | domain:Home
2025-08-26 21:59:05,950 | model_moe:
2025-08-26 21:59:05,950 | MRR: 0.0735
2025-08-26 21:59:05,950 | HR @1|5|10: 0.0579 	 0.0801 	 0.0938 	
2025-08-26 21:59:05,951 | NDCG @5|10: 0.0696 	 0.0740
2025-08-26 21:59:05,951 | 	avg_model_moe:
2025-08-26 21:59:05,951 | MRR: 0.0814
2025-08-26 21:59:05,952 | HR @1|5|10: 0.0655 	 0.0883 	 0.1020 	
2025-08-26 21:59:05,952 | NDCG @5|10: 0.0776 	 0.0819
2025-08-26 21:59:05,952 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:02:09,582 | Epoch 6/40 - client 0 -  Training Loss: 13.094

 33%|###3      | 1/3 [03:00<06:01, 180.70s/it]2025-08-26 22:02:30,462 | Epoch 6/40 - client 1 -  Training Loss: 10.551

 67%|######6   | 2/3 [03:21<01:26, 86.69s/it] 2025-08-26 22:04:15,651 | Epoch 6/40 - client 2 -  Training Loss: 12.568

100%|##########| 3/3 [05:06<00:00, 95.14s/it]
100%|##########| 3/3 [05:06<00:00, 102.26s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.81s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.32s/it]
100%|##########| 3/3 [00:18<00:00,  5.95s/it]
100%|##########| 3/3 [00:18<00:00,  6.23s/it]
2025-08-26 22:04:34,363 | Epoch6 Valid:
2025-08-26 22:04:34,363 | domain:Sports
2025-08-26 22:04:34,364 | model_moe:
2025-08-26 22:04:34,364 | MRR: 0.0856
2025-08-26 22:04:34,364 | HR @1|5|10: 0.0709 	 0.0905 	 0.1032 	
2025-08-26 22:04:34,364 | NDCG @5|10: 0.0811 	 0.0852
2025-08-26 22:04:34,365 | domain:Garden
2025-08-26 22:04:34,365 | model_moe:
2025-08-26 22:04:34,365 | MRR: 0.0896
2025-08-26 22:04:34,366 | HR @1|5|10: 0.0716 	 0.0969 	 0.1132 	
2025-08-26 22:04:34,366 | NDCG @5|10: 0.0855 	 0.0907
2025-08-26 22:04:34,366 | domain:Home
2025-08-26 22:04:34,366 | model_moe:
2025-08-26 22:04:34,367 | MRR: 0.0766
2025-08-26 22:04:34,367 | HR @1|5|10: 0.0606 	 0.0830 	 0.0973 	
2025-08-26 22:04:34,367 | NDCG @5|10: 0.0727 	 0.0772
2025-08-26 22:04:34,368 | 	avg_model_moe:
2025-08-26 22:04:34,368 | MRR: 0.0839
2025-08-26 22:04:34,368 | HR @1|5|10: 0.0677 	 0.0902 	 0.1046 	
2025-08-26 22:04:34,368 | NDCG @5|10: 0.0798 	 0.0844
2025-08-26 22:04:34,369 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:06:21,905 | Epoch 7/40 - client 2 -  Training Loss: 11.570

 33%|###3      | 1/3 [01:44<03:29, 104.77s/it]2025-08-26 22:09:22,754 | Epoch 7/40 - client 0 -  Training Loss: 12.096

 67%|######6   | 2/3 [04:45<02:29, 149.52s/it]2025-08-26 22:09:43,365 | Epoch 7/40 - client 1 -  Training Loss: 9.487

100%|##########| 3/3 [05:06<00:00, 90.66s/it] 
100%|##########| 3/3 [05:06<00:00, 102.08s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.83s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.32s/it]
100%|##########| 3/3 [00:18<00:00,  5.90s/it]
100%|##########| 3/3 [00:18<00:00,  6.19s/it]
2025-08-26 22:10:01,955 | Epoch7 Valid:
2025-08-26 22:10:01,955 | domain:Sports
2025-08-26 22:10:01,956 | model_moe:
2025-08-26 22:10:01,956 | MRR: 0.0868
2025-08-26 22:10:01,956 | HR @1|5|10: 0.0719 	 0.0915 	 0.1052 	
2025-08-26 22:10:01,957 | NDCG @5|10: 0.0822 	 0.0865
2025-08-26 22:10:01,957 | domain:Garden
2025-08-26 22:10:01,957 | model_moe:
2025-08-26 22:10:01,957 | MRR: 0.0897
2025-08-26 22:10:01,958 | HR @1|5|10: 0.0706 	 0.0992 	 0.1161 	
2025-08-26 22:10:01,958 | NDCG @5|10: 0.0862 	 0.0916
2025-08-26 22:10:01,958 | domain:Home
2025-08-26 22:10:01,959 | model_moe:
2025-08-26 22:10:01,959 | MRR: 0.0769
2025-08-26 22:10:01,959 | HR @1|5|10: 0.0612 	 0.0831 	 0.0963 	
2025-08-26 22:10:01,960 | NDCG @5|10: 0.0729 	 0.0771
2025-08-26 22:10:01,960 | 	avg_model_moe:
2025-08-26 22:10:01,960 | MRR: 0.0844
2025-08-26 22:10:01,960 | HR @1|5|10: 0.0679 	 0.0913 	 0.1059 	
2025-08-26 22:10:01,961 | NDCG @5|10: 0.0804 	 0.0851
2025-08-26 22:10:01,961 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:11:49,452 | Epoch 8/40 - client 2 -  Training Loss: 10.763

 33%|###3      | 1/3 [01:45<03:30, 105.18s/it]2025-08-26 22:12:10,324 | Epoch 8/40 - client 1 -  Training Loss: 8.683

 67%|######6   | 2/3 [02:06<00:55, 55.59s/it] 2025-08-26 22:15:11,239 | Epoch 8/40 - client 0 -  Training Loss: 11.281

100%|##########| 3/3 [05:06<00:00, 112.82s/it]
100%|##########| 3/3 [05:06<00:00, 102.32s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.75s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.26s/it]
100%|##########| 3/3 [00:18<00:00,  5.84s/it]
100%|##########| 3/3 [00:18<00:00,  6.13s/it]
2025-08-26 22:15:29,652 | Epoch8 Valid:
2025-08-26 22:15:29,652 | domain:Sports
2025-08-26 22:15:29,652 | model_moe:
2025-08-26 22:15:29,653 | MRR: 0.0867
2025-08-26 22:15:29,653 | HR @1|5|10: 0.0711 	 0.0921 	 0.1066 	
2025-08-26 22:15:29,653 | NDCG @5|10: 0.0821 	 0.0868
2025-08-26 22:15:29,654 | domain:Garden
2025-08-26 22:15:29,654 | model_moe:
2025-08-26 22:15:29,654 | MRR: 0.0892
2025-08-26 22:15:29,654 | HR @1|5|10: 0.0693 	 0.1005 	 0.1158 	
2025-08-26 22:15:29,655 | NDCG @5|10: 0.0862 	 0.0911
2025-08-26 22:15:29,655 | domain:Home
2025-08-26 22:15:29,655 | model_moe:
2025-08-26 22:15:29,656 | MRR: 0.0763
2025-08-26 22:15:29,656 | HR @1|5|10: 0.0603 	 0.0836 	 0.0965 	
2025-08-26 22:15:29,656 | NDCG @5|10: 0.0727 	 0.0768
2025-08-26 22:15:29,656 | 	avg_model_moe:
2025-08-26 22:15:29,657 | MRR: 0.0841
2025-08-26 22:15:29,657 | HR @1|5|10: 0.0669 	 0.0921 	 0.1063 	
2025-08-26 22:15:29,657 | NDCG @5|10: 0.0804 	 0.0849
2025-08-26 22:15:29,657 | Early Stopping counter: 1 out of 10

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:15:50,418 | Epoch 9/40 - client 1 -  Training Loss: 8.050

 33%|###3      | 1/3 [00:20<00:41, 20.76s/it]2025-08-26 22:17:35,520 | Epoch 9/40 - client 2 -  Training Loss: 10.087

 67%|######6   | 2/3 [02:05<01:10, 70.37s/it]2025-08-26 22:20:36,410 | Epoch 9/40 - client 0 -  Training Loss: 10.578

100%|##########| 3/3 [05:06<00:00, 120.84s/it]
100%|##########| 3/3 [05:06<00:00, 102.25s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.52s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.16s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.04s/it]
2025-08-26 22:20:54,557 | Epoch9 Valid:
2025-08-26 22:20:54,557 | domain:Sports
2025-08-26 22:20:54,557 | model_moe:
2025-08-26 22:20:54,558 | MRR: 0.0867
2025-08-26 22:20:54,558 | HR @1|5|10: 0.0707 	 0.0924 	 0.1079 	
2025-08-26 22:20:54,558 | NDCG @5|10: 0.0822 	 0.0871
2025-08-26 22:20:54,559 | domain:Garden
2025-08-26 22:20:54,559 | model_moe:
2025-08-26 22:20:54,559 | MRR: 0.0904
2025-08-26 22:20:54,559 | HR @1|5|10: 0.0709 	 0.1015 	 0.1197 	
2025-08-26 22:20:54,560 | NDCG @5|10: 0.0873 	 0.0930
2025-08-26 22:20:54,560 | domain:Home
2025-08-26 22:20:54,560 | model_moe:
2025-08-26 22:20:54,561 | MRR: 0.0759
2025-08-26 22:20:54,561 | HR @1|5|10: 0.0599 	 0.0828 	 0.0947 	
2025-08-26 22:20:54,561 | NDCG @5|10: 0.0722 	 0.0760
2025-08-26 22:20:54,562 | 	avg_model_moe:
2025-08-26 22:20:54,562 | MRR: 0.0843
2025-08-26 22:20:54,562 | HR @1|5|10: 0.0672 	 0.0922 	 0.1074 	
2025-08-26 22:20:54,562 | NDCG @5|10: 0.0805 	 0.0854
2025-08-26 22:20:54,563 | Early Stopping counter: 2 out of 10

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:22:39,702 | Epoch 10/40 - client 2 -  Training Loss: 9.482

 33%|###3      | 1/3 [01:45<03:30, 105.15s/it]2025-08-26 22:23:00,558 | Epoch 10/40 - client 1 -  Training Loss: 7.536

 67%|######6   | 2/3 [02:05<00:55, 55.56s/it] 2025-08-26 22:26:01,575 | Epoch 10/40 - client 0 -  Training Loss: 9.960

100%|##########| 3/3 [05:07<00:00, 112.85s/it]
100%|##########| 3/3 [05:07<00:00, 102.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.51s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.16s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.05s/it]
2025-08-26 22:26:19,735 | Epoch10 Valid:
2025-08-26 22:26:19,736 | domain:Sports
2025-08-26 22:26:19,736 | model_moe:
2025-08-26 22:26:19,736 | MRR: 0.0861
2025-08-26 22:26:19,736 | HR @1|5|10: 0.0694 	 0.0933 	 0.1082 	
2025-08-26 22:26:19,737 | NDCG @5|10: 0.0819 	 0.0867
2025-08-26 22:26:19,738 | domain:Garden
2025-08-26 22:26:19,738 | model_moe:
2025-08-26 22:26:19,739 | MRR: 0.0902
2025-08-26 22:26:19,739 | HR @1|5|10: 0.0699 	 0.1008 	 0.1191 	
2025-08-26 22:26:19,739 | NDCG @5|10: 0.0867 	 0.0925
2025-08-26 22:26:19,740 | domain:Home
2025-08-26 22:26:19,740 | model_moe:
2025-08-26 22:26:19,740 | MRR: 0.0758
2025-08-26 22:26:19,741 | HR @1|5|10: 0.0597 	 0.0826 	 0.0950 	
2025-08-26 22:26:19,741 | NDCG @5|10: 0.0720 	 0.0760
2025-08-26 22:26:19,741 | 	avg_model_moe:
2025-08-26 22:26:19,741 | MRR: 0.0840
2025-08-26 22:26:19,742 | HR @1|5|10: 0.0663 	 0.0923 	 0.1074 	
2025-08-26 22:26:19,742 | NDCG @5|10: 0.0802 	 0.0851
2025-08-26 22:26:19,742 | Early Stopping counter: 3 out of 10

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:29:20,488 | Epoch 11/40 - client 0 -  Training Loss: 9.411

 33%|###3      | 1/3 [03:00<06:01, 180.75s/it]2025-08-26 22:29:41,070 | Epoch 11/40 - client 1 -  Training Loss: 7.094

 67%|######6   | 2/3 [03:21<01:26, 86.53s/it] 2025-08-26 22:31:25,843 | Epoch 11/40 - client 2 -  Training Loss: 8.963

100%|##########| 3/3 [05:06<00:00, 94.86s/it]
100%|##########| 3/3 [05:06<00:00, 102.03s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.49s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.17s/it]
100%|##########| 3/3 [00:18<00:00,  5.88s/it]
100%|##########| 3/3 [00:18<00:00,  6.12s/it]
2025-08-26 22:31:44,229 | Epoch11 Valid:
2025-08-26 22:31:44,229 | domain:Sports
2025-08-26 22:31:44,232 | model_moe:
2025-08-26 22:31:44,232 | MRR: 0.0861
2025-08-26 22:31:44,232 | HR @1|5|10: 0.0694 	 0.0930 	 0.1074 	
2025-08-26 22:31:44,233 | NDCG @5|10: 0.0818 	 0.0864
2025-08-26 22:31:44,233 | domain:Garden
2025-08-26 22:31:44,233 | model_moe:
2025-08-26 22:31:44,234 | MRR: 0.0887
2025-08-26 22:31:44,235 | HR @1|5|10: 0.0683 	 0.1012 	 0.1184 	
2025-08-26 22:31:44,235 | NDCG @5|10: 0.0857 	 0.0911
2025-08-26 22:31:44,236 | domain:Home
2025-08-26 22:31:44,236 | model_moe:
2025-08-26 22:31:44,236 | MRR: 0.0761
2025-08-26 22:31:44,236 | HR @1|5|10: 0.0601 	 0.0834 	 0.0956 	
2025-08-26 22:31:44,237 | NDCG @5|10: 0.0725 	 0.0764
2025-08-26 22:31:44,237 | 	avg_model_moe:
2025-08-26 22:31:44,237 | MRR: 0.0836
2025-08-26 22:31:44,238 | HR @1|5|10: 0.0659 	 0.0925 	 0.1071 	
2025-08-26 22:31:44,238 | NDCG @5|10: 0.0800 	 0.0847
2025-08-26 22:31:44,238 | Early Stopping counter: 4 out of 10
2025-08-26 22:31:44,239 | Learning rate decay counter: 1 out of 1
2025-08-26 22:31:44,239 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:32:04,901 | Epoch 12/40 - client 1 -  Training Loss: 6.718

 33%|###3      | 1/3 [00:20<00:41, 20.66s/it]2025-08-26 22:33:49,626 | Epoch 12/40 - client 2 -  Training Loss: 8.479

 67%|######6   | 2/3 [02:05<01:10, 70.11s/it]2025-08-26 22:36:49,538 | Epoch 12/40 - client 0 -  Training Loss: 8.912

100%|##########| 3/3 [05:05<00:00, 120.25s/it]
100%|##########| 3/3 [05:05<00:00, 101.77s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.67s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.21s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.07s/it]
2025-08-26 22:37:07,769 | Epoch12 Valid:
2025-08-26 22:37:07,769 | domain:Sports
2025-08-26 22:37:07,770 | model_moe:
2025-08-26 22:37:07,770 | MRR: 0.0864
2025-08-26 22:37:07,771 | HR @1|5|10: 0.0694 	 0.0938 	 0.1089 	
2025-08-26 22:37:07,772 | NDCG @5|10: 0.0821 	 0.0870
2025-08-26 22:37:07,772 | domain:Garden
2025-08-26 22:37:07,772 | model_moe:
2025-08-26 22:37:07,773 | MRR: 0.0884
2025-08-26 22:37:07,773 | HR @1|5|10: 0.0683 	 0.1008 	 0.1174 	
2025-08-26 22:37:07,773 | NDCG @5|10: 0.0853 	 0.0906
2025-08-26 22:37:07,774 | domain:Home
2025-08-26 22:37:07,774 | model_moe:
2025-08-26 22:37:07,774 | MRR: 0.0754
2025-08-26 22:37:07,774 | HR @1|5|10: 0.0591 	 0.0827 	 0.0951 	
2025-08-26 22:37:07,775 | NDCG @5|10: 0.0718 	 0.0758
2025-08-26 22:37:07,775 | 	avg_model_moe:
2025-08-26 22:37:07,775 | MRR: 0.0834
2025-08-26 22:37:07,777 | HR @1|5|10: 0.0656 	 0.0925 	 0.1072 	
2025-08-26 22:37:07,777 | NDCG @5|10: 0.0798 	 0.0845
2025-08-26 22:37:07,777 | Early Stopping counter: 5 out of 10
2025-08-26 22:37:07,777 | Learning rate decay counter: 1 out of 1
2025-08-26 22:37:07,778 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:40:07,671 | Epoch 13/40 - client 0 -  Training Loss: 8.464

 33%|###3      | 1/3 [02:59<05:59, 179.89s/it]2025-08-26 22:40:28,381 | Epoch 13/40 - client 1 -  Training Loss: 6.396

 67%|######6   | 2/3 [03:20<01:26, 86.26s/it] 2025-08-26 22:42:13,447 | Epoch 13/40 - client 2 -  Training Loss: 8.057

100%|##########| 3/3 [05:05<00:00, 94.85s/it]
100%|##########| 3/3 [05:05<00:00, 101.89s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.46s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.12s/it]
100%|##########| 3/3 [00:18<00:00,  5.74s/it]
100%|##########| 3/3 [00:18<00:00,  6.01s/it]
2025-08-26 22:42:31,479 | Epoch13 Valid:
2025-08-26 22:42:31,479 | domain:Sports
2025-08-26 22:42:31,479 | model_moe:
2025-08-26 22:42:31,480 | MRR: 0.0860
2025-08-26 22:42:31,480 | HR @1|5|10: 0.0684 	 0.0940 	 0.1091 	
2025-08-26 22:42:31,480 | NDCG @5|10: 0.0819 	 0.0867
2025-08-26 22:42:31,481 | domain:Garden
2025-08-26 22:42:31,481 | model_moe:
2025-08-26 22:42:31,481 | MRR: 0.0879
2025-08-26 22:42:31,482 | HR @1|5|10: 0.0670 	 0.0982 	 0.1174 	
2025-08-26 22:42:31,482 | NDCG @5|10: 0.0839 	 0.0901
2025-08-26 22:42:31,482 | domain:Home
2025-08-26 22:42:31,483 | model_moe:
2025-08-26 22:42:31,483 | MRR: 0.0751
2025-08-26 22:42:31,483 | HR @1|5|10: 0.0591 	 0.0810 	 0.0939 	
2025-08-26 22:42:31,483 | NDCG @5|10: 0.0711 	 0.0752
2025-08-26 22:42:31,484 | 	avg_model_moe:
2025-08-26 22:42:31,484 | MRR: 0.0830
2025-08-26 22:42:31,484 | HR @1|5|10: 0.0648 	 0.0911 	 0.1068 	
2025-08-26 22:42:31,485 | NDCG @5|10: 0.0789 	 0.0840
2025-08-26 22:42:31,485 | Early Stopping counter: 6 out of 10
2025-08-26 22:42:31,485 | Learning rate decay counter: 1 out of 1
2025-08-26 22:42:31,485 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:45:31,294 | Epoch 14/40 - client 0 -  Training Loss: 8.066

 33%|###3      | 1/3 [02:59<05:59, 179.81s/it]2025-08-26 22:47:15,711 | Epoch 14/40 - client 2 -  Training Loss: 7.668

 67%|######6   | 2/3 [04:44<02:15, 135.46s/it]2025-08-26 22:47:36,158 | Epoch 14/40 - client 1 -  Training Loss: 6.104

100%|##########| 3/3 [05:04<00:00, 82.94s/it] 
100%|##########| 3/3 [05:04<00:00, 101.56s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.40s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.08s/it]
100%|##########| 3/3 [00:17<00:00,  5.69s/it]
100%|##########| 3/3 [00:17<00:00,  5.96s/it]
2025-08-26 22:47:54,053 | Epoch14 Valid:
2025-08-26 22:47:54,054 | domain:Sports
2025-08-26 22:47:54,054 | model_moe:
2025-08-26 22:47:54,054 | MRR: 0.0864
2025-08-26 22:47:54,055 | HR @1|5|10: 0.0687 	 0.0946 	 0.1096 	
2025-08-26 22:47:54,055 | NDCG @5|10: 0.0823 	 0.0871
2025-08-26 22:47:54,055 | domain:Garden
2025-08-26 22:47:54,056 | model_moe:
2025-08-26 22:47:54,056 | MRR: 0.0876
2025-08-26 22:47:54,056 | HR @1|5|10: 0.0667 	 0.0995 	 0.1152 	
2025-08-26 22:47:54,057 | NDCG @5|10: 0.0842 	 0.0893
2025-08-26 22:47:54,057 | domain:Home
2025-08-26 22:47:54,057 | model_moe:
2025-08-26 22:47:54,058 | MRR: 0.0742
2025-08-26 22:47:54,058 | HR @1|5|10: 0.0574 	 0.0825 	 0.0939 	
2025-08-26 22:47:54,058 | NDCG @5|10: 0.0709 	 0.0745
2025-08-26 22:47:54,058 | 	avg_model_moe:
2025-08-26 22:47:54,059 | MRR: 0.0827
2025-08-26 22:47:54,059 | HR @1|5|10: 0.0642 	 0.0922 	 0.1062 	
2025-08-26 22:47:54,059 | NDCG @5|10: 0.0791 	 0.0836
2025-08-26 22:47:54,060 | Early Stopping counter: 7 out of 10
2025-08-26 22:47:54,060 | Learning rate decay counter: 1 out of 1
2025-08-26 22:47:54,060 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:50:54,022 | Epoch 15/40 - client 0 -  Training Loss: 7.695

 33%|###3      | 1/3 [02:59<05:59, 179.96s/it]2025-08-26 22:52:38,594 | Epoch 15/40 - client 2 -  Training Loss: 7.322

 67%|######6   | 2/3 [04:44<02:15, 135.62s/it]2025-08-26 22:52:59,268 | Epoch 15/40 - client 1 -  Training Loss: 5.845

100%|##########| 3/3 [05:05<00:00, 83.13s/it] 
100%|##########| 3/3 [05:05<00:00, 101.74s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.49s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.12s/it]
100%|##########| 3/3 [00:18<00:00,  5.73s/it]
100%|##########| 3/3 [00:18<00:00,  6.00s/it]
2025-08-26 22:53:17,287 | Epoch15 Valid:
2025-08-26 22:53:17,288 | domain:Sports
2025-08-26 22:53:17,288 | model_moe:
2025-08-26 22:53:17,288 | MRR: 0.0857
2025-08-26 22:53:17,289 | HR @1|5|10: 0.0677 	 0.0937 	 0.1086 	
2025-08-26 22:53:17,289 | NDCG @5|10: 0.0815 	 0.0863
2025-08-26 22:53:17,289 | domain:Garden
2025-08-26 22:53:17,290 | model_moe:
2025-08-26 22:53:17,290 | MRR: 0.0879
2025-08-26 22:53:17,290 | HR @1|5|10: 0.0670 	 0.1002 	 0.1197 	
2025-08-26 22:53:17,290 | NDCG @5|10: 0.0846 	 0.0907
2025-08-26 22:53:17,291 | domain:Home
2025-08-26 22:53:17,291 | model_moe:
2025-08-26 22:53:17,291 | MRR: 0.0728
2025-08-26 22:53:17,291 | HR @1|5|10: 0.0557 	 0.0809 	 0.0934 	
2025-08-26 22:53:17,292 | NDCG @5|10: 0.0693 	 0.0734
2025-08-26 22:53:17,292 | 	avg_model_moe:
2025-08-26 22:53:17,292 | MRR: 0.0822
2025-08-26 22:53:17,293 | HR @1|5|10: 0.0635 	 0.0916 	 0.1072 	
2025-08-26 22:53:17,293 | NDCG @5|10: 0.0785 	 0.0835
2025-08-26 22:53:17,293 | Early Stopping counter: 8 out of 10
2025-08-26 22:53:17,293 | Learning rate decay counter: 1 out of 1
2025-08-26 22:53:17,294 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:53:37,933 | Epoch 16/40 - client 1 -  Training Loss: 5.604

 33%|###3      | 1/3 [00:20<00:41, 20.64s/it]2025-08-26 22:56:38,223 | Epoch 16/40 - client 0 -  Training Loss: 7.348

 67%|######6   | 2/3 [03:20<01:54, 114.55s/it]2025-08-26 22:58:23,511 | Epoch 16/40 - client 2 -  Training Loss: 6.990

100%|##########| 3/3 [05:06<00:00, 110.32s/it]
100%|##########| 3/3 [05:06<00:00, 102.07s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.67s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.31s/it]
100%|##########| 3/3 [00:18<00:00,  5.92s/it]
100%|##########| 3/3 [00:18<00:00,  6.19s/it]
2025-08-26 22:58:42,103 | Epoch16 Valid:
2025-08-26 22:58:42,104 | domain:Sports
2025-08-26 22:58:42,104 | model_moe:
2025-08-26 22:58:42,104 | MRR: 0.0852
2025-08-26 22:58:42,105 | HR @1|5|10: 0.0668 	 0.0941 	 0.1092 	
2025-08-26 22:58:42,105 | NDCG @5|10: 0.0811 	 0.0860
2025-08-26 22:58:42,105 | domain:Garden
2025-08-26 22:58:42,105 | model_moe:
2025-08-26 22:58:42,106 | MRR: 0.0870
2025-08-26 22:58:42,106 | HR @1|5|10: 0.0654 	 0.0992 	 0.1207 	
2025-08-26 22:58:42,106 | NDCG @5|10: 0.0835 	 0.0903
2025-08-26 22:58:42,107 | domain:Home
2025-08-26 22:58:42,107 | model_moe:
2025-08-26 22:58:42,107 | MRR: 0.0726
2025-08-26 22:58:42,107 | HR @1|5|10: 0.0556 	 0.0817 	 0.0942 	
2025-08-26 22:58:42,108 | NDCG @5|10: 0.0695 	 0.0735
2025-08-26 22:58:42,108 | 	avg_model_moe:
2025-08-26 22:58:42,108 | MRR: 0.0816
2025-08-26 22:58:42,109 | HR @1|5|10: 0.0626 	 0.0917 	 0.1080 	
2025-08-26 22:58:42,109 | NDCG @5|10: 0.0780 	 0.0832
2025-08-26 22:58:42,109 | Early Stopping counter: 9 out of 10
2025-08-26 22:58:42,109 | Learning rate decay counter: 1 out of 1
2025-08-26 22:58:42,110 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-26 22:59:03,212 | Epoch 17/40 - client 1 -  Training Loss: 5.401

 33%|###3      | 1/3 [00:21<00:42, 21.10s/it]2025-08-26 23:02:03,855 | Epoch 17/40 - client 0 -  Training Loss: 7.049

 67%|######6   | 2/3 [03:21<01:54, 114.95s/it]2025-08-26 23:03:49,063 | Epoch 17/40 - client 2 -  Training Loss: 6.709

100%|##########| 3/3 [05:06<00:00, 110.50s/it]
100%|##########| 3/3 [05:06<00:00, 102.32s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.68s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.31s/it]
100%|##########| 3/3 [00:18<00:00,  5.93s/it]
100%|##########| 3/3 [00:18<00:00,  6.20s/it]
2025-08-26 23:04:07,676 | Epoch17 Valid:
2025-08-26 23:04:07,677 | domain:Sports
2025-08-26 23:04:07,677 | model_moe:
2025-08-26 23:04:07,677 | MRR: 0.0847
2025-08-26 23:04:07,677 | HR @1|5|10: 0.0660 	 0.0938 	 0.1094 	
2025-08-26 23:04:07,678 | NDCG @5|10: 0.0806 	 0.0856
2025-08-26 23:04:07,678 | domain:Garden
2025-08-26 23:04:07,678 | model_moe:
2025-08-26 23:04:07,679 | MRR: 0.0865
2025-08-26 23:04:07,679 | HR @1|5|10: 0.0651 	 0.0999 	 0.1184 	
2025-08-26 23:04:07,679 | NDCG @5|10: 0.0833 	 0.0893
2025-08-26 23:04:07,679 | domain:Home
2025-08-26 23:04:07,680 | model_moe:
2025-08-26 23:04:07,680 | MRR: 0.0719
2025-08-26 23:04:07,680 | HR @1|5|10: 0.0549 	 0.0798 	 0.0939 	
2025-08-26 23:04:07,681 | NDCG @5|10: 0.0683 	 0.0728
2025-08-26 23:04:07,681 | 	avg_model_moe:
2025-08-26 23:04:07,681 | MRR: 0.0810
2025-08-26 23:04:07,681 | HR @1|5|10: 0.0620 	 0.0912 	 0.1072 	
2025-08-26 23:04:07,682 | NDCG @5|10: 0.0774 	 0.0826
2025-08-26 23:04:07,682 | Early Stopping counter: 10 out of 10
2025-08-26 23:04:07,682 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:14<00:29, 14.90s/it]
 67%|######6   | 2/3 [00:18<00:08,  8.46s/it]
100%|##########| 3/3 [00:29<00:00,  9.39s/it]
100%|##########| 3/3 [00:29<00:00,  9.79s/it]
2025-08-26 23:04:37,045 | Test:
2025-08-26 23:04:37,046 | domain:Sports
2025-08-26 23:04:37,046 | model_moe:
2025-08-26 23:04:37,047 | MRR: 0.0645
2025-08-26 23:04:37,047 | HR @1|5|10: 0.0510 	 0.0706 	 0.0810 	
2025-08-26 23:04:37,047 | NDCG @5|10: 0.0612 	 0.0645
2025-08-26 23:04:37,048 | domain:Garden
2025-08-26 23:04:37,048 | model_moe:
2025-08-26 23:04:37,048 | MRR: 0.0757
2025-08-26 23:04:37,049 | HR @1|5|10: 0.0623 	 0.0797 	 0.0951 	
2025-08-26 23:04:37,049 | NDCG @5|10: 0.0715 	 0.0764
2025-08-26 23:04:37,049 | domain:Home
2025-08-26 23:04:37,049 | model_moe:
2025-08-26 23:04:37,050 | MRR: 0.0573
2025-08-26 23:04:37,050 | HR @1|5|10: 0.0440 	 0.0632 	 0.0728 	
2025-08-26 23:04:37,050 | NDCG @5|10: 0.0542 	 0.0572
2025-08-26 23:04:37,051 | 	avg_model_moe:
2025-08-26 23:04:37,051 | MRR: 0.0658
2025-08-26 23:04:37,051 | HR @1|5|10: 0.0525 	 0.0712 	 0.0830 	
2025-08-26 23:04:37,052 | NDCG @5|10: 0.0623 	 0.0661
