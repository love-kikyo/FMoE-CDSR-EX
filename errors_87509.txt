gate_loss + new gate_input (num_domains)
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-28 00:58:35,045 | Running with the following configs:
	domains : ['Food', 'Kitchen', 'Clothing', 'Beauty']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 60
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 10
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 1.0
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/4 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-28 00:59:17,954 | Epoch 1/60 - client 1 -  Training Loss: 48.818

 25%|##5       | 1/4 [00:42<02:08, 42.90s/it]2025-08-28 00:59:30,466 | Epoch 1/60 - client 0 -  Training Loss: 44.551

 50%|#####     | 2/4 [00:55<00:50, 25.02s/it]2025-08-28 00:59:48,742 | Epoch 1/60 - client 2 -  Training Loss: 50.644

 75%|#######5  | 3/4 [01:13<00:21, 21.94s/it]2025-08-28 01:00:00,898 | Epoch 1/60 - client 3 -  Training Loss: 50.215

100%|##########| 4/4 [01:25<00:00, 18.08s/it]
100%|##########| 4/4 [01:25<00:00, 21.46s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.04it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.35s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.06s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:00:04,882 | Epoch1 Valid:
2025-08-28 01:00:04,882 | domain:Food
2025-08-28 01:00:04,882 | model_moe:
2025-08-28 01:00:04,883 | MRR: 0.2781
2025-08-28 01:00:04,883 | HR @1|5|10: 0.1852 	 0.3925 	 0.4744 	
2025-08-28 01:00:04,883 | NDCG @5|10: 0.2928 	 0.3194
2025-08-28 01:00:04,884 | domain:Kitchen
2025-08-28 01:00:04,884 | model_moe:
2025-08-28 01:00:04,884 | MRR: 0.0457
2025-08-28 01:00:04,886 | HR @1|5|10: 0.0212 	 0.0571 	 0.0843 	
2025-08-28 01:00:04,886 | NDCG @5|10: 0.0383 	 0.0471
2025-08-28 01:00:04,887 | domain:Clothing
2025-08-28 01:00:04,887 | model_moe:
2025-08-28 01:00:04,888 | MRR: 0.0173
2025-08-28 01:00:04,888 | HR @1|5|10: 0.0061 	 0.0183 	 0.0293 	
2025-08-28 01:00:04,888 | NDCG @5|10: 0.0124 	 0.0159
2025-08-28 01:00:04,889 | domain:Beauty
2025-08-28 01:00:04,889 | model_moe:
2025-08-28 01:00:04,889 | MRR: 0.1407
2025-08-28 01:00:04,889 | HR @1|5|10: 0.0837 	 0.1938 	 0.2572 	
2025-08-28 01:00:04,890 | NDCG @5|10: 0.1405 	 0.1614
2025-08-28 01:00:04,890 | 	avg_model_moe:
2025-08-28 01:00:04,890 | MRR: 0.1205
2025-08-28 01:00:04,890 | HR @1|5|10: 0.0740 	 0.1654 	 0.2113 	
2025-08-28 01:00:04,891 | NDCG @5|10: 0.1210 	 0.1359
2025-08-28 01:00:04,891 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:00:24,982 | Epoch 2/60 - client 2 -  Training Loss: 48.583

 25%|##5       | 1/4 [00:18<00:54, 18.11s/it]2025-08-28 01:00:37,146 | Epoch 2/60 - client 3 -  Training Loss: 47.937

 50%|#####     | 2/4 [00:30<00:29, 14.61s/it]2025-08-28 01:01:10,686 | Epoch 2/60 - client 1 -  Training Loss: 48.067

 75%|#######5  | 3/4 [01:03<00:23, 23.25s/it]2025-08-28 01:01:23,161 | Epoch 2/60 - client 0 -  Training Loss: 42.553

100%|##########| 4/4 [01:16<00:00, 19.00s/it]
100%|##########| 4/4 [01:16<00:00, 19.07s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:01:27,127 | Epoch2 Valid:
2025-08-28 01:01:27,127 | domain:Food
2025-08-28 01:01:27,128 | model_moe:
2025-08-28 01:01:27,128 | MRR: 0.3079
2025-08-28 01:01:27,128 | HR @1|5|10: 0.2073 	 0.4369 	 0.5157 	
2025-08-28 01:01:27,129 | NDCG @5|10: 0.3277 	 0.3533
2025-08-28 01:01:27,129 | domain:Kitchen
2025-08-28 01:01:27,129 | model_moe:
2025-08-28 01:01:27,129 | MRR: 0.0674
2025-08-28 01:01:27,130 | HR @1|5|10: 0.0322 	 0.0838 	 0.1271 	
2025-08-28 01:01:27,130 | NDCG @5|10: 0.0586 	 0.0726
2025-08-28 01:01:27,130 | domain:Clothing
2025-08-28 01:01:27,131 | model_moe:
2025-08-28 01:01:27,131 | MRR: 0.0239
2025-08-28 01:01:27,131 | HR @1|5|10: 0.0110 	 0.0269 	 0.0403 	
2025-08-28 01:01:27,131 | NDCG @5|10: 0.0189 	 0.0234
2025-08-28 01:01:27,132 | domain:Beauty
2025-08-28 01:01:27,132 | model_moe:
2025-08-28 01:01:27,132 | MRR: 0.1874
2025-08-28 01:01:27,133 | HR @1|5|10: 0.1184 	 0.2679 	 0.3254 	
2025-08-28 01:01:27,133 | NDCG @5|10: 0.1952 	 0.2141
2025-08-28 01:01:27,133 | 	avg_model_moe:
2025-08-28 01:01:27,133 | MRR: 0.1466
2025-08-28 01:01:27,134 | HR @1|5|10: 0.0922 	 0.2039 	 0.2521 	
2025-08-28 01:01:27,134 | NDCG @5|10: 0.1501 	 0.1658
2025-08-28 01:01:27,134 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:01:47,113 | Epoch 3/60 - client 2 -  Training Loss: 46.748

 25%|##5       | 1/4 [00:18<00:54, 18.06s/it]2025-08-28 01:02:20,514 | Epoch 3/60 - client 1 -  Training Loss: 47.266

 50%|#####     | 2/4 [00:51<00:54, 27.08s/it]2025-08-28 01:02:32,907 | Epoch 3/60 - client 0 -  Training Loss: 41.217

 75%|#######5  | 3/4 [01:03<00:20, 20.37s/it]2025-08-28 01:02:45,006 | Epoch 3/60 - client 3 -  Training Loss: 46.188

100%|##########| 4/4 [01:15<00:00, 17.11s/it]
100%|##########| 4/4 [01:15<00:00, 18.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:02:48,943 | Epoch3 Valid:
2025-08-28 01:02:48,943 | domain:Food
2025-08-28 01:02:48,943 | model_moe:
2025-08-28 01:02:48,944 | MRR: 0.3192
2025-08-28 01:02:48,944 | HR @1|5|10: 0.2135 	 0.4545 	 0.5249 	
2025-08-28 01:02:48,944 | NDCG @5|10: 0.3410 	 0.3645
2025-08-28 01:02:48,945 | domain:Kitchen
2025-08-28 01:02:48,945 | model_moe:
2025-08-28 01:02:48,945 | MRR: 0.0742
2025-08-28 01:02:48,945 | HR @1|5|10: 0.0364 	 0.0898 	 0.1413 	
2025-08-28 01:02:48,946 | NDCG @5|10: 0.0648 	 0.0813
2025-08-28 01:02:48,946 | domain:Clothing
2025-08-28 01:02:48,946 | model_moe:
2025-08-28 01:02:48,947 | MRR: 0.0258
2025-08-28 01:02:48,947 | HR @1|5|10: 0.0159 	 0.0257 	 0.0367 	
2025-08-28 01:02:48,947 | NDCG @5|10: 0.0202 	 0.0237
2025-08-28 01:02:48,947 | domain:Beauty
2025-08-28 01:02:48,948 | model_moe:
2025-08-28 01:02:48,948 | MRR: 0.2107
2025-08-28 01:02:48,948 | HR @1|5|10: 0.1364 	 0.2955 	 0.3505 	
2025-08-28 01:02:48,949 | NDCG @5|10: 0.2206 	 0.2387
2025-08-28 01:02:48,949 | 	avg_model_moe:
2025-08-28 01:02:48,949 | MRR: 0.1575
2025-08-28 01:02:48,949 | HR @1|5|10: 0.1005 	 0.2163 	 0.2633 	
2025-08-28 01:02:48,950 | NDCG @5|10: 0.1617 	 0.1770
2025-08-28 01:02:48,950 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:03:09,020 | Epoch 4/60 - client 2 -  Training Loss: 45.252

 25%|##5       | 1/4 [00:18<00:54, 18.06s/it]2025-08-28 01:03:21,158 | Epoch 4/60 - client 3 -  Training Loss: 44.851

 50%|#####     | 2/4 [00:30<00:29, 14.58s/it]2025-08-28 01:03:33,609 | Epoch 4/60 - client 0 -  Training Loss: 40.221

 75%|#######5  | 3/4 [00:42<00:13, 13.61s/it]2025-08-28 01:04:07,122 | Epoch 4/60 - client 1 -  Training Loss: 46.328

100%|##########| 4/4 [01:16<00:00, 21.47s/it]
100%|##########| 4/4 [01:16<00:00, 19.04s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.06s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:04:11,095 | Epoch4 Valid:
2025-08-28 01:04:11,096 | domain:Food
2025-08-28 01:04:11,096 | model_moe:
2025-08-28 01:04:11,097 | MRR: 0.3291
2025-08-28 01:04:11,097 | HR @1|5|10: 0.2242 	 0.4621 	 0.5325 	
2025-08-28 01:04:11,097 | NDCG @5|10: 0.3509 	 0.3741
2025-08-28 01:04:11,097 | domain:Kitchen
2025-08-28 01:04:11,098 | model_moe:
2025-08-28 01:04:11,098 | MRR: 0.0815
2025-08-28 01:04:11,098 | HR @1|5|10: 0.0442 	 0.1050 	 0.1487 	
2025-08-28 01:04:11,098 | NDCG @5|10: 0.0747 	 0.0887
2025-08-28 01:04:11,099 | domain:Clothing
2025-08-28 01:04:11,099 | model_moe:
2025-08-28 01:04:11,099 | MRR: 0.0230
2025-08-28 01:04:11,100 | HR @1|5|10: 0.0110 	 0.0257 	 0.0342 	
2025-08-28 01:04:11,100 | NDCG @5|10: 0.0184 	 0.0211
2025-08-28 01:04:11,100 | domain:Beauty
2025-08-28 01:04:11,100 | model_moe:
2025-08-28 01:04:11,101 | MRR: 0.2203
2025-08-28 01:04:11,101 | HR @1|5|10: 0.1471 	 0.2978 	 0.3660 	
2025-08-28 01:04:11,101 | NDCG @5|10: 0.2274 	 0.2499
2025-08-28 01:04:11,102 | 	avg_model_moe:
2025-08-28 01:04:11,102 | MRR: 0.1635
2025-08-28 01:04:11,102 | HR @1|5|10: 0.1066 	 0.2227 	 0.2704 	
2025-08-28 01:04:11,102 | NDCG @5|10: 0.1679 	 0.1834
2025-08-28 01:04:11,103 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:04:25,314 | Epoch 5/60 - client 0 -  Training Loss: 39.411

 25%|##5       | 1/4 [00:12<00:37, 12.41s/it]2025-08-28 01:04:43,373 | Epoch 5/60 - client 2 -  Training Loss: 43.920

 50%|#####     | 2/4 [00:30<00:31, 15.73s/it]2025-08-28 01:05:16,727 | Epoch 5/60 - client 1 -  Training Loss: 45.337

 75%|#######5  | 3/4 [01:03<00:23, 23.78s/it]2025-08-28 01:05:28,894 | Epoch 5/60 - client 3 -  Training Loss: 43.783

100%|##########| 4/4 [01:15<00:00, 19.20s/it]
100%|##########| 4/4 [01:15<00:00, 19.00s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:05:32,851 | Epoch5 Valid:
2025-08-28 01:05:32,852 | domain:Food
2025-08-28 01:05:32,852 | model_moe:
2025-08-28 01:05:32,853 | MRR: 0.3320
2025-08-28 01:05:32,853 | HR @1|5|10: 0.2303 	 0.4606 	 0.5287 	
2025-08-28 01:05:32,853 | NDCG @5|10: 0.3523 	 0.3750
2025-08-28 01:05:32,853 | domain:Kitchen
2025-08-28 01:05:32,854 | model_moe:
2025-08-28 01:05:32,854 | MRR: 0.0860
2025-08-28 01:05:32,854 | HR @1|5|10: 0.0460 	 0.1114 	 0.1552 	
2025-08-28 01:05:32,855 | NDCG @5|10: 0.0796 	 0.0938
2025-08-28 01:05:32,855 | domain:Clothing
2025-08-28 01:05:32,855 | model_moe:
2025-08-28 01:05:32,855 | MRR: 0.0227
2025-08-28 01:05:32,856 | HR @1|5|10: 0.0110 	 0.0244 	 0.0342 	
2025-08-28 01:05:32,856 | NDCG @5|10: 0.0177 	 0.0208
2025-08-28 01:05:32,856 | domain:Beauty
2025-08-28 01:05:32,857 | model_moe:
2025-08-28 01:05:32,857 | MRR: 0.2287
2025-08-28 01:05:32,857 | HR @1|5|10: 0.1567 	 0.3134 	 0.3720 	
2025-08-28 01:05:32,857 | NDCG @5|10: 0.2382 	 0.2576
2025-08-28 01:05:32,858 | 	avg_model_moe:
2025-08-28 01:05:32,858 | MRR: 0.1674
2025-08-28 01:05:32,858 | HR @1|5|10: 0.1110 	 0.2275 	 0.2725 	
2025-08-28 01:05:32,859 | NDCG @5|10: 0.1719 	 0.1868
2025-08-28 01:05:32,859 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:06:08,583 | Epoch 6/60 - client 1 -  Training Loss: 44.314

 25%|##5       | 1/4 [00:33<01:40, 33.48s/it]2025-08-28 01:06:26,679 | Epoch 6/60 - client 2 -  Training Loss: 42.679

 50%|#####     | 2/4 [00:51<00:48, 24.43s/it]2025-08-28 01:06:39,111 | Epoch 6/60 - client 0 -  Training Loss: 38.673

 75%|#######5  | 3/4 [01:04<00:18, 18.95s/it]2025-08-28 01:06:51,246 | Epoch 6/60 - client 3 -  Training Loss: 42.779

100%|##########| 4/4 [01:16<00:00, 16.26s/it]
100%|##########| 4/4 [01:16<00:00, 19.04s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:06:55,187 | Epoch6 Valid:
2025-08-28 01:06:55,188 | domain:Food
2025-08-28 01:06:55,188 | model_moe:
2025-08-28 01:06:55,188 | MRR: 0.3351
2025-08-28 01:06:55,189 | HR @1|5|10: 0.2357 	 0.4637 	 0.5287 	
2025-08-28 01:06:55,189 | NDCG @5|10: 0.3560 	 0.3773
2025-08-28 01:06:55,189 | domain:Kitchen
2025-08-28 01:06:55,189 | model_moe:
2025-08-28 01:06:55,190 | MRR: 0.0889
2025-08-28 01:06:55,190 | HR @1|5|10: 0.0488 	 0.1188 	 0.1630 	
2025-08-28 01:06:55,190 | NDCG @5|10: 0.0840 	 0.0982
2025-08-28 01:06:55,191 | domain:Clothing
2025-08-28 01:06:55,191 | model_moe:
2025-08-28 01:06:55,191 | MRR: 0.0224
2025-08-28 01:06:55,191 | HR @1|5|10: 0.0098 	 0.0244 	 0.0318 	
2025-08-28 01:06:55,192 | NDCG @5|10: 0.0177 	 0.0200
2025-08-28 01:06:55,192 | domain:Beauty
2025-08-28 01:06:55,192 | model_moe:
2025-08-28 01:06:55,193 | MRR: 0.2292
2025-08-28 01:06:55,193 | HR @1|5|10: 0.1555 	 0.3278 	 0.3816 	
2025-08-28 01:06:55,193 | NDCG @5|10: 0.2433 	 0.2607
2025-08-28 01:06:55,193 | 	avg_model_moe:
2025-08-28 01:06:55,194 | MRR: 0.1689
2025-08-28 01:06:55,194 | HR @1|5|10: 0.1124 	 0.2337 	 0.2763 	
2025-08-28 01:06:55,194 | NDCG @5|10: 0.1753 	 0.1891
2025-08-28 01:06:55,194 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:07:09,713 | Epoch 7/60 - client 0 -  Training Loss: 37.992

 25%|##5       | 1/4 [00:12<00:37, 12.49s/it]2025-08-28 01:07:21,915 | Epoch 7/60 - client 3 -  Training Loss: 41.870

 50%|#####     | 2/4 [00:24<00:24, 12.32s/it]2025-08-28 01:07:40,057 | Epoch 7/60 - client 2 -  Training Loss: 41.494

 75%|#######5  | 3/4 [00:42<00:14, 14.98s/it]2025-08-28 01:08:13,629 | Epoch 7/60 - client 1 -  Training Loss: 43.259

100%|##########| 4/4 [01:16<00:00, 22.32s/it]
100%|##########| 4/4 [01:16<00:00, 19.10s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.06s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:08:17,601 | Epoch7 Valid:
2025-08-28 01:08:17,602 | domain:Food
2025-08-28 01:08:17,602 | model_moe:
2025-08-28 01:08:17,602 | MRR: 0.3337
2025-08-28 01:08:17,603 | HR @1|5|10: 0.2341 	 0.4637 	 0.5264 	
2025-08-28 01:08:17,603 | NDCG @5|10: 0.3549 	 0.3756
2025-08-28 01:08:17,603 | domain:Kitchen
2025-08-28 01:08:17,603 | model_moe:
2025-08-28 01:08:17,604 | MRR: 0.0946
2025-08-28 01:08:17,604 | HR @1|5|10: 0.0548 	 0.1271 	 0.1690 	
2025-08-28 01:08:17,604 | NDCG @5|10: 0.0907 	 0.1042
2025-08-28 01:08:17,605 | domain:Clothing
2025-08-28 01:08:17,605 | model_moe:
2025-08-28 01:08:17,605 | MRR: 0.0199
2025-08-28 01:08:17,606 | HR @1|5|10: 0.0073 	 0.0244 	 0.0306 	
2025-08-28 01:08:17,606 | NDCG @5|10: 0.0162 	 0.0182
2025-08-28 01:08:17,606 | domain:Beauty
2025-08-28 01:08:17,606 | model_moe:
2025-08-28 01:08:17,607 | MRR: 0.2344
2025-08-28 01:08:17,607 | HR @1|5|10: 0.1627 	 0.3278 	 0.3864 	
2025-08-28 01:08:17,607 | NDCG @5|10: 0.2470 	 0.2660
2025-08-28 01:08:17,608 | 	avg_model_moe:
2025-08-28 01:08:17,608 | MRR: 0.1706
2025-08-28 01:08:17,608 | HR @1|5|10: 0.1147 	 0.2357 	 0.2781 	
2025-08-28 01:08:17,608 | NDCG @5|10: 0.1772 	 0.1910
2025-08-28 01:08:17,609 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:08:32,739 | Epoch 8/60 - client 0 -  Training Loss: 37.403

 25%|##5       | 1/4 [00:12<00:37, 12.42s/it]2025-08-28 01:08:44,862 | Epoch 8/60 - client 3 -  Training Loss: 41.049

 50%|#####     | 2/4 [00:24<00:24, 12.24s/it]2025-08-28 01:09:18,203 | Epoch 8/60 - client 1 -  Training Loss: 42.309

 75%|#######5  | 3/4 [00:57<00:21, 21.88s/it]2025-08-28 01:09:36,294 | Epoch 8/60 - client 2 -  Training Loss: 40.429

100%|##########| 4/4 [01:15<00:00, 20.38s/it]
100%|##########| 4/4 [01:15<00:00, 18.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:09:40,252 | Epoch8 Valid:
2025-08-28 01:09:40,252 | domain:Food
2025-08-28 01:09:40,253 | model_moe:
2025-08-28 01:09:40,253 | MRR: 0.3317
2025-08-28 01:09:40,253 | HR @1|5|10: 0.2326 	 0.4614 	 0.5226 	
2025-08-28 01:09:40,254 | NDCG @5|10: 0.3530 	 0.3733
2025-08-28 01:09:40,254 | domain:Kitchen
2025-08-28 01:09:40,254 | model_moe:
2025-08-28 01:09:40,254 | MRR: 0.0934
2025-08-28 01:09:40,255 | HR @1|5|10: 0.0534 	 0.1243 	 0.1667 	
2025-08-28 01:09:40,256 | NDCG @5|10: 0.0893 	 0.1028
2025-08-28 01:09:40,257 | domain:Clothing
2025-08-28 01:09:40,257 | model_moe:
2025-08-28 01:09:40,257 | MRR: 0.0198
2025-08-28 01:09:40,258 | HR @1|5|10: 0.0086 	 0.0220 	 0.0306 	
2025-08-28 01:09:40,258 | NDCG @5|10: 0.0158 	 0.0185
2025-08-28 01:09:40,258 | domain:Beauty
2025-08-28 01:09:40,258 | model_moe:
2025-08-28 01:09:40,259 | MRR: 0.2366
2025-08-28 01:09:40,259 | HR @1|5|10: 0.1651 	 0.3325 	 0.3804 	
2025-08-28 01:09:40,259 | NDCG @5|10: 0.2506 	 0.2663
2025-08-28 01:09:40,260 | 	avg_model_moe:
2025-08-28 01:09:40,260 | MRR: 0.1704
2025-08-28 01:09:40,260 | HR @1|5|10: 0.1149 	 0.2351 	 0.2750 	
2025-08-28 01:09:40,261 | NDCG @5|10: 0.1771 	 0.1902
2025-08-28 01:09:40,261 | Early Stopping counter: 1 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:10:13,708 | Epoch 9/60 - client 1 -  Training Loss: 41.463

 25%|##5       | 1/4 [00:33<01:40, 33.45s/it]2025-08-28 01:10:31,796 | Epoch 9/60 - client 2 -  Training Loss: 39.443

 50%|#####     | 2/4 [00:51<00:48, 24.41s/it]2025-08-28 01:10:44,214 | Epoch 9/60 - client 0 -  Training Loss: 36.861

 75%|#######5  | 3/4 [01:03<00:18, 18.94s/it]2025-08-28 01:10:56,335 | Epoch 9/60 - client 3 -  Training Loss: 40.274

100%|##########| 4/4 [01:16<00:00, 16.25s/it]
100%|##########| 4/4 [01:16<00:00, 19.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:11:00,272 | Epoch9 Valid:
2025-08-28 01:11:00,272 | domain:Food
2025-08-28 01:11:00,272 | model_moe:
2025-08-28 01:11:00,273 | MRR: 0.3393
2025-08-28 01:11:00,273 | HR @1|5|10: 0.2433 	 0.4637 	 0.5256 	
2025-08-28 01:11:00,273 | NDCG @5|10: 0.3592 	 0.3797
2025-08-28 01:11:00,274 | domain:Kitchen
2025-08-28 01:11:00,274 | model_moe:
2025-08-28 01:11:00,274 | MRR: 0.0954
2025-08-28 01:11:00,275 | HR @1|5|10: 0.0552 	 0.1225 	 0.1699 	
2025-08-28 01:11:00,275 | NDCG @5|10: 0.0900 	 0.1053
2025-08-28 01:11:00,275 | domain:Clothing
2025-08-28 01:11:00,276 | model_moe:
2025-08-28 01:11:00,276 | MRR: 0.0191
2025-08-28 01:11:00,276 | HR @1|5|10: 0.0086 	 0.0220 	 0.0269 	
2025-08-28 01:11:00,276 | NDCG @5|10: 0.0156 	 0.0172
2025-08-28 01:11:00,277 | domain:Beauty
2025-08-28 01:11:00,277 | model_moe:
2025-08-28 01:11:00,277 | MRR: 0.2375
2025-08-28 01:11:00,278 | HR @1|5|10: 0.1639 	 0.3349 	 0.3816 	
2025-08-28 01:11:00,278 | NDCG @5|10: 0.2519 	 0.2673
2025-08-28 01:11:00,278 | 	avg_model_moe:
2025-08-28 01:11:00,279 | MRR: 0.1728
2025-08-28 01:11:00,279 | HR @1|5|10: 0.1177 	 0.2358 	 0.2760 	
2025-08-28 01:11:00,279 | NDCG @5|10: 0.1792 	 0.1924
2025-08-28 01:11:00,280 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:11:35,338 | Epoch 10/60 - client 1 -  Training Loss: 40.722

 25%|##5       | 1/4 [00:33<01:39, 33.13s/it]2025-08-28 01:11:47,607 | Epoch 10/60 - client 0 -  Training Loss: 36.341

 50%|#####     | 2/4 [00:45<00:41, 20.86s/it]2025-08-28 01:11:59,674 | Epoch 10/60 - client 3 -  Training Loss: 39.568

 75%|#######5  | 3/4 [00:57<00:16, 16.84s/it]2025-08-28 01:12:17,669 | Epoch 10/60 - client 2 -  Training Loss: 38.516

100%|##########| 4/4 [01:15<00:00, 17.30s/it]
100%|##########| 4/4 [01:15<00:00, 18.87s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:12:21,600 | Epoch10 Valid:
2025-08-28 01:12:21,600 | domain:Food
2025-08-28 01:12:21,601 | model_moe:
2025-08-28 01:12:21,601 | MRR: 0.3376
2025-08-28 01:12:21,601 | HR @1|5|10: 0.2395 	 0.4667 	 0.5279 	
2025-08-28 01:12:21,602 | NDCG @5|10: 0.3591 	 0.3793
2025-08-28 01:12:21,602 | domain:Kitchen
2025-08-28 01:12:21,602 | model_moe:
2025-08-28 01:12:21,603 | MRR: 0.0952
2025-08-28 01:12:21,603 | HR @1|5|10: 0.0552 	 0.1248 	 0.1653 	
2025-08-28 01:12:21,603 | NDCG @5|10: 0.0907 	 0.1039
2025-08-28 01:12:21,603 | domain:Clothing
2025-08-28 01:12:21,604 | model_moe:
2025-08-28 01:12:21,604 | MRR: 0.0200
2025-08-28 01:12:21,606 | HR @1|5|10: 0.0098 	 0.0220 	 0.0269 	
2025-08-28 01:12:21,606 | NDCG @5|10: 0.0161 	 0.0178
2025-08-28 01:12:21,606 | domain:Beauty
2025-08-28 01:12:21,607 | model_moe:
2025-08-28 01:12:21,607 | MRR: 0.2394
2025-08-28 01:12:21,607 | HR @1|5|10: 0.1651 	 0.3301 	 0.3876 	
2025-08-28 01:12:21,607 | NDCG @5|10: 0.2513 	 0.2702
2025-08-28 01:12:21,608 | 	avg_model_moe:
2025-08-28 01:12:21,608 | MRR: 0.1730
2025-08-28 01:12:21,608 | HR @1|5|10: 0.1174 	 0.2359 	 0.2769 	
2025-08-28 01:12:21,609 | NDCG @5|10: 0.1793 	 0.1928
2025-08-28 01:12:21,609 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:12:36,156 | Epoch 11/60 - client 0 -  Training Loss: 35.847

 25%|##5       | 1/4 [00:12<00:37, 12.45s/it]2025-08-28 01:12:48,275 | Epoch 11/60 - client 3 -  Training Loss: 38.887

 50%|#####     | 2/4 [00:24<00:24, 12.26s/it]2025-08-28 01:13:06,340 | Epoch 11/60 - client 2 -  Training Loss: 37.644

 75%|#######5  | 3/4 [00:42<00:14, 14.91s/it]2025-08-28 01:13:39,673 | Epoch 11/60 - client 1 -  Training Loss: 40.036

100%|##########| 4/4 [01:15<00:00, 22.18s/it]
100%|##########| 4/4 [01:15<00:00, 18.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:13:43,642 | Epoch11 Valid:
2025-08-28 01:13:43,642 | domain:Food
2025-08-28 01:13:43,643 | model_moe:
2025-08-28 01:13:43,643 | MRR: 0.3412
2025-08-28 01:13:43,643 | HR @1|5|10: 0.2425 	 0.4682 	 0.5295 	
2025-08-28 01:13:43,644 | NDCG @5|10: 0.3623 	 0.3825
2025-08-28 01:13:43,645 | domain:Kitchen
2025-08-28 01:13:43,645 | model_moe:
2025-08-28 01:13:43,646 | MRR: 0.0970
2025-08-28 01:13:43,646 | HR @1|5|10: 0.0543 	 0.1298 	 0.1731 	
2025-08-28 01:13:43,646 | NDCG @5|10: 0.0932 	 0.1072
2025-08-28 01:13:43,646 | domain:Clothing
2025-08-28 01:13:43,647 | model_moe:
2025-08-28 01:13:43,647 | MRR: 0.0202
2025-08-28 01:13:43,647 | HR @1|5|10: 0.0098 	 0.0196 	 0.0330 	
2025-08-28 01:13:43,648 | NDCG @5|10: 0.0152 	 0.0193
2025-08-28 01:13:43,648 | domain:Beauty
2025-08-28 01:13:43,648 | model_moe:
2025-08-28 01:13:43,648 | MRR: 0.2408
2025-08-28 01:13:43,649 | HR @1|5|10: 0.1663 	 0.3385 	 0.3900 	
2025-08-28 01:13:43,649 | NDCG @5|10: 0.2551 	 0.2718
2025-08-28 01:13:43,649 | 	avg_model_moe:
2025-08-28 01:13:43,650 | MRR: 0.1748
2025-08-28 01:13:43,650 | HR @1|5|10: 0.1182 	 0.2390 	 0.2814 	
2025-08-28 01:13:43,650 | NDCG @5|10: 0.1814 	 0.1952
2025-08-28 01:13:43,650 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:13:57,921 | Epoch 12/60 - client 3 -  Training Loss: 38.248

 25%|##5       | 1/4 [00:12<00:36, 12.16s/it]2025-08-28 01:14:10,238 | Epoch 12/60 - client 0 -  Training Loss: 35.377

 50%|#####     | 2/4 [00:24<00:24, 12.25s/it]2025-08-28 01:14:28,216 | Epoch 12/60 - client 2 -  Training Loss: 36.834

 75%|#######5  | 3/4 [00:42<00:14, 14.87s/it]2025-08-28 01:15:01,436 | Epoch 12/60 - client 1 -  Training Loss: 39.373

100%|##########| 4/4 [01:15<00:00, 22.11s/it]
100%|##########| 4/4 [01:15<00:00, 18.92s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:15:05,400 | Epoch12 Valid:
2025-08-28 01:15:05,401 | domain:Food
2025-08-28 01:15:05,401 | model_moe:
2025-08-28 01:15:05,401 | MRR: 0.3465
2025-08-28 01:15:05,403 | HR @1|5|10: 0.2510 	 0.4667 	 0.5318 	
2025-08-28 01:15:05,403 | NDCG @5|10: 0.3653 	 0.3869
2025-08-28 01:15:05,403 | domain:Kitchen
2025-08-28 01:15:05,404 | model_moe:
2025-08-28 01:15:05,404 | MRR: 0.0976
2025-08-28 01:15:05,404 | HR @1|5|10: 0.0539 	 0.1321 	 0.1768 	
2025-08-28 01:15:05,405 | NDCG @5|10: 0.0942 	 0.1086
2025-08-28 01:15:05,405 | domain:Clothing
2025-08-28 01:15:05,405 | model_moe:
2025-08-28 01:15:05,406 | MRR: 0.0225
2025-08-28 01:15:05,406 | HR @1|5|10: 0.0110 	 0.0269 	 0.0306 	
2025-08-28 01:15:05,406 | NDCG @5|10: 0.0195 	 0.0206
2025-08-28 01:15:05,406 | domain:Beauty
2025-08-28 01:15:05,407 | model_moe:
2025-08-28 01:15:05,407 | MRR: 0.2409
2025-08-28 01:15:05,407 | HR @1|5|10: 0.1639 	 0.3337 	 0.3876 	
2025-08-28 01:15:05,408 | NDCG @5|10: 0.2535 	 0.2712
2025-08-28 01:15:05,408 | 	avg_model_moe:
2025-08-28 01:15:05,408 | MRR: 0.1769
2025-08-28 01:15:05,408 | HR @1|5|10: 0.1199 	 0.2399 	 0.2817 	
2025-08-28 01:15:05,409 | NDCG @5|10: 0.1831 	 0.1968
2025-08-28 01:15:05,409 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:15:40,891 | Epoch 13/60 - client 1 -  Training Loss: 38.763

 25%|##5       | 1/4 [00:33<01:40, 33.39s/it]2025-08-28 01:15:53,112 | Epoch 13/60 - client 3 -  Training Loss: 37.656

 50%|#####     | 2/4 [00:45<00:41, 20.94s/it]2025-08-28 01:16:05,542 | Epoch 13/60 - client 0 -  Training Loss: 34.928

 75%|#######5  | 3/4 [00:58<00:17, 17.05s/it]2025-08-28 01:16:23,610 | Epoch 13/60 - client 2 -  Training Loss: 36.074

100%|##########| 4/4 [01:16<00:00, 17.45s/it]
100%|##########| 4/4 [01:16<00:00, 19.03s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:16:27,560 | Epoch13 Valid:
2025-08-28 01:16:27,560 | domain:Food
2025-08-28 01:16:27,561 | model_moe:
2025-08-28 01:16:27,561 | MRR: 0.3488
2025-08-28 01:16:27,561 | HR @1|5|10: 0.2525 	 0.4675 	 0.5394 	
2025-08-28 01:16:27,562 | NDCG @5|10: 0.3668 	 0.3907
2025-08-28 01:16:27,562 | domain:Kitchen
2025-08-28 01:16:27,562 | model_moe:
2025-08-28 01:16:27,563 | MRR: 0.0976
2025-08-28 01:16:27,563 | HR @1|5|10: 0.0534 	 0.1344 	 0.1750 	
2025-08-28 01:16:27,563 | NDCG @5|10: 0.0952 	 0.1083
2025-08-28 01:16:27,563 | domain:Clothing
2025-08-28 01:16:27,564 | model_moe:
2025-08-28 01:16:27,564 | MRR: 0.0223
2025-08-28 01:16:27,564 | HR @1|5|10: 0.0110 	 0.0244 	 0.0318 	
2025-08-28 01:16:27,565 | NDCG @5|10: 0.0183 	 0.0206
2025-08-28 01:16:27,565 | domain:Beauty
2025-08-28 01:16:27,565 | model_moe:
2025-08-28 01:16:27,565 | MRR: 0.2414
2025-08-28 01:16:27,566 | HR @1|5|10: 0.1663 	 0.3301 	 0.3852 	
2025-08-28 01:16:27,566 | NDCG @5|10: 0.2526 	 0.2707
2025-08-28 01:16:27,566 | 	avg_model_moe:
2025-08-28 01:16:27,567 | MRR: 0.1775
2025-08-28 01:16:27,567 | HR @1|5|10: 0.1208 	 0.2391 	 0.2828 	
2025-08-28 01:16:27,567 | NDCG @5|10: 0.1832 	 0.1976
2025-08-28 01:16:27,567 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:16:41,417 | Epoch 14/60 - client 3 -  Training Loss: 37.125

 25%|##5       | 1/4 [00:12<00:36, 12.05s/it]2025-08-28 01:16:53,758 | Epoch 14/60 - client 0 -  Training Loss: 34.536

 50%|#####     | 2/4 [00:24<00:24, 12.22s/it]2025-08-28 01:17:11,773 | Epoch 14/60 - client 2 -  Training Loss: 35.392

 75%|#######5  | 3/4 [00:42<00:14, 14.87s/it]2025-08-28 01:17:45,013 | Epoch 14/60 - client 1 -  Training Loss: 38.200

100%|##########| 4/4 [01:15<00:00, 22.12s/it]
100%|##########| 4/4 [01:15<00:00, 18.91s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:17:48,945 | Epoch14 Valid:
2025-08-28 01:17:48,945 | domain:Food
2025-08-28 01:17:48,946 | model_moe:
2025-08-28 01:17:48,946 | MRR: 0.3496
2025-08-28 01:17:48,946 | HR @1|5|10: 0.2525 	 0.4744 	 0.5371 	
2025-08-28 01:17:48,946 | NDCG @5|10: 0.3701 	 0.3907
2025-08-28 01:17:48,947 | domain:Kitchen
2025-08-28 01:17:48,947 | model_moe:
2025-08-28 01:17:48,947 | MRR: 0.1009
2025-08-28 01:17:48,948 | HR @1|5|10: 0.0557 	 0.1367 	 0.1842 	
2025-08-28 01:17:48,948 | NDCG @5|10: 0.0976 	 0.1130
2025-08-28 01:17:48,948 | domain:Clothing
2025-08-28 01:17:48,949 | model_moe:
2025-08-28 01:17:48,949 | MRR: 0.0231
2025-08-28 01:17:48,949 | HR @1|5|10: 0.0122 	 0.0257 	 0.0342 	
2025-08-28 01:17:48,950 | NDCG @5|10: 0.0193 	 0.0219
2025-08-28 01:17:48,950 | domain:Beauty
2025-08-28 01:17:48,950 | model_moe:
2025-08-28 01:17:48,950 | MRR: 0.2429
2025-08-28 01:17:48,951 | HR @1|5|10: 0.1687 	 0.3313 	 0.3876 	
2025-08-28 01:17:48,951 | NDCG @5|10: 0.2542 	 0.2727
2025-08-28 01:17:48,951 | 	avg_model_moe:
2025-08-28 01:17:48,952 | MRR: 0.1791
2025-08-28 01:17:48,952 | HR @1|5|10: 0.1223 	 0.2420 	 0.2858 	
2025-08-28 01:17:48,952 | NDCG @5|10: 0.1853 	 0.1996
2025-08-28 01:17:48,952 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:18:03,218 | Epoch 15/60 - client 0 -  Training Loss: 34.169

 25%|##5       | 1/4 [00:12<00:37, 12.39s/it]2025-08-28 01:18:15,350 | Epoch 15/60 - client 3 -  Training Loss: 36.659

 50%|#####     | 2/4 [00:24<00:24, 12.24s/it]2025-08-28 01:18:33,433 | Epoch 15/60 - client 2 -  Training Loss: 34.773

 75%|#######5  | 3/4 [00:42<00:14, 14.91s/it]2025-08-28 01:19:06,746 | Epoch 15/60 - client 1 -  Training Loss: 37.713

100%|##########| 4/4 [01:15<00:00, 22.17s/it]
100%|##########| 4/4 [01:15<00:00, 18.98s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:19:10,694 | Epoch15 Valid:
2025-08-28 01:19:10,694 | domain:Food
2025-08-28 01:19:10,695 | model_moe:
2025-08-28 01:19:10,695 | MRR: 0.3513
2025-08-28 01:19:10,695 | HR @1|5|10: 0.2540 	 0.4728 	 0.5363 	
2025-08-28 01:19:10,696 | NDCG @5|10: 0.3706 	 0.3918
2025-08-28 01:19:10,696 | domain:Kitchen
2025-08-28 01:19:10,696 | model_moe:
2025-08-28 01:19:10,697 | MRR: 0.1018
2025-08-28 01:19:10,697 | HR @1|5|10: 0.0576 	 0.1390 	 0.1805 	
2025-08-28 01:19:10,697 | NDCG @5|10: 0.0993 	 0.1128
2025-08-28 01:19:10,697 | domain:Clothing
2025-08-28 01:19:10,698 | model_moe:
2025-08-28 01:19:10,698 | MRR: 0.0235
2025-08-28 01:19:10,698 | HR @1|5|10: 0.0122 	 0.0257 	 0.0379 	
2025-08-28 01:19:10,699 | NDCG @5|10: 0.0194 	 0.0232
2025-08-28 01:19:10,699 | domain:Beauty
2025-08-28 01:19:10,699 | model_moe:
2025-08-28 01:19:10,700 | MRR: 0.2427
2025-08-28 01:19:10,700 | HR @1|5|10: 0.1675 	 0.3325 	 0.3876 	
2025-08-28 01:19:10,700 | NDCG @5|10: 0.2541 	 0.2723
2025-08-28 01:19:10,700 | 	avg_model_moe:
2025-08-28 01:19:10,701 | MRR: 0.1798
2025-08-28 01:19:10,701 | HR @1|5|10: 0.1228 	 0.2425 	 0.2856 	
2025-08-28 01:19:10,701 | NDCG @5|10: 0.1859 	 0.2000
2025-08-28 01:19:10,702 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:19:30,610 | Epoch 16/60 - client 2 -  Training Loss: 34.214

 25%|##5       | 1/4 [00:18<00:54, 18.10s/it]2025-08-28 01:20:04,040 | Epoch 16/60 - client 1 -  Training Loss: 37.243

 50%|#####     | 2/4 [00:51<00:54, 27.12s/it]2025-08-28 01:20:16,148 | Epoch 16/60 - client 3 -  Training Loss: 36.216

 75%|#######5  | 3/4 [01:03<00:20, 20.26s/it]2025-08-28 01:20:28,578 | Epoch 16/60 - client 0 -  Training Loss: 33.827

100%|##########| 4/4 [01:16<00:00, 17.17s/it]
100%|##########| 4/4 [01:16<00:00, 19.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:20:32,539 | Epoch16 Valid:
2025-08-28 01:20:32,540 | domain:Food
2025-08-28 01:20:32,540 | model_moe:
2025-08-28 01:20:32,540 | MRR: 0.3518
2025-08-28 01:20:32,540 | HR @1|5|10: 0.2525 	 0.4774 	 0.5402 	
2025-08-28 01:20:32,541 | NDCG @5|10: 0.3722 	 0.3931
2025-08-28 01:20:32,541 | domain:Kitchen
2025-08-28 01:20:32,541 | model_moe:
2025-08-28 01:20:32,542 | MRR: 0.1020
2025-08-28 01:20:32,542 | HR @1|5|10: 0.0566 	 0.1409 	 0.1832 	
2025-08-28 01:20:32,542 | NDCG @5|10: 0.1000 	 0.1137
2025-08-28 01:20:32,543 | domain:Clothing
2025-08-28 01:20:32,543 | model_moe:
2025-08-28 01:20:32,543 | MRR: 0.0242
2025-08-28 01:20:32,543 | HR @1|5|10: 0.0134 	 0.0232 	 0.0342 	
2025-08-28 01:20:32,544 | NDCG @5|10: 0.0191 	 0.0227
2025-08-28 01:20:32,544 | domain:Beauty
2025-08-28 01:20:32,544 | model_moe:
2025-08-28 01:20:32,545 | MRR: 0.2450
2025-08-28 01:20:32,545 | HR @1|5|10: 0.1663 	 0.3373 	 0.3876 	
2025-08-28 01:20:32,545 | NDCG @5|10: 0.2578 	 0.2744
2025-08-28 01:20:32,545 | 	avg_model_moe:
2025-08-28 01:20:32,546 | MRR: 0.1808
2025-08-28 01:20:32,546 | HR @1|5|10: 0.1222 	 0.2447 	 0.2863 	
2025-08-28 01:20:32,546 | NDCG @5|10: 0.1873 	 0.2010
2025-08-28 01:20:32,547 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:20:52,413 | Epoch 17/60 - client 2 -  Training Loss: 33.691

 25%|##5       | 1/4 [00:17<00:53, 17.99s/it]2025-08-28 01:21:25,580 | Epoch 17/60 - client 1 -  Training Loss: 36.812

 50%|#####     | 2/4 [00:51<00:53, 26.92s/it]2025-08-28 01:21:37,946 | Epoch 17/60 - client 0 -  Training Loss: 33.500

 75%|#######5  | 3/4 [01:03<00:20, 20.27s/it]2025-08-28 01:21:50,002 | Epoch 17/60 - client 3 -  Training Loss: 35.802

100%|##########| 4/4 [01:15<00:00, 17.03s/it]
100%|##########| 4/4 [01:15<00:00, 18.89s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:21:53,938 | Epoch17 Valid:
2025-08-28 01:21:53,939 | domain:Food
2025-08-28 01:21:53,939 | model_moe:
2025-08-28 01:21:53,940 | MRR: 0.3584
2025-08-28 01:21:53,940 | HR @1|5|10: 0.2617 	 0.4782 	 0.5432 	
2025-08-28 01:21:53,940 | NDCG @5|10: 0.3772 	 0.3987
2025-08-28 01:21:53,940 | domain:Kitchen
2025-08-28 01:21:53,941 | model_moe:
2025-08-28 01:21:53,941 | MRR: 0.1040
2025-08-28 01:21:53,941 | HR @1|5|10: 0.0599 	 0.1372 	 0.1865 	
2025-08-28 01:21:53,942 | NDCG @5|10: 0.0999 	 0.1159
2025-08-28 01:21:53,942 | domain:Clothing
2025-08-28 01:21:53,942 | model_moe:
2025-08-28 01:21:53,942 | MRR: 0.0256
2025-08-28 01:21:53,943 | HR @1|5|10: 0.0147 	 0.0257 	 0.0379 	
2025-08-28 01:21:53,943 | NDCG @5|10: 0.0207 	 0.0247
2025-08-28 01:21:53,943 | domain:Beauty
2025-08-28 01:21:53,944 | model_moe:
2025-08-28 01:21:53,944 | MRR: 0.2475
2025-08-28 01:21:53,944 | HR @1|5|10: 0.1711 	 0.3373 	 0.3911 	
2025-08-28 01:21:53,944 | NDCG @5|10: 0.2594 	 0.2771
2025-08-28 01:21:53,945 | 	avg_model_moe:
2025-08-28 01:21:53,945 | MRR: 0.1839
2025-08-28 01:21:53,945 | HR @1|5|10: 0.1268 	 0.2446 	 0.2897 	
2025-08-28 01:21:53,946 | NDCG @5|10: 0.1893 	 0.2041
2025-08-28 01:21:53,946 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:22:07,882 | Epoch 18/60 - client 3 -  Training Loss: 35.415

 25%|##5       | 1/4 [00:12<00:36, 12.13s/it]2025-08-28 01:22:20,260 | Epoch 18/60 - client 0 -  Training Loss: 33.199

 50%|#####     | 2/4 [00:24<00:24, 12.28s/it]2025-08-28 01:22:38,318 | Epoch 18/60 - client 2 -  Training Loss: 33.215

 75%|#######5  | 3/4 [00:42<00:14, 14.92s/it]2025-08-28 01:23:11,628 | Epoch 18/60 - client 1 -  Training Loss: 36.385

100%|##########| 4/4 [01:15<00:00, 22.18s/it]
100%|##########| 4/4 [01:15<00:00, 18.97s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:23:15,582 | Epoch18 Valid:
2025-08-28 01:23:15,583 | domain:Food
2025-08-28 01:23:15,583 | model_moe:
2025-08-28 01:23:15,584 | MRR: 0.3573
2025-08-28 01:23:15,584 | HR @1|5|10: 0.2586 	 0.4797 	 0.5463 	
2025-08-28 01:23:15,584 | NDCG @5|10: 0.3770 	 0.3988
2025-08-28 01:23:15,585 | domain:Kitchen
2025-08-28 01:23:15,585 | model_moe:
2025-08-28 01:23:15,585 | MRR: 0.1034
2025-08-28 01:23:15,586 | HR @1|5|10: 0.0557 	 0.1409 	 0.1924 	
2025-08-28 01:23:15,586 | NDCG @5|10: 0.1003 	 0.1169
2025-08-28 01:23:15,586 | domain:Clothing
2025-08-28 01:23:15,586 | model_moe:
2025-08-28 01:23:15,587 | MRR: 0.0254
2025-08-28 01:23:15,587 | HR @1|5|10: 0.0134 	 0.0269 	 0.0355 	
2025-08-28 01:23:15,587 | NDCG @5|10: 0.0209 	 0.0237
2025-08-28 01:23:15,588 | domain:Beauty
2025-08-28 01:23:15,588 | model_moe:
2025-08-28 01:23:15,588 | MRR: 0.2455
2025-08-28 01:23:15,589 | HR @1|5|10: 0.1699 	 0.3361 	 0.3864 	
2025-08-28 01:23:15,589 | NDCG @5|10: 0.2577 	 0.2743
2025-08-28 01:23:15,589 | 	avg_model_moe:
2025-08-28 01:23:15,589 | MRR: 0.1829
2025-08-28 01:23:15,590 | HR @1|5|10: 0.1244 	 0.2459 	 0.2901 	
2025-08-28 01:23:15,590 | NDCG @5|10: 0.1890 	 0.2034
2025-08-28 01:23:15,590 | Early Stopping counter: 1 out of 10
2025-08-28 01:23:15,591 | Learning rate decay counter: 1 out of 1
2025-08-28 01:23:15,591 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:23:27,923 | Epoch 19/60 - client 3 -  Training Loss: 35.055

 25%|##5       | 1/4 [00:12<00:36, 12.33s/it]2025-08-28 01:23:46,426 | Epoch 19/60 - client 2 -  Training Loss: 32.767

 50%|#####     | 2/4 [00:30<00:31, 15.96s/it]2025-08-28 01:24:19,707 | Epoch 19/60 - client 1 -  Training Loss: 35.983

 75%|#######5  | 3/4 [01:04<00:23, 23.87s/it]2025-08-28 01:24:32,092 | Epoch 19/60 - client 0 -  Training Loss: 32.910

100%|##########| 4/4 [01:16<00:00, 19.34s/it]
100%|##########| 4/4 [01:16<00:00, 19.13s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:24:36,038 | Epoch19 Valid:
2025-08-28 01:24:36,039 | domain:Food
2025-08-28 01:24:36,039 | model_moe:
2025-08-28 01:24:36,039 | MRR: 0.3588
2025-08-28 01:24:36,040 | HR @1|5|10: 0.2601 	 0.4790 	 0.5486 	
2025-08-28 01:24:36,040 | NDCG @5|10: 0.3776 	 0.4005
2025-08-28 01:24:36,040 | domain:Kitchen
2025-08-28 01:24:36,041 | model_moe:
2025-08-28 01:24:36,041 | MRR: 0.1056
2025-08-28 01:24:36,041 | HR @1|5|10: 0.0612 	 0.1436 	 0.1906 	
2025-08-28 01:24:36,042 | NDCG @5|10: 0.1029 	 0.1181
2025-08-28 01:24:36,042 | domain:Clothing
2025-08-28 01:24:36,042 | model_moe:
2025-08-28 01:24:36,042 | MRR: 0.0250
2025-08-28 01:24:36,043 | HR @1|5|10: 0.0110 	 0.0293 	 0.0367 	
2025-08-28 01:24:36,043 | NDCG @5|10: 0.0214 	 0.0237
2025-08-28 01:24:36,043 | domain:Beauty
2025-08-28 01:24:36,044 | model_moe:
2025-08-28 01:24:36,044 | MRR: 0.2446
2025-08-28 01:24:36,044 | HR @1|5|10: 0.1699 	 0.3361 	 0.3852 	
2025-08-28 01:24:36,044 | NDCG @5|10: 0.2570 	 0.2732
2025-08-28 01:24:36,045 | 	avg_model_moe:
2025-08-28 01:24:36,045 | MRR: 0.1835
2025-08-28 01:24:36,045 | HR @1|5|10: 0.1256 	 0.2470 	 0.2903 	
2025-08-28 01:24:36,046 | NDCG @5|10: 0.1897 	 0.2039
2025-08-28 01:24:36,046 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:25:09,343 | Epoch 20/60 - client 1 -  Training Loss: 35.605

 25%|##5       | 1/4 [00:33<01:39, 33.30s/it]2025-08-28 01:25:27,421 | Epoch 20/60 - client 2 -  Training Loss: 32.358

 50%|#####     | 2/4 [00:51<00:48, 24.34s/it]2025-08-28 01:25:39,638 | Epoch 20/60 - client 3 -  Training Loss: 34.726

 75%|#######5  | 3/4 [01:03<00:18, 18.81s/it]2025-08-28 01:25:52,075 | Epoch 20/60 - client 0 -  Training Loss: 32.647

100%|##########| 4/4 [01:16<00:00, 16.29s/it]
100%|##########| 4/4 [01:16<00:00, 19.01s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.35s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.06s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:25:56,046 | Epoch20 Valid:
2025-08-28 01:25:56,046 | domain:Food
2025-08-28 01:25:56,046 | model_moe:
2025-08-28 01:25:56,047 | MRR: 0.3591
2025-08-28 01:25:56,047 | HR @1|5|10: 0.2594 	 0.4797 	 0.5432 	
2025-08-28 01:25:56,047 | NDCG @5|10: 0.3783 	 0.3994
2025-08-28 01:25:56,048 | domain:Kitchen
2025-08-28 01:25:56,048 | model_moe:
2025-08-28 01:25:56,048 | MRR: 0.1080
2025-08-28 01:25:56,049 | HR @1|5|10: 0.0608 	 0.1473 	 0.1957 	
2025-08-28 01:25:56,049 | NDCG @5|10: 0.1056 	 0.1212
2025-08-28 01:25:56,049 | domain:Clothing
2025-08-28 01:25:56,050 | model_moe:
2025-08-28 01:25:56,050 | MRR: 0.0235
2025-08-28 01:25:56,050 | HR @1|5|10: 0.0098 	 0.0293 	 0.0342 	
2025-08-28 01:25:56,050 | NDCG @5|10: 0.0204 	 0.0219
2025-08-28 01:25:56,051 | domain:Beauty
2025-08-28 01:25:56,051 | model_moe:
2025-08-28 01:25:56,051 | MRR: 0.2468
2025-08-28 01:25:56,052 | HR @1|5|10: 0.1746 	 0.3337 	 0.3888 	
2025-08-28 01:25:56,052 | NDCG @5|10: 0.2578 	 0.2759
2025-08-28 01:25:56,052 | 	avg_model_moe:
2025-08-28 01:25:56,052 | MRR: 0.1844
2025-08-28 01:25:56,053 | HR @1|5|10: 0.1261 	 0.2475 	 0.2905 	
2025-08-28 01:25:56,053 | NDCG @5|10: 0.1905 	 0.2046
2025-08-28 01:25:56,053 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:26:10,057 | Epoch 21/60 - client 3 -  Training Loss: 34.397

 25%|##5       | 1/4 [00:12<00:36, 12.04s/it]2025-08-28 01:26:28,057 | Epoch 21/60 - client 2 -  Training Loss: 31.962

 50%|#####     | 2/4 [00:30<00:31, 15.55s/it]2025-08-28 01:27:01,251 | Epoch 21/60 - client 1 -  Training Loss: 35.238

 75%|#######5  | 3/4 [01:03<00:23, 23.60s/it]2025-08-28 01:27:13,618 | Epoch 21/60 - client 0 -  Training Loss: 32.386

100%|##########| 4/4 [01:15<00:00, 19.17s/it]
100%|##########| 4/4 [01:15<00:00, 18.90s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:27:17,563 | Epoch21 Valid:
2025-08-28 01:27:17,564 | domain:Food
2025-08-28 01:27:17,564 | model_moe:
2025-08-28 01:27:17,564 | MRR: 0.3603
2025-08-28 01:27:17,565 | HR @1|5|10: 0.2624 	 0.4813 	 0.5478 	
2025-08-28 01:27:17,565 | NDCG @5|10: 0.3796 	 0.4016
2025-08-28 01:27:17,565 | domain:Kitchen
2025-08-28 01:27:17,566 | model_moe:
2025-08-28 01:27:17,566 | MRR: 0.1088
2025-08-28 01:27:17,566 | HR @1|5|10: 0.0617 	 0.1501 	 0.1989 	
2025-08-28 01:27:17,567 | NDCG @5|10: 0.1069 	 0.1227
2025-08-28 01:27:17,567 | domain:Clothing
2025-08-28 01:27:17,567 | model_moe:
2025-08-28 01:27:17,568 | MRR: 0.0244
2025-08-28 01:27:17,568 | HR @1|5|10: 0.0110 	 0.0269 	 0.0403 	
2025-08-28 01:27:17,568 | NDCG @5|10: 0.0198 	 0.0241
2025-08-28 01:27:17,569 | domain:Beauty
2025-08-28 01:27:17,569 | model_moe:
2025-08-28 01:27:17,569 | MRR: 0.2496
2025-08-28 01:27:17,569 | HR @1|5|10: 0.1746 	 0.3385 	 0.3864 	
2025-08-28 01:27:17,570 | NDCG @5|10: 0.2617 	 0.2774
2025-08-28 01:27:17,570 | 	avg_model_moe:
2025-08-28 01:27:17,570 | MRR: 0.1858
2025-08-28 01:27:17,571 | HR @1|5|10: 0.1274 	 0.2492 	 0.2934 	
2025-08-28 01:27:17,571 | NDCG @5|10: 0.1920 	 0.2064
2025-08-28 01:27:17,571 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:27:31,942 | Epoch 22/60 - client 0 -  Training Loss: 32.153

 25%|##5       | 1/4 [00:12<00:37, 12.37s/it]2025-08-28 01:27:49,892 | Epoch 22/60 - client 2 -  Training Loss: 31.591

 50%|#####     | 2/4 [00:30<00:31, 15.65s/it]2025-08-28 01:28:01,920 | Epoch 22/60 - client 3 -  Training Loss: 34.086

 75%|#######5  | 3/4 [00:42<00:13, 14.00s/it]2025-08-28 01:28:35,021 | Epoch 22/60 - client 1 -  Training Loss: 34.887

100%|##########| 4/4 [01:15<00:00, 21.54s/it]
100%|##########| 4/4 [01:15<00:00, 18.86s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:28:38,921 | Epoch22 Valid:
2025-08-28 01:28:38,921 | domain:Food
2025-08-28 01:28:38,921 | model_moe:
2025-08-28 01:28:38,922 | MRR: 0.3612
2025-08-28 01:28:38,922 | HR @1|5|10: 0.2624 	 0.4828 	 0.5463 	
2025-08-28 01:28:38,922 | NDCG @5|10: 0.3807 	 0.4018
2025-08-28 01:28:38,923 | domain:Kitchen
2025-08-28 01:28:38,923 | model_moe:
2025-08-28 01:28:38,923 | MRR: 0.1111
2025-08-28 01:28:38,924 | HR @1|5|10: 0.0645 	 0.1483 	 0.2026 	
2025-08-28 01:28:38,924 | NDCG @5|10: 0.1076 	 0.1252
2025-08-28 01:28:38,924 | domain:Clothing
2025-08-28 01:28:38,924 | model_moe:
2025-08-28 01:28:38,925 | MRR: 0.0258
2025-08-28 01:28:38,925 | HR @1|5|10: 0.0122 	 0.0293 	 0.0403 	
2025-08-28 01:28:38,925 | NDCG @5|10: 0.0216 	 0.0251
2025-08-28 01:28:38,926 | domain:Beauty
2025-08-28 01:28:38,926 | model_moe:
2025-08-28 01:28:38,926 | MRR: 0.2483
2025-08-28 01:28:38,926 | HR @1|5|10: 0.1734 	 0.3385 	 0.3935 	
2025-08-28 01:28:38,927 | NDCG @5|10: 0.2603 	 0.2784
2025-08-28 01:28:38,927 | 	avg_model_moe:
2025-08-28 01:28:38,927 | MRR: 0.1866
2025-08-28 01:28:38,928 | HR @1|5|10: 0.1281 	 0.2497 	 0.2957 	
2025-08-28 01:28:38,928 | NDCG @5|10: 0.1926 	 0.2076
2025-08-28 01:28:38,928 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:28:53,028 | Epoch 23/60 - client 3 -  Training Loss: 33.800

 25%|##5       | 1/4 [00:12<00:36, 12.13s/it]2025-08-28 01:29:05,458 | Epoch 23/60 - client 0 -  Training Loss: 31.918

 50%|#####     | 2/4 [00:24<00:24, 12.30s/it]2025-08-28 01:29:38,893 | Epoch 23/60 - client 1 -  Training Loss: 34.559

 75%|#######5  | 3/4 [00:57<00:21, 21.95s/it]2025-08-28 01:29:56,956 | Epoch 23/60 - client 2 -  Training Loss: 31.253

100%|##########| 4/4 [01:16<00:00, 20.42s/it]
100%|##########| 4/4 [01:16<00:00, 19.01s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:30:00,898 | Epoch23 Valid:
2025-08-28 01:30:00,898 | domain:Food
2025-08-28 01:30:00,899 | model_moe:
2025-08-28 01:30:00,899 | MRR: 0.3627
2025-08-28 01:30:00,899 | HR @1|5|10: 0.2655 	 0.4843 	 0.5493 	
2025-08-28 01:30:00,899 | NDCG @5|10: 0.3823 	 0.4037
2025-08-28 01:30:00,900 | domain:Kitchen
2025-08-28 01:30:00,900 | model_moe:
2025-08-28 01:30:00,900 | MRR: 0.1096
2025-08-28 01:30:00,901 | HR @1|5|10: 0.0622 	 0.1529 	 0.2007 	
2025-08-28 01:30:00,901 | NDCG @5|10: 0.1082 	 0.1237
2025-08-28 01:30:00,901 | domain:Clothing
2025-08-28 01:30:00,902 | model_moe:
2025-08-28 01:30:00,902 | MRR: 0.0250
2025-08-28 01:30:00,902 | HR @1|5|10: 0.0122 	 0.0281 	 0.0355 	
2025-08-28 01:30:00,903 | NDCG @5|10: 0.0209 	 0.0232
2025-08-28 01:30:00,903 | domain:Beauty
2025-08-28 01:30:00,903 | model_moe:
2025-08-28 01:30:00,904 | MRR: 0.2488
2025-08-28 01:30:00,904 | HR @1|5|10: 0.1746 	 0.3421 	 0.3876 	
2025-08-28 01:30:00,904 | NDCG @5|10: 0.2621 	 0.2772
2025-08-28 01:30:00,904 | 	avg_model_moe:
2025-08-28 01:30:00,905 | MRR: 0.1865
2025-08-28 01:30:00,905 | HR @1|5|10: 0.1286 	 0.2518 	 0.2933 	
2025-08-28 01:30:00,905 | NDCG @5|10: 0.1934 	 0.2069
2025-08-28 01:30:00,906 | Early Stopping counter: 1 out of 10
2025-08-28 01:30:00,906 | Learning rate decay counter: 1 out of 1
2025-08-28 01:30:00,906 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:30:12,995 | Epoch 24/60 - client 3 -  Training Loss: 33.521

 25%|##5       | 1/4 [00:12<00:36, 12.09s/it]2025-08-28 01:30:31,060 | Epoch 24/60 - client 2 -  Training Loss: 30.935

 50%|#####     | 2/4 [00:30<00:31, 15.60s/it]2025-08-28 01:31:04,426 | Epoch 24/60 - client 1 -  Training Loss: 34.242

 75%|#######5  | 3/4 [01:03<00:23, 23.71s/it]2025-08-28 01:31:16,873 | Epoch 24/60 - client 0 -  Training Loss: 31.697

100%|##########| 4/4 [01:15<00:00, 19.27s/it]
100%|##########| 4/4 [01:15<00:00, 18.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:31:20,829 | Epoch24 Valid:
2025-08-28 01:31:20,830 | domain:Food
2025-08-28 01:31:20,830 | model_moe:
2025-08-28 01:31:20,830 | MRR: 0.3634
2025-08-28 01:31:20,831 | HR @1|5|10: 0.2655 	 0.4874 	 0.5440 	
2025-08-28 01:31:20,831 | NDCG @5|10: 0.3842 	 0.4029
2025-08-28 01:31:20,831 | domain:Kitchen
2025-08-28 01:31:20,831 | model_moe:
2025-08-28 01:31:20,832 | MRR: 0.1087
2025-08-28 01:31:20,832 | HR @1|5|10: 0.0612 	 0.1506 	 0.1998 	
2025-08-28 01:31:20,832 | NDCG @5|10: 0.1069 	 0.1228
2025-08-28 01:31:20,833 | domain:Clothing
2025-08-28 01:31:20,833 | model_moe:
2025-08-28 01:31:20,833 | MRR: 0.0236
2025-08-28 01:31:20,834 | HR @1|5|10: 0.0086 	 0.0257 	 0.0416 	
2025-08-28 01:31:20,834 | NDCG @5|10: 0.0186 	 0.0236
2025-08-28 01:31:20,834 | domain:Beauty
2025-08-28 01:31:20,834 | model_moe:
2025-08-28 01:31:20,835 | MRR: 0.2519
2025-08-28 01:31:20,835 | HR @1|5|10: 0.1794 	 0.3433 	 0.3911 	
2025-08-28 01:31:20,835 | NDCG @5|10: 0.2648 	 0.2807
2025-08-28 01:31:20,836 | 	avg_model_moe:
2025-08-28 01:31:20,836 | MRR: 0.1869
2025-08-28 01:31:20,836 | HR @1|5|10: 0.1287 	 0.2517 	 0.2941 	
2025-08-28 01:31:20,837 | NDCG @5|10: 0.1936 	 0.2075
2025-08-28 01:31:20,837 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:31:55,868 | Epoch 25/60 - client 1 -  Training Loss: 33.933

 25%|##5       | 1/4 [00:33<01:39, 33.08s/it]2025-08-28 01:32:13,820 | Epoch 25/60 - client 2 -  Training Loss: 30.622

 50%|#####     | 2/4 [00:51<00:48, 24.18s/it]2025-08-28 01:32:25,798 | Epoch 25/60 - client 3 -  Training Loss: 33.254

 75%|#######5  | 3/4 [01:03<00:18, 18.61s/it]2025-08-28 01:32:38,206 | Epoch 25/60 - client 0 -  Training Loss: 31.487

100%|##########| 4/4 [01:15<00:00, 16.16s/it]
100%|##########| 4/4 [01:15<00:00, 18.86s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:32:42,146 | Epoch25 Valid:
2025-08-28 01:32:42,147 | domain:Food
2025-08-28 01:32:42,147 | model_moe:
2025-08-28 01:32:42,147 | MRR: 0.3636
2025-08-28 01:32:42,148 | HR @1|5|10: 0.2655 	 0.4881 	 0.5501 	
2025-08-28 01:32:42,148 | NDCG @5|10: 0.3845 	 0.4048
2025-08-28 01:32:42,148 | domain:Kitchen
2025-08-28 01:32:42,148 | model_moe:
2025-08-28 01:32:42,149 | MRR: 0.1116
2025-08-28 01:32:42,149 | HR @1|5|10: 0.0635 	 0.1542 	 0.2053 	
2025-08-28 01:32:42,149 | NDCG @5|10: 0.1097 	 0.1263
2025-08-28 01:32:42,150 | domain:Clothing
2025-08-28 01:32:42,150 | model_moe:
2025-08-28 01:32:42,150 | MRR: 0.0251
2025-08-28 01:32:42,151 | HR @1|5|10: 0.0122 	 0.0269 	 0.0403 	
2025-08-28 01:32:42,151 | NDCG @5|10: 0.0201 	 0.0244
2025-08-28 01:32:42,151 | domain:Beauty
2025-08-28 01:32:42,151 | model_moe:
2025-08-28 01:32:42,152 | MRR: 0.2512
2025-08-28 01:32:42,152 | HR @1|5|10: 0.1770 	 0.3421 	 0.3911 	
2025-08-28 01:32:42,152 | NDCG @5|10: 0.2639 	 0.2801
2025-08-28 01:32:42,153 | 	avg_model_moe:
2025-08-28 01:32:42,153 | MRR: 0.1879
2025-08-28 01:32:42,153 | HR @1|5|10: 0.1296 	 0.2528 	 0.2967 	
2025-08-28 01:32:42,153 | NDCG @5|10: 0.1946 	 0.2089
2025-08-28 01:32:42,154 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:33:17,496 | Epoch 26/60 - client 1 -  Training Loss: 33.648

 25%|##5       | 1/4 [00:33<01:40, 33.36s/it]2025-08-28 01:33:29,575 | Epoch 26/60 - client 3 -  Training Loss: 32.998

 50%|#####     | 2/4 [00:45<00:41, 20.84s/it]2025-08-28 01:33:41,942 | Epoch 26/60 - client 0 -  Training Loss: 31.283

 75%|#######5  | 3/4 [00:57<00:16, 16.97s/it]2025-08-28 01:33:59,974 | Epoch 26/60 - client 2 -  Training Loss: 30.330

100%|##########| 4/4 [01:15<00:00, 17.39s/it]
100%|##########| 4/4 [01:15<00:00, 18.96s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:34:03,895 | Epoch26 Valid:
2025-08-28 01:34:03,896 | domain:Food
2025-08-28 01:34:03,896 | model_moe:
2025-08-28 01:34:03,897 | MRR: 0.3630
2025-08-28 01:34:03,897 | HR @1|5|10: 0.2647 	 0.4889 	 0.5471 	
2025-08-28 01:34:03,897 | NDCG @5|10: 0.3842 	 0.4035
2025-08-28 01:34:03,898 | domain:Kitchen
2025-08-28 01:34:03,898 | model_moe:
2025-08-28 01:34:03,898 | MRR: 0.1126
2025-08-28 01:34:03,899 | HR @1|5|10: 0.0631 	 0.1575 	 0.2053 	
2025-08-28 01:34:03,899 | NDCG @5|10: 0.1115 	 0.1270
2025-08-28 01:34:03,899 | domain:Clothing
2025-08-28 01:34:03,899 | model_moe:
2025-08-28 01:34:03,900 | MRR: 0.0240
2025-08-28 01:34:03,900 | HR @1|5|10: 0.0098 	 0.0281 	 0.0379 	
2025-08-28 01:34:03,900 | NDCG @5|10: 0.0196 	 0.0227
2025-08-28 01:34:03,901 | domain:Beauty
2025-08-28 01:34:03,901 | model_moe:
2025-08-28 01:34:03,901 | MRR: 0.2523
2025-08-28 01:34:03,902 | HR @1|5|10: 0.1794 	 0.3445 	 0.3900 	
2025-08-28 01:34:03,902 | NDCG @5|10: 0.2657 	 0.2806
2025-08-28 01:34:03,902 | 	avg_model_moe:
2025-08-28 01:34:03,902 | MRR: 0.1880
2025-08-28 01:34:03,903 | HR @1|5|10: 0.1293 	 0.2547 	 0.2951 	
2025-08-28 01:34:03,903 | NDCG @5|10: 0.1953 	 0.2084
2025-08-28 01:34:03,903 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:34:23,935 | Epoch 27/60 - client 2 -  Training Loss: 30.065

 25%|##5       | 1/4 [00:18<00:54, 18.05s/it]2025-08-28 01:34:57,334 | Epoch 27/60 - client 1 -  Training Loss: 33.370

 50%|#####     | 2/4 [00:51<00:54, 27.09s/it]2025-08-28 01:35:09,733 | Epoch 27/60 - client 0 -  Training Loss: 31.092

 75%|#######5  | 3/4 [01:03<00:20, 20.38s/it]2025-08-28 01:35:21,828 | Epoch 27/60 - client 3 -  Training Loss: 32.757

100%|##########| 4/4 [01:15<00:00, 17.11s/it]
100%|##########| 4/4 [01:15<00:00, 18.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:35:25,774 | Epoch27 Valid:
2025-08-28 01:35:25,774 | domain:Food
2025-08-28 01:35:25,775 | model_moe:
2025-08-28 01:35:25,775 | MRR: 0.3647
2025-08-28 01:35:25,775 | HR @1|5|10: 0.2678 	 0.4904 	 0.5478 	
2025-08-28 01:35:25,776 | NDCG @5|10: 0.3859 	 0.4049
2025-08-28 01:35:25,776 | domain:Kitchen
2025-08-28 01:35:25,776 | model_moe:
2025-08-28 01:35:25,776 | MRR: 0.1107
2025-08-28 01:35:25,777 | HR @1|5|10: 0.0617 	 0.1565 	 0.2072 	
2025-08-28 01:35:25,777 | NDCG @5|10: 0.1097 	 0.1260
2025-08-28 01:35:25,777 | domain:Clothing
2025-08-28 01:35:25,779 | model_moe:
2025-08-28 01:35:25,779 | MRR: 0.0238
2025-08-28 01:35:25,780 | HR @1|5|10: 0.0086 	 0.0269 	 0.0379 	
2025-08-28 01:35:25,780 | NDCG @5|10: 0.0189 	 0.0224
2025-08-28 01:35:25,780 | domain:Beauty
2025-08-28 01:35:25,780 | model_moe:
2025-08-28 01:35:25,781 | MRR: 0.2504
2025-08-28 01:35:25,781 | HR @1|5|10: 0.1746 	 0.3445 	 0.3876 	
2025-08-28 01:35:25,781 | NDCG @5|10: 0.2642 	 0.2784
2025-08-28 01:35:25,782 | 	avg_model_moe:
2025-08-28 01:35:25,782 | MRR: 0.1874
2025-08-28 01:35:25,782 | HR @1|5|10: 0.1282 	 0.2546 	 0.2951 	
2025-08-28 01:35:25,783 | NDCG @5|10: 0.1947 	 0.2079
2025-08-28 01:35:25,783 | Early Stopping counter: 1 out of 10
2025-08-28 01:35:25,783 | Learning rate decay counter: 1 out of 1
2025-08-28 01:35:25,783 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:35:38,154 | Epoch 28/60 - client 0 -  Training Loss: 30.920

 25%|##5       | 1/4 [00:12<00:37, 12.37s/it]2025-08-28 01:35:56,199 | Epoch 28/60 - client 2 -  Training Loss: 29.808

 50%|#####     | 2/4 [00:30<00:31, 15.71s/it]2025-08-28 01:36:29,499 | Epoch 28/60 - client 1 -  Training Loss: 33.102

 75%|#######5  | 3/4 [01:03<00:23, 23.74s/it]2025-08-28 01:36:41,674 | Epoch 28/60 - client 3 -  Training Loss: 32.536

100%|##########| 4/4 [01:15<00:00, 19.17s/it]
100%|##########| 4/4 [01:15<00:00, 18.97s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:36:45,632 | Epoch28 Valid:
2025-08-28 01:36:45,632 | domain:Food
2025-08-28 01:36:45,633 | model_moe:
2025-08-28 01:36:45,633 | MRR: 0.3653
2025-08-28 01:36:45,633 | HR @1|5|10: 0.2670 	 0.4897 	 0.5493 	
2025-08-28 01:36:45,634 | NDCG @5|10: 0.3862 	 0.4059
2025-08-28 01:36:45,634 | domain:Kitchen
2025-08-28 01:36:45,634 | model_moe:
2025-08-28 01:36:45,635 | MRR: 0.1137
2025-08-28 01:36:45,635 | HR @1|5|10: 0.0640 	 0.1598 	 0.2067 	
2025-08-28 01:36:45,635 | NDCG @5|10: 0.1129 	 0.1280
2025-08-28 01:36:45,635 | domain:Clothing
2025-08-28 01:36:45,636 | model_moe:
2025-08-28 01:36:45,636 | MRR: 0.0237
2025-08-28 01:36:45,636 | HR @1|5|10: 0.0073 	 0.0318 	 0.0416 	
2025-08-28 01:36:45,637 | NDCG @5|10: 0.0202 	 0.0235
2025-08-28 01:36:45,637 | domain:Beauty
2025-08-28 01:36:45,637 | model_moe:
2025-08-28 01:36:45,638 | MRR: 0.2520
2025-08-28 01:36:45,638 | HR @1|5|10: 0.1758 	 0.3457 	 0.3911 	
2025-08-28 01:36:45,638 | NDCG @5|10: 0.2658 	 0.2807
2025-08-28 01:36:45,638 | 	avg_model_moe:
2025-08-28 01:36:45,639 | MRR: 0.1887
2025-08-28 01:36:45,639 | HR @1|5|10: 0.1285 	 0.2567 	 0.2972 	
2025-08-28 01:36:45,639 | NDCG @5|10: 0.1963 	 0.2095
2025-08-28 01:36:45,639 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:37:05,468 | Epoch 29/60 - client 2 -  Training Loss: 29.571

 25%|##5       | 1/4 [00:17<00:53, 17.93s/it]2025-08-28 01:37:17,409 | Epoch 29/60 - client 3 -  Training Loss: 32.308

 50%|#####     | 2/4 [00:29<00:28, 14.41s/it]2025-08-28 01:37:29,645 | Epoch 29/60 - client 0 -  Training Loss: 30.735

 75%|#######5  | 3/4 [00:42<00:13, 13.42s/it]2025-08-28 01:38:02,680 | Epoch 29/60 - client 1 -  Training Loss: 32.844

100%|##########| 4/4 [01:15<00:00, 21.16s/it]
100%|##########| 4/4 [01:15<00:00, 18.79s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:38:06,598 | Epoch29 Valid:
2025-08-28 01:38:06,598 | domain:Food
2025-08-28 01:38:06,599 | model_moe:
2025-08-28 01:38:06,599 | MRR: 0.3647
2025-08-28 01:38:06,599 | HR @1|5|10: 0.2647 	 0.4927 	 0.5486 	
2025-08-28 01:38:06,599 | NDCG @5|10: 0.3870 	 0.4053
2025-08-28 01:38:06,600 | domain:Kitchen
2025-08-28 01:38:06,600 | model_moe:
2025-08-28 01:38:06,600 | MRR: 0.1128
2025-08-28 01:38:06,601 | HR @1|5|10: 0.0622 	 0.1611 	 0.2072 	
2025-08-28 01:38:06,601 | NDCG @5|10: 0.1126 	 0.1275
2025-08-28 01:38:06,601 | domain:Clothing
2025-08-28 01:38:06,602 | model_moe:
2025-08-28 01:38:06,602 | MRR: 0.0241
2025-08-28 01:38:06,602 | HR @1|5|10: 0.0086 	 0.0293 	 0.0403 	
2025-08-28 01:38:06,603 | NDCG @5|10: 0.0199 	 0.0235
2025-08-28 01:38:06,603 | domain:Beauty
2025-08-28 01:38:06,603 | model_moe:
2025-08-28 01:38:06,603 | MRR: 0.2520
2025-08-28 01:38:06,604 | HR @1|5|10: 0.1794 	 0.3457 	 0.3900 	
2025-08-28 01:38:06,604 | NDCG @5|10: 0.2659 	 0.2803
2025-08-28 01:38:06,604 | 	avg_model_moe:
2025-08-28 01:38:06,605 | MRR: 0.1884
2025-08-28 01:38:06,605 | HR @1|5|10: 0.1287 	 0.2572 	 0.2965 	
2025-08-28 01:38:06,605 | NDCG @5|10: 0.1963 	 0.2091
2025-08-28 01:38:06,605 | Early Stopping counter: 1 out of 10
2025-08-28 01:38:06,606 | Learning rate decay counter: 1 out of 1
2025-08-28 01:38:06,606 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:38:18,558 | Epoch 30/60 - client 3 -  Training Loss: 32.083

 25%|##5       | 1/4 [00:11<00:35, 11.95s/it]2025-08-28 01:38:30,870 | Epoch 30/60 - client 0 -  Training Loss: 30.564

 50%|#####     | 2/4 [00:24<00:24, 12.16s/it]2025-08-28 01:39:03,890 | Epoch 30/60 - client 1 -  Training Loss: 32.591

 75%|#######5  | 3/4 [00:57<00:21, 21.69s/it]2025-08-28 01:39:21,808 | Epoch 30/60 - client 2 -  Training Loss: 29.322

100%|##########| 4/4 [01:15<00:00, 20.20s/it]
100%|##########| 4/4 [01:15<00:00, 18.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:39:25,716 | Epoch30 Valid:
2025-08-28 01:39:25,717 | domain:Food
2025-08-28 01:39:25,717 | model_moe:
2025-08-28 01:39:25,717 | MRR: 0.3630
2025-08-28 01:39:25,718 | HR @1|5|10: 0.2632 	 0.4904 	 0.5478 	
2025-08-28 01:39:25,718 | NDCG @5|10: 0.3846 	 0.4037
2025-08-28 01:39:25,718 | domain:Kitchen
2025-08-28 01:39:25,719 | model_moe:
2025-08-28 01:39:25,719 | MRR: 0.1136
2025-08-28 01:39:25,719 | HR @1|5|10: 0.0622 	 0.1602 	 0.2104 	
2025-08-28 01:39:25,719 | NDCG @5|10: 0.1126 	 0.1290
2025-08-28 01:39:25,720 | domain:Clothing
2025-08-28 01:39:25,720 | model_moe:
2025-08-28 01:39:25,720 | MRR: 0.0253
2025-08-28 01:39:25,721 | HR @1|5|10: 0.0098 	 0.0306 	 0.0416 	
2025-08-28 01:39:25,721 | NDCG @5|10: 0.0212 	 0.0247
2025-08-28 01:39:25,721 | domain:Beauty
2025-08-28 01:39:25,722 | model_moe:
2025-08-28 01:39:25,722 | MRR: 0.2553
2025-08-28 01:39:25,722 | HR @1|5|10: 0.1842 	 0.3421 	 0.3911 	
2025-08-28 01:39:25,724 | NDCG @5|10: 0.2672 	 0.2833
2025-08-28 01:39:25,724 | 	avg_model_moe:
2025-08-28 01:39:25,724 | MRR: 0.1893
2025-08-28 01:39:25,725 | HR @1|5|10: 0.1298 	 0.2558 	 0.2977 	
2025-08-28 01:39:25,725 | NDCG @5|10: 0.1964 	 0.2102
2025-08-28 01:39:25,725 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:40:01,231 | Epoch 31/60 - client 1 -  Training Loss: 32.346

 25%|##5       | 1/4 [00:33<01:39, 33.20s/it]2025-08-28 01:40:13,387 | Epoch 31/60 - client 3 -  Training Loss: 31.878

 50%|#####     | 2/4 [00:45<00:41, 20.82s/it]2025-08-28 01:40:25,797 | Epoch 31/60 - client 0 -  Training Loss: 30.399

 75%|#######5  | 3/4 [00:57<00:16, 16.98s/it]2025-08-28 01:40:43,862 | Epoch 31/60 - client 2 -  Training Loss: 29.101

100%|##########| 4/4 [01:15<00:00, 17.41s/it]
100%|##########| 4/4 [01:15<00:00, 18.96s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:40:47,832 | Epoch31 Valid:
2025-08-28 01:40:47,832 | domain:Food
2025-08-28 01:40:47,832 | model_moe:
2025-08-28 01:40:47,833 | MRR: 0.3635
2025-08-28 01:40:47,833 | HR @1|5|10: 0.2640 	 0.4858 	 0.5486 	
2025-08-28 01:40:47,835 | NDCG @5|10: 0.3836 	 0.4043
2025-08-28 01:40:47,835 | domain:Kitchen
2025-08-28 01:40:47,835 | model_moe:
2025-08-28 01:40:47,836 | MRR: 0.1154
2025-08-28 01:40:47,836 | HR @1|5|10: 0.0640 	 0.1593 	 0.2122 	
2025-08-28 01:40:47,836 | NDCG @5|10: 0.1134 	 0.1307
2025-08-28 01:40:47,837 | domain:Clothing
2025-08-28 01:40:47,837 | model_moe:
2025-08-28 01:40:47,837 | MRR: 0.0238
2025-08-28 01:40:47,838 | HR @1|5|10: 0.0086 	 0.0318 	 0.0428 	
2025-08-28 01:40:47,838 | NDCG @5|10: 0.0203 	 0.0238
2025-08-28 01:40:47,838 | domain:Beauty
2025-08-28 01:40:47,839 | model_moe:
2025-08-28 01:40:47,839 | MRR: 0.2524
2025-08-28 01:40:47,839 | HR @1|5|10: 0.1818 	 0.3409 	 0.3876 	
2025-08-28 01:40:47,839 | NDCG @5|10: 0.2647 	 0.2800
2025-08-28 01:40:47,840 | 	avg_model_moe:
2025-08-28 01:40:47,840 | MRR: 0.1888
2025-08-28 01:40:47,840 | HR @1|5|10: 0.1296 	 0.2545 	 0.2978 	
2025-08-28 01:40:47,841 | NDCG @5|10: 0.1955 	 0.2097
2025-08-28 01:40:47,841 | Early Stopping counter: 1 out of 10
2025-08-28 01:40:47,841 | Learning rate decay counter: 1 out of 1
2025-08-28 01:40:47,842 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:41:21,122 | Epoch 32/60 - client 1 -  Training Loss: 32.127

 25%|##5       | 1/4 [00:33<01:39, 33.28s/it]2025-08-28 01:41:33,171 | Epoch 32/60 - client 3 -  Training Loss: 31.692

 50%|#####     | 2/4 [00:45<00:41, 20.79s/it]2025-08-28 01:41:45,507 | Epoch 32/60 - client 0 -  Training Loss: 30.244

 75%|#######5  | 3/4 [00:57<00:16, 16.93s/it]2025-08-28 01:42:03,627 | Epoch 32/60 - client 2 -  Training Loss: 28.895

100%|##########| 4/4 [01:15<00:00, 17.40s/it]
100%|##########| 4/4 [01:15<00:00, 18.95s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:42:07,561 | Epoch32 Valid:
2025-08-28 01:42:07,562 | domain:Food
2025-08-28 01:42:07,562 | model_moe:
2025-08-28 01:42:07,562 | MRR: 0.3649
2025-08-28 01:42:07,563 | HR @1|5|10: 0.2663 	 0.4935 	 0.5493 	
2025-08-28 01:42:07,563 | NDCG @5|10: 0.3873 	 0.4056
2025-08-28 01:42:07,563 | domain:Kitchen
2025-08-28 01:42:07,563 | model_moe:
2025-08-28 01:42:07,564 | MRR: 0.1161
2025-08-28 01:42:07,565 | HR @1|5|10: 0.0640 	 0.1634 	 0.2164 	
2025-08-28 01:42:07,566 | NDCG @5|10: 0.1153 	 0.1324
2025-08-28 01:42:07,566 | domain:Clothing
2025-08-28 01:42:07,566 | model_moe:
2025-08-28 01:42:07,566 | MRR: 0.0243
2025-08-28 01:42:07,567 | HR @1|5|10: 0.0073 	 0.0306 	 0.0452 	
2025-08-28 01:42:07,567 | NDCG @5|10: 0.0203 	 0.0250
2025-08-28 01:42:07,569 | domain:Beauty
2025-08-28 01:42:07,569 | model_moe:
2025-08-28 01:42:07,569 | MRR: 0.2547
2025-08-28 01:42:07,570 | HR @1|5|10: 0.1842 	 0.3397 	 0.3840 	
2025-08-28 01:42:07,570 | NDCG @5|10: 0.2658 	 0.2806
2025-08-28 01:42:07,570 | 	avg_model_moe:
2025-08-28 01:42:07,570 | MRR: 0.1900
2025-08-28 01:42:07,571 | HR @1|5|10: 0.1305 	 0.2568 	 0.2987 	
2025-08-28 01:42:07,571 | NDCG @5|10: 0.1972 	 0.2109
2025-08-28 01:42:07,571 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:42:27,399 | Epoch 33/60 - client 2 -  Training Loss: 28.693

 25%|##5       | 1/4 [00:17<00:53, 17.92s/it]2025-08-28 01:42:39,372 | Epoch 33/60 - client 3 -  Training Loss: 31.496

 50%|#####     | 2/4 [00:29<00:28, 14.42s/it]2025-08-28 01:43:12,504 | Epoch 33/60 - client 1 -  Training Loss: 31.904

 75%|#######5  | 3/4 [01:03<00:22, 22.96s/it]2025-08-28 01:43:24,809 | Epoch 33/60 - client 0 -  Training Loss: 30.096

100%|##########| 4/4 [01:15<00:00, 18.76s/it]
100%|##########| 4/4 [01:15<00:00, 18.83s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:43:28,773 | Epoch33 Valid:
2025-08-28 01:43:28,774 | domain:Food
2025-08-28 01:43:28,774 | model_moe:
2025-08-28 01:43:28,774 | MRR: 0.3669
2025-08-28 01:43:28,775 | HR @1|5|10: 0.2701 	 0.4904 	 0.5516 	
2025-08-28 01:43:28,775 | NDCG @5|10: 0.3877 	 0.4079
2025-08-28 01:43:28,775 | domain:Kitchen
2025-08-28 01:43:28,776 | model_moe:
2025-08-28 01:43:28,776 | MRR: 0.1177
2025-08-28 01:43:28,776 | HR @1|5|10: 0.0663 	 0.1639 	 0.2187 	
2025-08-28 01:43:28,777 | NDCG @5|10: 0.1166 	 0.1342
2025-08-28 01:43:28,777 | domain:Clothing
2025-08-28 01:43:28,777 | model_moe:
2025-08-28 01:43:28,778 | MRR: 0.0251
2025-08-28 01:43:28,778 | HR @1|5|10: 0.0098 	 0.0318 	 0.0465 	
2025-08-28 01:43:28,778 | NDCG @5|10: 0.0213 	 0.0259
2025-08-28 01:43:28,778 | domain:Beauty
2025-08-28 01:43:28,779 | model_moe:
2025-08-28 01:43:28,779 | MRR: 0.2572
2025-08-28 01:43:28,779 | HR @1|5|10: 0.1914 	 0.3385 	 0.3900 	
2025-08-28 01:43:28,780 | NDCG @5|10: 0.2673 	 0.2842
2025-08-28 01:43:28,780 | 	avg_model_moe:
2025-08-28 01:43:28,780 | MRR: 0.1917
2025-08-28 01:43:28,780 | HR @1|5|10: 0.1344 	 0.2562 	 0.3017 	
2025-08-28 01:43:28,781 | NDCG @5|10: 0.1982 	 0.2131
2025-08-28 01:43:28,781 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:44:03,901 | Epoch 34/60 - client 1 -  Training Loss: 31.687

 25%|##5       | 1/4 [00:33<01:39, 33.17s/it]2025-08-28 01:44:15,829 | Epoch 34/60 - client 3 -  Training Loss: 31.312

 50%|#####     | 2/4 [00:45<00:41, 20.68s/it]2025-08-28 01:44:28,051 | Epoch 34/60 - client 0 -  Training Loss: 29.946

 75%|#######5  | 3/4 [00:57<00:16, 16.82s/it]2025-08-28 01:44:45,967 | Epoch 34/60 - client 2 -  Training Loss: 28.492

100%|##########| 4/4 [01:15<00:00, 17.25s/it]
100%|##########| 4/4 [01:15<00:00, 18.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:44:49,868 | Epoch34 Valid:
2025-08-28 01:44:49,869 | domain:Food
2025-08-28 01:44:49,869 | model_moe:
2025-08-28 01:44:49,869 | MRR: 0.3663
2025-08-28 01:44:49,870 | HR @1|5|10: 0.2686 	 0.4912 	 0.5509 	
2025-08-28 01:44:49,870 | NDCG @5|10: 0.3873 	 0.4071
2025-08-28 01:44:49,870 | domain:Kitchen
2025-08-28 01:44:49,870 | model_moe:
2025-08-28 01:44:49,871 | MRR: 0.1182
2025-08-28 01:44:49,871 | HR @1|5|10: 0.0649 	 0.1634 	 0.2173 	
2025-08-28 01:44:49,871 | NDCG @5|10: 0.1167 	 0.1342
2025-08-28 01:44:49,872 | domain:Clothing
2025-08-28 01:44:49,872 | model_moe:
2025-08-28 01:44:49,872 | MRR: 0.0235
2025-08-28 01:44:49,873 | HR @1|5|10: 0.0073 	 0.0318 	 0.0440 	
2025-08-28 01:44:49,873 | NDCG @5|10: 0.0200 	 0.0240
2025-08-28 01:44:49,873 | domain:Beauty
2025-08-28 01:44:49,874 | model_moe:
2025-08-28 01:44:49,874 | MRR: 0.2560
2025-08-28 01:44:49,874 | HR @1|5|10: 0.1854 	 0.3421 	 0.3935 	
2025-08-28 01:44:49,874 | NDCG @5|10: 0.2674 	 0.2842
2025-08-28 01:44:49,875 | 	avg_model_moe:
2025-08-28 01:44:49,876 | MRR: 0.1910
2025-08-28 01:44:49,877 | HR @1|5|10: 0.1316 	 0.2571 	 0.3014 	
2025-08-28 01:44:49,877 | NDCG @5|10: 0.1978 	 0.2124
2025-08-28 01:44:49,877 | Early Stopping counter: 1 out of 10
2025-08-28 01:44:49,878 | Learning rate decay counter: 1 out of 1
2025-08-28 01:44:49,878 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:45:23,151 | Epoch 35/60 - client 1 -  Training Loss: 31.490

 25%|##5       | 1/4 [00:33<01:39, 33.28s/it]2025-08-28 01:45:35,390 | Epoch 35/60 - client 0 -  Training Loss: 29.808

 50%|#####     | 2/4 [00:45<00:41, 20.90s/it]2025-08-28 01:45:53,341 | Epoch 35/60 - client 2 -  Training Loss: 28.315

 75%|#######5  | 3/4 [01:03<00:19, 19.55s/it]2025-08-28 01:46:05,288 | Epoch 35/60 - client 3 -  Training Loss: 31.142

100%|##########| 4/4 [01:15<00:00, 16.55s/it]
100%|##########| 4/4 [01:15<00:00, 18.85s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:46:09,190 | Epoch35 Valid:
2025-08-28 01:46:09,190 | domain:Food
2025-08-28 01:46:09,192 | model_moe:
2025-08-28 01:46:09,192 | MRR: 0.3663
2025-08-28 01:46:09,193 | HR @1|5|10: 0.2686 	 0.4889 	 0.5478 	
2025-08-28 01:46:09,193 | NDCG @5|10: 0.3866 	 0.4062
2025-08-28 01:46:09,193 | domain:Kitchen
2025-08-28 01:46:09,193 | model_moe:
2025-08-28 01:46:09,194 | MRR: 0.1200
2025-08-28 01:46:09,196 | HR @1|5|10: 0.0668 	 0.1680 	 0.2155 	
2025-08-28 01:46:09,197 | NDCG @5|10: 0.1197 	 0.1351
2025-08-28 01:46:09,197 | domain:Clothing
2025-08-28 01:46:09,197 | model_moe:
2025-08-28 01:46:09,198 | MRR: 0.0248
2025-08-28 01:46:09,198 | HR @1|5|10: 0.0086 	 0.0330 	 0.0477 	
2025-08-28 01:46:09,198 | NDCG @5|10: 0.0213 	 0.0259
2025-08-28 01:46:09,199 | domain:Beauty
2025-08-28 01:46:09,200 | model_moe:
2025-08-28 01:46:09,200 | MRR: 0.2562
2025-08-28 01:46:09,200 | HR @1|5|10: 0.1902 	 0.3385 	 0.3911 	
2025-08-28 01:46:09,201 | NDCG @5|10: 0.2665 	 0.2837
2025-08-28 01:46:09,201 | 	avg_model_moe:
2025-08-28 01:46:09,201 | MRR: 0.1918
2025-08-28 01:46:09,202 | HR @1|5|10: 0.1335 	 0.2571 	 0.3005 	
2025-08-28 01:46:09,202 | NDCG @5|10: 0.1985 	 0.2127
2025-08-28 01:46:09,202 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:46:24,295 | Epoch 36/60 - client 0 -  Training Loss: 29.681

 25%|##5       | 1/4 [00:13<00:39, 13.09s/it]2025-08-28 01:46:57,631 | Epoch 36/60 - client 1 -  Training Loss: 31.296

 50%|#####     | 2/4 [00:46<00:49, 25.00s/it]2025-08-28 01:47:15,703 | Epoch 36/60 - client 2 -  Training Loss: 28.134

 75%|#######5  | 3/4 [01:04<00:21, 21.84s/it]2025-08-28 01:47:27,775 | Epoch 36/60 - client 3 -  Training Loss: 30.971

100%|##########| 4/4 [01:16<00:00, 17.98s/it]
100%|##########| 4/4 [01:16<00:00, 19.14s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:47:31,720 | Epoch36 Valid:
2025-08-28 01:47:31,720 | domain:Food
2025-08-28 01:47:31,721 | model_moe:
2025-08-28 01:47:31,721 | MRR: 0.3671
2025-08-28 01:47:31,721 | HR @1|5|10: 0.2701 	 0.4927 	 0.5486 	
2025-08-28 01:47:31,722 | NDCG @5|10: 0.3885 	 0.4070
2025-08-28 01:47:31,722 | domain:Kitchen
2025-08-28 01:47:31,722 | model_moe:
2025-08-28 01:47:31,723 | MRR: 0.1187
2025-08-28 01:47:31,723 | HR @1|5|10: 0.0645 	 0.1662 	 0.2210 	
2025-08-28 01:47:31,723 | NDCG @5|10: 0.1180 	 0.1355
2025-08-28 01:47:31,724 | domain:Clothing
2025-08-28 01:47:31,724 | model_moe:
2025-08-28 01:47:31,724 | MRR: 0.0260
2025-08-28 01:47:31,724 | HR @1|5|10: 0.0110 	 0.0318 	 0.0489 	
2025-08-28 01:47:31,725 | NDCG @5|10: 0.0217 	 0.0272
2025-08-28 01:47:31,725 | domain:Beauty
2025-08-28 01:47:31,725 | model_moe:
2025-08-28 01:47:31,726 | MRR: 0.2536
2025-08-28 01:47:31,726 | HR @1|5|10: 0.1818 	 0.3361 	 0.3911 	
2025-08-28 01:47:31,726 | NDCG @5|10: 0.2636 	 0.2819
2025-08-28 01:47:31,726 | 	avg_model_moe:
2025-08-28 01:47:31,727 | MRR: 0.1914
2025-08-28 01:47:31,727 | HR @1|5|10: 0.1318 	 0.2567 	 0.3024 	
2025-08-28 01:47:31,727 | NDCG @5|10: 0.1979 	 0.2129
2025-08-28 01:47:31,728 | Early Stopping counter: 1 out of 10
2025-08-28 01:47:31,728 | Learning rate decay counter: 1 out of 1
2025-08-28 01:47:31,728 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:48:04,979 | Epoch 37/60 - client 1 -  Training Loss: 31.116

 25%|##5       | 1/4 [00:33<01:39, 33.25s/it]2025-08-28 01:48:23,017 | Epoch 37/60 - client 2 -  Training Loss: 27.972

 50%|#####     | 2/4 [00:51<00:48, 24.30s/it]2025-08-28 01:48:35,401 | Epoch 37/60 - client 0 -  Training Loss: 29.548

 75%|#######5  | 3/4 [01:03<00:18, 18.86s/it]2025-08-28 01:48:47,582 | Epoch 37/60 - client 3 -  Training Loss: 30.805

100%|##########| 4/4 [01:15<00:00, 16.22s/it]
100%|##########| 4/4 [01:15<00:00, 18.96s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:48:51,538 | Epoch37 Valid:
2025-08-28 01:48:51,539 | domain:Food
2025-08-28 01:48:51,539 | model_moe:
2025-08-28 01:48:51,539 | MRR: 0.3670
2025-08-28 01:48:51,540 | HR @1|5|10: 0.2701 	 0.4897 	 0.5486 	
2025-08-28 01:48:51,540 | NDCG @5|10: 0.3877 	 0.4071
2025-08-28 01:48:51,541 | domain:Kitchen
2025-08-28 01:48:51,541 | model_moe:
2025-08-28 01:48:51,541 | MRR: 0.1209
2025-08-28 01:48:51,542 | HR @1|5|10: 0.0677 	 0.1680 	 0.2192 	
2025-08-28 01:48:51,542 | NDCG @5|10: 0.1203 	 0.1367
2025-08-28 01:48:51,542 | domain:Clothing
2025-08-28 01:48:51,542 | model_moe:
2025-08-28 01:48:51,543 | MRR: 0.0253
2025-08-28 01:48:51,543 | HR @1|5|10: 0.0086 	 0.0355 	 0.0538 	
2025-08-28 01:48:51,543 | NDCG @5|10: 0.0223 	 0.0281
2025-08-28 01:48:51,544 | domain:Beauty
2025-08-28 01:48:51,544 | model_moe:
2025-08-28 01:48:51,544 | MRR: 0.2575
2025-08-28 01:48:51,545 | HR @1|5|10: 0.1890 	 0.3385 	 0.3900 	
2025-08-28 01:48:51,545 | NDCG @5|10: 0.2675 	 0.2843
2025-08-28 01:48:51,545 | 	avg_model_moe:
2025-08-28 01:48:51,545 | MRR: 0.1927
2025-08-28 01:48:51,546 | HR @1|5|10: 0.1338 	 0.2579 	 0.3029 	
2025-08-28 01:48:51,546 | NDCG @5|10: 0.1994 	 0.2140
2025-08-28 01:48:51,546 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:49:05,925 | Epoch 38/60 - client 0 -  Training Loss: 29.423

 25%|##5       | 1/4 [00:12<00:36, 12.29s/it]2025-08-28 01:49:17,922 | Epoch 38/60 - client 3 -  Training Loss: 30.652

 50%|#####     | 2/4 [00:24<00:24, 12.12s/it]2025-08-28 01:49:35,863 | Epoch 38/60 - client 2 -  Training Loss: 27.804

 75%|#######5  | 3/4 [00:42<00:14, 14.78s/it]2025-08-28 01:50:08,906 | Epoch 38/60 - client 1 -  Training Loss: 30.935

100%|##########| 4/4 [01:15<00:00, 21.99s/it]
100%|##########| 4/4 [01:15<00:00, 18.82s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-28 01:50:12,831 | Epoch38 Valid:
2025-08-28 01:50:12,832 | domain:Food
2025-08-28 01:50:12,832 | model_moe:
2025-08-28 01:50:12,832 | MRR: 0.3647
2025-08-28 01:50:12,833 | HR @1|5|10: 0.2655 	 0.4943 	 0.5509 	
2025-08-28 01:50:12,833 | NDCG @5|10: 0.3874 	 0.4060
2025-08-28 01:50:12,833 | domain:Kitchen
2025-08-28 01:50:12,834 | model_moe:
2025-08-28 01:50:12,834 | MRR: 0.1211
2025-08-28 01:50:12,834 | HR @1|5|10: 0.0681 	 0.1662 	 0.2201 	
2025-08-28 01:50:12,835 | NDCG @5|10: 0.1197 	 0.1370
2025-08-28 01:50:12,835 | domain:Clothing
2025-08-28 01:50:12,835 | model_moe:
2025-08-28 01:50:12,835 | MRR: 0.0255
2025-08-28 01:50:12,836 | HR @1|5|10: 0.0098 	 0.0342 	 0.0501 	
2025-08-28 01:50:12,836 | NDCG @5|10: 0.0220 	 0.0272
2025-08-28 01:50:12,836 | domain:Beauty
2025-08-28 01:50:12,837 | model_moe:
2025-08-28 01:50:12,837 | MRR: 0.2541
2025-08-28 01:50:12,837 | HR @1|5|10: 0.1830 	 0.3385 	 0.3947 	
2025-08-28 01:50:12,838 | NDCG @5|10: 0.2649 	 0.2832
2025-08-28 01:50:12,838 | 	avg_model_moe:
2025-08-28 01:50:12,838 | MRR: 0.1914
2025-08-28 01:50:12,838 | HR @1|5|10: 0.1316 	 0.2583 	 0.3040 	
2025-08-28 01:50:12,839 | NDCG @5|10: 0.1985 	 0.2134
2025-08-28 01:50:12,839 | Early Stopping counter: 1 out of 10
2025-08-28 01:50:12,839 | Learning rate decay counter: 1 out of 1
2025-08-28 01:50:12,840 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:50:46,009 | Epoch 39/60 - client 1 -  Training Loss: 30.752

 25%|##5       | 1/4 [00:33<01:39, 33.17s/it]2025-08-28 01:50:58,116 | Epoch 39/60 - client 3 -  Training Loss: 30.495

 50%|#####     | 2/4 [00:45<00:41, 20.78s/it]2025-08-28 01:51:10,819 | Epoch 39/60 - client 0 -  Training Loss: 29.299

 75%|#######5  | 3/4 [00:57<00:17, 17.09s/it]2025-08-28 01:51:28,780 | Epoch 39/60 - client 2 -  Training Loss: 27.635

100%|##########| 4/4 [01:15<00:00, 17.43s/it]
100%|##########| 4/4 [01:15<00:00, 18.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:51:32,680 | Epoch39 Valid:
2025-08-28 01:51:32,680 | domain:Food
2025-08-28 01:51:32,680 | model_moe:
2025-08-28 01:51:32,681 | MRR: 0.3669
2025-08-28 01:51:32,681 | HR @1|5|10: 0.2701 	 0.4912 	 0.5509 	
2025-08-28 01:51:32,681 | NDCG @5|10: 0.3879 	 0.4075
2025-08-28 01:51:32,682 | domain:Kitchen
2025-08-28 01:51:32,682 | model_moe:
2025-08-28 01:51:32,682 | MRR: 0.1236
2025-08-28 01:51:32,683 | HR @1|5|10: 0.0709 	 0.1703 	 0.2215 	
2025-08-28 01:51:32,683 | NDCG @5|10: 0.1228 	 0.1393
2025-08-28 01:51:32,683 | domain:Clothing
2025-08-28 01:51:32,684 | model_moe:
2025-08-28 01:51:32,684 | MRR: 0.0259
2025-08-28 01:51:32,684 | HR @1|5|10: 0.0098 	 0.0330 	 0.0465 	
2025-08-28 01:51:32,685 | NDCG @5|10: 0.0220 	 0.0265
2025-08-28 01:51:32,685 | domain:Beauty
2025-08-28 01:51:32,685 | model_moe:
2025-08-28 01:51:32,686 | MRR: 0.2556
2025-08-28 01:51:32,686 | HR @1|5|10: 0.1866 	 0.3409 	 0.3923 	
2025-08-28 01:51:32,686 | NDCG @5|10: 0.2667 	 0.2835
2025-08-28 01:51:32,686 | 	avg_model_moe:
2025-08-28 01:51:32,687 | MRR: 0.1930
2025-08-28 01:51:32,687 | HR @1|5|10: 0.1343 	 0.2589 	 0.3028 	
2025-08-28 01:51:32,687 | NDCG @5|10: 0.1998 	 0.2142
2025-08-28 01:51:32,688 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:51:46,874 | Epoch 40/60 - client 0 -  Training Loss: 29.184

 25%|##5       | 1/4 [00:12<00:36, 12.30s/it]2025-08-28 01:52:04,925 | Epoch 40/60 - client 2 -  Training Loss: 27.497

 50%|#####     | 2/4 [00:30<00:31, 15.68s/it]2025-08-28 01:52:16,838 | Epoch 40/60 - client 3 -  Training Loss: 30.363

 75%|#######5  | 3/4 [00:42<00:13, 13.96s/it]2025-08-28 01:52:49,790 | Epoch 40/60 - client 1 -  Training Loss: 30.581

100%|##########| 4/4 [01:15<00:00, 21.46s/it]
100%|##########| 4/4 [01:15<00:00, 18.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:52:53,688 | Epoch40 Valid:
2025-08-28 01:52:53,689 | domain:Food
2025-08-28 01:52:53,689 | model_moe:
2025-08-28 01:52:53,690 | MRR: 0.3661
2025-08-28 01:52:53,690 | HR @1|5|10: 0.2678 	 0.4935 	 0.5516 	
2025-08-28 01:52:53,690 | NDCG @5|10: 0.3881 	 0.4071
2025-08-28 01:52:53,691 | domain:Kitchen
2025-08-28 01:52:53,691 | model_moe:
2025-08-28 01:52:53,691 | MRR: 0.1217
2025-08-28 01:52:53,691 | HR @1|5|10: 0.0681 	 0.1680 	 0.2182 	
2025-08-28 01:52:53,692 | NDCG @5|10: 0.1208 	 0.1370
2025-08-28 01:52:53,692 | domain:Clothing
2025-08-28 01:52:53,692 | model_moe:
2025-08-28 01:52:53,693 | MRR: 0.0264
2025-08-28 01:52:53,693 | HR @1|5|10: 0.0098 	 0.0318 	 0.0501 	
2025-08-28 01:52:53,693 | NDCG @5|10: 0.0219 	 0.0278
2025-08-28 01:52:53,694 | domain:Beauty
2025-08-28 01:52:53,694 | model_moe:
2025-08-28 01:52:53,694 | MRR: 0.2537
2025-08-28 01:52:53,694 | HR @1|5|10: 0.1830 	 0.3421 	 0.3876 	
2025-08-28 01:52:53,695 | NDCG @5|10: 0.2660 	 0.2810
2025-08-28 01:52:53,695 | 	avg_model_moe:
2025-08-28 01:52:53,695 | MRR: 0.1920
2025-08-28 01:52:53,696 | HR @1|5|10: 0.1322 	 0.2589 	 0.3019 	
2025-08-28 01:52:53,696 | NDCG @5|10: 0.1992 	 0.2132
2025-08-28 01:52:53,696 | Early Stopping counter: 1 out of 10
2025-08-28 01:52:53,697 | Learning rate decay counter: 1 out of 1
2025-08-28 01:52:53,697 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:53:26,600 | Epoch 41/60 - client 1 -  Training Loss: 30.417

 25%|##5       | 1/4 [00:32<01:38, 32.90s/it]2025-08-28 01:53:44,543 | Epoch 41/60 - client 2 -  Training Loss: 27.356

 50%|#####     | 2/4 [00:50<00:48, 24.10s/it]2025-08-28 01:53:56,703 | Epoch 41/60 - client 0 -  Training Loss: 29.083

 75%|#######5  | 3/4 [01:03<00:18, 18.65s/it]2025-08-28 01:54:08,571 | Epoch 41/60 - client 3 -  Training Loss: 30.233

100%|##########| 4/4 [01:14<00:00, 15.97s/it]
100%|##########| 4/4 [01:14<00:00, 18.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:54:12,479 | Epoch41 Valid:
2025-08-28 01:54:12,480 | domain:Food
2025-08-28 01:54:12,480 | model_moe:
2025-08-28 01:54:12,480 | MRR: 0.3664
2025-08-28 01:54:12,481 | HR @1|5|10: 0.2701 	 0.4904 	 0.5501 	
2025-08-28 01:54:12,481 | NDCG @5|10: 0.3875 	 0.4070
2025-08-28 01:54:12,481 | domain:Kitchen
2025-08-28 01:54:12,482 | model_moe:
2025-08-28 01:54:12,482 | MRR: 0.1246
2025-08-28 01:54:12,482 | HR @1|5|10: 0.0718 	 0.1727 	 0.2210 	
2025-08-28 01:54:12,482 | NDCG @5|10: 0.1243 	 0.1398
2025-08-28 01:54:12,483 | domain:Clothing
2025-08-28 01:54:12,483 | model_moe:
2025-08-28 01:54:12,483 | MRR: 0.0275
2025-08-28 01:54:12,484 | HR @1|5|10: 0.0110 	 0.0355 	 0.0526 	
2025-08-28 01:54:12,484 | NDCG @5|10: 0.0238 	 0.0293
2025-08-28 01:54:12,484 | domain:Beauty
2025-08-28 01:54:12,485 | model_moe:
2025-08-28 01:54:12,485 | MRR: 0.2549
2025-08-28 01:54:12,485 | HR @1|5|10: 0.1854 	 0.3421 	 0.3888 	
2025-08-28 01:54:12,485 | NDCG @5|10: 0.2667 	 0.2820
2025-08-28 01:54:12,486 | 	avg_model_moe:
2025-08-28 01:54:12,486 | MRR: 0.1933
2025-08-28 01:54:12,486 | HR @1|5|10: 0.1346 	 0.2602 	 0.3031 	
2025-08-28 01:54:12,487 | NDCG @5|10: 0.2006 	 0.2145
2025-08-28 01:54:12,487 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:54:47,534 | Epoch 42/60 - client 1 -  Training Loss: 30.264

 25%|##5       | 1/4 [00:32<01:38, 32.94s/it]2025-08-28 01:55:05,436 | Epoch 42/60 - client 2 -  Training Loss: 27.225

 50%|#####     | 2/4 [00:50<00:48, 24.09s/it]2025-08-28 01:55:17,325 | Epoch 42/60 - client 3 -  Training Loss: 30.090

 75%|#######5  | 3/4 [01:02<00:18, 18.52s/it]2025-08-28 01:55:29,533 | Epoch 42/60 - client 0 -  Training Loss: 28.966

100%|##########| 4/4 [01:14<00:00, 16.03s/it]
100%|##########| 4/4 [01:14<00:00, 18.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-28 01:55:33,411 | Epoch42 Valid:
2025-08-28 01:55:33,411 | domain:Food
2025-08-28 01:55:33,412 | model_moe:
2025-08-28 01:55:33,412 | MRR: 0.3666
2025-08-28 01:55:33,412 | HR @1|5|10: 0.2708 	 0.4904 	 0.5478 	
2025-08-28 01:55:33,413 | NDCG @5|10: 0.3878 	 0.4066
2025-08-28 01:55:33,413 | domain:Kitchen
2025-08-28 01:55:33,413 | model_moe:
2025-08-28 01:55:33,414 | MRR: 0.1236
2025-08-28 01:55:33,414 | HR @1|5|10: 0.0700 	 0.1717 	 0.2205 	
2025-08-28 01:55:33,414 | NDCG @5|10: 0.1234 	 0.1390
2025-08-28 01:55:33,415 | domain:Clothing
2025-08-28 01:55:33,415 | model_moe:
2025-08-28 01:55:33,415 | MRR: 0.0258
2025-08-28 01:55:33,415 | HR @1|5|10: 0.0098 	 0.0342 	 0.0465 	
2025-08-28 01:55:33,416 | NDCG @5|10: 0.0224 	 0.0262
2025-08-28 01:55:33,416 | domain:Beauty
2025-08-28 01:55:33,416 | model_moe:
2025-08-28 01:55:33,417 | MRR: 0.2574
2025-08-28 01:55:33,417 | HR @1|5|10: 0.1902 	 0.3385 	 0.3888 	
2025-08-28 01:55:33,417 | NDCG @5|10: 0.2673 	 0.2837
2025-08-28 01:55:33,417 | 	avg_model_moe:
2025-08-28 01:55:33,418 | MRR: 0.1933
2025-08-28 01:55:33,418 | HR @1|5|10: 0.1352 	 0.2587 	 0.3009 	
2025-08-28 01:55:33,418 | NDCG @5|10: 0.2002 	 0.2139
2025-08-28 01:55:33,419 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:56:08,391 | Epoch 43/60 - client 1 -  Training Loss: 30.105

 25%|##5       | 1/4 [00:33<01:39, 33.06s/it]2025-08-28 01:56:26,330 | Epoch 43/60 - client 2 -  Training Loss: 27.095

 50%|#####     | 2/4 [00:51<00:48, 24.17s/it]2025-08-28 01:56:38,286 | Epoch 43/60 - client 3 -  Training Loss: 29.949

 75%|#######5  | 3/4 [01:02<00:18, 18.59s/it]2025-08-28 01:56:50,533 | Epoch 43/60 - client 0 -  Training Loss: 28.860

100%|##########| 4/4 [01:15<00:00, 16.09s/it]
100%|##########| 4/4 [01:15<00:00, 18.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.06s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-28 01:56:54,493 | Epoch43 Valid:
2025-08-28 01:56:54,494 | domain:Food
2025-08-28 01:56:54,494 | model_moe:
2025-08-28 01:56:54,495 | MRR: 0.3677
2025-08-28 01:56:54,495 | HR @1|5|10: 0.2716 	 0.4904 	 0.5524 	
2025-08-28 01:56:54,495 | NDCG @5|10: 0.3885 	 0.4086
2025-08-28 01:56:54,496 | domain:Kitchen
2025-08-28 01:56:54,496 | model_moe:
2025-08-28 01:56:54,496 | MRR: 0.1223
2025-08-28 01:56:54,497 | HR @1|5|10: 0.0681 	 0.1708 	 0.2238 	
2025-08-28 01:56:54,497 | NDCG @5|10: 0.1218 	 0.1389
2025-08-28 01:56:54,497 | domain:Clothing
2025-08-28 01:56:54,497 | model_moe:
2025-08-28 01:56:54,498 | MRR: 0.0269
2025-08-28 01:56:54,498 | HR @1|5|10: 0.0098 	 0.0379 	 0.0477 	
2025-08-28 01:56:54,498 | NDCG @5|10: 0.0244 	 0.0276
2025-08-28 01:56:54,499 | domain:Beauty
2025-08-28 01:56:54,499 | model_moe:
2025-08-28 01:56:54,499 | MRR: 0.2542
2025-08-28 01:56:54,500 | HR @1|5|10: 0.1842 	 0.3421 	 0.3864 	
2025-08-28 01:56:54,500 | NDCG @5|10: 0.2665 	 0.2808
2025-08-28 01:56:54,500 | 	avg_model_moe:
2025-08-28 01:56:54,500 | MRR: 0.1927
2025-08-28 01:56:54,501 | HR @1|5|10: 0.1334 	 0.2603 	 0.3026 	
2025-08-28 01:56:54,501 | NDCG @5|10: 0.2003 	 0.2140
2025-08-28 01:56:54,501 | Early Stopping counter: 1 out of 10
2025-08-28 01:56:54,502 | Learning rate decay counter: 1 out of 1
2025-08-28 01:56:54,502 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:57:27,535 | Epoch 44/60 - client 1 -  Training Loss: 29.960

 25%|##5       | 1/4 [00:33<01:39, 33.03s/it]2025-08-28 01:57:39,471 | Epoch 44/60 - client 3 -  Training Loss: 29.831

 50%|#####     | 2/4 [00:44<00:41, 20.62s/it]2025-08-28 01:57:51,697 | Epoch 44/60 - client 0 -  Training Loss: 28.760

 75%|#######5  | 3/4 [00:57<00:16, 16.79s/it]2025-08-28 01:58:09,613 | Epoch 44/60 - client 2 -  Training Loss: 26.969

100%|##########| 4/4 [01:15<00:00, 17.23s/it]
100%|##########| 4/4 [01:15<00:00, 18.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 01:58:13,508 | Epoch44 Valid:
2025-08-28 01:58:13,509 | domain:Food
2025-08-28 01:58:13,509 | model_moe:
2025-08-28 01:58:13,509 | MRR: 0.3649
2025-08-28 01:58:13,510 | HR @1|5|10: 0.2670 	 0.4904 	 0.5463 	
2025-08-28 01:58:13,510 | NDCG @5|10: 0.3865 	 0.4049
2025-08-28 01:58:13,510 | domain:Kitchen
2025-08-28 01:58:13,511 | model_moe:
2025-08-28 01:58:13,511 | MRR: 0.1223
2025-08-28 01:58:13,511 | HR @1|5|10: 0.0672 	 0.1722 	 0.2242 	
2025-08-28 01:58:13,512 | NDCG @5|10: 0.1222 	 0.1390
2025-08-28 01:58:13,512 | domain:Clothing
2025-08-28 01:58:13,512 | model_moe:
2025-08-28 01:58:13,513 | MRR: 0.0266
2025-08-28 01:58:13,513 | HR @1|5|10: 0.0086 	 0.0379 	 0.0501 	
2025-08-28 01:58:13,513 | NDCG @5|10: 0.0242 	 0.0282
2025-08-28 01:58:13,514 | domain:Beauty
2025-08-28 01:58:13,514 | model_moe:
2025-08-28 01:58:13,514 | MRR: 0.2559
2025-08-28 01:58:13,514 | HR @1|5|10: 0.1878 	 0.3397 	 0.3911 	
2025-08-28 01:58:13,515 | NDCG @5|10: 0.2665 	 0.2832
2025-08-28 01:58:13,515 | 	avg_model_moe:
2025-08-28 01:58:13,515 | MRR: 0.1924
2025-08-28 01:58:13,516 | HR @1|5|10: 0.1326 	 0.2601 	 0.3029 	
2025-08-28 01:58:13,516 | NDCG @5|10: 0.1999 	 0.2138
2025-08-28 01:58:13,516 | Early Stopping counter: 2 out of 10
2025-08-28 01:58:13,517 | Learning rate decay counter: 1 out of 1
2025-08-28 01:58:13,517 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 01:58:25,734 | Epoch 45/60 - client 0 -  Training Loss: 28.662

 25%|##5       | 1/4 [00:12<00:36, 12.22s/it]2025-08-28 01:58:58,781 | Epoch 45/60 - client 1 -  Training Loss: 29.814

 50%|#####     | 2/4 [00:45<00:48, 24.47s/it]2025-08-28 01:59:16,666 | Epoch 45/60 - client 2 -  Training Loss: 26.846

 75%|#######5  | 3/4 [01:03<00:21, 21.46s/it]2025-08-28 01:59:28,561 | Epoch 45/60 - client 3 -  Training Loss: 29.698

100%|##########| 4/4 [01:15<00:00, 17.69s/it]
100%|##########| 4/4 [01:15<00:00, 18.76s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-28 01:59:32,429 | Epoch45 Valid:
2025-08-28 01:59:32,430 | domain:Food
2025-08-28 01:59:32,430 | model_moe:
2025-08-28 01:59:32,430 | MRR: 0.3643
2025-08-28 01:59:32,431 | HR @1|5|10: 0.2670 	 0.4874 	 0.5463 	
2025-08-28 01:59:32,431 | NDCG @5|10: 0.3851 	 0.4045
2025-08-28 01:59:32,431 | domain:Kitchen
2025-08-28 01:59:32,432 | model_moe:
2025-08-28 01:59:32,432 | MRR: 0.1232
2025-08-28 01:59:32,432 | HR @1|5|10: 0.0691 	 0.1727 	 0.2215 	
2025-08-28 01:59:32,433 | NDCG @5|10: 0.1233 	 0.1391
2025-08-28 01:59:32,433 | domain:Clothing
2025-08-28 01:59:32,433 | model_moe:
2025-08-28 01:59:32,433 | MRR: 0.0266
2025-08-28 01:59:32,434 | HR @1|5|10: 0.0098 	 0.0342 	 0.0465 	
2025-08-28 01:59:32,434 | NDCG @5|10: 0.0231 	 0.0271
2025-08-28 01:59:32,434 | domain:Beauty
2025-08-28 01:59:32,435 | model_moe:
2025-08-28 01:59:32,435 | MRR: 0.2516
2025-08-28 01:59:32,435 | HR @1|5|10: 0.1794 	 0.3361 	 0.3876 	
2025-08-28 01:59:32,436 | NDCG @5|10: 0.2622 	 0.2791
2025-08-28 01:59:32,436 | 	avg_model_moe:
2025-08-28 01:59:32,436 | MRR: 0.1914
2025-08-28 01:59:32,436 | HR @1|5|10: 0.1313 	 0.2576 	 0.3004 	
2025-08-28 01:59:32,437 | NDCG @5|10: 0.1984 	 0.2124
2025-08-28 01:59:32,437 | Early Stopping counter: 3 out of 10
2025-08-28 01:59:32,437 | Learning rate decay counter: 1 out of 1
2025-08-28 01:59:32,438 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 02:00:05,422 | Epoch 46/60 - client 1 -  Training Loss: 29.671

 25%|##5       | 1/4 [00:32<01:38, 32.99s/it]2025-08-28 02:00:17,592 | Epoch 46/60 - client 0 -  Training Loss: 28.566

 50%|#####     | 2/4 [00:45<00:41, 20.74s/it]2025-08-28 02:00:29,469 | Epoch 46/60 - client 3 -  Training Loss: 29.571

 75%|#######5  | 3/4 [00:57<00:16, 16.69s/it]2025-08-28 02:00:47,321 | Epoch 46/60 - client 2 -  Training Loss: 26.733

100%|##########| 4/4 [01:14<00:00, 17.15s/it]
100%|##########| 4/4 [01:14<00:00, 18.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-28 02:00:51,178 | Epoch46 Valid:
2025-08-28 02:00:51,178 | domain:Food
2025-08-28 02:00:51,179 | model_moe:
2025-08-28 02:00:51,179 | MRR: 0.3665
2025-08-28 02:00:51,179 | HR @1|5|10: 0.2716 	 0.4897 	 0.5486 	
2025-08-28 02:00:51,180 | NDCG @5|10: 0.3874 	 0.4067
2025-08-28 02:00:51,180 | domain:Kitchen
2025-08-28 02:00:51,180 | model_moe:
2025-08-28 02:00:51,180 | MRR: 0.1244
2025-08-28 02:00:51,181 | HR @1|5|10: 0.0695 	 0.1722 	 0.2233 	
2025-08-28 02:00:51,181 | NDCG @5|10: 0.1240 	 0.1405
2025-08-28 02:00:51,181 | domain:Clothing
2025-08-28 02:00:51,182 | model_moe:
2025-08-28 02:00:51,182 | MRR: 0.0270
2025-08-28 02:00:51,182 | HR @1|5|10: 0.0110 	 0.0367 	 0.0489 	
2025-08-28 02:00:51,183 | NDCG @5|10: 0.0242 	 0.0281
2025-08-28 02:00:51,183 | domain:Beauty
2025-08-28 02:00:51,183 | model_moe:
2025-08-28 02:00:51,183 | MRR: 0.2545
2025-08-28 02:00:51,184 | HR @1|5|10: 0.1854 	 0.3397 	 0.3876 	
2025-08-28 02:00:51,184 | NDCG @5|10: 0.2658 	 0.2815
2025-08-28 02:00:51,184 | 	avg_model_moe:
2025-08-28 02:00:51,185 | MRR: 0.1931
2025-08-28 02:00:51,185 | HR @1|5|10: 0.1344 	 0.2596 	 0.3021 	
2025-08-28 02:00:51,185 | NDCG @5|10: 0.2003 	 0.2142
2025-08-28 02:00:51,186 | Early Stopping counter: 4 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 02:01:03,368 | Epoch 47/60 - client 0 -  Training Loss: 28.473

 25%|##5       | 1/4 [00:12<00:36, 12.19s/it]2025-08-28 02:01:15,281 | Epoch 47/60 - client 3 -  Training Loss: 29.448

 50%|#####     | 2/4 [00:24<00:24, 12.03s/it]2025-08-28 02:01:48,241 | Epoch 47/60 - client 1 -  Training Loss: 29.540

 75%|#######5  | 3/4 [00:57<00:21, 21.58s/it]2025-08-28 02:02:06,104 | Epoch 47/60 - client 2 -  Training Loss: 26.619

100%|##########| 4/4 [01:14<00:00, 20.11s/it]
100%|##########| 4/4 [01:14<00:00, 18.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 02:02:09,997 | Epoch47 Valid:
2025-08-28 02:02:09,998 | domain:Food
2025-08-28 02:02:09,998 | model_moe:
2025-08-28 02:02:09,998 | MRR: 0.3654
2025-08-28 02:02:09,999 | HR @1|5|10: 0.2686 	 0.4927 	 0.5478 	
2025-08-28 02:02:09,999 | NDCG @5|10: 0.3878 	 0.4058
2025-08-28 02:02:09,999 | domain:Kitchen
2025-08-28 02:02:10,000 | model_moe:
2025-08-28 02:02:10,000 | MRR: 0.1229
2025-08-28 02:02:10,000 | HR @1|5|10: 0.0677 	 0.1727 	 0.2238 	
2025-08-28 02:02:10,001 | NDCG @5|10: 0.1230 	 0.1396
2025-08-28 02:02:10,001 | domain:Clothing
2025-08-28 02:02:10,001 | model_moe:
2025-08-28 02:02:10,001 | MRR: 0.0268
2025-08-28 02:02:10,002 | HR @1|5|10: 0.0110 	 0.0342 	 0.0501 	
2025-08-28 02:02:10,002 | NDCG @5|10: 0.0230 	 0.0282
2025-08-28 02:02:10,002 | domain:Beauty
2025-08-28 02:02:10,003 | model_moe:
2025-08-28 02:02:10,003 | MRR: 0.2523
2025-08-28 02:02:10,003 | HR @1|5|10: 0.1794 	 0.3373 	 0.3923 	
2025-08-28 02:02:10,004 | NDCG @5|10: 0.2630 	 0.2811
2025-08-28 02:02:10,004 | 	avg_model_moe:
2025-08-28 02:02:10,004 | MRR: 0.1918
2025-08-28 02:02:10,005 | HR @1|5|10: 0.1317 	 0.2592 	 0.3035 	
2025-08-28 02:02:10,005 | NDCG @5|10: 0.1992 	 0.2137
2025-08-28 02:02:10,005 | Early Stopping counter: 5 out of 10
2025-08-28 02:02:10,005 | Learning rate decay counter: 1 out of 1
2025-08-28 02:02:10,006 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 02:02:42,955 | Epoch 48/60 - client 1 -  Training Loss: 29.413

 25%|##5       | 1/4 [00:32<01:38, 32.95s/it]2025-08-28 02:02:55,115 | Epoch 48/60 - client 0 -  Training Loss: 28.392

 50%|#####     | 2/4 [00:45<00:41, 20.72s/it]2025-08-28 02:03:06,992 | Epoch 48/60 - client 3 -  Training Loss: 29.334

 75%|#######5  | 3/4 [00:56<00:16, 16.68s/it]2025-08-28 02:03:24,860 | Epoch 48/60 - client 2 -  Training Loss: 26.513

100%|##########| 4/4 [01:14<00:00, 17.15s/it]
100%|##########| 4/4 [01:14<00:00, 18.71s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-28 02:03:28,721 | Epoch48 Valid:
2025-08-28 02:03:28,722 | domain:Food
2025-08-28 02:03:28,722 | model_moe:
2025-08-28 02:03:28,722 | MRR: 0.3635
2025-08-28 02:03:28,723 | HR @1|5|10: 0.2655 	 0.4912 	 0.5516 	
2025-08-28 02:03:28,723 | NDCG @5|10: 0.3859 	 0.4054
2025-08-28 02:03:28,724 | domain:Kitchen
2025-08-28 02:03:28,725 | model_moe:
2025-08-28 02:03:28,725 | MRR: 0.1242
2025-08-28 02:03:28,725 | HR @1|5|10: 0.0700 	 0.1717 	 0.2251 	
2025-08-28 02:03:28,726 | NDCG @5|10: 0.1236 	 0.1409
2025-08-28 02:03:28,726 | domain:Clothing
2025-08-28 02:03:28,726 | model_moe:
2025-08-28 02:03:28,727 | MRR: 0.0274
2025-08-28 02:03:28,727 | HR @1|5|10: 0.0110 	 0.0391 	 0.0477 	
2025-08-28 02:03:28,727 | NDCG @5|10: 0.0251 	 0.0279
2025-08-28 02:03:28,728 | domain:Beauty
2025-08-28 02:03:28,728 | model_moe:
2025-08-28 02:03:28,728 | MRR: 0.2547
2025-08-28 02:03:28,728 | HR @1|5|10: 0.1854 	 0.3409 	 0.3900 	
2025-08-28 02:03:28,729 | NDCG @5|10: 0.2660 	 0.2822
2025-08-28 02:03:28,729 | 	avg_model_moe:
2025-08-28 02:03:28,729 | MRR: 0.1924
2025-08-28 02:03:28,730 | HR @1|5|10: 0.1330 	 0.2607 	 0.3036 	
2025-08-28 02:03:28,730 | NDCG @5|10: 0.2002 	 0.2141
2025-08-28 02:03:28,730 | Early Stopping counter: 6 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 02:03:46,586 | Epoch 49/60 - client 2 -  Training Loss: 26.408

 25%|##5       | 1/4 [00:17<00:53, 17.86s/it]2025-08-28 02:04:19,524 | Epoch 49/60 - client 1 -  Training Loss: 29.280

 50%|#####     | 2/4 [00:50<00:53, 26.73s/it]2025-08-28 02:04:31,399 | Epoch 49/60 - client 3 -  Training Loss: 29.224

 75%|#######5  | 3/4 [01:02<00:19, 19.95s/it]2025-08-28 02:04:43,563 | Epoch 49/60 - client 0 -  Training Loss: 28.313

100%|##########| 4/4 [01:14<00:00, 16.87s/it]
100%|##########| 4/4 [01:14<00:00, 18.71s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-28 02:04:47,418 | Epoch49 Valid:
2025-08-28 02:04:47,419 | domain:Food
2025-08-28 02:04:47,420 | model_moe:
2025-08-28 02:04:47,420 | MRR: 0.3649
2025-08-28 02:04:47,420 | HR @1|5|10: 0.2686 	 0.4866 	 0.5455 	
2025-08-28 02:04:47,421 | NDCG @5|10: 0.3855 	 0.4047
2025-08-28 02:04:47,421 | domain:Kitchen
2025-08-28 02:04:47,421 | model_moe:
2025-08-28 02:04:47,422 | MRR: 0.1239
2025-08-28 02:04:47,423 | HR @1|5|10: 0.0700 	 0.1736 	 0.2238 	
2025-08-28 02:04:47,423 | NDCG @5|10: 0.1241 	 0.1404
2025-08-28 02:04:47,424 | domain:Clothing
2025-08-28 02:04:47,424 | model_moe:
2025-08-28 02:04:47,424 | MRR: 0.0273
2025-08-28 02:04:47,425 | HR @1|5|10: 0.0110 	 0.0342 	 0.0477 	
2025-08-28 02:04:47,425 | NDCG @5|10: 0.0236 	 0.0281
2025-08-28 02:04:47,425 | domain:Beauty
2025-08-28 02:04:47,425 | model_moe:
2025-08-28 02:04:47,426 | MRR: 0.2530
2025-08-28 02:04:47,426 | HR @1|5|10: 0.1818 	 0.3397 	 0.3923 	
2025-08-28 02:04:47,426 | NDCG @5|10: 0.2643 	 0.2816
2025-08-28 02:04:47,427 | 	avg_model_moe:
2025-08-28 02:04:47,427 | MRR: 0.1923
2025-08-28 02:04:47,427 | HR @1|5|10: 0.1328 	 0.2585 	 0.3023 	
2025-08-28 02:04:47,427 | NDCG @5|10: 0.1994 	 0.2137
2025-08-28 02:04:47,428 | Early Stopping counter: 7 out of 10
2025-08-28 02:04:47,428 | Learning rate decay counter: 1 out of 1
2025-08-28 02:04:47,428 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 02:05:20,378 | Epoch 50/60 - client 1 -  Training Loss: 29.172

 25%|##5       | 1/4 [00:32<01:38, 32.95s/it]2025-08-28 02:05:32,273 | Epoch 50/60 - client 3 -  Training Loss: 29.121

 50%|#####     | 2/4 [00:44<00:41, 20.57s/it]2025-08-28 02:05:50,142 | Epoch 50/60 - client 2 -  Training Loss: 26.307

 75%|#######5  | 3/4 [01:02<00:19, 19.33s/it]2025-08-28 02:06:02,315 | Epoch 50/60 - client 0 -  Training Loss: 28.237

100%|##########| 4/4 [01:14<00:00, 16.51s/it]
100%|##########| 4/4 [01:14<00:00, 18.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.09it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-28 02:06:06,176 | Epoch50 Valid:
2025-08-28 02:06:06,176 | domain:Food
2025-08-28 02:06:06,177 | model_moe:
2025-08-28 02:06:06,177 | MRR: 0.3658
2025-08-28 02:06:06,177 | HR @1|5|10: 0.2708 	 0.4858 	 0.5409 	
2025-08-28 02:06:06,177 | NDCG @5|10: 0.3862 	 0.4042
2025-08-28 02:06:06,178 | domain:Kitchen
2025-08-28 02:06:06,178 | model_moe:
2025-08-28 02:06:06,178 | MRR: 0.1232
2025-08-28 02:06:06,179 | HR @1|5|10: 0.0686 	 0.1759 	 0.2251 	
2025-08-28 02:06:06,179 | NDCG @5|10: 0.1243 	 0.1402
2025-08-28 02:06:06,179 | domain:Clothing
2025-08-28 02:06:06,180 | model_moe:
2025-08-28 02:06:06,180 | MRR: 0.0261
2025-08-28 02:06:06,180 | HR @1|5|10: 0.0086 	 0.0330 	 0.0477 	
2025-08-28 02:06:06,180 | NDCG @5|10: 0.0222 	 0.0268
2025-08-28 02:06:06,181 | domain:Beauty
2025-08-28 02:06:06,182 | model_moe:
2025-08-28 02:06:06,183 | MRR: 0.2498
2025-08-28 02:06:06,183 | HR @1|5|10: 0.1746 	 0.3421 	 0.3900 	
2025-08-28 02:06:06,183 | NDCG @5|10: 0.2628 	 0.2786
2025-08-28 02:06:06,184 | 	avg_model_moe:
2025-08-28 02:06:06,184 | MRR: 0.1912
2025-08-28 02:06:06,184 | HR @1|5|10: 0.1307 	 0.2592 	 0.3009 	
2025-08-28 02:06:06,184 | NDCG @5|10: 0.1989 	 0.2125
2025-08-28 02:06:06,185 | Early Stopping counter: 8 out of 10
2025-08-28 02:06:06,185 | Learning rate decay counter: 1 out of 1
2025-08-28 02:06:06,185 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 02:06:24,030 | Epoch 51/60 - client 2 -  Training Loss: 26.209

 25%|##5       | 1/4 [00:17<00:53, 17.85s/it]2025-08-28 02:06:57,002 | Epoch 51/60 - client 1 -  Training Loss: 29.041

 50%|#####     | 2/4 [00:50<00:53, 26.74s/it]2025-08-28 02:07:09,176 | Epoch 51/60 - client 0 -  Training Loss: 28.142

 75%|#######5  | 3/4 [01:02<00:20, 20.09s/it]2025-08-28 02:07:21,095 | Epoch 51/60 - client 3 -  Training Loss: 29.013

100%|##########| 4/4 [01:14<00:00, 16.87s/it]
100%|##########| 4/4 [01:14<00:00, 18.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-28 02:07:24,979 | Epoch51 Valid:
2025-08-28 02:07:24,980 | domain:Food
2025-08-28 02:07:24,980 | model_moe:
2025-08-28 02:07:24,980 | MRR: 0.3658
2025-08-28 02:07:24,980 | HR @1|5|10: 0.2724 	 0.4881 	 0.5425 	
2025-08-28 02:07:24,981 | NDCG @5|10: 0.3870 	 0.4046
2025-08-28 02:07:24,981 | domain:Kitchen
2025-08-28 02:07:24,981 | model_moe:
2025-08-28 02:07:24,982 | MRR: 0.1234
2025-08-28 02:07:24,982 | HR @1|5|10: 0.0691 	 0.1750 	 0.2242 	
2025-08-28 02:07:24,982 | NDCG @5|10: 0.1242 	 0.1401
2025-08-28 02:07:24,983 | domain:Clothing
2025-08-28 02:07:24,983 | model_moe:
2025-08-28 02:07:24,983 | MRR: 0.0271
2025-08-28 02:07:24,983 | HR @1|5|10: 0.0110 	 0.0330 	 0.0465 	
2025-08-28 02:07:24,984 | NDCG @5|10: 0.0230 	 0.0272
2025-08-28 02:07:24,984 | domain:Beauty
2025-08-28 02:07:24,984 | model_moe:
2025-08-28 02:07:24,985 | MRR: 0.2505
2025-08-28 02:07:24,985 | HR @1|5|10: 0.1770 	 0.3433 	 0.3900 	
2025-08-28 02:07:24,985 | NDCG @5|10: 0.2636 	 0.2790
2025-08-28 02:07:24,986 | 	avg_model_moe:
2025-08-28 02:07:24,986 | MRR: 0.1917
2025-08-28 02:07:24,986 | HR @1|5|10: 0.1324 	 0.2599 	 0.3008 	
2025-08-28 02:07:24,988 | NDCG @5|10: 0.1994 	 0.2127
2025-08-28 02:07:24,988 | Early Stopping counter: 9 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-28 02:07:37,191 | Epoch 52/60 - client 0 -  Training Loss: 28.056

 25%|##5       | 1/4 [00:12<00:36, 12.20s/it]2025-08-28 02:07:49,074 | Epoch 52/60 - client 3 -  Training Loss: 28.910

 50%|#####     | 2/4 [00:24<00:24, 12.02s/it]2025-08-28 02:08:06,924 | Epoch 52/60 - client 2 -  Training Loss: 26.121

 75%|#######5  | 3/4 [00:41<00:14, 14.68s/it]2025-08-28 02:08:39,896 | Epoch 52/60 - client 1 -  Training Loss: 28.935

100%|##########| 4/4 [01:14<00:00, 21.90s/it]
100%|##########| 4/4 [01:14<00:00, 18.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-28 02:08:43,782 | Epoch52 Valid:
2025-08-28 02:08:43,783 | domain:Food
2025-08-28 02:08:43,783 | model_moe:
2025-08-28 02:08:43,786 | MRR: 0.3664
2025-08-28 02:08:43,786 | HR @1|5|10: 0.2724 	 0.4874 	 0.5463 	
2025-08-28 02:08:43,787 | NDCG @5|10: 0.3869 	 0.4060
2025-08-28 02:08:43,787 | domain:Kitchen
2025-08-28 02:08:43,787 | model_moe:
2025-08-28 02:08:43,788 | MRR: 0.1230
2025-08-28 02:08:43,788 | HR @1|5|10: 0.0686 	 0.1745 	 0.2233 	
2025-08-28 02:08:43,790 | NDCG @5|10: 0.1238 	 0.1397
2025-08-28 02:08:43,791 | domain:Clothing
2025-08-28 02:08:43,791 | model_moe:
2025-08-28 02:08:43,791 | MRR: 0.0267
2025-08-28 02:08:43,791 | HR @1|5|10: 0.0098 	 0.0342 	 0.0489 	
2025-08-28 02:08:43,792 | NDCG @5|10: 0.0229 	 0.0277
2025-08-28 02:08:43,792 | domain:Beauty
2025-08-28 02:08:43,792 | model_moe:
2025-08-28 02:08:43,793 | MRR: 0.2537
2025-08-28 02:08:43,793 | HR @1|5|10: 0.1830 	 0.3397 	 0.3900 	
2025-08-28 02:08:43,793 | NDCG @5|10: 0.2648 	 0.2814
2025-08-28 02:08:43,793 | 	avg_model_moe:
2025-08-28 02:08:43,794 | MRR: 0.1924
2025-08-28 02:08:43,794 | HR @1|5|10: 0.1334 	 0.2590 	 0.3021 	
2025-08-28 02:08:43,795 | NDCG @5|10: 0.1996 	 0.2137
2025-08-28 02:08:43,796 | Early Stopping counter: 10 out of 10
2025-08-28 02:08:43,796 | Early stopping

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:02<00:06,  2.19s/it]
 50%|#####     | 2/4 [00:06<00:06,  3.46s/it]
 75%|#######5  | 3/4 [00:09<00:03,  3.32s/it]
100%|##########| 4/4 [00:11<00:00,  2.91s/it]
100%|##########| 4/4 [00:11<00:00,  3.00s/it]
2025-08-28 02:08:55,784 | Test:
2025-08-28 02:08:55,785 | domain:Food
2025-08-28 02:08:55,785 | model_moe:
2025-08-28 02:08:55,785 | MRR: 0.2997
2025-08-28 02:08:55,786 | HR @1|5|10: 0.2057 	 0.4122 	 0.4805 	
2025-08-28 02:08:55,786 | NDCG @5|10: 0.3160 	 0.3381
2025-08-28 02:08:55,786 | domain:Kitchen
2025-08-28 02:08:55,787 | model_moe:
2025-08-28 02:08:55,787 | MRR: 0.1205
2025-08-28 02:08:55,787 | HR @1|5|10: 0.0670 	 0.1744 	 0.2285 	
2025-08-28 02:08:55,787 | NDCG @5|10: 0.1213 	 0.1388
2025-08-28 02:08:55,788 | domain:Clothing
2025-08-28 02:08:55,788 | model_moe:
2025-08-28 02:08:55,788 | MRR: 0.0257
2025-08-28 02:08:55,789 | HR @1|5|10: 0.0104 	 0.0289 	 0.0439 	
2025-08-28 02:08:55,789 | NDCG @5|10: 0.0202 	 0.0252
2025-08-28 02:08:55,789 | domain:Beauty
2025-08-28 02:08:55,790 | model_moe:
2025-08-28 02:08:55,790 | MRR: 0.2029
2025-08-28 02:08:55,790 | HR @1|5|10: 0.1228 	 0.2936 	 0.3626 	
2025-08-28 02:08:55,791 | NDCG @5|10: 0.2128 	 0.2355
2025-08-28 02:08:55,791 | 	avg_model_moe:
2025-08-28 02:08:55,791 | MRR: 0.1622
2025-08-28 02:08:55,791 | HR @1|5|10: 0.1015 	 0.2272 	 0.2789 	
2025-08-28 02:08:55,792 | NDCG @5|10: 0.1676 	 0.1844
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-28 02:11:37,962 | Running with the following configs:
	domains : ['Movies', 'Books', 'Games']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-28 02:12:02,120 | Epoch 1/40 - client 2 -  Training Loss: 31.972

 33%|###3      | 1/3 [00:24<00:48, 24.14s/it]2025-08-28 02:15:44,452 | Epoch 1/40 - client 1 -  Training Loss: 34.980

 67%|######6   | 2/3 [04:06<02:20, 140.72s/it]2025-08-28 02:18:14,208 | Epoch 1/40 - client 0 -  Training Loss: 36.582

100%|##########| 3/3 [06:36<00:00, 144.85s/it]
100%|##########| 3/3 [06:36<00:00, 132.08s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.76s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.33s/it]
100%|##########| 3/3 [00:15<00:00,  4.52s/it]
100%|##########| 3/3 [00:15<00:00,  5.22s/it]
2025-08-28 02:18:29,884 | Epoch1 Valid:
2025-08-28 02:18:29,884 | domain:Movies
2025-08-28 02:18:29,885 | model_moe:
2025-08-28 02:18:29,885 | MRR: 0.0389
2025-08-28 02:18:29,886 | HR @1|5|10: 0.0213 	 0.0453 	 0.0641 	
2025-08-28 02:18:29,886 | NDCG @5|10: 0.0334 	 0.0395
2025-08-28 02:18:29,886 | domain:Books
2025-08-28 02:18:29,886 | model_moe:
2025-08-28 02:18:29,887 | MRR: 0.0251
2025-08-28 02:18:29,887 | HR @1|5|10: 0.0152 	 0.0264 	 0.0342 	
2025-08-28 02:18:29,887 | NDCG @5|10: 0.0210 	 0.0234
2025-08-28 02:18:29,888 | domain:Games
2025-08-28 02:18:29,888 | model_moe:
2025-08-28 02:18:29,888 | MRR: 0.0587
2025-08-28 02:18:29,889 | HR @1|5|10: 0.0393 	 0.0670 	 0.0881 	
2025-08-28 02:18:29,889 | NDCG @5|10: 0.0540 	 0.0608
2025-08-28 02:18:29,889 | 	avg_model_moe:
2025-08-28 02:18:29,889 | MRR: 0.0409
2025-08-28 02:18:29,890 | HR @1|5|10: 0.0253 	 0.0462 	 0.0621 	
2025-08-28 02:18:29,890 | NDCG @5|10: 0.0361 	 0.0412
2025-08-28 02:18:29,890 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 02:21:02,742 | Epoch 2/40 - client 0 -  Training Loss: 34.328

 33%|###3      | 1/3 [02:31<05:02, 151.05s/it]2025-08-28 02:21:15,857 | Epoch 2/40 - client 2 -  Training Loss: 30.061

 67%|######6   | 2/3 [02:44<01:09, 69.91s/it] 2025-08-28 02:24:58,373 | Epoch 2/40 - client 1 -  Training Loss: 32.890

100%|##########| 3/3 [06:26<00:00, 139.60s/it]
100%|##########| 3/3 [06:26<00:00, 128.90s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.92s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.55s/it]
100%|##########| 3/3 [00:16<00:00,  4.65s/it]
100%|##########| 3/3 [00:16<00:00,  5.37s/it]
2025-08-28 02:25:14,500 | Epoch2 Valid:
2025-08-28 02:25:14,500 | domain:Movies
2025-08-28 02:25:14,500 | model_moe:
2025-08-28 02:25:14,501 | MRR: 0.0987
2025-08-28 02:25:14,501 | HR @1|5|10: 0.0549 	 0.1266 	 0.1766 	
2025-08-28 02:25:14,501 | NDCG @5|10: 0.0914 	 0.1074
2025-08-28 02:25:14,502 | domain:Books
2025-08-28 02:25:14,502 | model_moe:
2025-08-28 02:25:14,502 | MRR: 0.0691
2025-08-28 02:25:14,502 | HR @1|5|10: 0.0418 	 0.0818 	 0.1111 	
2025-08-28 02:25:14,503 | NDCG @5|10: 0.0622 	 0.0716
2025-08-28 02:25:14,503 | domain:Games
2025-08-28 02:25:14,503 | model_moe:
2025-08-28 02:25:14,504 | MRR: 0.0699
2025-08-28 02:25:14,504 | HR @1|5|10: 0.0473 	 0.0830 	 0.1121 	
2025-08-28 02:25:14,504 | NDCG @5|10: 0.0650 	 0.0746
2025-08-28 02:25:14,505 | 	avg_model_moe:
2025-08-28 02:25:14,505 | MRR: 0.0792
2025-08-28 02:25:14,505 | HR @1|5|10: 0.0480 	 0.0971 	 0.1333 	
2025-08-28 02:25:14,505 | NDCG @5|10: 0.0729 	 0.0846
2025-08-28 02:25:14,506 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 02:27:46,728 | Epoch 3/40 - client 0 -  Training Loss: 33.260

 33%|###3      | 1/3 [02:30<05:01, 150.50s/it]2025-08-28 02:31:29,211 | Epoch 3/40 - client 1 -  Training Loss: 31.639

 67%|######6   | 2/3 [06:12<03:12, 192.85s/it]2025-08-28 02:31:42,211 | Epoch 3/40 - client 2 -  Training Loss: 29.040

100%|##########| 3/3 [06:25<00:00, 110.72s/it]
100%|##########| 3/3 [06:25<00:00, 128.66s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.71s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.30s/it]
100%|##########| 3/3 [00:15<00:00,  4.51s/it]
100%|##########| 3/3 [00:15<00:00,  5.21s/it]
2025-08-28 02:31:57,853 | Epoch3 Valid:
2025-08-28 02:31:57,853 | domain:Movies
2025-08-28 02:31:57,853 | model_moe:
2025-08-28 02:31:57,854 | MRR: 0.1206
2025-08-28 02:31:57,854 | HR @1|5|10: 0.0704 	 0.1565 	 0.2160 	
2025-08-28 02:31:57,854 | NDCG @5|10: 0.1145 	 0.1337
2025-08-28 02:31:57,855 | domain:Books
2025-08-28 02:31:57,855 | model_moe:
2025-08-28 02:31:57,855 | MRR: 0.0953
2025-08-28 02:31:57,856 | HR @1|5|10: 0.0566 	 0.1204 	 0.1628 	
2025-08-28 02:31:57,856 | NDCG @5|10: 0.0892 	 0.1028
2025-08-28 02:31:57,856 | domain:Games
2025-08-28 02:31:57,857 | model_moe:
2025-08-28 02:31:57,857 | MRR: 0.0831
2025-08-28 02:31:57,857 | HR @1|5|10: 0.0568 	 0.1004 	 0.1252 	
2025-08-28 02:31:57,857 | NDCG @5|10: 0.0797 	 0.0877
2025-08-28 02:31:57,858 | 	avg_model_moe:
2025-08-28 02:31:57,858 | MRR: 0.0996
2025-08-28 02:31:57,858 | HR @1|5|10: 0.0612 	 0.1258 	 0.1680 	
2025-08-28 02:31:57,859 | NDCG @5|10: 0.0945 	 0.1081
2025-08-28 02:31:57,859 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 02:35:41,062 | Epoch 4/40 - client 1 -  Training Loss: 30.482

 33%|###3      | 1/3 [03:41<07:23, 221.51s/it]2025-08-28 02:38:11,008 | Epoch 4/40 - client 0 -  Training Loss: 32.313

 67%|######6   | 2/3 [06:11<02:59, 179.41s/it]2025-08-28 02:38:24,008 | Epoch 4/40 - client 2 -  Training Loss: 28.132

100%|##########| 3/3 [06:24<00:00, 103.42s/it]
100%|##########| 3/3 [06:24<00:00, 128.15s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.84s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.37s/it]
100%|##########| 3/3 [00:15<00:00,  4.55s/it]
100%|##########| 3/3 [00:15<00:00,  5.26s/it]
2025-08-28 02:38:39,804 | Epoch4 Valid:
2025-08-28 02:38:39,804 | domain:Movies
2025-08-28 02:38:39,804 | model_moe:
2025-08-28 02:38:39,805 | MRR: 0.1346
2025-08-28 02:38:39,805 | HR @1|5|10: 0.0787 	 0.1800 	 0.2408 	
2025-08-28 02:38:39,806 | NDCG @5|10: 0.1309 	 0.1504
2025-08-28 02:38:39,807 | domain:Books
2025-08-28 02:38:39,807 | model_moe:
2025-08-28 02:38:39,807 | MRR: 0.1134
2025-08-28 02:38:39,808 | HR @1|5|10: 0.0689 	 0.1462 	 0.1963 	
2025-08-28 02:38:39,808 | NDCG @5|10: 0.1080 	 0.1242
2025-08-28 02:38:39,808 | domain:Games
2025-08-28 02:38:39,811 | model_moe:
2025-08-28 02:38:39,811 | MRR: 0.0950
2025-08-28 02:38:39,811 | HR @1|5|10: 0.0691 	 0.1150 	 0.1405 	
2025-08-28 02:38:39,812 | NDCG @5|10: 0.0922 	 0.1003
2025-08-28 02:38:39,812 | 	avg_model_moe:
2025-08-28 02:38:39,812 | MRR: 0.1143
2025-08-28 02:38:39,812 | HR @1|5|10: 0.0722 	 0.1471 	 0.1925 	
2025-08-28 02:38:39,814 | NDCG @5|10: 0.1104 	 0.1250
2025-08-28 02:38:39,814 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 02:42:24,195 | Epoch 5/40 - client 1 -  Training Loss: 29.245

 33%|###3      | 1/3 [03:42<07:24, 222.26s/it]2025-08-28 02:42:37,163 | Epoch 5/40 - client 2 -  Training Loss: 27.147

 67%|######6   | 2/3 [03:55<01:39, 99.15s/it] 2025-08-28 02:45:08,269 | Epoch 5/40 - client 0 -  Training Loss: 31.338

100%|##########| 3/3 [06:26<00:00, 122.87s/it]
100%|##########| 3/3 [06:26<00:00, 128.78s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.80s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.50s/it]
100%|##########| 3/3 [00:16<00:00,  4.65s/it]
100%|##########| 3/3 [00:16<00:00,  5.35s/it]
2025-08-28 02:45:24,345 | Epoch5 Valid:
2025-08-28 02:45:24,346 | domain:Movies
2025-08-28 02:45:24,346 | model_moe:
2025-08-28 02:45:24,347 | MRR: 0.1474
2025-08-28 02:45:24,347 | HR @1|5|10: 0.0890 	 0.1971 	 0.2596 	
2025-08-28 02:45:24,347 | NDCG @5|10: 0.1445 	 0.1648
2025-08-28 02:45:24,347 | domain:Books
2025-08-28 02:45:24,348 | model_moe:
2025-08-28 02:45:24,348 | MRR: 0.1248
2025-08-28 02:45:24,348 | HR @1|5|10: 0.0765 	 0.1617 	 0.2174 	
2025-08-28 02:45:24,349 | NDCG @5|10: 0.1198 	 0.1379
2025-08-28 02:45:24,349 | domain:Games
2025-08-28 02:45:24,349 | model_moe:
2025-08-28 02:45:24,350 | MRR: 0.1047
2025-08-28 02:45:24,350 | HR @1|5|10: 0.0771 	 0.1274 	 0.1492 	
2025-08-28 02:45:24,350 | NDCG @5|10: 0.1028 	 0.1097
2025-08-28 02:45:24,350 | 	avg_model_moe:
2025-08-28 02:45:24,351 | MRR: 0.1256
2025-08-28 02:45:24,351 | HR @1|5|10: 0.0809 	 0.1621 	 0.2087 	
2025-08-28 02:45:24,351 | NDCG @5|10: 0.1224 	 0.1375
2025-08-28 02:45:24,352 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 02:49:08,933 | Epoch 6/40 - client 1 -  Training Loss: 28.035

 33%|###3      | 1/3 [03:42<07:24, 222.47s/it]2025-08-28 02:51:39,224 | Epoch 6/40 - client 0 -  Training Loss: 30.421

 67%|######6   | 2/3 [06:12<03:00, 180.01s/it]2025-08-28 02:51:52,158 | Epoch 6/40 - client 2 -  Training Loss: 26.128

100%|##########| 3/3 [06:25<00:00, 103.72s/it]
100%|##########| 3/3 [06:25<00:00, 128.57s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.83s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.42s/it]
100%|##########| 3/3 [00:15<00:00,  4.60s/it]
100%|##########| 3/3 [00:15<00:00,  5.30s/it]
2025-08-28 02:52:08,085 | Epoch6 Valid:
2025-08-28 02:52:08,090 | domain:Movies
2025-08-28 02:52:08,090 | model_moe:
2025-08-28 02:52:08,091 | MRR: 0.1555
2025-08-28 02:52:08,091 | HR @1|5|10: 0.0960 	 0.2051 	 0.2701 	
2025-08-28 02:52:08,091 | NDCG @5|10: 0.1524 	 0.1733
2025-08-28 02:52:08,092 | domain:Books
2025-08-28 02:52:08,092 | model_moe:
2025-08-28 02:52:08,092 | MRR: 0.1305
2025-08-28 02:52:08,093 | HR @1|5|10: 0.0795 	 0.1712 	 0.2282 	
2025-08-28 02:52:08,093 | NDCG @5|10: 0.1265 	 0.1448
2025-08-28 02:52:08,093 | domain:Games
2025-08-28 02:52:08,093 | model_moe:
2025-08-28 02:52:08,094 | MRR: 0.1145
2025-08-28 02:52:08,094 | HR @1|5|10: 0.0881 	 0.1310 	 0.1579 	
2025-08-28 02:52:08,094 | NDCG @5|10: 0.1103 	 0.1190
2025-08-28 02:52:08,095 | 	avg_model_moe:
2025-08-28 02:52:08,095 | MRR: 0.1335
2025-08-28 02:52:08,095 | HR @1|5|10: 0.0879 	 0.1691 	 0.2188 	
2025-08-28 02:52:08,096 | NDCG @5|10: 0.1297 	 0.1457
2025-08-28 02:52:08,096 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 02:54:40,600 | Epoch 7/40 - client 0 -  Training Loss: 29.656

 33%|###3      | 1/3 [02:30<05:01, 150.59s/it]2025-08-28 02:58:22,896 | Epoch 7/40 - client 1 -  Training Loss: 27.034

 67%|######6   | 2/3 [06:12<03:12, 192.78s/it]2025-08-28 02:58:35,860 | Epoch 7/40 - client 2 -  Training Loss: 25.228

100%|##########| 3/3 [06:25<00:00, 110.66s/it]
100%|##########| 3/3 [06:25<00:00, 128.62s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.81s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.37s/it]
100%|##########| 3/3 [00:15<00:00,  4.56s/it]
100%|##########| 3/3 [00:15<00:00,  5.26s/it]
2025-08-28 02:58:51,667 | Epoch7 Valid:
2025-08-28 02:58:51,668 | domain:Movies
2025-08-28 02:58:51,668 | model_moe:
2025-08-28 02:58:51,668 | MRR: 0.1609
2025-08-28 02:58:51,669 | HR @1|5|10: 0.0985 	 0.2131 	 0.2809 	
2025-08-28 02:58:51,669 | NDCG @5|10: 0.1581 	 0.1800
2025-08-28 02:58:51,669 | domain:Books
2025-08-28 02:58:51,669 | model_moe:
2025-08-28 02:58:51,670 | MRR: 0.1340
2025-08-28 02:58:51,670 | HR @1|5|10: 0.0815 	 0.1767 	 0.2341 	
2025-08-28 02:58:51,670 | NDCG @5|10: 0.1303 	 0.1488
2025-08-28 02:58:51,671 | domain:Games
2025-08-28 02:58:51,671 | model_moe:
2025-08-28 02:58:51,671 | MRR: 0.1210
2025-08-28 02:58:51,672 | HR @1|5|10: 0.0946 	 0.1354 	 0.1638 	
2025-08-28 02:58:51,672 | NDCG @5|10: 0.1156 	 0.1249
2025-08-28 02:58:51,676 | 	avg_model_moe:
2025-08-28 02:58:51,676 | MRR: 0.1386
2025-08-28 02:58:51,676 | HR @1|5|10: 0.0915 	 0.1750 	 0.2262 	
2025-08-28 02:58:51,677 | NDCG @5|10: 0.1347 	 0.1512
2025-08-28 02:58:51,677 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:01:23,538 | Epoch 8/40 - client 0 -  Training Loss: 29.020

 33%|###3      | 1/3 [02:29<04:59, 149.92s/it]2025-08-28 03:01:36,286 | Epoch 8/40 - client 2 -  Training Loss: 24.520

 67%|######6   | 2/3 [02:42<01:09, 69.23s/it] 2025-08-28 03:05:18,237 | Epoch 8/40 - client 1 -  Training Loss: 26.272

100%|##########| 3/3 [06:24<00:00, 138.96s/it]
100%|##########| 3/3 [06:24<00:00, 128.20s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.71s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.28s/it]
100%|##########| 3/3 [00:15<00:00,  4.50s/it]
100%|##########| 3/3 [00:15<00:00,  5.19s/it]
2025-08-28 03:05:33,838 | Epoch8 Valid:
2025-08-28 03:05:33,839 | domain:Movies
2025-08-28 03:05:33,839 | model_moe:
2025-08-28 03:05:33,839 | MRR: 0.1627
2025-08-28 03:05:33,840 | HR @1|5|10: 0.0993 	 0.2170 	 0.2828 	
2025-08-28 03:05:33,840 | NDCG @5|10: 0.1605 	 0.1818
2025-08-28 03:05:33,840 | domain:Books
2025-08-28 03:05:33,840 | model_moe:
2025-08-28 03:05:33,841 | MRR: 0.1394
2025-08-28 03:05:33,841 | HR @1|5|10: 0.0857 	 0.1852 	 0.2412 	
2025-08-28 03:05:33,843 | NDCG @5|10: 0.1365 	 0.1545
2025-08-28 03:05:33,843 | domain:Games
2025-08-28 03:05:33,843 | model_moe:
2025-08-28 03:05:33,844 | MRR: 0.1232
2025-08-28 03:05:33,844 | HR @1|5|10: 0.0946 	 0.1426 	 0.1703 	
2025-08-28 03:05:33,844 | NDCG @5|10: 0.1193 	 0.1281
2025-08-28 03:05:33,844 | 	avg_model_moe:
2025-08-28 03:05:33,845 | MRR: 0.1417
2025-08-28 03:05:33,845 | HR @1|5|10: 0.0932 	 0.1816 	 0.2314 	
2025-08-28 03:05:33,845 | NDCG @5|10: 0.1387 	 0.1548
2025-08-28 03:05:33,846 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:05:48,961 | Epoch 9/40 - client 2 -  Training Loss: 23.930

 33%|###3      | 1/3 [00:13<00:26, 13.14s/it]2025-08-28 03:08:19,173 | Epoch 9/40 - client 0 -  Training Loss: 28.487

 67%|######6   | 2/3 [02:43<01:33, 93.77s/it]2025-08-28 03:12:01,308 | Epoch 9/40 - client 1 -  Training Loss: 25.661

100%|##########| 3/3 [06:25<00:00, 152.38s/it]
100%|##########| 3/3 [06:25<00:00, 128.50s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.82s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.39s/it]
100%|##########| 3/3 [00:15<00:00,  4.59s/it]
100%|##########| 3/3 [00:15<00:00,  5.29s/it]
2025-08-28 03:12:17,197 | Epoch9 Valid:
2025-08-28 03:12:17,200 | domain:Movies
2025-08-28 03:12:17,201 | model_moe:
2025-08-28 03:12:17,411 | MRR: 0.1666
2025-08-28 03:12:17,412 | HR @1|5|10: 0.1021 	 0.2220 	 0.2865 	
2025-08-28 03:12:17,412 | NDCG @5|10: 0.1646 	 0.1854
2025-08-28 03:12:17,412 | domain:Books
2025-08-28 03:12:17,413 | model_moe:
2025-08-28 03:12:17,413 | MRR: 0.1445
2025-08-28 03:12:17,413 | HR @1|5|10: 0.0883 	 0.1907 	 0.2530 	
2025-08-28 03:12:17,414 | NDCG @5|10: 0.1411 	 0.1611
2025-08-28 03:12:17,414 | domain:Games
2025-08-28 03:12:17,414 | model_moe:
2025-08-28 03:12:17,415 | MRR: 0.1246
2025-08-28 03:12:17,415 | HR @1|5|10: 0.0946 	 0.1448 	 0.1747 	
2025-08-28 03:12:17,415 | NDCG @5|10: 0.1207 	 0.1303
2025-08-28 03:12:17,416 | 	avg_model_moe:
2025-08-28 03:12:17,416 | MRR: 0.1452
2025-08-28 03:12:17,416 | HR @1|5|10: 0.0950 	 0.1859 	 0.2381 	
2025-08-28 03:12:17,417 | NDCG @5|10: 0.1422 	 0.1590
2025-08-28 03:12:17,417 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:16:01,032 | Epoch 10/40 - client 1 -  Training Loss: 25.133

 33%|###3      | 1/3 [03:41<07:22, 221.43s/it]2025-08-28 03:18:30,477 | Epoch 10/40 - client 0 -  Training Loss: 28.016

 67%|######6   | 2/3 [06:10<02:59, 179.09s/it]2025-08-28 03:18:43,328 | Epoch 10/40 - client 2 -  Training Loss: 23.423

100%|##########| 3/3 [06:23<00:00, 103.17s/it]
100%|##########| 3/3 [06:23<00:00, 127.91s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.98s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.52s/it]
100%|##########| 3/3 [00:16<00:00,  4.63s/it]
100%|##########| 3/3 [00:16<00:00,  5.36s/it]
2025-08-28 03:18:59,421 | Epoch10 Valid:
2025-08-28 03:18:59,424 | domain:Movies
2025-08-28 03:18:59,424 | model_moe:
2025-08-28 03:18:59,425 | MRR: 0.1726
2025-08-28 03:18:59,425 | HR @1|5|10: 0.1072 	 0.2294 	 0.2962 	
2025-08-28 03:18:59,425 | NDCG @5|10: 0.1708 	 0.1925
2025-08-28 03:18:59,426 | domain:Books
2025-08-28 03:18:59,426 | model_moe:
2025-08-28 03:18:59,426 | MRR: 0.1478
2025-08-28 03:18:59,426 | HR @1|5|10: 0.0892 	 0.1975 	 0.2605 	
2025-08-28 03:18:59,427 | NDCG @5|10: 0.1452 	 0.1655
2025-08-28 03:18:59,427 | domain:Games
2025-08-28 03:18:59,427 | model_moe:
2025-08-28 03:18:59,428 | MRR: 0.1264
2025-08-28 03:18:59,428 | HR @1|5|10: 0.0946 	 0.1528 	 0.1812 	
2025-08-28 03:18:59,429 | NDCG @5|10: 0.1245 	 0.1334
2025-08-28 03:18:59,430 | 	avg_model_moe:
2025-08-28 03:18:59,430 | MRR: 0.1490
2025-08-28 03:18:59,430 | HR @1|5|10: 0.0970 	 0.1933 	 0.2460 	
2025-08-28 03:18:59,431 | NDCG @5|10: 0.1468 	 0.1638
2025-08-28 03:18:59,431 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:19:14,104 | Epoch 11/40 - client 2 -  Training Loss: 23.001

 33%|###3      | 1/3 [00:12<00:25, 12.86s/it]2025-08-28 03:21:43,923 | Epoch 11/40 - client 0 -  Training Loss: 27.586

 67%|######6   | 2/3 [02:42<01:33, 93.42s/it]2025-08-28 03:25:26,792 | Epoch 11/40 - client 1 -  Training Loss: 24.678

100%|##########| 3/3 [06:25<00:00, 152.53s/it]
100%|##########| 3/3 [06:25<00:00, 128.51s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.79s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.35s/it]
100%|##########| 3/3 [00:15<00:00,  4.54s/it]
100%|##########| 3/3 [00:15<00:00,  5.24s/it]
2025-08-28 03:25:42,521 | Epoch11 Valid:
2025-08-28 03:25:42,521 | domain:Movies
2025-08-28 03:25:42,522 | model_moe:
2025-08-28 03:25:42,522 | MRR: 0.1739
2025-08-28 03:25:42,522 | HR @1|5|10: 0.1065 	 0.2366 	 0.2988 	
2025-08-28 03:25:42,523 | NDCG @5|10: 0.1739 	 0.1939
2025-08-28 03:25:42,523 | domain:Books
2025-08-28 03:25:42,523 | model_moe:
2025-08-28 03:25:42,524 | MRR: 0.1526
2025-08-28 03:25:42,524 | HR @1|5|10: 0.0935 	 0.2038 	 0.2653 	
2025-08-28 03:25:42,524 | NDCG @5|10: 0.1503 	 0.1701
2025-08-28 03:25:42,525 | domain:Games
2025-08-28 03:25:42,525 | model_moe:
2025-08-28 03:25:42,525 | MRR: 0.1255
2025-08-28 03:25:42,526 | HR @1|5|10: 0.0917 	 0.1536 	 0.1805 	
2025-08-28 03:25:42,526 | NDCG @5|10: 0.1239 	 0.1326
2025-08-28 03:25:42,526 | 	avg_model_moe:
2025-08-28 03:25:42,526 | MRR: 0.1506
2025-08-28 03:25:42,527 | HR @1|5|10: 0.0972 	 0.1980 	 0.2482 	
2025-08-28 03:25:42,527 | NDCG @5|10: 0.1493 	 0.1656
2025-08-28 03:25:42,527 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:25:57,273 | Epoch 12/40 - client 2 -  Training Loss: 22.620

 33%|###3      | 1/3 [00:12<00:25, 12.86s/it]2025-08-28 03:29:38,832 | Epoch 12/40 - client 1 -  Training Loss: 24.262

 67%|######6   | 2/3 [03:54<02:15, 135.63s/it]2025-08-28 03:32:08,748 | Epoch 12/40 - client 0 -  Training Loss: 27.202

100%|##########| 3/3 [06:24<00:00, 142.16s/it]
100%|##########| 3/3 [06:24<00:00, 128.12s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.77s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.33s/it]
100%|##########| 3/3 [00:15<00:00,  4.52s/it]
100%|##########| 3/3 [00:15<00:00,  5.23s/it]
2025-08-28 03:32:24,461 | Epoch12 Valid:
2025-08-28 03:32:24,461 | domain:Movies
2025-08-28 03:32:24,461 | model_moe:
2025-08-28 03:32:24,462 | MRR: 0.1772
2025-08-28 03:32:24,462 | HR @1|5|10: 0.1097 	 0.2381 	 0.3055 	
2025-08-28 03:32:24,462 | NDCG @5|10: 0.1763 	 0.1980
2025-08-28 03:32:24,463 | domain:Books
2025-08-28 03:32:24,463 | model_moe:
2025-08-28 03:32:24,463 | MRR: 0.1567
2025-08-28 03:32:24,464 | HR @1|5|10: 0.0968 	 0.2076 	 0.2710 	
2025-08-28 03:32:24,464 | NDCG @5|10: 0.1543 	 0.1747
2025-08-28 03:32:24,464 | domain:Games
2025-08-28 03:32:24,465 | model_moe:
2025-08-28 03:32:24,465 | MRR: 0.1291
2025-08-28 03:32:24,465 | HR @1|5|10: 0.0975 	 0.1550 	 0.1841 	
2025-08-28 03:32:24,465 | NDCG @5|10: 0.1269 	 0.1363
2025-08-28 03:32:24,466 | 	avg_model_moe:
2025-08-28 03:32:24,466 | MRR: 0.1543
2025-08-28 03:32:24,466 | HR @1|5|10: 0.1014 	 0.2003 	 0.2535 	
2025-08-28 03:32:24,467 | NDCG @5|10: 0.1525 	 0.1697
2025-08-28 03:32:24,469 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:34:55,792 | Epoch 13/40 - client 0 -  Training Loss: 26.847

 33%|###3      | 1/3 [02:29<04:58, 149.04s/it]2025-08-28 03:35:08,449 | Epoch 13/40 - client 2 -  Training Loss: 22.275

 67%|######6   | 2/3 [02:41<01:08, 68.81s/it] 2025-08-28 03:38:48,944 | Epoch 13/40 - client 1 -  Training Loss: 23.883

100%|##########| 3/3 [06:22<00:00, 138.07s/it]
100%|##########| 3/3 [06:22<00:00, 127.40s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.69s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.27s/it]
100%|##########| 3/3 [00:15<00:00,  4.47s/it]
100%|##########| 3/3 [00:15<00:00,  5.17s/it]
2025-08-28 03:39:04,476 | Epoch13 Valid:
2025-08-28 03:39:04,476 | domain:Movies
2025-08-28 03:39:04,477 | model_moe:
2025-08-28 03:39:04,477 | MRR: 0.1788
2025-08-28 03:39:04,477 | HR @1|5|10: 0.1097 	 0.2417 	 0.3073 	
2025-08-28 03:39:04,478 | NDCG @5|10: 0.1786 	 0.1997
2025-08-28 03:39:04,478 | domain:Books
2025-08-28 03:39:04,478 | model_moe:
2025-08-28 03:39:04,478 | MRR: 0.1594
2025-08-28 03:39:04,479 | HR @1|5|10: 0.0993 	 0.2130 	 0.2733 	
2025-08-28 03:39:04,479 | NDCG @5|10: 0.1579 	 0.1773
2025-08-28 03:39:04,479 | domain:Games
2025-08-28 03:39:04,480 | model_moe:
2025-08-28 03:39:04,480 | MRR: 0.1257
2025-08-28 03:39:04,480 | HR @1|5|10: 0.0910 	 0.1543 	 0.1820 	
2025-08-28 03:39:04,481 | NDCG @5|10: 0.1240 	 0.1330
2025-08-28 03:39:04,481 | 	avg_model_moe:
2025-08-28 03:39:04,481 | MRR: 0.1547
2025-08-28 03:39:04,482 | HR @1|5|10: 0.1000 	 0.2030 	 0.2542 	
2025-08-28 03:39:04,482 | NDCG @5|10: 0.1535 	 0.1700
2025-08-28 03:39:04,482 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:39:19,022 | Epoch 14/40 - client 2 -  Training Loss: 21.987

 33%|###3      | 1/3 [00:12<00:25, 12.60s/it]2025-08-28 03:41:47,613 | Epoch 14/40 - client 0 -  Training Loss: 26.521

 67%|######6   | 2/3 [02:41<01:32, 92.59s/it]2025-08-28 03:45:27,792 | Epoch 14/40 - client 1 -  Training Loss: 23.543

100%|##########| 3/3 [06:21<00:00, 150.86s/it]
100%|##########| 3/3 [06:21<00:00, 127.13s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.71s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.28s/it]
100%|##########| 3/3 [00:15<00:00,  4.48s/it]
100%|##########| 3/3 [00:15<00:00,  5.18s/it]
2025-08-28 03:45:43,361 | Epoch14 Valid:
2025-08-28 03:45:43,362 | domain:Movies
2025-08-28 03:45:43,362 | model_moe:
2025-08-28 03:45:43,363 | MRR: 0.1805
2025-08-28 03:45:43,363 | HR @1|5|10: 0.1115 	 0.2439 	 0.3125 	
2025-08-28 03:45:43,363 | NDCG @5|10: 0.1802 	 0.2023
2025-08-28 03:45:43,364 | domain:Books
2025-08-28 03:45:43,364 | model_moe:
2025-08-28 03:45:43,364 | MRR: 0.1602
2025-08-28 03:45:43,365 | HR @1|5|10: 0.0994 	 0.2121 	 0.2774 	
2025-08-28 03:45:43,365 | NDCG @5|10: 0.1579 	 0.1789
2025-08-28 03:45:43,365 | domain:Games
2025-08-28 03:45:43,366 | model_moe:
2025-08-28 03:45:43,367 | MRR: 0.1237
2025-08-28 03:45:43,367 | HR @1|5|10: 0.0895 	 0.1572 	 0.1820 	
2025-08-28 03:45:43,367 | NDCG @5|10: 0.1236 	 0.1317
2025-08-28 03:45:43,368 | 	avg_model_moe:
2025-08-28 03:45:43,368 | MRR: 0.1548
2025-08-28 03:45:43,368 | HR @1|5|10: 0.1001 	 0.2044 	 0.2573 	
2025-08-28 03:45:43,371 | NDCG @5|10: 0.1539 	 0.1709
2025-08-28 03:45:43,371 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:48:14,668 | Epoch 15/40 - client 0 -  Training Loss: 26.212

 33%|###3      | 1/3 [02:29<04:58, 149.31s/it]2025-08-28 03:48:27,419 | Epoch 15/40 - client 2 -  Training Loss: 21.712

 67%|######6   | 2/3 [02:42<01:08, 68.97s/it] 2025-08-28 03:52:07,771 | Epoch 15/40 - client 1 -  Training Loss: 23.227

100%|##########| 3/3 [06:22<00:00, 138.10s/it]
100%|##########| 3/3 [06:22<00:00, 127.47s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.72s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.29s/it]
100%|##########| 3/3 [00:15<00:00,  4.48s/it]
100%|##########| 3/3 [00:15<00:00,  5.18s/it]
2025-08-28 03:52:23,341 | Epoch15 Valid:
2025-08-28 03:52:23,342 | domain:Movies
2025-08-28 03:52:23,343 | model_moe:
2025-08-28 03:52:23,344 | MRR: 0.1829
2025-08-28 03:52:23,344 | HR @1|5|10: 0.1144 	 0.2457 	 0.3144 	
2025-08-28 03:52:23,344 | NDCG @5|10: 0.1823 	 0.2045
2025-08-28 03:52:23,345 | domain:Books
2025-08-28 03:52:23,345 | model_moe:
2025-08-28 03:52:23,345 | MRR: 0.1618
2025-08-28 03:52:23,346 | HR @1|5|10: 0.1012 	 0.2134 	 0.2770 	
2025-08-28 03:52:23,347 | NDCG @5|10: 0.1595 	 0.1799
2025-08-28 03:52:23,347 | domain:Games
2025-08-28 03:52:23,347 | model_moe:
2025-08-28 03:52:23,348 | MRR: 0.1287
2025-08-28 03:52:23,348 | HR @1|5|10: 0.0961 	 0.1608 	 0.1870 	
2025-08-28 03:52:23,348 | NDCG @5|10: 0.1282 	 0.1365
2025-08-28 03:52:23,350 | 	avg_model_moe:
2025-08-28 03:52:23,350 | MRR: 0.1578
2025-08-28 03:52:23,350 | HR @1|5|10: 0.1039 	 0.2066 	 0.2595 	
2025-08-28 03:52:23,350 | NDCG @5|10: 0.1567 	 0.1737
2025-08-28 03:52:23,351 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:52:38,014 | Epoch 16/40 - client 2 -  Training Loss: 21.467

 33%|###3      | 1/3 [00:12<00:25, 12.77s/it]2025-08-28 03:56:18,590 | Epoch 16/40 - client 1 -  Training Loss: 22.940

 67%|######6   | 2/3 [03:53<02:15, 135.01s/it]2025-08-28 03:58:47,805 | Epoch 16/40 - client 0 -  Training Loss: 25.922

100%|##########| 3/3 [06:22<00:00, 141.50s/it]
100%|##########| 3/3 [06:22<00:00, 127.53s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.77s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.33s/it]
100%|##########| 3/3 [00:15<00:00,  4.51s/it]
100%|##########| 3/3 [00:15<00:00,  5.22s/it]
2025-08-28 03:59:03,488 | Epoch16 Valid:
2025-08-28 03:59:03,490 | domain:Movies
2025-08-28 03:59:03,490 | model_moe:
2025-08-28 03:59:03,491 | MRR: 0.1833
2025-08-28 03:59:03,491 | HR @1|5|10: 0.1141 	 0.2481 	 0.3160 	
2025-08-28 03:59:03,491 | NDCG @5|10: 0.1833 	 0.2052
2025-08-28 03:59:03,492 | domain:Books
2025-08-28 03:59:03,492 | model_moe:
2025-08-28 03:59:03,492 | MRR: 0.1620
2025-08-28 03:59:03,493 | HR @1|5|10: 0.1007 	 0.2149 	 0.2778 	
2025-08-28 03:59:03,493 | NDCG @5|10: 0.1600 	 0.1803
2025-08-28 03:59:03,493 | domain:Games
2025-08-28 03:59:03,494 | model_moe:
2025-08-28 03:59:03,494 | MRR: 0.1269
2025-08-28 03:59:03,494 | HR @1|5|10: 0.0917 	 0.1572 	 0.1878 	
2025-08-28 03:59:03,494 | NDCG @5|10: 0.1253 	 0.1353
2025-08-28 03:59:03,495 | 	avg_model_moe:
2025-08-28 03:59:03,495 | MRR: 0.1574
2025-08-28 03:59:03,495 | HR @1|5|10: 0.1022 	 0.2067 	 0.2605 	
2025-08-28 03:59:03,496 | NDCG @5|10: 0.1562 	 0.1736
2025-08-28 03:59:03,496 | Early Stopping counter: 1 out of 5
2025-08-28 03:59:03,496 | Learning rate decay counter: 1 out of 1
2025-08-28 03:59:03,497 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 03:59:16,301 | Epoch 17/40 - client 2 -  Training Loss: 21.231

 33%|###3      | 1/3 [00:12<00:25, 12.81s/it]2025-08-28 04:02:57,254 | Epoch 17/40 - client 1 -  Training Loss: 22.671

 67%|######6   | 2/3 [03:53<02:15, 135.26s/it]2025-08-28 04:05:26,540 | Epoch 17/40 - client 0 -  Training Loss: 25.651

100%|##########| 3/3 [06:23<00:00, 141.65s/it]
100%|##########| 3/3 [06:23<00:00, 127.68s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.88s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.36s/it]
100%|##########| 3/3 [00:15<00:00,  4.53s/it]
100%|##########| 3/3 [00:15<00:00,  5.24s/it]
2025-08-28 04:05:42,307 | Epoch17 Valid:
2025-08-28 04:05:42,307 | domain:Movies
2025-08-28 04:05:42,308 | model_moe:
2025-08-28 04:05:42,308 | MRR: 0.1846
2025-08-28 04:05:42,308 | HR @1|5|10: 0.1146 	 0.2494 	 0.3175 	
2025-08-28 04:05:42,309 | NDCG @5|10: 0.1845 	 0.2065
2025-08-28 04:05:42,309 | domain:Books
2025-08-28 04:05:42,309 | model_moe:
2025-08-28 04:05:42,310 | MRR: 0.1633
2025-08-28 04:05:42,310 | HR @1|5|10: 0.1023 	 0.2147 	 0.2807 	
2025-08-28 04:05:42,310 | NDCG @5|10: 0.1608 	 0.1820
2025-08-28 04:05:42,310 | domain:Games
2025-08-28 04:05:42,311 | model_moe:
2025-08-28 04:05:42,313 | MRR: 0.1284
2025-08-28 04:05:42,313 | HR @1|5|10: 0.0917 	 0.1608 	 0.1900 	
2025-08-28 04:05:42,314 | NDCG @5|10: 0.1277 	 0.1371
2025-08-28 04:05:42,314 | 	avg_model_moe:
2025-08-28 04:05:42,314 | MRR: 0.1588
2025-08-28 04:05:42,315 | HR @1|5|10: 0.1029 	 0.2083 	 0.2627 	
2025-08-28 04:05:42,315 | NDCG @5|10: 0.1577 	 0.1752
2025-08-28 04:05:42,317 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 04:08:13,428 | Epoch 18/40 - client 0 -  Training Loss: 25.404

 33%|###3      | 1/3 [02:29<04:58, 149.25s/it]2025-08-28 04:11:54,373 | Epoch 18/40 - client 1 -  Training Loss: 22.428

 67%|######6   | 2/3 [06:10<03:11, 191.42s/it]2025-08-28 04:12:07,137 | Epoch 18/40 - client 2 -  Training Loss: 21.030

100%|##########| 3/3 [06:22<00:00, 109.84s/it]
100%|##########| 3/3 [06:22<00:00, 127.65s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.77s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.36s/it]
100%|##########| 3/3 [00:15<00:00,  4.55s/it]
100%|##########| 3/3 [00:15<00:00,  5.25s/it]
2025-08-28 04:12:22,894 | Epoch18 Valid:
2025-08-28 04:12:22,897 | domain:Movies
2025-08-28 04:12:22,898 | model_moe:
2025-08-28 04:12:22,898 | MRR: 0.1844
2025-08-28 04:12:22,898 | HR @1|5|10: 0.1143 	 0.2495 	 0.3175 	
2025-08-28 04:12:22,899 | NDCG @5|10: 0.1843 	 0.2063
2025-08-28 04:12:22,899 | domain:Books
2025-08-28 04:12:22,899 | model_moe:
2025-08-28 04:12:22,899 | MRR: 0.1620
2025-08-28 04:12:22,900 | HR @1|5|10: 0.1006 	 0.2124 	 0.2794 	
2025-08-28 04:12:22,900 | NDCG @5|10: 0.1591 	 0.1806
2025-08-28 04:12:22,900 | domain:Games
2025-08-28 04:12:22,901 | model_moe:
2025-08-28 04:12:22,901 | MRR: 0.1292
2025-08-28 04:12:22,901 | HR @1|5|10: 0.0924 	 0.1594 	 0.1892 	
2025-08-28 04:12:22,901 | NDCG @5|10: 0.1276 	 0.1373
2025-08-28 04:12:22,902 | 	avg_model_moe:
2025-08-28 04:12:22,902 | MRR: 0.1585
2025-08-28 04:12:22,902 | HR @1|5|10: 0.1024 	 0.2071 	 0.2620 	
2025-08-28 04:12:22,903 | NDCG @5|10: 0.1570 	 0.1747
2025-08-28 04:12:22,903 | Early Stopping counter: 1 out of 5
2025-08-28 04:12:22,903 | Learning rate decay counter: 1 out of 1
2025-08-28 04:12:22,903 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 04:12:35,678 | Epoch 19/40 - client 2 -  Training Loss: 20.840

 33%|###3      | 1/3 [00:12<00:25, 12.78s/it]2025-08-28 04:16:16,403 | Epoch 19/40 - client 1 -  Training Loss: 22.201

 67%|######6   | 2/3 [03:53<02:15, 135.11s/it]2025-08-28 04:18:45,827 | Epoch 19/40 - client 0 -  Training Loss: 25.164

100%|##########| 3/3 [06:22<00:00, 141.64s/it]
100%|##########| 3/3 [06:22<00:00, 127.65s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.73s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.30s/it]
100%|##########| 3/3 [00:15<00:00,  4.49s/it]
100%|##########| 3/3 [00:15<00:00,  5.20s/it]
2025-08-28 04:19:01,452 | Epoch19 Valid:
2025-08-28 04:19:01,452 | domain:Movies
2025-08-28 04:19:01,453 | model_moe:
2025-08-28 04:19:01,453 | MRR: 0.1855
2025-08-28 04:19:01,453 | HR @1|5|10: 0.1154 	 0.2510 	 0.3202 	
2025-08-28 04:19:01,454 | NDCG @5|10: 0.1855 	 0.2079
2025-08-28 04:19:01,455 | domain:Books
2025-08-28 04:19:01,455 | model_moe:
2025-08-28 04:19:01,456 | MRR: 0.1622
2025-08-28 04:19:01,456 | HR @1|5|10: 0.1002 	 0.2172 	 0.2810 	
2025-08-28 04:19:01,456 | NDCG @5|10: 0.1607 	 0.1812
2025-08-28 04:19:01,457 | domain:Games
2025-08-28 04:19:01,457 | model_moe:
2025-08-28 04:19:01,460 | MRR: 0.1250
2025-08-28 04:19:01,461 | HR @1|5|10: 0.0859 	 0.1608 	 0.1914 	
2025-08-28 04:19:01,461 | NDCG @5|10: 0.1253 	 0.1349
2025-08-28 04:19:01,461 | 	avg_model_moe:
2025-08-28 04:19:01,462 | MRR: 0.1576
2025-08-28 04:19:01,462 | HR @1|5|10: 0.1005 	 0.2097 	 0.2642 	
2025-08-28 04:19:01,462 | NDCG @5|10: 0.1572 	 0.1746
2025-08-28 04:19:01,465 | Early Stopping counter: 2 out of 5
2025-08-28 04:19:01,465 | Learning rate decay counter: 1 out of 1
2025-08-28 04:19:01,465 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 04:19:14,218 | Epoch 20/40 - client 2 -  Training Loss: 20.659

 33%|###3      | 1/3 [00:12<00:25, 12.75s/it]2025-08-28 04:21:43,473 | Epoch 20/40 - client 0 -  Training Loss: 24.939

 67%|######6   | 2/3 [02:42<01:33, 93.05s/it]2025-08-28 04:25:24,416 | Epoch 20/40 - client 1 -  Training Loss: 21.980

100%|##########| 3/3 [06:22<00:00, 151.45s/it]
100%|##########| 3/3 [06:22<00:00, 127.65s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.74s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.31s/it]
100%|##########| 3/3 [00:15<00:00,  4.50s/it]
100%|##########| 3/3 [00:15<00:00,  5.20s/it]
2025-08-28 04:25:40,035 | Epoch20 Valid:
2025-08-28 04:25:40,036 | domain:Movies
2025-08-28 04:25:40,036 | model_moe:
2025-08-28 04:25:40,036 | MRR: 0.1856
2025-08-28 04:25:40,037 | HR @1|5|10: 0.1158 	 0.2508 	 0.3196 	
2025-08-28 04:25:40,037 | NDCG @5|10: 0.1856 	 0.2077
2025-08-28 04:25:40,037 | domain:Books
2025-08-28 04:25:40,039 | model_moe:
2025-08-28 04:25:40,039 | MRR: 0.1627
2025-08-28 04:25:40,039 | HR @1|5|10: 0.1016 	 0.2138 	 0.2808 	
2025-08-28 04:25:40,040 | NDCG @5|10: 0.1599 	 0.1815
2025-08-28 04:25:40,040 | domain:Games
2025-08-28 04:25:40,040 | model_moe:
2025-08-28 04:25:40,040 | MRR: 0.1254
2025-08-28 04:25:40,041 | HR @1|5|10: 0.0888 	 0.1608 	 0.1849 	
2025-08-28 04:25:40,041 | NDCG @5|10: 0.1255 	 0.1332
2025-08-28 04:25:40,041 | 	avg_model_moe:
2025-08-28 04:25:40,042 | MRR: 0.1579
2025-08-28 04:25:40,042 | HR @1|5|10: 0.1021 	 0.2085 	 0.2618 	
2025-08-28 04:25:40,042 | NDCG @5|10: 0.1570 	 0.1742
2025-08-28 04:25:40,042 | Early Stopping counter: 3 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 04:25:52,776 | Epoch 21/40 - client 2 -  Training Loss: 20.503

 33%|###3      | 1/3 [00:12<00:25, 12.73s/it]2025-08-28 04:28:21,975 | Epoch 21/40 - client 0 -  Training Loss: 24.731

 67%|######6   | 2/3 [02:41<01:33, 93.01s/it]2025-08-28 04:32:02,802 | Epoch 21/40 - client 1 -  Training Loss: 21.785

100%|##########| 3/3 [06:22<00:00, 151.38s/it]
100%|##########| 3/3 [06:22<00:00, 127.59s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.70s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.27s/it]
100%|##########| 3/3 [00:15<00:00,  4.48s/it]
100%|##########| 3/3 [00:15<00:00,  5.18s/it]
2025-08-28 04:32:18,354 | Epoch21 Valid:
2025-08-28 04:32:18,354 | domain:Movies
2025-08-28 04:32:18,355 | model_moe:
2025-08-28 04:32:18,355 | MRR: 0.1842
2025-08-28 04:32:18,355 | HR @1|5|10: 0.1146 	 0.2508 	 0.3187 	
2025-08-28 04:32:18,356 | NDCG @5|10: 0.1847 	 0.2065
2025-08-28 04:32:18,356 | domain:Books
2025-08-28 04:32:18,356 | model_moe:
2025-08-28 04:32:18,356 | MRR: 0.1620
2025-08-28 04:32:18,357 | HR @1|5|10: 0.1002 	 0.2150 	 0.2816 	
2025-08-28 04:32:18,357 | NDCG @5|10: 0.1597 	 0.1813
2025-08-28 04:32:18,357 | domain:Games
2025-08-28 04:32:18,358 | model_moe:
2025-08-28 04:32:18,358 | MRR: 0.1267
2025-08-28 04:32:18,358 | HR @1|5|10: 0.0888 	 0.1587 	 0.1936 	
2025-08-28 04:32:18,358 | NDCG @5|10: 0.1253 	 0.1366
2025-08-28 04:32:18,359 | 	avg_model_moe:
2025-08-28 04:32:18,359 | MRR: 0.1576
2025-08-28 04:32:18,359 | HR @1|5|10: 0.1012 	 0.2082 	 0.2646 	
2025-08-28 04:32:18,360 | NDCG @5|10: 0.1566 	 0.1748
2025-08-28 04:32:18,360 | Early Stopping counter: 4 out of 5
2025-08-28 04:32:18,360 | Learning rate decay counter: 1 out of 1
2025-08-28 04:32:18,360 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 04:34:47,641 | Epoch 22/40 - client 0 -  Training Loss: 24.530

 33%|###3      | 1/3 [02:29<04:58, 149.29s/it]2025-08-28 04:35:00,415 | Epoch 22/40 - client 2 -  Training Loss: 20.335

 67%|######6   | 2/3 [02:42<01:08, 68.98s/it] 2025-08-28 04:38:41,186 | Epoch 22/40 - client 1 -  Training Loss: 21.597

100%|##########| 3/3 [06:22<00:00, 138.29s/it]
100%|##########| 3/3 [06:22<00:00, 127.61s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.75s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.31s/it]
100%|##########| 3/3 [00:15<00:00,  4.50s/it]
100%|##########| 3/3 [00:15<00:00,  5.20s/it]
2025-08-28 04:38:56,828 | Epoch22 Valid:
2025-08-28 04:38:56,829 | domain:Movies
2025-08-28 04:38:56,829 | model_moe:
2025-08-28 04:38:56,830 | MRR: 0.1847
2025-08-28 04:38:56,830 | HR @1|5|10: 0.1147 	 0.2505 	 0.3181 	
2025-08-28 04:38:56,830 | NDCG @5|10: 0.1848 	 0.2066
2025-08-28 04:38:56,832 | domain:Books
2025-08-28 04:38:56,832 | model_moe:
2025-08-28 04:38:56,832 | MRR: 0.1626
2025-08-28 04:38:56,832 | HR @1|5|10: 0.1010 	 0.2149 	 0.2816 	
2025-08-28 04:38:56,833 | NDCG @5|10: 0.1602 	 0.1816
2025-08-28 04:38:56,833 | domain:Games
2025-08-28 04:38:56,833 | model_moe:
2025-08-28 04:38:56,836 | MRR: 0.1257
2025-08-28 04:38:56,836 | HR @1|5|10: 0.0866 	 0.1587 	 0.1900 	
2025-08-28 04:38:56,836 | NDCG @5|10: 0.1248 	 0.1347
2025-08-28 04:38:56,837 | 	avg_model_moe:
2025-08-28 04:38:56,837 | MRR: 0.1577
2025-08-28 04:38:56,837 | HR @1|5|10: 0.1008 	 0.2080 	 0.2632 	
2025-08-28 04:38:56,837 | NDCG @5|10: 0.1566 	 0.1743
2025-08-28 04:38:56,838 | Early Stopping counter: 5 out of 5
2025-08-28 04:38:56,838 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.76s/it]
 67%|######6   | 2/3 [00:21<00:11, 11.15s/it]
100%|##########| 3/3 [00:23<00:00,  6.92s/it]
100%|##########| 3/3 [00:23<00:00,  7.93s/it]
2025-08-28 04:39:20,616 | Test:
2025-08-28 04:39:20,618 | domain:Movies
2025-08-28 04:39:20,618 | model_moe:
2025-08-28 04:39:20,618 | MRR: 0.1848
2025-08-28 04:39:20,619 | HR @1|5|10: 0.1154 	 0.2506 	 0.3179 	
2025-08-28 04:39:20,619 | NDCG @5|10: 0.1854 	 0.2072
2025-08-28 04:39:20,619 | domain:Books
2025-08-28 04:39:20,620 | model_moe:
2025-08-28 04:39:20,620 | MRR: 0.1323
2025-08-28 04:39:20,620 | HR @1|5|10: 0.0817 	 0.1759 	 0.2287 	
2025-08-28 04:39:20,620 | NDCG @5|10: 0.1302 	 0.1473
2025-08-28 04:39:20,621 | domain:Games
2025-08-28 04:39:20,621 | model_moe:
2025-08-28 04:39:20,621 | MRR: 0.0806
2025-08-28 04:39:20,622 | HR @1|5|10: 0.0506 	 0.1025 	 0.1253 	
2025-08-28 04:39:20,622 | NDCG @5|10: 0.0782 	 0.0854
2025-08-28 04:39:20,622 | 	avg_model_moe:
2025-08-28 04:39:20,622 | MRR: 0.1326
2025-08-28 04:39:20,623 | HR @1|5|10: 0.0825 	 0.1763 	 0.2240 	
2025-08-28 04:39:20,623 | NDCG @5|10: 0.1313 	 0.1466
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-28 04:42:18,370 | Running with the following configs:
	domains : ['Sports', 'Garden', 'Home']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 0.1
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-28 04:42:50,709 | Epoch 1/40 - client 1 -  Training Loss: 23.170

 33%|###3      | 1/3 [00:32<01:04, 32.33s/it]2025-08-28 04:44:51,830 | Epoch 1/40 - client 2 -  Training Loss: 27.576

 67%|######6   | 2/3 [02:33<01:24, 84.56s/it]2025-08-28 04:48:23,230 | Epoch 1/40 - client 0 -  Training Loss: 28.836

100%|##########| 3/3 [06:04<00:00, 142.48s/it]
100%|##########| 3/3 [06:04<00:00, 121.62s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.30s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.51s/it]
100%|##########| 3/3 [00:19<00:00,  6.09s/it]
100%|##########| 3/3 [00:19<00:00,  6.41s/it]
2025-08-28 04:48:42,481 | Epoch1 Valid:
2025-08-28 04:48:42,481 | domain:Sports
2025-08-28 04:48:42,482 | model_moe:
2025-08-28 04:48:42,482 | MRR: 0.0429
2025-08-28 04:48:42,482 | HR @1|5|10: 0.0330 	 0.0448 	 0.0522 	
2025-08-28 04:48:42,483 | NDCG @5|10: 0.0392 	 0.0415
2025-08-28 04:48:42,483 | domain:Garden
2025-08-28 04:48:42,483 | model_moe:
2025-08-28 04:48:42,484 | MRR: 0.0396
2025-08-28 04:48:42,484 | HR @1|5|10: 0.0244 	 0.0465 	 0.0586 	
2025-08-28 04:48:42,484 | NDCG @5|10: 0.0360 	 0.0399
2025-08-28 04:48:42,485 | domain:Home
2025-08-28 04:48:42,485 | model_moe:
2025-08-28 04:48:42,485 | MRR: 0.0466
2025-08-28 04:48:42,485 | HR @1|5|10: 0.0361 	 0.0500 	 0.0584 	
2025-08-28 04:48:42,486 | NDCG @5|10: 0.0430 	 0.0457
2025-08-28 04:48:42,486 | 	avg_model_moe:
2025-08-28 04:48:42,486 | MRR: 0.0430
2025-08-28 04:48:42,487 | HR @1|5|10: 0.0312 	 0.0471 	 0.0564 	
2025-08-28 04:48:42,487 | NDCG @5|10: 0.0394 	 0.0424
2025-08-28 04:48:42,487 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 04:50:45,783 | Epoch 2/40 - client 2 -  Training Loss: 23.645

 33%|###3      | 1/3 [02:00<04:01, 120.56s/it]2025-08-28 04:54:16,904 | Epoch 2/40 - client 0 -  Training Loss: 24.403

 67%|######6   | 2/3 [05:31<02:53, 173.83s/it]2025-08-28 04:54:38,593 | Epoch 2/40 - client 1 -  Training Loss: 20.179

100%|##########| 3/3 [05:53<00:00, 104.36s/it]
100%|##########| 3/3 [05:53<00:00, 117.79s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.13s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.42s/it]
100%|##########| 3/3 [00:19<00:00,  6.03s/it]
100%|##########| 3/3 [00:19<00:00,  6.33s/it]
2025-08-28 04:54:57,610 | Epoch2 Valid:
2025-08-28 04:54:57,610 | domain:Sports
2025-08-28 04:54:57,610 | model_moe:
2025-08-28 04:54:57,611 | MRR: 0.0575
2025-08-28 04:54:57,611 | HR @1|5|10: 0.0428 	 0.0620 	 0.0751 	
2025-08-28 04:54:57,611 | NDCG @5|10: 0.0528 	 0.0570
2025-08-28 04:54:57,612 | domain:Garden
2025-08-28 04:54:57,612 | model_moe:
2025-08-28 04:54:57,612 | MRR: 0.0508
2025-08-28 04:54:57,613 | HR @1|5|10: 0.0361 	 0.0560 	 0.0716 	
2025-08-28 04:54:57,613 | NDCG @5|10: 0.0463 	 0.0513
2025-08-28 04:54:57,613 | domain:Home
2025-08-28 04:54:57,614 | model_moe:
2025-08-28 04:54:57,614 | MRR: 0.0577
2025-08-28 04:54:57,614 | HR @1|5|10: 0.0434 	 0.0631 	 0.0738 	
2025-08-28 04:54:57,614 | NDCG @5|10: 0.0537 	 0.0571
2025-08-28 04:54:57,615 | 	avg_model_moe:
2025-08-28 04:54:57,615 | MRR: 0.0553
2025-08-28 04:54:57,615 | HR @1|5|10: 0.0408 	 0.0604 	 0.0735 	
2025-08-28 04:54:57,616 | NDCG @5|10: 0.0509 	 0.0552
2025-08-28 04:54:57,616 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 04:57:00,571 | Epoch 3/40 - client 2 -  Training Loss: 19.659

 33%|###3      | 1/3 [02:00<04:01, 120.59s/it]2025-08-28 05:00:31,995 | Epoch 3/40 - client 0 -  Training Loss: 20.204

 67%|######6   | 2/3 [05:32<02:54, 174.02s/it]2025-08-28 05:00:53,399 | Epoch 3/40 - client 1 -  Training Loss: 17.564

100%|##########| 3/3 [05:53<00:00, 104.33s/it]
100%|##########| 3/3 [05:53<00:00, 117.80s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.03s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.39s/it]
100%|##########| 3/3 [00:18<00:00,  6.03s/it]
100%|##########| 3/3 [00:18<00:00,  6.32s/it]
2025-08-28 05:01:12,375 | Epoch3 Valid:
2025-08-28 05:01:12,375 | domain:Sports
2025-08-28 05:01:12,375 | model_moe:
2025-08-28 05:01:12,376 | MRR: 0.0696
2025-08-28 05:01:12,376 | HR @1|5|10: 0.0560 	 0.0733 	 0.0853 	
2025-08-28 05:01:12,376 | NDCG @5|10: 0.0650 	 0.0689
2025-08-28 05:01:12,377 | domain:Garden
2025-08-28 05:01:12,377 | model_moe:
2025-08-28 05:01:12,378 | MRR: 0.0699
2025-08-28 05:01:12,379 | HR @1|5|10: 0.0547 	 0.0764 	 0.0891 	
2025-08-28 05:01:12,379 | NDCG @5|10: 0.0662 	 0.0702
2025-08-28 05:01:12,379 | domain:Home
2025-08-28 05:01:12,380 | model_moe:
2025-08-28 05:01:12,380 | MRR: 0.0634
2025-08-28 05:01:12,380 | HR @1|5|10: 0.0508 	 0.0653 	 0.0778 	
2025-08-28 05:01:12,381 | NDCG @5|10: 0.0585 	 0.0625
2025-08-28 05:01:12,381 | 	avg_model_moe:
2025-08-28 05:01:12,381 | MRR: 0.0676
2025-08-28 05:01:12,382 | HR @1|5|10: 0.0538 	 0.0717 	 0.0841 	
2025-08-28 05:01:12,382 | NDCG @5|10: 0.0632 	 0.0672
2025-08-28 05:01:12,382 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:03:15,542 | Epoch 4/40 - client 2 -  Training Loss: 16.285

 33%|###3      | 1/3 [02:00<04:01, 120.69s/it]2025-08-28 05:03:36,886 | Epoch 4/40 - client 1 -  Training Loss: 14.479

 67%|######6   | 2/3 [02:22<01:02, 62.25s/it] 2025-08-28 05:07:08,452 | Epoch 4/40 - client 0 -  Training Loss: 16.735

100%|##########| 3/3 [05:53<00:00, 130.43s/it]
100%|##########| 3/3 [05:53<00:00, 117.87s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.05s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.39s/it]
100%|##########| 3/3 [00:19<00:00,  6.06s/it]
100%|##########| 3/3 [00:19<00:00,  6.34s/it]
2025-08-28 05:07:27,508 | Epoch4 Valid:
2025-08-28 05:07:27,509 | domain:Sports
2025-08-28 05:07:27,509 | model_moe:
2025-08-28 05:07:27,510 | MRR: 0.0781
2025-08-28 05:07:27,510 | HR @1|5|10: 0.0641 	 0.0817 	 0.0957 	
2025-08-28 05:07:27,510 | NDCG @5|10: 0.0733 	 0.0778
2025-08-28 05:07:27,511 | domain:Garden
2025-08-28 05:07:27,511 | model_moe:
2025-08-28 05:07:27,511 | MRR: 0.0818
2025-08-28 05:07:27,511 | HR @1|5|10: 0.0664 	 0.0891 	 0.1031 	
2025-08-28 05:07:27,512 | NDCG @5|10: 0.0783 	 0.0827
2025-08-28 05:07:27,513 | domain:Home
2025-08-28 05:07:27,514 | model_moe:
2025-08-28 05:07:27,514 | MRR: 0.0692
2025-08-28 05:07:27,514 | HR @1|5|10: 0.0555 	 0.0739 	 0.0853 	
2025-08-28 05:07:27,515 | NDCG @5|10: 0.0651 	 0.0688
2025-08-28 05:07:27,515 | 	avg_model_moe:
2025-08-28 05:07:27,515 | MRR: 0.0764
2025-08-28 05:07:27,515 | HR @1|5|10: 0.0620 	 0.0816 	 0.0947 	
2025-08-28 05:07:27,516 | NDCG @5|10: 0.0722 	 0.0764
2025-08-28 05:07:27,516 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:11:01,656 | Epoch 5/40 - client 0 -  Training Loss: 14.529

 33%|###3      | 1/3 [03:31<07:02, 211.28s/it]2025-08-28 05:11:23,292 | Epoch 5/40 - client 1 -  Training Loss: 12.131

 67%|######6   | 2/3 [03:52<01:39, 99.72s/it] 2025-08-28 05:13:24,672 | Epoch 5/40 - client 2 -  Training Loss: 14.058

100%|##########| 3/3 [05:54<00:00, 109.61s/it]
100%|##########| 3/3 [05:54<00:00, 118.10s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.28s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.49s/it]
100%|##########| 3/3 [00:19<00:00,  6.06s/it]
100%|##########| 3/3 [00:19<00:00,  6.38s/it]
2025-08-28 05:13:43,837 | Epoch5 Valid:
2025-08-28 05:13:43,837 | domain:Sports
2025-08-28 05:13:43,841 | model_moe:
2025-08-28 05:13:43,842 | MRR: 0.0830
2025-08-28 05:13:43,842 | HR @1|5|10: 0.0687 	 0.0869 	 0.1002 	
2025-08-28 05:13:43,842 | NDCG @5|10: 0.0783 	 0.0826
2025-08-28 05:13:43,843 | domain:Garden
2025-08-28 05:13:43,843 | model_moe:
2025-08-28 05:13:43,843 | MRR: 0.0858
2025-08-28 05:13:43,843 | HR @1|5|10: 0.0693 	 0.0956 	 0.1057 	
2025-08-28 05:13:43,844 | NDCG @5|10: 0.0832 	 0.0864
2025-08-28 05:13:43,844 | domain:Home
2025-08-28 05:13:43,844 | model_moe:
2025-08-28 05:13:43,845 | MRR: 0.0741
2025-08-28 05:13:43,845 | HR @1|5|10: 0.0590 	 0.0801 	 0.0923 	
2025-08-28 05:13:43,845 | NDCG @5|10: 0.0702 	 0.0741
2025-08-28 05:13:43,847 | 	avg_model_moe:
2025-08-28 05:13:43,847 | MRR: 0.0809
2025-08-28 05:13:43,847 | HR @1|5|10: 0.0656 	 0.0876 	 0.0994 	
2025-08-28 05:13:43,848 | NDCG @5|10: 0.0772 	 0.0810
2025-08-28 05:13:43,848 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:17:18,936 | Epoch 6/40 - client 0 -  Training Loss: 13.110

 33%|###3      | 1/3 [03:31<07:03, 211.50s/it]2025-08-28 05:17:40,274 | Epoch 6/40 - client 1 -  Training Loss: 10.570

 67%|######6   | 2/3 [03:52<01:39, 99.64s/it] 2025-08-28 05:19:40,964 | Epoch 6/40 - client 2 -  Training Loss: 12.578

100%|##########| 3/3 [05:53<00:00, 109.25s/it]
100%|##########| 3/3 [05:53<00:00, 117.84s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.04s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.39s/it]
100%|##########| 3/3 [00:18<00:00,  6.02s/it]
100%|##########| 3/3 [00:18<00:00,  6.32s/it]
2025-08-28 05:19:59,930 | Epoch6 Valid:
2025-08-28 05:19:59,931 | domain:Sports
2025-08-28 05:19:59,931 | model_moe:
2025-08-28 05:19:59,931 | MRR: 0.0852
2025-08-28 05:19:59,932 | HR @1|5|10: 0.0703 	 0.0897 	 0.1029 	
2025-08-28 05:19:59,932 | NDCG @5|10: 0.0806 	 0.0849
2025-08-28 05:19:59,932 | domain:Garden
2025-08-28 05:19:59,933 | model_moe:
2025-08-28 05:19:59,933 | MRR: 0.0856
2025-08-28 05:19:59,933 | HR @1|5|10: 0.0683 	 0.0947 	 0.1064 	
2025-08-28 05:19:59,933 | NDCG @5|10: 0.0826 	 0.0864
2025-08-28 05:19:59,934 | domain:Home
2025-08-28 05:19:59,934 | model_moe:
2025-08-28 05:19:59,934 | MRR: 0.0768
2025-08-28 05:19:59,935 | HR @1|5|10: 0.0609 	 0.0835 	 0.0971 	
2025-08-28 05:19:59,935 | NDCG @5|10: 0.0731 	 0.0774
2025-08-28 05:19:59,935 | 	avg_model_moe:
2025-08-28 05:19:59,935 | MRR: 0.0825
2025-08-28 05:19:59,936 | HR @1|5|10: 0.0665 	 0.0893 	 0.1021 	
2025-08-28 05:19:59,936 | NDCG @5|10: 0.0788 	 0.0829
2025-08-28 05:19:59,936 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:22:02,898 | Epoch 7/40 - client 2 -  Training Loss: 11.576

 33%|###3      | 1/3 [02:00<04:00, 120.50s/it]2025-08-28 05:25:33,896 | Epoch 7/40 - client 0 -  Training Loss: 12.090

 67%|######6   | 2/3 [05:31<02:53, 173.73s/it]2025-08-28 05:25:55,454 | Epoch 7/40 - client 1 -  Training Loss: 9.492

100%|##########| 3/3 [05:53<00:00, 104.25s/it]
100%|##########| 3/3 [05:53<00:00, 117.69s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.16s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.43s/it]
100%|##########| 3/3 [00:19<00:00,  6.04s/it]
100%|##########| 3/3 [00:19<00:00,  6.35s/it]
2025-08-28 05:26:14,517 | Epoch7 Valid:
2025-08-28 05:26:14,520 | domain:Sports
2025-08-28 05:26:14,520 | model_moe:
2025-08-28 05:26:14,520 | MRR: 0.0860
2025-08-28 05:26:14,521 | HR @1|5|10: 0.0711 	 0.0911 	 0.1046 	
2025-08-28 05:26:14,521 | NDCG @5|10: 0.0816 	 0.0859
2025-08-28 05:26:14,521 | domain:Garden
2025-08-28 05:26:14,521 | model_moe:
2025-08-28 05:26:14,522 | MRR: 0.0853
2025-08-28 05:26:14,522 | HR @1|5|10: 0.0667 	 0.0973 	 0.1096 	
2025-08-28 05:26:14,522 | NDCG @5|10: 0.0830 	 0.0870
2025-08-28 05:26:14,523 | domain:Home
2025-08-28 05:26:14,523 | model_moe:
2025-08-28 05:26:14,523 | MRR: 0.0770
2025-08-28 05:26:14,524 | HR @1|5|10: 0.0611 	 0.0834 	 0.0965 	
2025-08-28 05:26:14,524 | NDCG @5|10: 0.0731 	 0.0773
2025-08-28 05:26:14,524 | 	avg_model_moe:
2025-08-28 05:26:14,525 | MRR: 0.0828
2025-08-28 05:26:14,525 | HR @1|5|10: 0.0663 	 0.0906 	 0.1036 	
2025-08-28 05:26:14,525 | NDCG @5|10: 0.0792 	 0.0834
2025-08-28 05:26:14,526 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:28:17,357 | Epoch 8/40 - client 2 -  Training Loss: 10.779

 33%|###3      | 1/3 [02:00<04:01, 120.60s/it]2025-08-28 05:28:38,662 | Epoch 8/40 - client 1 -  Training Loss: 8.701

 67%|######6   | 2/3 [02:21<01:02, 62.19s/it] 2025-08-28 05:32:10,017 | Epoch 8/40 - client 0 -  Training Loss: 11.296

100%|##########| 3/3 [05:53<00:00, 130.30s/it]
100%|##########| 3/3 [05:53<00:00, 117.75s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.03s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.42s/it]
100%|##########| 3/3 [00:19<00:00,  6.17s/it]
100%|##########| 3/3 [00:19<00:00,  6.43s/it]
2025-08-28 05:32:29,344 | Epoch8 Valid:
2025-08-28 05:32:29,344 | domain:Sports
2025-08-28 05:32:29,344 | model_moe:
2025-08-28 05:32:29,345 | MRR: 0.0860
2025-08-28 05:32:29,345 | HR @1|5|10: 0.0703 	 0.0921 	 0.1065 	
2025-08-28 05:32:29,345 | NDCG @5|10: 0.0817 	 0.0863
2025-08-28 05:32:29,346 | domain:Garden
2025-08-28 05:32:29,349 | model_moe:
2025-08-28 05:32:29,349 | MRR: 0.0851
2025-08-28 05:32:29,350 | HR @1|5|10: 0.0670 	 0.0937 	 0.1096 	
2025-08-28 05:32:29,350 | NDCG @5|10: 0.0817 	 0.0867
2025-08-28 05:32:29,350 | domain:Home
2025-08-28 05:32:29,351 | model_moe:
2025-08-28 05:32:29,351 | MRR: 0.0764
2025-08-28 05:32:29,353 | HR @1|5|10: 0.0602 	 0.0829 	 0.0961 	
2025-08-28 05:32:29,353 | NDCG @5|10: 0.0726 	 0.0768
2025-08-28 05:32:29,354 | 	avg_model_moe:
2025-08-28 05:32:29,354 | MRR: 0.0825
2025-08-28 05:32:29,354 | HR @1|5|10: 0.0658 	 0.0896 	 0.1041 	
2025-08-28 05:32:29,355 | NDCG @5|10: 0.0786 	 0.0833
2025-08-28 05:32:29,355 | Early Stopping counter: 1 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:32:50,838 | Epoch 9/40 - client 1 -  Training Loss: 8.059

 33%|###3      | 1/3 [00:21<00:42, 21.48s/it]2025-08-28 05:34:51,391 | Epoch 9/40 - client 2 -  Training Loss: 10.091

 67%|######6   | 2/3 [02:22<01:19, 79.76s/it]2025-08-28 05:38:23,285 | Epoch 9/40 - client 0 -  Training Loss: 10.586

100%|##########| 3/3 [05:53<00:00, 140.09s/it]
100%|##########| 3/3 [05:53<00:00, 117.98s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.98s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.36s/it]
100%|##########| 3/3 [00:18<00:00,  5.99s/it]
100%|##########| 3/3 [00:18<00:00,  6.28s/it]
2025-08-28 05:38:42,139 | Epoch9 Valid:
2025-08-28 05:38:42,140 | domain:Sports
2025-08-28 05:38:42,140 | model_moe:
2025-08-28 05:38:42,141 | MRR: 0.0864
2025-08-28 05:38:42,141 | HR @1|5|10: 0.0706 	 0.0930 	 0.1064 	
2025-08-28 05:38:42,141 | NDCG @5|10: 0.0822 	 0.0865
2025-08-28 05:38:42,142 | domain:Garden
2025-08-28 05:38:42,143 | model_moe:
2025-08-28 05:38:42,143 | MRR: 0.0843
2025-08-28 05:38:42,144 | HR @1|5|10: 0.0654 	 0.0947 	 0.1103 	
2025-08-28 05:38:42,144 | NDCG @5|10: 0.0813 	 0.0864
2025-08-28 05:38:42,144 | domain:Home
2025-08-28 05:38:42,144 | model_moe:
2025-08-28 05:38:42,145 | MRR: 0.0759
2025-08-28 05:38:42,147 | HR @1|5|10: 0.0597 	 0.0824 	 0.0966 	
2025-08-28 05:38:42,148 | NDCG @5|10: 0.0720 	 0.0765
2025-08-28 05:38:42,148 | 	avg_model_moe:
2025-08-28 05:38:42,148 | MRR: 0.0822
2025-08-28 05:38:42,149 | HR @1|5|10: 0.0652 	 0.0900 	 0.1044 	
2025-08-28 05:38:42,149 | NDCG @5|10: 0.0785 	 0.0831
2025-08-28 05:38:42,149 | Early Stopping counter: 2 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:40:42,388 | Epoch 10/40 - client 2 -  Training Loss: 9.501

 33%|###3      | 1/3 [02:00<04:00, 120.24s/it]2025-08-28 05:41:04,011 | Epoch 10/40 - client 1 -  Training Loss: 7.546

 67%|######6   | 2/3 [02:21<01:02, 62.23s/it] 2025-08-28 05:44:34,718 | Epoch 10/40 - client 0 -  Training Loss: 9.978

100%|##########| 3/3 [05:52<00:00, 130.04s/it]
100%|##########| 3/3 [05:52<00:00, 117.53s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.94s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.33s/it]
100%|##########| 3/3 [00:18<00:00,  5.97s/it]
100%|##########| 3/3 [00:18<00:00,  6.26s/it]
2025-08-28 05:44:53,539 | Epoch10 Valid:
2025-08-28 05:44:53,539 | domain:Sports
2025-08-28 05:44:53,540 | model_moe:
2025-08-28 05:44:53,540 | MRR: 0.0859
2025-08-28 05:44:53,540 | HR @1|5|10: 0.0696 	 0.0929 	 0.1082 	
2025-08-28 05:44:53,541 | NDCG @5|10: 0.0817 	 0.0866
2025-08-28 05:44:53,541 | domain:Garden
2025-08-28 05:44:53,541 | model_moe:
2025-08-28 05:44:53,542 | MRR: 0.0839
2025-08-28 05:44:53,542 | HR @1|5|10: 0.0644 	 0.0947 	 0.1109 	
2025-08-28 05:44:53,542 | NDCG @5|10: 0.0809 	 0.0861
2025-08-28 05:44:53,543 | domain:Home
2025-08-28 05:44:53,543 | model_moe:
2025-08-28 05:44:53,543 | MRR: 0.0758
2025-08-28 05:44:53,543 | HR @1|5|10: 0.0595 	 0.0823 	 0.0966 	
2025-08-28 05:44:53,544 | NDCG @5|10: 0.0718 	 0.0765
2025-08-28 05:44:53,544 | 	avg_model_moe:
2025-08-28 05:44:53,544 | MRR: 0.0819
2025-08-28 05:44:53,545 | HR @1|5|10: 0.0645 	 0.0900 	 0.1053 	
2025-08-28 05:44:53,545 | NDCG @5|10: 0.0781 	 0.0830
2025-08-28 05:44:53,545 | Early Stopping counter: 3 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:48:23,996 | Epoch 11/40 - client 0 -  Training Loss: 9.416

 33%|###3      | 1/3 [03:30<07:00, 210.46s/it]2025-08-28 05:48:45,537 | Epoch 11/40 - client 1 -  Training Loss: 7.105

 67%|######6   | 2/3 [03:51<01:39, 99.33s/it] 2025-08-28 05:50:45,782 | Epoch 11/40 - client 2 -  Training Loss: 8.962

100%|##########| 3/3 [05:52<00:00, 108.88s/it]
100%|##########| 3/3 [05:52<00:00, 117.41s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.00s/it]
 67%|######6   | 2/3 [00:12<00:05,  5.39s/it]
100%|##########| 3/3 [00:19<00:00,  6.05s/it]
100%|##########| 3/3 [00:19<00:00,  6.34s/it]
2025-08-28 05:51:04,814 | Epoch11 Valid:
2025-08-28 05:51:04,814 | domain:Sports
2025-08-28 05:51:04,815 | model_moe:
2025-08-28 05:51:04,815 | MRR: 0.0861
2025-08-28 05:51:04,815 | HR @1|5|10: 0.0698 	 0.0926 	 0.1079 	
2025-08-28 05:51:04,816 | NDCG @5|10: 0.0816 	 0.0865
2025-08-28 05:51:04,816 | domain:Garden
2025-08-28 05:51:04,818 | model_moe:
2025-08-28 05:51:04,819 | MRR: 0.0832
2025-08-28 05:51:04,819 | HR @1|5|10: 0.0644 	 0.0937 	 0.1113 	
2025-08-28 05:51:04,819 | NDCG @5|10: 0.0800 	 0.0856
2025-08-28 05:51:04,820 | domain:Home
2025-08-28 05:51:04,820 | model_moe:
2025-08-28 05:51:04,820 | MRR: 0.0747
2025-08-28 05:51:04,822 | HR @1|5|10: 0.0581 	 0.0823 	 0.0966 	
2025-08-28 05:51:04,823 | NDCG @5|10: 0.0710 	 0.0756
2025-08-28 05:51:04,823 | 	avg_model_moe:
2025-08-28 05:51:04,823 | MRR: 0.0813
2025-08-28 05:51:04,824 | HR @1|5|10: 0.0641 	 0.0895 	 0.1053 	
2025-08-28 05:51:04,824 | NDCG @5|10: 0.0775 	 0.0826
2025-08-28 05:51:04,824 | Early Stopping counter: 4 out of 5
2025-08-28 05:51:04,827 | Learning rate decay counter: 1 out of 1
2025-08-28 05:51:04,827 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-28 05:51:25,998 | Epoch 12/40 - client 1 -  Training Loss: 6.728

 33%|###3      | 1/3 [00:21<00:42, 21.17s/it]2025-08-28 05:53:25,827 | Epoch 12/40 - client 2 -  Training Loss: 8.481

 67%|######6   | 2/3 [02:21<01:19, 79.20s/it]2025-08-28 05:56:55,838 | Epoch 12/40 - client 0 -  Training Loss: 8.923

100%|##########| 3/3 [05:51<00:00, 138.94s/it]
100%|##########| 3/3 [05:51<00:00, 117.01s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.89s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.30s/it]
100%|##########| 3/3 [00:18<00:00,  5.94s/it]
100%|##########| 3/3 [00:18<00:00,  6.22s/it]
2025-08-28 05:57:14,530 | Epoch12 Valid:
2025-08-28 05:57:14,530 | domain:Sports
2025-08-28 05:57:14,530 | model_moe:
2025-08-28 05:57:14,531 | MRR: 0.0858
2025-08-28 05:57:14,531 | HR @1|5|10: 0.0687 	 0.0924 	 0.1089 	
2025-08-28 05:57:14,531 | NDCG @5|10: 0.0812 	 0.0865
2025-08-28 05:57:14,532 | domain:Garden
2025-08-28 05:57:14,532 | model_moe:
2025-08-28 05:57:14,532 | MRR: 0.0832
2025-08-28 05:57:14,533 | HR @1|5|10: 0.0641 	 0.0934 	 0.1106 	
2025-08-28 05:57:14,533 | NDCG @5|10: 0.0798 	 0.0853
2025-08-28 05:57:14,533 | domain:Home
2025-08-28 05:57:14,533 | model_moe:
2025-08-28 05:57:14,534 | MRR: 0.0743
2025-08-28 05:57:14,534 | HR @1|5|10: 0.0573 	 0.0820 	 0.0961 	
2025-08-28 05:57:14,534 | NDCG @5|10: 0.0706 	 0.0752
2025-08-28 05:57:14,535 | 	avg_model_moe:
2025-08-28 05:57:14,535 | MRR: 0.0811
2025-08-28 05:57:14,535 | HR @1|5|10: 0.0633 	 0.0893 	 0.1052 	
2025-08-28 05:57:14,535 | NDCG @5|10: 0.0772 	 0.0823
2025-08-28 05:57:14,536 | Early Stopping counter: 5 out of 5
2025-08-28 05:57:14,536 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:14<00:29, 14.81s/it]
 67%|######6   | 2/3 [00:18<00:08,  8.04s/it]
100%|##########| 3/3 [00:28<00:00,  9.03s/it]
100%|##########| 3/3 [00:28<00:00,  9.44s/it]
2025-08-28 05:57:42,859 | Test:
2025-08-28 05:57:42,861 | domain:Sports
2025-08-28 05:57:42,861 | model_moe:
2025-08-28 05:57:42,862 | MRR: 0.0656
2025-08-28 05:57:42,862 | HR @1|5|10: 0.0525 	 0.0706 	 0.0813 	
2025-08-28 05:57:42,862 | NDCG @5|10: 0.0620 	 0.0655
2025-08-28 05:57:42,863 | domain:Garden
2025-08-28 05:57:42,863 | model_moe:
2025-08-28 05:57:42,863 | MRR: 0.0745
2025-08-28 05:57:42,864 | HR @1|5|10: 0.0607 	 0.0813 	 0.0896 	
2025-08-28 05:57:42,864 | NDCG @5|10: 0.0716 	 0.0743
2025-08-28 05:57:42,864 | domain:Home
2025-08-28 05:57:42,865 | model_moe:
2025-08-28 05:57:42,865 | MRR: 0.0557
2025-08-28 05:57:42,865 | HR @1|5|10: 0.0430 	 0.0601 	 0.0709 	
2025-08-28 05:57:42,865 | NDCG @5|10: 0.0519 	 0.0554
2025-08-28 05:57:42,866 | 	avg_model_moe:
2025-08-28 05:57:42,866 | MRR: 0.0653
2025-08-28 05:57:42,866 | HR @1|5|10: 0.0521 	 0.0706 	 0.0806 	
2025-08-28 05:57:42,867 | NDCG @5|10: 0.0618 	 0.0651
