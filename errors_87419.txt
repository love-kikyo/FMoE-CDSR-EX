recon_loss取平均 + gate_loss
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 00:43:18,333 | Running with the following configs:
	domains : ['Food', 'Kitchen', 'Clothing', 'Beauty']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 60
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 10
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 1.0
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:44:00,114 | Epoch 1/60 - client 1 -  Training Loss: 36.171

 25%|##5       | 1/4 [00:41<02:05, 41.77s/it]2025-08-27 00:44:12,706 | Epoch 1/60 - client 0 -  Training Loss: 33.350

 50%|#####     | 2/4 [00:54<00:49, 24.61s/it]2025-08-27 00:44:29,479 | Epoch 1/60 - client 2 -  Training Loss: 36.046

 75%|#######5  | 3/4 [01:11<00:21, 21.03s/it]2025-08-27 00:44:41,845 | Epoch 1/60 - client 3 -  Training Loss: 35.899

100%|##########| 4/4 [01:23<00:00, 17.61s/it]
100%|##########| 4/4 [01:23<00:00, 20.88s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.03s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.11s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 00:44:46,040 | Epoch1 Valid:
2025-08-27 00:44:46,040 | domain:Food
2025-08-27 00:44:46,041 | model_moe:
2025-08-27 00:44:46,041 | MRR: 0.2636
2025-08-27 00:44:46,041 | HR @1|5|10: 0.1653 	 0.3856 	 0.4682 	
2025-08-27 00:44:46,041 | NDCG @5|10: 0.2806 	 0.3076
2025-08-27 00:44:46,042 | domain:Kitchen
2025-08-27 00:44:46,042 | model_moe:
2025-08-27 00:44:46,042 | MRR: 0.0207
2025-08-27 00:44:46,043 | HR @1|5|10: 0.0064 	 0.0216 	 0.0382 	
2025-08-27 00:44:46,043 | NDCG @5|10: 0.0139 	 0.0192
2025-08-27 00:44:46,043 | domain:Clothing
2025-08-27 00:44:46,044 | model_moe:
2025-08-27 00:44:46,044 | MRR: 0.0086
2025-08-27 00:44:46,044 | HR @1|5|10: 0.0012 	 0.0049 	 0.0147 	
2025-08-27 00:44:46,044 | NDCG @5|10: 0.0031 	 0.0063
2025-08-27 00:44:46,045 | domain:Beauty
2025-08-27 00:44:46,045 | model_moe:
2025-08-27 00:44:46,045 | MRR: 0.1390
2025-08-27 00:44:46,046 | HR @1|5|10: 0.0885 	 0.1806 	 0.2536 	
2025-08-27 00:44:46,046 | NDCG @5|10: 0.1350 	 0.1585
2025-08-27 00:44:46,046 | 	avg_model_moe:
2025-08-27 00:44:46,046 | MRR: 0.1080
2025-08-27 00:44:46,047 | HR @1|5|10: 0.0654 	 0.1482 	 0.1937 	
2025-08-27 00:44:46,047 | NDCG @5|10: 0.1081 	 0.1229
2025-08-27 00:44:46,047 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:45:05,809 | Epoch 2/60 - client 2 -  Training Loss: 35.179

 25%|##5       | 1/4 [00:16<00:50, 16.68s/it]2025-08-27 00:45:18,038 | Epoch 2/60 - client 3 -  Training Loss: 34.799

 50%|#####     | 2/4 [00:28<00:28, 14.06s/it]2025-08-27 00:45:48,893 | Epoch 2/60 - client 1 -  Training Loss: 36.284

 75%|#######5  | 3/4 [00:59<00:21, 21.73s/it]2025-08-27 00:46:01,475 | Epoch 2/60 - client 0 -  Training Loss: 32.371

100%|##########| 4/4 [01:12<00:00, 18.12s/it]
100%|##########| 4/4 [01:12<00:00, 18.09s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 00:46:05,638 | Epoch2 Valid:
2025-08-27 00:46:05,638 | domain:Food
2025-08-27 00:46:05,638 | model_moe:
2025-08-27 00:46:05,639 | MRR: 0.2937
2025-08-27 00:46:05,639 | HR @1|5|10: 0.1943 	 0.4147 	 0.5019 	
2025-08-27 00:46:05,639 | NDCG @5|10: 0.3103 	 0.3386
2025-08-27 00:46:05,639 | domain:Kitchen
2025-08-27 00:46:05,640 | model_moe:
2025-08-27 00:46:05,640 | MRR: 0.0712
2025-08-27 00:46:05,640 | HR @1|5|10: 0.0355 	 0.0930 	 0.1358 	
2025-08-27 00:46:05,641 | NDCG @5|10: 0.0644 	 0.0781
2025-08-27 00:46:05,641 | domain:Clothing
2025-08-27 00:46:05,641 | model_moe:
2025-08-27 00:46:05,642 | MRR: 0.0169
2025-08-27 00:46:05,642 | HR @1|5|10: 0.0061 	 0.0196 	 0.0269 	
2025-08-27 00:46:05,642 | NDCG @5|10: 0.0132 	 0.0155
2025-08-27 00:46:05,642 | domain:Beauty
2025-08-27 00:46:05,643 | model_moe:
2025-08-27 00:46:05,643 | MRR: 0.1580
2025-08-27 00:46:05,643 | HR @1|5|10: 0.0885 	 0.2249 	 0.3110 	
2025-08-27 00:46:05,644 | NDCG @5|10: 0.1593 	 0.1870
2025-08-27 00:46:05,644 | 	avg_model_moe:
2025-08-27 00:46:05,644 | MRR: 0.1349
2025-08-27 00:46:05,645 | HR @1|5|10: 0.0811 	 0.1880 	 0.2439 	
2025-08-27 00:46:05,645 | NDCG @5|10: 0.1368 	 0.1548
2025-08-27 00:46:05,645 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:46:24,660 | Epoch 3/60 - client 2 -  Training Loss: 34.774

 25%|##5       | 1/4 [00:16<00:50, 16.73s/it]2025-08-27 00:46:55,483 | Epoch 3/60 - client 1 -  Training Loss: 36.373

 50%|#####     | 2/4 [00:47<00:50, 25.02s/it]2025-08-27 00:47:08,234 | Epoch 3/60 - client 0 -  Training Loss: 31.945

 75%|#######5  | 3/4 [01:00<00:19, 19.42s/it]2025-08-27 00:47:20,530 | Epoch 3/60 - client 3 -  Training Loss: 34.314

100%|##########| 4/4 [01:12<00:00, 16.61s/it]
100%|##########| 4/4 [01:12<00:00, 18.15s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.11s/it]
100%|##########| 4/4 [00:04<00:00,  1.04it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 00:47:24,723 | Epoch3 Valid:
2025-08-27 00:47:24,723 | domain:Food
2025-08-27 00:47:24,724 | model_moe:
2025-08-27 00:47:24,724 | MRR: 0.2972
2025-08-27 00:47:24,724 | HR @1|5|10: 0.1959 	 0.4200 	 0.5011 	
2025-08-27 00:47:24,725 | NDCG @5|10: 0.3142 	 0.3409
2025-08-27 00:47:24,725 | domain:Kitchen
2025-08-27 00:47:24,725 | model_moe:
2025-08-27 00:47:24,726 | MRR: 0.0758
2025-08-27 00:47:24,726 | HR @1|5|10: 0.0382 	 0.0939 	 0.1400 	
2025-08-27 00:47:24,726 | NDCG @5|10: 0.0673 	 0.0822
2025-08-27 00:47:24,726 | domain:Clothing
2025-08-27 00:47:24,727 | model_moe:
2025-08-27 00:47:24,727 | MRR: 0.0237
2025-08-27 00:47:24,727 | HR @1|5|10: 0.0122 	 0.0281 	 0.0379 	
2025-08-27 00:47:24,728 | NDCG @5|10: 0.0200 	 0.0233
2025-08-27 00:47:24,728 | domain:Beauty
2025-08-27 00:47:24,728 | model_moe:
2025-08-27 00:47:24,729 | MRR: 0.1766
2025-08-27 00:47:24,729 | HR @1|5|10: 0.1041 	 0.2500 	 0.3206 	
2025-08-27 00:47:24,729 | NDCG @5|10: 0.1805 	 0.2037
2025-08-27 00:47:24,729 | 	avg_model_moe:
2025-08-27 00:47:24,730 | MRR: 0.1433
2025-08-27 00:47:24,730 | HR @1|5|10: 0.0876 	 0.1980 	 0.2499 	
2025-08-27 00:47:24,730 | NDCG @5|10: 0.1455 	 0.1625
2025-08-27 00:47:24,731 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:47:43,938 | Epoch 4/60 - client 2 -  Training Loss: 34.213

 25%|##5       | 1/4 [00:16<00:50, 16.73s/it]2025-08-27 00:47:56,223 | Epoch 4/60 - client 3 -  Training Loss: 33.730

 50%|#####     | 2/4 [00:29<00:28, 14.12s/it]2025-08-27 00:48:08,831 | Epoch 4/60 - client 0 -  Training Loss: 31.450

 75%|#######5  | 3/4 [00:41<00:13, 13.43s/it]2025-08-27 00:48:39,538 | Epoch 4/60 - client 1 -  Training Loss: 35.924

100%|##########| 4/4 [01:12<00:00, 20.25s/it]
100%|##########| 4/4 [01:12<00:00, 18.08s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.03s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.12s/it]
100%|##########| 4/4 [00:04<00:00,  1.01it/s]
100%|##########| 4/4 [00:04<00:00,  1.07s/it]
2025-08-27 00:48:43,825 | Epoch4 Valid:
2025-08-27 00:48:43,825 | domain:Food
2025-08-27 00:48:43,825 | model_moe:
2025-08-27 00:48:43,826 | MRR: 0.2970
2025-08-27 00:48:43,826 | HR @1|5|10: 0.1974 	 0.4208 	 0.5034 	
2025-08-27 00:48:43,826 | NDCG @5|10: 0.3142 	 0.3412
2025-08-27 00:48:43,827 | domain:Kitchen
2025-08-27 00:48:43,827 | model_moe:
2025-08-27 00:48:43,827 | MRR: 0.0819
2025-08-27 00:48:43,827 | HR @1|5|10: 0.0433 	 0.1017 	 0.1538 	
2025-08-27 00:48:43,828 | NDCG @5|10: 0.0731 	 0.0899
2025-08-27 00:48:43,828 | domain:Clothing
2025-08-27 00:48:43,828 | model_moe:
2025-08-27 00:48:43,829 | MRR: 0.0264
2025-08-27 00:48:43,829 | HR @1|5|10: 0.0134 	 0.0318 	 0.0501 	
2025-08-27 00:48:43,829 | NDCG @5|10: 0.0222 	 0.0280
2025-08-27 00:48:43,830 | domain:Beauty
2025-08-27 00:48:43,830 | model_moe:
2025-08-27 00:48:43,830 | MRR: 0.1834
2025-08-27 00:48:43,830 | HR @1|5|10: 0.1100 	 0.2727 	 0.3313 	
2025-08-27 00:48:43,831 | NDCG @5|10: 0.1931 	 0.2121
2025-08-27 00:48:43,831 | 	avg_model_moe:
2025-08-27 00:48:43,831 | MRR: 0.1472
2025-08-27 00:48:43,832 | HR @1|5|10: 0.0910 	 0.2068 	 0.2597 	
2025-08-27 00:48:43,832 | NDCG @5|10: 0.1506 	 0.1678
2025-08-27 00:48:43,832 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:48:58,546 | Epoch 5/60 - client 0 -  Training Loss: 30.945

 25%|##5       | 1/4 [00:12<00:37, 12.67s/it]2025-08-27 00:49:15,277 | Epoch 5/60 - client 2 -  Training Loss: 33.623

 50%|#####     | 2/4 [00:29<00:30, 15.06s/it]2025-08-27 00:49:46,119 | Epoch 5/60 - client 1 -  Training Loss: 35.191

 75%|#######5  | 3/4 [01:00<00:22, 22.26s/it]2025-08-27 00:49:58,421 | Epoch 5/60 - client 3 -  Training Loss: 33.150

100%|##########| 4/4 [01:12<00:00, 18.33s/it]
100%|##########| 4/4 [01:12<00:00, 18.14s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.02s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.41s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.11s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 00:50:02,615 | Epoch5 Valid:
2025-08-27 00:50:02,615 | domain:Food
2025-08-27 00:50:02,615 | model_moe:
2025-08-27 00:50:02,616 | MRR: 0.3013
2025-08-27 00:50:02,616 | HR @1|5|10: 0.2066 	 0.4200 	 0.4996 	
2025-08-27 00:50:02,616 | NDCG @5|10: 0.3171 	 0.3431
2025-08-27 00:50:02,616 | domain:Kitchen
2025-08-27 00:50:02,617 | model_moe:
2025-08-27 00:50:02,617 | MRR: 0.0820
2025-08-27 00:50:02,617 | HR @1|5|10: 0.0410 	 0.1082 	 0.1602 	
2025-08-27 00:50:02,618 | NDCG @5|10: 0.0749 	 0.0915
2025-08-27 00:50:02,618 | domain:Clothing
2025-08-27 00:50:02,618 | model_moe:
2025-08-27 00:50:02,618 | MRR: 0.0295
2025-08-27 00:50:02,619 | HR @1|5|10: 0.0171 	 0.0306 	 0.0489 	
2025-08-27 00:50:02,619 | NDCG @5|10: 0.0239 	 0.0299
2025-08-27 00:50:02,619 | domain:Beauty
2025-08-27 00:50:02,619 | model_moe:
2025-08-27 00:50:02,620 | MRR: 0.1923
2025-08-27 00:50:02,620 | HR @1|5|10: 0.1196 	 0.2727 	 0.3337 	
2025-08-27 00:50:02,620 | NDCG @5|10: 0.1992 	 0.2193
2025-08-27 00:50:02,621 | 	avg_model_moe:
2025-08-27 00:50:02,621 | MRR: 0.1512
2025-08-27 00:50:02,621 | HR @1|5|10: 0.0961 	 0.2079 	 0.2606 	
2025-08-27 00:50:02,622 | NDCG @5|10: 0.1538 	 0.1710
2025-08-27 00:50:02,622 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:50:35,667 | Epoch 6/60 - client 1 -  Training Loss: 34.060

 25%|##5       | 1/4 [00:30<01:32, 30.75s/it]2025-08-27 00:50:52,488 | Epoch 6/60 - client 2 -  Training Loss: 33.053

 50%|#####     | 2/4 [00:47<00:45, 22.56s/it]2025-08-27 00:51:05,071 | Epoch 6/60 - client 0 -  Training Loss: 30.410

 75%|#######5  | 3/4 [01:00<00:18, 18.00s/it]2025-08-27 00:51:17,287 | Epoch 6/60 - client 3 -  Training Loss: 32.542

100%|##########| 4/4 [01:12<00:00, 15.72s/it]
100%|##########| 4/4 [01:12<00:00, 18.09s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.11s/it]
100%|##########| 4/4 [00:04<00:00,  1.04it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 00:51:21,475 | Epoch6 Valid:
2025-08-27 00:51:21,476 | domain:Food
2025-08-27 00:51:21,476 | model_moe:
2025-08-27 00:51:21,476 | MRR: 0.3015
2025-08-27 00:51:21,477 | HR @1|5|10: 0.2050 	 0.4223 	 0.5019 	
2025-08-27 00:51:21,477 | NDCG @5|10: 0.3180 	 0.3439
2025-08-27 00:51:21,477 | domain:Kitchen
2025-08-27 00:51:21,478 | model_moe:
2025-08-27 00:51:21,478 | MRR: 0.0901
2025-08-27 00:51:21,478 | HR @1|5|10: 0.0460 	 0.1188 	 0.1722 	
2025-08-27 00:51:21,478 | NDCG @5|10: 0.0836 	 0.1007
2025-08-27 00:51:21,479 | domain:Clothing
2025-08-27 00:51:21,479 | model_moe:
2025-08-27 00:51:21,479 | MRR: 0.0299
2025-08-27 00:51:21,480 | HR @1|5|10: 0.0171 	 0.0306 	 0.0477 	
2025-08-27 00:51:21,480 | NDCG @5|10: 0.0241 	 0.0297
2025-08-27 00:51:21,480 | domain:Beauty
2025-08-27 00:51:21,481 | model_moe:
2025-08-27 00:51:21,481 | MRR: 0.1883
2025-08-27 00:51:21,481 | HR @1|5|10: 0.1124 	 0.2727 	 0.3397 	
2025-08-27 00:51:21,481 | NDCG @5|10: 0.1961 	 0.2179
2025-08-27 00:51:21,482 | 	avg_model_moe:
2025-08-27 00:51:21,482 | MRR: 0.1524
2025-08-27 00:51:21,482 | HR @1|5|10: 0.0952 	 0.2111 	 0.2654 	
2025-08-27 00:51:21,483 | NDCG @5|10: 0.1554 	 0.1731
2025-08-27 00:51:21,483 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:51:36,320 | Epoch 7/60 - client 0 -  Training Loss: 29.863

 25%|##5       | 1/4 [00:12<00:37, 12.63s/it]2025-08-27 00:51:48,634 | Epoch 7/60 - client 3 -  Training Loss: 31.959

 50%|#####     | 2/4 [00:24<00:24, 12.44s/it]2025-08-27 00:52:05,326 | Epoch 7/60 - client 2 -  Training Loss: 32.491

 75%|#######5  | 3/4 [00:41<00:14, 14.38s/it]2025-08-27 00:52:36,098 | Epoch 7/60 - client 1 -  Training Loss: 32.887

100%|##########| 4/4 [01:12<00:00, 20.85s/it]
100%|##########| 4/4 [01:12<00:00, 18.10s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.44s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.13s/it]
100%|##########| 4/4 [00:04<00:00,  1.03it/s]
100%|##########| 4/4 [00:04<00:00,  1.06s/it]
2025-08-27 00:52:40,351 | Epoch7 Valid:
2025-08-27 00:52:40,351 | domain:Food
2025-08-27 00:52:40,351 | model_moe:
2025-08-27 00:52:40,352 | MRR: 0.3041
2025-08-27 00:52:40,352 | HR @1|5|10: 0.2104 	 0.4216 	 0.5096 	
2025-08-27 00:52:40,352 | NDCG @5|10: 0.3190 	 0.3481
2025-08-27 00:52:40,353 | domain:Kitchen
2025-08-27 00:52:40,353 | model_moe:
2025-08-27 00:52:40,353 | MRR: 0.0965
2025-08-27 00:52:40,354 | HR @1|5|10: 0.0529 	 0.1257 	 0.1773 	
2025-08-27 00:52:40,354 | NDCG @5|10: 0.0902 	 0.1068
2025-08-27 00:52:40,354 | domain:Clothing
2025-08-27 00:52:40,356 | model_moe:
2025-08-27 00:52:40,356 | MRR: 0.0232
2025-08-27 00:52:40,356 | HR @1|5|10: 0.0073 	 0.0330 	 0.0452 	
2025-08-27 00:52:40,357 | NDCG @5|10: 0.0205 	 0.0246
2025-08-27 00:52:40,357 | domain:Beauty
2025-08-27 00:52:40,357 | model_moe:
2025-08-27 00:52:40,358 | MRR: 0.1947
2025-08-27 00:52:40,358 | HR @1|5|10: 0.1232 	 0.2727 	 0.3433 	
2025-08-27 00:52:40,358 | NDCG @5|10: 0.2006 	 0.2236
2025-08-27 00:52:40,359 | 	avg_model_moe:
2025-08-27 00:52:40,359 | MRR: 0.1546
2025-08-27 00:52:40,359 | HR @1|5|10: 0.0985 	 0.2133 	 0.2688 	
2025-08-27 00:52:40,359 | NDCG @5|10: 0.1576 	 0.1758
2025-08-27 00:52:40,360 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:52:54,802 | Epoch 8/60 - client 0 -  Training Loss: 29.430

 25%|##5       | 1/4 [00:12<00:37, 12.57s/it]2025-08-27 00:53:07,003 | Epoch 8/60 - client 3 -  Training Loss: 31.530

 50%|#####     | 2/4 [00:24<00:24, 12.35s/it]2025-08-27 00:53:37,657 | Epoch 8/60 - client 1 -  Training Loss: 31.835

 75%|#######5  | 3/4 [00:55<00:20, 20.71s/it]2025-08-27 00:53:54,296 | Epoch 8/60 - client 2 -  Training Loss: 32.042

100%|##########| 4/4 [01:12<00:00, 19.10s/it]
100%|##########| 4/4 [01:12<00:00, 18.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 00:53:58,450 | Epoch8 Valid:
2025-08-27 00:53:58,450 | domain:Food
2025-08-27 00:53:58,450 | model_moe:
2025-08-27 00:53:58,451 | MRR: 0.2967
2025-08-27 00:53:58,451 | HR @1|5|10: 0.1966 	 0.4277 	 0.5073 	
2025-08-27 00:53:58,451 | NDCG @5|10: 0.3165 	 0.3427
2025-08-27 00:53:58,452 | domain:Kitchen
2025-08-27 00:53:58,452 | model_moe:
2025-08-27 00:53:58,452 | MRR: 0.0944
2025-08-27 00:53:58,453 | HR @1|5|10: 0.0483 	 0.1271 	 0.1796 	
2025-08-27 00:53:58,453 | NDCG @5|10: 0.0896 	 0.1065
2025-08-27 00:53:58,453 | domain:Clothing
2025-08-27 00:53:58,453 | model_moe:
2025-08-27 00:53:58,454 | MRR: 0.0187
2025-08-27 00:53:58,454 | HR @1|5|10: 0.0061 	 0.0269 	 0.0355 	
2025-08-27 00:53:58,454 | NDCG @5|10: 0.0160 	 0.0187
2025-08-27 00:53:58,454 | domain:Beauty
2025-08-27 00:53:58,455 | model_moe:
2025-08-27 00:53:58,455 | MRR: 0.1950
2025-08-27 00:53:58,455 | HR @1|5|10: 0.1232 	 0.2703 	 0.3505 	
2025-08-27 00:53:58,455 | NDCG @5|10: 0.1998 	 0.2259
2025-08-27 00:53:58,456 | 	avg_model_moe:
2025-08-27 00:53:58,457 | MRR: 0.1512
2025-08-27 00:53:58,458 | HR @1|5|10: 0.0936 	 0.2130 	 0.2682 	
2025-08-27 00:53:58,458 | NDCG @5|10: 0.1555 	 0.1734
2025-08-27 00:53:58,458 | Early Stopping counter: 1 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:54:29,130 | Epoch 9/60 - client 1 -  Training Loss: 31.142

 25%|##5       | 1/4 [00:30<01:32, 30.67s/it]2025-08-27 00:54:45,845 | Epoch 9/60 - client 2 -  Training Loss: 31.751

 50%|#####     | 2/4 [00:47<00:44, 22.46s/it]2025-08-27 00:54:58,405 | Epoch 9/60 - client 0 -  Training Loss: 29.206

 75%|#######5  | 3/4 [00:59<00:17, 17.94s/it]2025-08-27 00:55:10,603 | Epoch 9/60 - client 3 -  Training Loss: 31.324

100%|##########| 4/4 [01:12<00:00, 15.67s/it]
100%|##########| 4/4 [01:12<00:00, 18.04s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 00:55:14,742 | Epoch9 Valid:
2025-08-27 00:55:14,742 | domain:Food
2025-08-27 00:55:14,742 | model_moe:
2025-08-27 00:55:14,743 | MRR: 0.2961
2025-08-27 00:55:14,743 | HR @1|5|10: 0.1959 	 0.4292 	 0.5096 	
2025-08-27 00:55:14,743 | NDCG @5|10: 0.3165 	 0.3428
2025-08-27 00:55:14,744 | domain:Kitchen
2025-08-27 00:55:14,744 | model_moe:
2025-08-27 00:55:14,744 | MRR: 0.0963
2025-08-27 00:55:14,744 | HR @1|5|10: 0.0516 	 0.1344 	 0.1837 	
2025-08-27 00:55:14,745 | NDCG @5|10: 0.0933 	 0.1091
2025-08-27 00:55:14,745 | domain:Clothing
2025-08-27 00:55:14,745 | model_moe:
2025-08-27 00:55:14,746 | MRR: 0.0216
2025-08-27 00:55:14,746 | HR @1|5|10: 0.0061 	 0.0367 	 0.0428 	
2025-08-27 00:55:14,746 | NDCG @5|10: 0.0209 	 0.0229
2025-08-27 00:55:14,746 | domain:Beauty
2025-08-27 00:55:14,747 | model_moe:
2025-08-27 00:55:14,747 | MRR: 0.1896
2025-08-27 00:55:14,747 | HR @1|5|10: 0.1136 	 0.2656 	 0.3433 	
2025-08-27 00:55:14,747 | NDCG @5|10: 0.1940 	 0.2198
2025-08-27 00:55:14,748 | 	avg_model_moe:
2025-08-27 00:55:14,748 | MRR: 0.1509
2025-08-27 00:55:14,748 | HR @1|5|10: 0.0918 	 0.2165 	 0.2698 	
2025-08-27 00:55:14,749 | NDCG @5|10: 0.1562 	 0.1737
2025-08-27 00:55:14,749 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:55:45,397 | Epoch 10/60 - client 1 -  Training Loss: 30.834

 25%|##5       | 1/4 [00:30<01:31, 30.65s/it]2025-08-27 00:55:57,953 | Epoch 10/60 - client 0 -  Training Loss: 29.026

 50%|#####     | 2/4 [00:43<00:40, 20.01s/it]2025-08-27 00:56:10,154 | Epoch 10/60 - client 3 -  Training Loss: 31.088

 75%|#######5  | 3/4 [00:55<00:16, 16.44s/it]2025-08-27 00:56:26,814 | Epoch 10/60 - client 2 -  Training Loss: 31.554

100%|##########| 4/4 [01:12<00:00, 16.53s/it]
100%|##########| 4/4 [01:12<00:00, 18.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.44s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.12s/it]
100%|##########| 4/4 [00:04<00:00,  1.04it/s]
100%|##########| 4/4 [00:04<00:00,  1.05s/it]
2025-08-27 00:56:31,045 | Epoch10 Valid:
2025-08-27 00:56:31,046 | domain:Food
2025-08-27 00:56:31,046 | model_moe:
2025-08-27 00:56:31,046 | MRR: 0.3013
2025-08-27 00:56:31,047 | HR @1|5|10: 0.2020 	 0.4315 	 0.5195 	
2025-08-27 00:56:31,047 | NDCG @5|10: 0.3199 	 0.3488
2025-08-27 00:56:31,047 | domain:Kitchen
2025-08-27 00:56:31,048 | model_moe:
2025-08-27 00:56:31,048 | MRR: 0.1030
2025-08-27 00:56:31,048 | HR @1|5|10: 0.0552 	 0.1381 	 0.1989 	
2025-08-27 00:56:31,048 | NDCG @5|10: 0.0978 	 0.1176
2025-08-27 00:56:31,049 | domain:Clothing
2025-08-27 00:56:31,049 | model_moe:
2025-08-27 00:56:31,049 | MRR: 0.0239
2025-08-27 00:56:31,050 | HR @1|5|10: 0.0098 	 0.0306 	 0.0403 	
2025-08-27 00:56:31,050 | NDCG @5|10: 0.0207 	 0.0238
2025-08-27 00:56:31,050 | domain:Beauty
2025-08-27 00:56:31,050 | model_moe:
2025-08-27 00:56:31,051 | MRR: 0.1945
2025-08-27 00:56:31,051 | HR @1|5|10: 0.1184 	 0.2703 	 0.3565 	
2025-08-27 00:56:31,051 | NDCG @5|10: 0.1990 	 0.2272
2025-08-27 00:56:31,051 | 	avg_model_moe:
2025-08-27 00:56:31,052 | MRR: 0.1557
2025-08-27 00:56:31,052 | HR @1|5|10: 0.0964 	 0.2176 	 0.2788 	
2025-08-27 00:56:31,052 | NDCG @5|10: 0.1594 	 0.1793
2025-08-27 00:56:31,053 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:56:45,771 | Epoch 11/60 - client 0 -  Training Loss: 28.807

 25%|##5       | 1/4 [00:12<00:37, 12.58s/it]2025-08-27 00:56:57,976 | Epoch 11/60 - client 3 -  Training Loss: 30.851

 50%|#####     | 2/4 [00:24<00:24, 12.36s/it]2025-08-27 00:57:14,631 | Epoch 11/60 - client 2 -  Training Loss: 31.303

 75%|#######5  | 3/4 [00:41<00:14, 14.32s/it]2025-08-27 00:57:45,348 | Epoch 11/60 - client 1 -  Training Loss: 30.571

100%|##########| 4/4 [01:12<00:00, 20.79s/it]
100%|##########| 4/4 [01:12<00:00, 18.04s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.02s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 00:57:49,512 | Epoch11 Valid:
2025-08-27 00:57:49,512 | domain:Food
2025-08-27 00:57:49,512 | model_moe:
2025-08-27 00:57:49,513 | MRR: 0.3032
2025-08-27 00:57:49,513 | HR @1|5|10: 0.2050 	 0.4361 	 0.5142 	
2025-08-27 00:57:49,513 | NDCG @5|10: 0.3235 	 0.3489
2025-08-27 00:57:49,513 | domain:Kitchen
2025-08-27 00:57:49,514 | model_moe:
2025-08-27 00:57:49,514 | MRR: 0.1035
2025-08-27 00:57:49,514 | HR @1|5|10: 0.0557 	 0.1413 	 0.2003 	
2025-08-27 00:57:49,515 | NDCG @5|10: 0.0993 	 0.1184
2025-08-27 00:57:49,515 | domain:Clothing
2025-08-27 00:57:49,515 | model_moe:
2025-08-27 00:57:49,516 | MRR: 0.0246
2025-08-27 00:57:49,516 | HR @1|5|10: 0.0110 	 0.0269 	 0.0440 	
2025-08-27 00:57:49,516 | NDCG @5|10: 0.0197 	 0.0252
2025-08-27 00:57:49,516 | domain:Beauty
2025-08-27 00:57:49,517 | model_moe:
2025-08-27 00:57:49,517 | MRR: 0.1937
2025-08-27 00:57:49,517 | HR @1|5|10: 0.1196 	 0.2715 	 0.3553 	
2025-08-27 00:57:49,518 | NDCG @5|10: 0.1987 	 0.2260
2025-08-27 00:57:49,518 | 	avg_model_moe:
2025-08-27 00:57:49,518 | MRR: 0.1562
2025-08-27 00:57:49,518 | HR @1|5|10: 0.0978 	 0.2190 	 0.2784 	
2025-08-27 00:57:49,519 | NDCG @5|10: 0.1603 	 0.1796
2025-08-27 00:57:49,519 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:58:04,099 | Epoch 12/60 - client 3 -  Training Loss: 30.619

 25%|##5       | 1/4 [00:12<00:36, 12.22s/it]2025-08-27 00:58:16,664 | Epoch 12/60 - client 0 -  Training Loss: 28.612

 50%|#####     | 2/4 [00:24<00:24, 12.42s/it]2025-08-27 00:58:33,386 | Epoch 12/60 - client 2 -  Training Loss: 31.068

 75%|#######5  | 3/4 [00:41<00:14, 14.38s/it]2025-08-27 00:59:04,044 | Epoch 12/60 - client 1 -  Training Loss: 30.327

100%|##########| 4/4 [01:12<00:00, 20.81s/it]
100%|##########| 4/4 [01:12<00:00, 18.04s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 00:59:08,203 | Epoch12 Valid:
2025-08-27 00:59:08,203 | domain:Food
2025-08-27 00:59:08,203 | model_moe:
2025-08-27 00:59:08,204 | MRR: 0.3035
2025-08-27 00:59:08,204 | HR @1|5|10: 0.2028 	 0.4384 	 0.5142 	
2025-08-27 00:59:08,204 | NDCG @5|10: 0.3243 	 0.3493
2025-08-27 00:59:08,205 | domain:Kitchen
2025-08-27 00:59:08,205 | model_moe:
2025-08-27 00:59:08,205 | MRR: 0.1032
2025-08-27 00:59:08,205 | HR @1|5|10: 0.0539 	 0.1436 	 0.1984 	
2025-08-27 00:59:08,206 | NDCG @5|10: 0.0997 	 0.1175
2025-08-27 00:59:08,206 | domain:Clothing
2025-08-27 00:59:08,206 | model_moe:
2025-08-27 00:59:08,207 | MRR: 0.0228
2025-08-27 00:59:08,207 | HR @1|5|10: 0.0086 	 0.0281 	 0.0416 	
2025-08-27 00:59:08,207 | NDCG @5|10: 0.0192 	 0.0235
2025-08-27 00:59:08,207 | domain:Beauty
2025-08-27 00:59:08,208 | model_moe:
2025-08-27 00:59:08,208 | MRR: 0.1912
2025-08-27 00:59:08,208 | HR @1|5|10: 0.1172 	 0.2632 	 0.3433 	
2025-08-27 00:59:08,209 | NDCG @5|10: 0.1950 	 0.2210
2025-08-27 00:59:08,209 | 	avg_model_moe:
2025-08-27 00:59:08,209 | MRR: 0.1552
2025-08-27 00:59:08,209 | HR @1|5|10: 0.0956 	 0.2183 	 0.2744 	
2025-08-27 00:59:08,210 | NDCG @5|10: 0.1595 	 0.1778
2025-08-27 00:59:08,210 | Early Stopping counter: 1 out of 10
2025-08-27 00:59:08,210 | Learning rate decay counter: 1 out of 1
2025-08-27 00:59:08,210 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 00:59:38,862 | Epoch 13/60 - client 1 -  Training Loss: 30.113

 25%|##5       | 1/4 [00:30<01:31, 30.65s/it]2025-08-27 00:59:51,063 | Epoch 13/60 - client 3 -  Training Loss: 30.416

 50%|#####     | 2/4 [00:42<00:39, 19.80s/it]2025-08-27 01:00:03,600 | Epoch 13/60 - client 0 -  Training Loss: 28.466

 75%|#######5  | 3/4 [00:55<00:16, 16.48s/it]2025-08-27 01:00:20,352 | Epoch 13/60 - client 2 -  Training Loss: 30.863

100%|##########| 4/4 [01:12<00:00, 16.59s/it]
100%|##########| 4/4 [01:12<00:00, 18.04s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 01:00:24,520 | Epoch13 Valid:
2025-08-27 01:00:24,520 | domain:Food
2025-08-27 01:00:24,520 | model_moe:
2025-08-27 01:00:24,521 | MRR: 0.3095
2025-08-27 01:00:24,521 | HR @1|5|10: 0.2104 	 0.4399 	 0.5126 	
2025-08-27 01:00:24,521 | NDCG @5|10: 0.3295 	 0.3535
2025-08-27 01:00:24,522 | domain:Kitchen
2025-08-27 01:00:24,522 | model_moe:
2025-08-27 01:00:24,522 | MRR: 0.1073
2025-08-27 01:00:24,524 | HR @1|5|10: 0.0571 	 0.1459 	 0.2017 	
2025-08-27 01:00:24,524 | NDCG @5|10: 0.1032 	 0.1215
2025-08-27 01:00:24,524 | domain:Clothing
2025-08-27 01:00:24,525 | model_moe:
2025-08-27 01:00:24,525 | MRR: 0.0247
2025-08-27 01:00:24,525 | HR @1|5|10: 0.0122 	 0.0281 	 0.0428 	
2025-08-27 01:00:24,525 | NDCG @5|10: 0.0205 	 0.0251
2025-08-27 01:00:24,526 | domain:Beauty
2025-08-27 01:00:24,526 | model_moe:
2025-08-27 01:00:24,526 | MRR: 0.1919
2025-08-27 01:00:24,527 | HR @1|5|10: 0.1172 	 0.2679 	 0.3433 	
2025-08-27 01:00:24,527 | NDCG @5|10: 0.1965 	 0.2214
2025-08-27 01:00:24,527 | 	avg_model_moe:
2025-08-27 01:00:24,527 | MRR: 0.1583
2025-08-27 01:00:24,528 | HR @1|5|10: 0.0992 	 0.2205 	 0.2751 	
2025-08-27 01:00:24,528 | NDCG @5|10: 0.1624 	 0.1803
2025-08-27 01:00:24,528 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:00:38,835 | Epoch 14/60 - client 3 -  Training Loss: 30.263

 25%|##5       | 1/4 [00:12<00:36, 12.29s/it]2025-08-27 01:00:51,460 | Epoch 14/60 - client 0 -  Training Loss: 28.355

 50%|#####     | 2/4 [00:24<00:24, 12.49s/it]2025-08-27 01:01:08,143 | Epoch 14/60 - client 2 -  Training Loss: 30.681

 75%|#######5  | 3/4 [00:41<00:14, 14.40s/it]2025-08-27 01:01:38,862 | Epoch 14/60 - client 1 -  Training Loss: 29.957

100%|##########| 4/4 [01:12<00:00, 20.84s/it]
100%|##########| 4/4 [01:12<00:00, 18.08s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:01:43,000 | Epoch14 Valid:
2025-08-27 01:01:43,001 | domain:Food
2025-08-27 01:01:43,001 | model_moe:
2025-08-27 01:01:43,001 | MRR: 0.3102
2025-08-27 01:01:43,002 | HR @1|5|10: 0.2089 	 0.4476 	 0.5172 	
2025-08-27 01:01:43,002 | NDCG @5|10: 0.3325 	 0.3552
2025-08-27 01:01:43,002 | domain:Kitchen
2025-08-27 01:01:43,002 | model_moe:
2025-08-27 01:01:43,003 | MRR: 0.1098
2025-08-27 01:01:43,003 | HR @1|5|10: 0.0594 	 0.1464 	 0.2044 	
2025-08-27 01:01:43,003 | NDCG @5|10: 0.1050 	 0.1241
2025-08-27 01:01:43,004 | domain:Clothing
2025-08-27 01:01:43,004 | model_moe:
2025-08-27 01:01:43,004 | MRR: 0.0249
2025-08-27 01:01:43,004 | HR @1|5|10: 0.0122 	 0.0269 	 0.0428 	
2025-08-27 01:01:43,005 | NDCG @5|10: 0.0201 	 0.0252
2025-08-27 01:01:43,005 | domain:Beauty
2025-08-27 01:01:43,005 | model_moe:
2025-08-27 01:01:43,006 | MRR: 0.1956
2025-08-27 01:01:43,006 | HR @1|5|10: 0.1172 	 0.2787 	 0.3517 	
2025-08-27 01:01:43,006 | NDCG @5|10: 0.2025 	 0.2264
2025-08-27 01:01:43,006 | 	avg_model_moe:
2025-08-27 01:01:43,007 | MRR: 0.1601
2025-08-27 01:01:43,007 | HR @1|5|10: 0.0994 	 0.2249 	 0.2790 	
2025-08-27 01:01:43,007 | NDCG @5|10: 0.1650 	 0.1827
2025-08-27 01:01:43,008 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:01:57,414 | Epoch 15/60 - client 0 -  Training Loss: 28.245

 25%|##5       | 1/4 [00:12<00:37, 12.56s/it]2025-08-27 01:02:09,724 | Epoch 15/60 - client 3 -  Training Loss: 30.134

 50%|#####     | 2/4 [00:24<00:24, 12.41s/it]2025-08-27 01:02:26,387 | Epoch 15/60 - client 2 -  Training Loss: 30.516

 75%|#######5  | 3/4 [00:41<00:14, 14.35s/it]2025-08-27 01:02:57,044 | Epoch 15/60 - client 1 -  Training Loss: 29.827

100%|##########| 4/4 [01:12<00:00, 20.79s/it]
100%|##########| 4/4 [01:12<00:00, 18.05s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:03:01,193 | Epoch15 Valid:
2025-08-27 01:03:01,194 | domain:Food
2025-08-27 01:03:01,194 | model_moe:
2025-08-27 01:03:01,194 | MRR: 0.3156
2025-08-27 01:03:01,195 | HR @1|5|10: 0.2165 	 0.4507 	 0.5172 	
2025-08-27 01:03:01,195 | NDCG @5|10: 0.3371 	 0.3594
2025-08-27 01:03:01,195 | domain:Kitchen
2025-08-27 01:03:01,196 | model_moe:
2025-08-27 01:03:01,196 | MRR: 0.1076
2025-08-27 01:03:01,196 | HR @1|5|10: 0.0552 	 0.1492 	 0.2026 	
2025-08-27 01:03:01,196 | NDCG @5|10: 0.1045 	 0.1219
2025-08-27 01:03:01,197 | domain:Clothing
2025-08-27 01:03:01,197 | model_moe:
2025-08-27 01:03:01,197 | MRR: 0.0244
2025-08-27 01:03:01,198 | HR @1|5|10: 0.0122 	 0.0269 	 0.0452 	
2025-08-27 01:03:01,198 | NDCG @5|10: 0.0196 	 0.0255
2025-08-27 01:03:01,198 | domain:Beauty
2025-08-27 01:03:01,198 | model_moe:
2025-08-27 01:03:01,199 | MRR: 0.1992
2025-08-27 01:03:01,199 | HR @1|5|10: 0.1232 	 0.2799 	 0.3600 	
2025-08-27 01:03:01,199 | NDCG @5|10: 0.2054 	 0.2314
2025-08-27 01:03:01,200 | 	avg_model_moe:
2025-08-27 01:03:01,200 | MRR: 0.1617
2025-08-27 01:03:01,200 | HR @1|5|10: 0.1018 	 0.2267 	 0.2813 	
2025-08-27 01:03:01,200 | NDCG @5|10: 0.1666 	 0.1845
2025-08-27 01:03:01,201 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:03:19,733 | Epoch 16/60 - client 2 -  Training Loss: 30.375

 25%|##5       | 1/4 [00:16<00:50, 16.67s/it]2025-08-27 01:03:50,432 | Epoch 16/60 - client 1 -  Training Loss: 29.720

 50%|#####     | 2/4 [00:47<00:49, 24.92s/it]2025-08-27 01:04:02,788 | Epoch 16/60 - client 3 -  Training Loss: 30.010

 75%|#######5  | 3/4 [00:59<00:19, 19.18s/it]2025-08-27 01:04:15,353 | Epoch 16/60 - client 0 -  Training Loss: 28.155

100%|##########| 4/4 [01:12<00:00, 16.57s/it]
100%|##########| 4/4 [01:12<00:00, 18.07s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:04:19,499 | Epoch16 Valid:
2025-08-27 01:04:19,499 | domain:Food
2025-08-27 01:04:19,499 | model_moe:
2025-08-27 01:04:19,500 | MRR: 0.3170
2025-08-27 01:04:19,500 | HR @1|5|10: 0.2150 	 0.4583 	 0.5203 	
2025-08-27 01:04:19,500 | NDCG @5|10: 0.3412 	 0.3615
2025-08-27 01:04:19,501 | domain:Kitchen
2025-08-27 01:04:19,501 | model_moe:
2025-08-27 01:04:19,501 | MRR: 0.1124
2025-08-27 01:04:19,501 | HR @1|5|10: 0.0617 	 0.1538 	 0.2072 	
2025-08-27 01:04:19,502 | NDCG @5|10: 0.1093 	 0.1268
2025-08-27 01:04:19,502 | domain:Clothing
2025-08-27 01:04:19,502 | model_moe:
2025-08-27 01:04:19,503 | MRR: 0.0233
2025-08-27 01:04:19,503 | HR @1|5|10: 0.0098 	 0.0281 	 0.0452 	
2025-08-27 01:04:19,503 | NDCG @5|10: 0.0191 	 0.0246
2025-08-27 01:04:19,503 | domain:Beauty
2025-08-27 01:04:19,504 | model_moe:
2025-08-27 01:04:19,504 | MRR: 0.2023
2025-08-27 01:04:19,504 | HR @1|5|10: 0.1256 	 0.2871 	 0.3612 	
2025-08-27 01:04:19,505 | NDCG @5|10: 0.2101 	 0.2341
2025-08-27 01:04:19,505 | 	avg_model_moe:
2025-08-27 01:04:19,505 | MRR: 0.1638
2025-08-27 01:04:19,505 | HR @1|5|10: 0.1030 	 0.2318 	 0.2835 	
2025-08-27 01:04:19,506 | NDCG @5|10: 0.1699 	 0.1867
2025-08-27 01:04:19,506 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:04:38,021 | Epoch 17/60 - client 2 -  Training Loss: 30.244

 25%|##5       | 1/4 [00:16<00:49, 16.62s/it]2025-08-27 01:05:08,664 | Epoch 17/60 - client 1 -  Training Loss: 29.635

 50%|#####     | 2/4 [00:47<00:49, 24.87s/it]2025-08-27 01:05:21,195 | Epoch 17/60 - client 0 -  Training Loss: 28.081

 75%|#######5  | 3/4 [00:59<00:19, 19.24s/it]2025-08-27 01:05:33,401 | Epoch 17/60 - client 3 -  Training Loss: 29.906

100%|##########| 4/4 [01:12<00:00, 16.46s/it]
100%|##########| 4/4 [01:12<00:00, 18.00s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:05:37,553 | Epoch17 Valid:
2025-08-27 01:05:37,553 | domain:Food
2025-08-27 01:05:37,554 | model_moe:
2025-08-27 01:05:37,554 | MRR: 0.3206
2025-08-27 01:05:37,554 | HR @1|5|10: 0.2181 	 0.4637 	 0.5241 	
2025-08-27 01:05:37,555 | NDCG @5|10: 0.3456 	 0.3652
2025-08-27 01:05:37,555 | domain:Kitchen
2025-08-27 01:05:37,555 | model_moe:
2025-08-27 01:05:37,555 | MRR: 0.1114
2025-08-27 01:05:37,556 | HR @1|5|10: 0.0585 	 0.1552 	 0.2104 	
2025-08-27 01:05:37,556 | NDCG @5|10: 0.1089 	 0.1268
2025-08-27 01:05:37,556 | domain:Clothing
2025-08-27 01:05:37,557 | model_moe:
2025-08-27 01:05:37,557 | MRR: 0.0237
2025-08-27 01:05:37,557 | HR @1|5|10: 0.0098 	 0.0281 	 0.0416 	
2025-08-27 01:05:37,557 | NDCG @5|10: 0.0195 	 0.0238
2025-08-27 01:05:37,558 | domain:Beauty
2025-08-27 01:05:37,558 | model_moe:
2025-08-27 01:05:37,558 | MRR: 0.2040
2025-08-27 01:05:37,558 | HR @1|5|10: 0.1292 	 0.2847 	 0.3648 	
2025-08-27 01:05:37,559 | NDCG @5|10: 0.2099 	 0.2359
2025-08-27 01:05:37,559 | 	avg_model_moe:
2025-08-27 01:05:37,559 | MRR: 0.1649
2025-08-27 01:05:37,560 | HR @1|5|10: 0.1039 	 0.2329 	 0.2852 	
2025-08-27 01:05:37,560 | NDCG @5|10: 0.1709 	 0.1879
2025-08-27 01:05:37,560 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:05:51,801 | Epoch 18/60 - client 3 -  Training Loss: 29.806

 25%|##5       | 1/4 [00:12<00:36, 12.33s/it]2025-08-27 01:06:04,371 | Epoch 18/60 - client 0 -  Training Loss: 28.007

 50%|#####     | 2/4 [00:24<00:24, 12.47s/it]2025-08-27 01:06:21,015 | Epoch 18/60 - client 2 -  Training Loss: 30.116

 75%|#######5  | 3/4 [00:41<00:14, 14.38s/it]2025-08-27 01:06:51,688 | Epoch 18/60 - client 1 -  Training Loss: 29.562

100%|##########| 4/4 [01:12<00:00, 20.81s/it]
100%|##########| 4/4 [01:12<00:00, 18.06s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 01:06:55,857 | Epoch18 Valid:
2025-08-27 01:06:55,857 | domain:Food
2025-08-27 01:06:55,858 | model_moe:
2025-08-27 01:06:55,858 | MRR: 0.3154
2025-08-27 01:06:55,858 | HR @1|5|10: 0.2096 	 0.4660 	 0.5241 	
2025-08-27 01:06:55,859 | NDCG @5|10: 0.3426 	 0.3614
2025-08-27 01:06:55,859 | domain:Kitchen
2025-08-27 01:06:55,859 | model_moe:
2025-08-27 01:06:55,860 | MRR: 0.1132
2025-08-27 01:06:55,860 | HR @1|5|10: 0.0589 	 0.1598 	 0.2145 	
2025-08-27 01:06:55,860 | NDCG @5|10: 0.1112 	 0.1291
2025-08-27 01:06:55,860 | domain:Clothing
2025-08-27 01:06:55,861 | model_moe:
2025-08-27 01:06:55,861 | MRR: 0.0244
2025-08-27 01:06:55,861 | HR @1|5|10: 0.0110 	 0.0306 	 0.0416 	
2025-08-27 01:06:55,861 | NDCG @5|10: 0.0209 	 0.0244
2025-08-27 01:06:55,862 | domain:Beauty
2025-08-27 01:06:55,862 | model_moe:
2025-08-27 01:06:55,862 | MRR: 0.2051
2025-08-27 01:06:55,863 | HR @1|5|10: 0.1268 	 0.2895 	 0.3648 	
2025-08-27 01:06:55,863 | NDCG @5|10: 0.2121 	 0.2367
2025-08-27 01:06:55,863 | 	avg_model_moe:
2025-08-27 01:06:55,864 | MRR: 0.1645
2025-08-27 01:06:55,864 | HR @1|5|10: 0.1016 	 0.2364 	 0.2863 	
2025-08-27 01:06:55,864 | NDCG @5|10: 0.1717 	 0.1879
2025-08-27 01:06:55,864 | Early Stopping counter: 1 out of 10
2025-08-27 01:06:55,865 | Learning rate decay counter: 1 out of 1
2025-08-27 01:06:55,865 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:07:08,080 | Epoch 19/60 - client 3 -  Training Loss: 29.703

 25%|##5       | 1/4 [00:12<00:36, 12.22s/it]2025-08-27 01:07:24,728 | Epoch 19/60 - client 2 -  Training Loss: 29.993

 50%|#####     | 2/4 [00:28<00:29, 14.82s/it]2025-08-27 01:07:55,442 | Epoch 19/60 - client 1 -  Training Loss: 29.482

 75%|#######5  | 3/4 [00:59<00:22, 22.08s/it]2025-08-27 01:08:07,930 | Epoch 19/60 - client 0 -  Training Loss: 27.934

100%|##########| 4/4 [01:12<00:00, 18.29s/it]
100%|##########| 4/4 [01:12<00:00, 18.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.00it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:08:12,051 | Epoch19 Valid:
2025-08-27 01:08:12,052 | domain:Food
2025-08-27 01:08:12,052 | model_moe:
2025-08-27 01:08:12,054 | MRR: 0.3202
2025-08-27 01:08:12,055 | HR @1|5|10: 0.2173 	 0.4637 	 0.5264 	
2025-08-27 01:08:12,055 | NDCG @5|10: 0.3451 	 0.3656
2025-08-27 01:08:12,055 | domain:Kitchen
2025-08-27 01:08:12,056 | model_moe:
2025-08-27 01:08:12,056 | MRR: 0.1143
2025-08-27 01:08:12,056 | HR @1|5|10: 0.0599 	 0.1616 	 0.2136 	
2025-08-27 01:08:12,056 | NDCG @5|10: 0.1130 	 0.1298
2025-08-27 01:08:12,057 | domain:Clothing
2025-08-27 01:08:12,057 | model_moe:
2025-08-27 01:08:12,057 | MRR: 0.0254
2025-08-27 01:08:12,058 | HR @1|5|10: 0.0122 	 0.0330 	 0.0403 	
2025-08-27 01:08:12,058 | NDCG @5|10: 0.0225 	 0.0248
2025-08-27 01:08:12,058 | domain:Beauty
2025-08-27 01:08:12,061 | model_moe:
2025-08-27 01:08:12,061 | MRR: 0.2071
2025-08-27 01:08:12,061 | HR @1|5|10: 0.1304 	 0.2955 	 0.3672 	
2025-08-27 01:08:12,061 | NDCG @5|10: 0.2158 	 0.2390
2025-08-27 01:08:12,062 | 	avg_model_moe:
2025-08-27 01:08:12,062 | MRR: 0.1667
2025-08-27 01:08:12,062 | HR @1|5|10: 0.1049 	 0.2384 	 0.2869 	
2025-08-27 01:08:12,063 | NDCG @5|10: 0.1741 	 0.1898
2025-08-27 01:08:12,063 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:08:44,877 | Epoch 20/60 - client 1 -  Training Loss: 29.398

 25%|##5       | 1/4 [00:30<01:31, 30.65s/it]2025-08-27 01:09:01,506 | Epoch 20/60 - client 2 -  Training Loss: 29.884

 50%|#####     | 2/4 [00:47<00:44, 22.40s/it]2025-08-27 01:09:13,678 | Epoch 20/60 - client 3 -  Training Loss: 29.601

 75%|#######5  | 3/4 [00:59<00:17, 17.73s/it]2025-08-27 01:09:26,189 | Epoch 20/60 - client 0 -  Training Loss: 27.864

100%|##########| 4/4 [01:11<00:00, 15.67s/it]
100%|##########| 4/4 [01:11<00:00, 17.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.43s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.12s/it]
100%|##########| 4/4 [00:04<00:00,  1.04it/s]
100%|##########| 4/4 [00:04<00:00,  1.05s/it]
2025-08-27 01:09:30,407 | Epoch20 Valid:
2025-08-27 01:09:30,407 | domain:Food
2025-08-27 01:09:30,407 | model_moe:
2025-08-27 01:09:30,408 | MRR: 0.3250
2025-08-27 01:09:30,408 | HR @1|5|10: 0.2226 	 0.4644 	 0.5233 	
2025-08-27 01:09:30,408 | NDCG @5|10: 0.3490 	 0.3683
2025-08-27 01:09:30,409 | domain:Kitchen
2025-08-27 01:09:30,409 | model_moe:
2025-08-27 01:09:30,409 | MRR: 0.1155
2025-08-27 01:09:30,410 | HR @1|5|10: 0.0617 	 0.1644 	 0.2155 	
2025-08-27 01:09:30,410 | NDCG @5|10: 0.1149 	 0.1313
2025-08-27 01:09:30,410 | domain:Clothing
2025-08-27 01:09:30,410 | model_moe:
2025-08-27 01:09:30,411 | MRR: 0.0249
2025-08-27 01:09:30,411 | HR @1|5|10: 0.0110 	 0.0318 	 0.0465 	
2025-08-27 01:09:30,411 | NDCG @5|10: 0.0213 	 0.0261
2025-08-27 01:09:30,411 | domain:Beauty
2025-08-27 01:09:30,412 | model_moe:
2025-08-27 01:09:30,412 | MRR: 0.2098
2025-08-27 01:09:30,412 | HR @1|5|10: 0.1340 	 0.2990 	 0.3756 	
2025-08-27 01:09:30,413 | NDCG @5|10: 0.2186 	 0.2434
2025-08-27 01:09:30,413 | 	avg_model_moe:
2025-08-27 01:09:30,413 | MRR: 0.1688
2025-08-27 01:09:30,413 | HR @1|5|10: 0.1073 	 0.2399 	 0.2902 	
2025-08-27 01:09:30,414 | NDCG @5|10: 0.1759 	 0.1923
2025-08-27 01:09:30,414 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:09:44,960 | Epoch 21/60 - client 3 -  Training Loss: 29.514

 25%|##5       | 1/4 [00:12<00:36, 12.24s/it]2025-08-27 01:10:01,596 | Epoch 21/60 - client 2 -  Training Loss: 29.773

 50%|#####     | 2/4 [00:28<00:29, 14.83s/it]2025-08-27 01:10:32,246 | Epoch 21/60 - client 1 -  Training Loss: 29.330

 75%|#######5  | 3/4 [00:59<00:22, 22.05s/it]2025-08-27 01:10:44,748 | Epoch 21/60 - client 0 -  Training Loss: 27.804

100%|##########| 4/4 [01:12<00:00, 18.28s/it]
100%|##########| 4/4 [01:12<00:00, 18.01s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:10:48,872 | Epoch21 Valid:
2025-08-27 01:10:48,872 | domain:Food
2025-08-27 01:10:48,873 | model_moe:
2025-08-27 01:10:48,873 | MRR: 0.3204
2025-08-27 01:10:48,873 | HR @1|5|10: 0.2158 	 0.4644 	 0.5241 	
2025-08-27 01:10:48,874 | NDCG @5|10: 0.3453 	 0.3651
2025-08-27 01:10:48,874 | domain:Kitchen
2025-08-27 01:10:48,874 | model_moe:
2025-08-27 01:10:48,874 | MRR: 0.1127
2025-08-27 01:10:48,875 | HR @1|5|10: 0.0566 	 0.1639 	 0.2141 	
2025-08-27 01:10:48,875 | NDCG @5|10: 0.1126 	 0.1289
2025-08-27 01:10:48,875 | domain:Clothing
2025-08-27 01:10:48,875 | model_moe:
2025-08-27 01:10:48,876 | MRR: 0.0261
2025-08-27 01:10:48,876 | HR @1|5|10: 0.0122 	 0.0330 	 0.0477 	
2025-08-27 01:10:48,876 | NDCG @5|10: 0.0225 	 0.0273
2025-08-27 01:10:48,877 | domain:Beauty
2025-08-27 01:10:48,877 | model_moe:
2025-08-27 01:10:48,877 | MRR: 0.2114
2025-08-27 01:10:48,877 | HR @1|5|10: 0.1364 	 0.2931 	 0.3744 	
2025-08-27 01:10:48,878 | NDCG @5|10: 0.2175 	 0.2440
2025-08-27 01:10:48,878 | 	avg_model_moe:
2025-08-27 01:10:48,878 | MRR: 0.1676
2025-08-27 01:10:48,878 | HR @1|5|10: 0.1052 	 0.2386 	 0.2901 	
2025-08-27 01:10:48,879 | NDCG @5|10: 0.1745 	 0.1913
2025-08-27 01:10:48,879 | Early Stopping counter: 1 out of 10
2025-08-27 01:10:48,879 | Learning rate decay counter: 1 out of 1
2025-08-27 01:10:48,880 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:11:01,383 | Epoch 22/60 - client 0 -  Training Loss: 27.737

 25%|##5       | 1/4 [00:12<00:37, 12.51s/it]2025-08-27 01:11:18,086 | Epoch 22/60 - client 2 -  Training Loss: 29.662

 50%|#####     | 2/4 [00:29<00:29, 14.97s/it]2025-08-27 01:11:30,298 | Epoch 22/60 - client 3 -  Training Loss: 29.434

 75%|#######5  | 3/4 [00:41<00:13, 13.71s/it]2025-08-27 01:12:00,918 | Epoch 22/60 - client 1 -  Training Loss: 29.266

100%|##########| 4/4 [01:12<00:00, 20.39s/it]
100%|##########| 4/4 [01:12<00:00, 18.01s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:12:05,072 | Epoch22 Valid:
2025-08-27 01:12:05,072 | domain:Food
2025-08-27 01:12:05,073 | model_moe:
2025-08-27 01:12:05,073 | MRR: 0.3213
2025-08-27 01:12:05,073 | HR @1|5|10: 0.2165 	 0.4660 	 0.5279 	
2025-08-27 01:12:05,074 | NDCG @5|10: 0.3464 	 0.3668
2025-08-27 01:12:05,074 | domain:Kitchen
2025-08-27 01:12:05,074 | model_moe:
2025-08-27 01:12:05,074 | MRR: 0.1148
2025-08-27 01:12:05,075 | HR @1|5|10: 0.0585 	 0.1648 	 0.2178 	
2025-08-27 01:12:05,075 | NDCG @5|10: 0.1140 	 0.1313
2025-08-27 01:12:05,075 | domain:Clothing
2025-08-27 01:12:05,076 | model_moe:
2025-08-27 01:12:05,076 | MRR: 0.0258
2025-08-27 01:12:05,076 | HR @1|5|10: 0.0122 	 0.0293 	 0.0477 	
2025-08-27 01:12:05,076 | NDCG @5|10: 0.0210 	 0.0270
2025-08-27 01:12:05,077 | domain:Beauty
2025-08-27 01:12:05,077 | model_moe:
2025-08-27 01:12:05,077 | MRR: 0.2128
2025-08-27 01:12:05,078 | HR @1|5|10: 0.1364 	 0.3038 	 0.3732 	
2025-08-27 01:12:05,078 | NDCG @5|10: 0.2222 	 0.2448
2025-08-27 01:12:05,078 | 	avg_model_moe:
2025-08-27 01:12:05,078 | MRR: 0.1687
2025-08-27 01:12:05,079 | HR @1|5|10: 0.1059 	 0.2410 	 0.2916 	
2025-08-27 01:12:05,079 | NDCG @5|10: 0.1759 	 0.1925
2025-08-27 01:12:05,079 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:12:17,256 | Epoch 23/60 - client 3 -  Training Loss: 29.350

 25%|##5       | 1/4 [00:12<00:36, 12.18s/it]2025-08-27 01:12:29,774 | Epoch 23/60 - client 0 -  Training Loss: 27.680

 50%|#####     | 2/4 [00:24<00:24, 12.38s/it]2025-08-27 01:13:00,409 | Epoch 23/60 - client 1 -  Training Loss: 29.198

 75%|#######5  | 3/4 [00:55<00:20, 20.71s/it]2025-08-27 01:13:17,159 | Epoch 23/60 - client 2 -  Training Loss: 29.558

100%|##########| 4/4 [01:12<00:00, 19.15s/it]
100%|##########| 4/4 [01:12<00:00, 18.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:13:21,304 | Epoch23 Valid:
2025-08-27 01:13:21,304 | domain:Food
2025-08-27 01:13:21,305 | model_moe:
2025-08-27 01:13:21,305 | MRR: 0.3243
2025-08-27 01:13:21,305 | HR @1|5|10: 0.2204 	 0.4629 	 0.5272 	
2025-08-27 01:13:21,305 | NDCG @5|10: 0.3475 	 0.3688
2025-08-27 01:13:21,306 | domain:Kitchen
2025-08-27 01:13:21,306 | model_moe:
2025-08-27 01:13:21,306 | MRR: 0.1168
2025-08-27 01:13:21,306 | HR @1|5|10: 0.0603 	 0.1680 	 0.2196 	
2025-08-27 01:13:21,307 | NDCG @5|10: 0.1165 	 0.1333
2025-08-27 01:13:21,307 | domain:Clothing
2025-08-27 01:13:21,307 | model_moe:
2025-08-27 01:13:21,308 | MRR: 0.0276
2025-08-27 01:13:21,308 | HR @1|5|10: 0.0147 	 0.0318 	 0.0501 	
2025-08-27 01:13:21,308 | NDCG @5|10: 0.0232 	 0.0289
2025-08-27 01:13:21,308 | domain:Beauty
2025-08-27 01:13:21,309 | model_moe:
2025-08-27 01:13:21,309 | MRR: 0.2131
2025-08-27 01:13:21,309 | HR @1|5|10: 0.1376 	 0.2990 	 0.3732 	
2025-08-27 01:13:21,309 | NDCG @5|10: 0.2208 	 0.2450
2025-08-27 01:13:21,310 | 	avg_model_moe:
2025-08-27 01:13:21,310 | MRR: 0.1705
2025-08-27 01:13:21,310 | HR @1|5|10: 0.1082 	 0.2404 	 0.2925 	
2025-08-27 01:13:21,310 | NDCG @5|10: 0.1770 	 0.1940
2025-08-27 01:13:21,311 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:13:35,399 | Epoch 24/60 - client 3 -  Training Loss: 29.276

 25%|##5       | 1/4 [00:12<00:36, 12.20s/it]2025-08-27 01:13:52,022 | Epoch 24/60 - client 2 -  Training Loss: 29.458

 50%|#####     | 2/4 [00:28<00:29, 14.80s/it]2025-08-27 01:14:22,652 | Epoch 24/60 - client 1 -  Training Loss: 29.147

 75%|#######5  | 3/4 [00:59<00:22, 22.03s/it]2025-08-27 01:14:35,164 | Epoch 24/60 - client 0 -  Training Loss: 27.628

100%|##########| 4/4 [01:11<00:00, 18.27s/it]
100%|##########| 4/4 [01:11<00:00, 17.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 01:14:39,321 | Epoch24 Valid:
2025-08-27 01:14:39,321 | domain:Food
2025-08-27 01:14:39,322 | model_moe:
2025-08-27 01:14:39,322 | MRR: 0.3212
2025-08-27 01:14:39,322 | HR @1|5|10: 0.2165 	 0.4621 	 0.5302 	
2025-08-27 01:14:39,323 | NDCG @5|10: 0.3445 	 0.3671
2025-08-27 01:14:39,323 | domain:Kitchen
2025-08-27 01:14:39,323 | model_moe:
2025-08-27 01:14:39,324 | MRR: 0.1171
2025-08-27 01:14:39,324 | HR @1|5|10: 0.0603 	 0.1708 	 0.2192 	
2025-08-27 01:14:39,324 | NDCG @5|10: 0.1175 	 0.1332
2025-08-27 01:14:39,325 | domain:Clothing
2025-08-27 01:14:39,325 | model_moe:
2025-08-27 01:14:39,325 | MRR: 0.0257
2025-08-27 01:14:39,325 | HR @1|5|10: 0.0110 	 0.0342 	 0.0465 	
2025-08-27 01:14:39,326 | NDCG @5|10: 0.0227 	 0.0267
2025-08-27 01:14:39,326 | domain:Beauty
2025-08-27 01:14:39,326 | model_moe:
2025-08-27 01:14:39,327 | MRR: 0.2120
2025-08-27 01:14:39,327 | HR @1|5|10: 0.1352 	 0.3062 	 0.3756 	
2025-08-27 01:14:39,327 | NDCG @5|10: 0.2224 	 0.2450
2025-08-27 01:14:39,327 | 	avg_model_moe:
2025-08-27 01:14:39,328 | MRR: 0.1690
2025-08-27 01:14:39,328 | HR @1|5|10: 0.1058 	 0.2433 	 0.2929 	
2025-08-27 01:14:39,328 | NDCG @5|10: 0.1768 	 0.1930
2025-08-27 01:14:39,329 | Early Stopping counter: 1 out of 10
2025-08-27 01:14:39,329 | Learning rate decay counter: 1 out of 1
2025-08-27 01:14:39,329 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:15:10,081 | Epoch 25/60 - client 1 -  Training Loss: 29.081

 25%|##5       | 1/4 [00:30<01:32, 30.75s/it]2025-08-27 01:15:26,709 | Epoch 25/60 - client 2 -  Training Loss: 29.352

 50%|#####     | 2/4 [00:47<00:44, 22.44s/it]2025-08-27 01:15:38,898 | Epoch 25/60 - client 3 -  Training Loss: 29.197

 75%|#######5  | 3/4 [00:59<00:17, 17.76s/it]2025-08-27 01:15:51,423 | Epoch 25/60 - client 0 -  Training Loss: 27.569

100%|##########| 4/4 [01:12<00:00, 15.69s/it]
100%|##########| 4/4 [01:12<00:00, 18.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:15:55,578 | Epoch25 Valid:
2025-08-27 01:15:55,578 | domain:Food
2025-08-27 01:15:55,578 | model_moe:
2025-08-27 01:15:55,579 | MRR: 0.3235
2025-08-27 01:15:55,579 | HR @1|5|10: 0.2188 	 0.4713 	 0.5272 	
2025-08-27 01:15:55,579 | NDCG @5|10: 0.3498 	 0.3681
2025-08-27 01:15:55,579 | domain:Kitchen
2025-08-27 01:15:55,580 | model_moe:
2025-08-27 01:15:55,580 | MRR: 0.1163
2025-08-27 01:15:55,580 | HR @1|5|10: 0.0608 	 0.1690 	 0.2173 	
2025-08-27 01:15:55,581 | NDCG @5|10: 0.1166 	 0.1322
2025-08-27 01:15:55,581 | domain:Clothing
2025-08-27 01:15:55,581 | model_moe:
2025-08-27 01:15:55,581 | MRR: 0.0255
2025-08-27 01:15:55,582 | HR @1|5|10: 0.0086 	 0.0342 	 0.0489 	
2025-08-27 01:15:55,582 | NDCG @5|10: 0.0226 	 0.0273
2025-08-27 01:15:55,582 | domain:Beauty
2025-08-27 01:15:55,583 | model_moe:
2025-08-27 01:15:55,583 | MRR: 0.2173
2025-08-27 01:15:55,583 | HR @1|5|10: 0.1435 	 0.3074 	 0.3816 	
2025-08-27 01:15:55,583 | NDCG @5|10: 0.2264 	 0.2506
2025-08-27 01:15:55,584 | 	avg_model_moe:
2025-08-27 01:15:55,584 | MRR: 0.1706
2025-08-27 01:15:55,584 | HR @1|5|10: 0.1079 	 0.2455 	 0.2937 	
2025-08-27 01:15:55,584 | NDCG @5|10: 0.1788 	 0.1945
2025-08-27 01:15:55,585 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:16:28,130 | Epoch 26/60 - client 1 -  Training Loss: 29.023

 25%|##5       | 1/4 [00:30<01:32, 30.68s/it]2025-08-27 01:16:40,442 | Epoch 26/60 - client 3 -  Training Loss: 29.125

 50%|#####     | 2/4 [00:42<00:39, 19.87s/it]2025-08-27 01:16:52,974 | Epoch 26/60 - client 0 -  Training Loss: 27.518

 75%|#######5  | 3/4 [00:55<00:16, 16.52s/it]2025-08-27 01:17:09,660 | Epoch 26/60 - client 2 -  Training Loss: 29.259

100%|##########| 4/4 [01:12<00:00, 16.59s/it]
100%|##########| 4/4 [01:12<00:00, 18.05s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:17:13,816 | Epoch26 Valid:
2025-08-27 01:17:13,816 | domain:Food
2025-08-27 01:17:13,816 | model_moe:
2025-08-27 01:17:13,817 | MRR: 0.3267
2025-08-27 01:17:13,817 | HR @1|5|10: 0.2249 	 0.4675 	 0.5287 	
2025-08-27 01:17:13,817 | NDCG @5|10: 0.3507 	 0.3709
2025-08-27 01:17:13,818 | domain:Kitchen
2025-08-27 01:17:13,818 | model_moe:
2025-08-27 01:17:13,818 | MRR: 0.1179
2025-08-27 01:17:13,818 | HR @1|5|10: 0.0603 	 0.1708 	 0.2178 	
2025-08-27 01:17:13,819 | NDCG @5|10: 0.1183 	 0.1335
2025-08-27 01:17:13,819 | domain:Clothing
2025-08-27 01:17:13,819 | model_moe:
2025-08-27 01:17:13,820 | MRR: 0.0263
2025-08-27 01:17:13,820 | HR @1|5|10: 0.0110 	 0.0355 	 0.0489 	
2025-08-27 01:17:13,820 | NDCG @5|10: 0.0234 	 0.0278
2025-08-27 01:17:13,821 | domain:Beauty
2025-08-27 01:17:13,821 | model_moe:
2025-08-27 01:17:13,821 | MRR: 0.2175
2025-08-27 01:17:13,821 | HR @1|5|10: 0.1423 	 0.3098 	 0.3828 	
2025-08-27 01:17:13,822 | NDCG @5|10: 0.2277 	 0.2510
2025-08-27 01:17:13,822 | 	avg_model_moe:
2025-08-27 01:17:13,822 | MRR: 0.1721
2025-08-27 01:17:13,823 | HR @1|5|10: 0.1097 	 0.2459 	 0.2945 	
2025-08-27 01:17:13,823 | NDCG @5|10: 0.1800 	 0.1958
2025-08-27 01:17:13,823 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:17:32,243 | Epoch 27/60 - client 2 -  Training Loss: 29.158

 25%|##5       | 1/4 [00:16<00:49, 16.62s/it]2025-08-27 01:18:02,851 | Epoch 27/60 - client 1 -  Training Loss: 28.963

 50%|#####     | 2/4 [00:47<00:49, 24.85s/it]2025-08-27 01:18:15,395 | Epoch 27/60 - client 0 -  Training Loss: 27.473

 75%|#######5  | 3/4 [00:59<00:19, 19.23s/it]2025-08-27 01:18:27,664 | Epoch 27/60 - client 3 -  Training Loss: 29.054

100%|##########| 4/4 [01:12<00:00, 16.48s/it]
100%|##########| 4/4 [01:12<00:00, 18.01s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:18:31,813 | Epoch27 Valid:
2025-08-27 01:18:31,813 | domain:Food
2025-08-27 01:18:31,813 | model_moe:
2025-08-27 01:18:31,814 | MRR: 0.3258
2025-08-27 01:18:31,814 | HR @1|5|10: 0.2219 	 0.4652 	 0.5310 	
2025-08-27 01:18:31,814 | NDCG @5|10: 0.3490 	 0.3708
2025-08-27 01:18:31,814 | domain:Kitchen
2025-08-27 01:18:31,815 | model_moe:
2025-08-27 01:18:31,815 | MRR: 0.1183
2025-08-27 01:18:31,815 | HR @1|5|10: 0.0612 	 0.1708 	 0.2205 	
2025-08-27 01:18:31,816 | NDCG @5|10: 0.1185 	 0.1345
2025-08-27 01:18:31,816 | domain:Clothing
2025-08-27 01:18:31,816 | model_moe:
2025-08-27 01:18:31,816 | MRR: 0.0276
2025-08-27 01:18:31,817 | HR @1|5|10: 0.0122 	 0.0367 	 0.0477 	
2025-08-27 01:18:31,817 | NDCG @5|10: 0.0250 	 0.0286
2025-08-27 01:18:31,817 | domain:Beauty
2025-08-27 01:18:31,818 | model_moe:
2025-08-27 01:18:31,818 | MRR: 0.2170
2025-08-27 01:18:31,818 | HR @1|5|10: 0.1423 	 0.3086 	 0.3840 	
2025-08-27 01:18:31,818 | NDCG @5|10: 0.2266 	 0.2510
2025-08-27 01:18:31,819 | 	avg_model_moe:
2025-08-27 01:18:31,819 | MRR: 0.1722
2025-08-27 01:18:31,819 | HR @1|5|10: 0.1094 	 0.2453 	 0.2958 	
2025-08-27 01:18:31,820 | NDCG @5|10: 0.1798 	 0.1962
2025-08-27 01:18:31,820 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:18:46,399 | Epoch 28/60 - client 0 -  Training Loss: 27.419

 25%|##5       | 1/4 [00:12<00:37, 12.51s/it]2025-08-27 01:19:03,005 | Epoch 28/60 - client 2 -  Training Loss: 29.070

 50%|#####     | 2/4 [00:29<00:29, 14.92s/it]2025-08-27 01:19:33,582 | Epoch 28/60 - client 1 -  Training Loss: 28.902

 75%|#######5  | 3/4 [00:59<00:22, 22.07s/it]2025-08-27 01:19:45,735 | Epoch 28/60 - client 3 -  Training Loss: 28.981

100%|##########| 4/4 [01:11<00:00, 18.15s/it]
100%|##########| 4/4 [01:11<00:00, 17.96s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:19:49,871 | Epoch28 Valid:
2025-08-27 01:19:49,871 | domain:Food
2025-08-27 01:19:49,871 | model_moe:
2025-08-27 01:19:49,872 | MRR: 0.3268
2025-08-27 01:19:49,872 | HR @1|5|10: 0.2242 	 0.4682 	 0.5264 	
2025-08-27 01:19:49,872 | NDCG @5|10: 0.3510 	 0.3703
2025-08-27 01:19:49,873 | domain:Kitchen
2025-08-27 01:19:49,873 | model_moe:
2025-08-27 01:19:49,873 | MRR: 0.1145
2025-08-27 01:19:49,873 | HR @1|5|10: 0.0562 	 0.1703 	 0.2215 	
2025-08-27 01:19:49,874 | NDCG @5|10: 0.1156 	 0.1320
2025-08-27 01:19:49,874 | domain:Clothing
2025-08-27 01:19:49,874 | model_moe:
2025-08-27 01:19:49,875 | MRR: 0.0271
2025-08-27 01:19:49,875 | HR @1|5|10: 0.0122 	 0.0318 	 0.0440 	
2025-08-27 01:19:49,875 | NDCG @5|10: 0.0227 	 0.0267
2025-08-27 01:19:49,875 | domain:Beauty
2025-08-27 01:19:49,876 | model_moe:
2025-08-27 01:19:49,876 | MRR: 0.2187
2025-08-27 01:19:49,876 | HR @1|5|10: 0.1423 	 0.3134 	 0.3852 	
2025-08-27 01:19:49,877 | NDCG @5|10: 0.2294 	 0.2528
2025-08-27 01:19:49,877 | 	avg_model_moe:
2025-08-27 01:19:49,877 | MRR: 0.1718
2025-08-27 01:19:49,877 | HR @1|5|10: 0.1087 	 0.2459 	 0.2943 	
2025-08-27 01:19:49,878 | NDCG @5|10: 0.1797 	 0.1955
2025-08-27 01:19:49,878 | Early Stopping counter: 1 out of 10
2025-08-27 01:19:49,878 | Learning rate decay counter: 1 out of 1
2025-08-27 01:19:49,879 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:20:06,577 | Epoch 29/60 - client 2 -  Training Loss: 28.980

 25%|##5       | 1/4 [00:16<00:50, 16.70s/it]2025-08-27 01:20:18,724 | Epoch 29/60 - client 3 -  Training Loss: 28.906

 50%|#####     | 2/4 [00:28<00:28, 14.02s/it]2025-08-27 01:20:31,209 | Epoch 29/60 - client 0 -  Training Loss: 27.364

 75%|#######5  | 3/4 [00:41<00:13, 13.32s/it]2025-08-27 01:21:01,809 | Epoch 29/60 - client 1 -  Training Loss: 28.840

100%|##########| 4/4 [01:11<00:00, 20.14s/it]
100%|##########| 4/4 [01:11<00:00, 17.98s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:21:05,956 | Epoch29 Valid:
2025-08-27 01:21:05,956 | domain:Food
2025-08-27 01:21:05,957 | model_moe:
2025-08-27 01:21:05,957 | MRR: 0.3289
2025-08-27 01:21:05,957 | HR @1|5|10: 0.2265 	 0.4660 	 0.5340 	
2025-08-27 01:21:05,958 | NDCG @5|10: 0.3514 	 0.3740
2025-08-27 01:21:05,958 | domain:Kitchen
2025-08-27 01:21:05,958 | model_moe:
2025-08-27 01:21:05,959 | MRR: 0.1195
2025-08-27 01:21:05,959 | HR @1|5|10: 0.0626 	 0.1750 	 0.2201 	
2025-08-27 01:21:05,959 | NDCG @5|10: 0.1207 	 0.1353
2025-08-27 01:21:05,959 | domain:Clothing
2025-08-27 01:21:05,960 | model_moe:
2025-08-27 01:21:05,960 | MRR: 0.0282
2025-08-27 01:21:05,960 | HR @1|5|10: 0.0134 	 0.0355 	 0.0513 	
2025-08-27 01:21:05,961 | NDCG @5|10: 0.0247 	 0.0298
2025-08-27 01:21:05,961 | domain:Beauty
2025-08-27 01:21:05,961 | model_moe:
2025-08-27 01:21:05,962 | MRR: 0.2189
2025-08-27 01:21:05,962 | HR @1|5|10: 0.1411 	 0.3134 	 0.3888 	
2025-08-27 01:21:05,962 | NDCG @5|10: 0.2294 	 0.2538
2025-08-27 01:21:05,962 | 	avg_model_moe:
2025-08-27 01:21:05,963 | MRR: 0.1738
2025-08-27 01:21:05,963 | HR @1|5|10: 0.1109 	 0.2474 	 0.2986 	
2025-08-27 01:21:05,963 | NDCG @5|10: 0.1816 	 0.1982
2025-08-27 01:21:05,964 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:21:20,029 | Epoch 30/60 - client 3 -  Training Loss: 28.850

 25%|##5       | 1/4 [00:12<00:36, 12.18s/it]2025-08-27 01:21:32,561 | Epoch 30/60 - client 0 -  Training Loss: 27.325

 50%|#####     | 2/4 [00:24<00:24, 12.39s/it]2025-08-27 01:22:03,310 | Epoch 30/60 - client 1 -  Training Loss: 28.796

 75%|#######5  | 3/4 [00:55<00:20, 20.77s/it]2025-08-27 01:22:19,904 | Epoch 30/60 - client 2 -  Training Loss: 28.887

100%|##########| 4/4 [01:12<00:00, 19.12s/it]
100%|##########| 4/4 [01:12<00:00, 18.01s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:22:24,045 | Epoch30 Valid:
2025-08-27 01:22:24,045 | domain:Food
2025-08-27 01:22:24,045 | model_moe:
2025-08-27 01:22:24,046 | MRR: 0.3287
2025-08-27 01:22:24,046 | HR @1|5|10: 0.2257 	 0.4660 	 0.5333 	
2025-08-27 01:22:24,046 | NDCG @5|10: 0.3513 	 0.3736
2025-08-27 01:22:24,046 | domain:Kitchen
2025-08-27 01:22:24,047 | model_moe:
2025-08-27 01:22:24,047 | MRR: 0.1182
2025-08-27 01:22:24,047 | HR @1|5|10: 0.0622 	 0.1713 	 0.2219 	
2025-08-27 01:22:24,048 | NDCG @5|10: 0.1184 	 0.1347
2025-08-27 01:22:24,048 | domain:Clothing
2025-08-27 01:22:24,048 | model_moe:
2025-08-27 01:22:24,048 | MRR: 0.0275
2025-08-27 01:22:24,049 | HR @1|5|10: 0.0122 	 0.0379 	 0.0501 	
2025-08-27 01:22:24,049 | NDCG @5|10: 0.0250 	 0.0290
2025-08-27 01:22:24,049 | domain:Beauty
2025-08-27 01:22:24,049 | model_moe:
2025-08-27 01:22:24,050 | MRR: 0.2175
2025-08-27 01:22:24,050 | HR @1|5|10: 0.1400 	 0.3110 	 0.3840 	
2025-08-27 01:22:24,050 | NDCG @5|10: 0.2276 	 0.2514
2025-08-27 01:22:24,050 | 	avg_model_moe:
2025-08-27 01:22:24,051 | MRR: 0.1730
2025-08-27 01:22:24,051 | HR @1|5|10: 0.1100 	 0.2465 	 0.2973 	
2025-08-27 01:22:24,051 | NDCG @5|10: 0.1806 	 0.1972
2025-08-27 01:22:24,052 | Early Stopping counter: 1 out of 10
2025-08-27 01:22:24,052 | Learning rate decay counter: 1 out of 1
2025-08-27 01:22:24,052 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:22:54,659 | Epoch 31/60 - client 1 -  Training Loss: 28.739

 25%|##5       | 1/4 [00:30<01:31, 30.61s/it]2025-08-27 01:23:06,828 | Epoch 31/60 - client 3 -  Training Loss: 28.783

 50%|#####     | 2/4 [00:42<00:39, 19.76s/it]2025-08-27 01:23:19,327 | Epoch 31/60 - client 0 -  Training Loss: 27.275

 75%|#######5  | 3/4 [00:55<00:16, 16.45s/it]2025-08-27 01:23:36,044 | Epoch 31/60 - client 2 -  Training Loss: 28.796

100%|##########| 4/4 [01:11<00:00, 16.55s/it]
100%|##########| 4/4 [01:11<00:00, 18.00s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:23:40,179 | Epoch31 Valid:
2025-08-27 01:23:40,179 | domain:Food
2025-08-27 01:23:40,180 | model_moe:
2025-08-27 01:23:40,180 | MRR: 0.3318
2025-08-27 01:23:40,180 | HR @1|5|10: 0.2303 	 0.4705 	 0.5340 	
2025-08-27 01:23:40,181 | NDCG @5|10: 0.3551 	 0.3761
2025-08-27 01:23:40,181 | domain:Kitchen
2025-08-27 01:23:40,181 | model_moe:
2025-08-27 01:23:40,181 | MRR: 0.1190
2025-08-27 01:23:40,182 | HR @1|5|10: 0.0626 	 0.1708 	 0.2205 	
2025-08-27 01:23:40,182 | NDCG @5|10: 0.1188 	 0.1350
2025-08-27 01:23:40,182 | domain:Clothing
2025-08-27 01:23:40,182 | model_moe:
2025-08-27 01:23:40,183 | MRR: 0.0284
2025-08-27 01:23:40,183 | HR @1|5|10: 0.0134 	 0.0355 	 0.0501 	
2025-08-27 01:23:40,183 | NDCG @5|10: 0.0249 	 0.0295
2025-08-27 01:23:40,184 | domain:Beauty
2025-08-27 01:23:40,184 | model_moe:
2025-08-27 01:23:40,184 | MRR: 0.2201
2025-08-27 01:23:40,184 | HR @1|5|10: 0.1435 	 0.3182 	 0.3864 	
2025-08-27 01:23:40,185 | NDCG @5|10: 0.2317 	 0.2541
2025-08-27 01:23:40,185 | 	avg_model_moe:
2025-08-27 01:23:40,185 | MRR: 0.1748
2025-08-27 01:23:40,186 | HR @1|5|10: 0.1125 	 0.2487 	 0.2978 	
2025-08-27 01:23:40,186 | NDCG @5|10: 0.1826 	 0.1987
2025-08-27 01:23:40,186 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:24:12,633 | Epoch 32/60 - client 1 -  Training Loss: 28.686

 25%|##5       | 1/4 [00:30<01:31, 30.57s/it]2025-08-27 01:24:24,785 | Epoch 32/60 - client 3 -  Training Loss: 28.714

 50%|#####     | 2/4 [00:42<00:39, 19.74s/it]2025-08-27 01:24:37,274 | Epoch 32/60 - client 0 -  Training Loss: 27.229

 75%|#######5  | 3/4 [00:55<00:16, 16.43s/it]2025-08-27 01:24:53,864 | Epoch 32/60 - client 2 -  Training Loss: 28.712

100%|##########| 4/4 [01:11<00:00, 16.49s/it]
100%|##########| 4/4 [01:11<00:00, 17.95s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 01:24:58,028 | Epoch32 Valid:
2025-08-27 01:24:58,029 | domain:Food
2025-08-27 01:24:58,029 | model_moe:
2025-08-27 01:24:58,030 | MRR: 0.3307
2025-08-27 01:24:58,030 | HR @1|5|10: 0.2272 	 0.4705 	 0.5348 	
2025-08-27 01:24:58,030 | NDCG @5|10: 0.3543 	 0.3756
2025-08-27 01:24:58,030 | domain:Kitchen
2025-08-27 01:24:58,031 | model_moe:
2025-08-27 01:24:58,031 | MRR: 0.1179
2025-08-27 01:24:58,031 | HR @1|5|10: 0.0631 	 0.1708 	 0.2219 	
2025-08-27 01:24:58,032 | NDCG @5|10: 0.1184 	 0.1347
2025-08-27 01:24:58,032 | domain:Clothing
2025-08-27 01:24:58,032 | model_moe:
2025-08-27 01:24:58,032 | MRR: 0.0284
2025-08-27 01:24:58,033 | HR @1|5|10: 0.0134 	 0.0318 	 0.0513 	
2025-08-27 01:24:58,033 | NDCG @5|10: 0.0235 	 0.0297
2025-08-27 01:24:58,033 | domain:Beauty
2025-08-27 01:24:58,034 | model_moe:
2025-08-27 01:24:58,034 | MRR: 0.2203
2025-08-27 01:24:58,034 | HR @1|5|10: 0.1435 	 0.3194 	 0.3864 	
2025-08-27 01:24:58,034 | NDCG @5|10: 0.2324 	 0.2543
2025-08-27 01:24:58,035 | 	avg_model_moe:
2025-08-27 01:24:58,035 | MRR: 0.1743
2025-08-27 01:24:58,035 | HR @1|5|10: 0.1118 	 0.2481 	 0.2986 	
2025-08-27 01:24:58,036 | NDCG @5|10: 0.1821 	 0.1986
2025-08-27 01:24:58,036 | Early Stopping counter: 1 out of 10
2025-08-27 01:24:58,036 | Learning rate decay counter: 1 out of 1
2025-08-27 01:24:58,036 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:25:14,771 | Epoch 33/60 - client 2 -  Training Loss: 28.626

 25%|##5       | 1/4 [00:16<00:50, 16.74s/it]2025-08-27 01:25:26,958 | Epoch 33/60 - client 3 -  Training Loss: 28.646

 50%|#####     | 2/4 [00:28<00:28, 14.06s/it]2025-08-27 01:25:57,598 | Epoch 33/60 - client 1 -  Training Loss: 28.628

 75%|#######5  | 3/4 [00:59<00:21, 21.63s/it]2025-08-27 01:26:10,122 | Epoch 33/60 - client 0 -  Training Loss: 27.175

100%|##########| 4/4 [01:12<00:00, 18.04s/it]
100%|##########| 4/4 [01:12<00:00, 18.02s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:26:14,274 | Epoch33 Valid:
2025-08-27 01:26:14,274 | domain:Food
2025-08-27 01:26:14,275 | model_moe:
2025-08-27 01:26:14,275 | MRR: 0.3330
2025-08-27 01:26:14,275 | HR @1|5|10: 0.2303 	 0.4667 	 0.5348 	
2025-08-27 01:26:14,276 | NDCG @5|10: 0.3547 	 0.3772
2025-08-27 01:26:14,276 | domain:Kitchen
2025-08-27 01:26:14,276 | model_moe:
2025-08-27 01:26:14,276 | MRR: 0.1215
2025-08-27 01:26:14,277 | HR @1|5|10: 0.0635 	 0.1745 	 0.2233 	
2025-08-27 01:26:14,277 | NDCG @5|10: 0.1216 	 0.1375
2025-08-27 01:26:14,277 | domain:Clothing
2025-08-27 01:26:14,278 | model_moe:
2025-08-27 01:26:14,278 | MRR: 0.0293
2025-08-27 01:26:14,278 | HR @1|5|10: 0.0147 	 0.0318 	 0.0513 	
2025-08-27 01:26:14,278 | NDCG @5|10: 0.0241 	 0.0304
2025-08-27 01:26:14,279 | domain:Beauty
2025-08-27 01:26:14,279 | model_moe:
2025-08-27 01:26:14,279 | MRR: 0.2202
2025-08-27 01:26:14,279 | HR @1|5|10: 0.1423 	 0.3194 	 0.3828 	
2025-08-27 01:26:14,280 | NDCG @5|10: 0.2324 	 0.2532
2025-08-27 01:26:14,280 | 	avg_model_moe:
2025-08-27 01:26:14,280 | MRR: 0.1760
2025-08-27 01:26:14,281 | HR @1|5|10: 0.1127 	 0.2481 	 0.2981 	
2025-08-27 01:26:14,281 | NDCG @5|10: 0.1832 	 0.1996
2025-08-27 01:26:14,281 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:26:46,708 | Epoch 34/60 - client 1 -  Training Loss: 28.584

 25%|##5       | 1/4 [00:30<01:31, 30.60s/it]2025-08-27 01:26:58,977 | Epoch 34/60 - client 3 -  Training Loss: 28.602

 50%|#####     | 2/4 [00:42<00:39, 19.82s/it]2025-08-27 01:27:11,476 | Epoch 34/60 - client 0 -  Training Loss: 27.143

 75%|#######5  | 3/4 [00:55<00:16, 16.47s/it]2025-08-27 01:27:28,079 | Epoch 34/60 - client 2 -  Training Loss: 28.534

100%|##########| 4/4 [01:11<00:00, 16.53s/it]
100%|##########| 4/4 [01:11<00:00, 17.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:27:32,234 | Epoch34 Valid:
2025-08-27 01:27:32,234 | domain:Food
2025-08-27 01:27:32,235 | model_moe:
2025-08-27 01:27:32,235 | MRR: 0.3311
2025-08-27 01:27:32,235 | HR @1|5|10: 0.2288 	 0.4660 	 0.5340 	
2025-08-27 01:27:32,236 | NDCG @5|10: 0.3528 	 0.3755
2025-08-27 01:27:32,236 | domain:Kitchen
2025-08-27 01:27:32,236 | model_moe:
2025-08-27 01:27:32,237 | MRR: 0.1198
2025-08-27 01:27:32,237 | HR @1|5|10: 0.0631 	 0.1731 	 0.2270 	
2025-08-27 01:27:32,237 | NDCG @5|10: 0.1200 	 0.1373
2025-08-27 01:27:32,237 | domain:Clothing
2025-08-27 01:27:32,238 | model_moe:
2025-08-27 01:27:32,238 | MRR: 0.0284
2025-08-27 01:27:32,238 | HR @1|5|10: 0.0134 	 0.0342 	 0.0526 	
2025-08-27 01:27:32,239 | NDCG @5|10: 0.0243 	 0.0301
2025-08-27 01:27:32,239 | domain:Beauty
2025-08-27 01:27:32,239 | model_moe:
2025-08-27 01:27:32,239 | MRR: 0.2203
2025-08-27 01:27:32,240 | HR @1|5|10: 0.1447 	 0.3218 	 0.3888 	
2025-08-27 01:27:32,240 | NDCG @5|10: 0.2332 	 0.2549
2025-08-27 01:27:32,240 | 	avg_model_moe:
2025-08-27 01:27:32,241 | MRR: 0.1749
2025-08-27 01:27:32,241 | HR @1|5|10: 0.1125 	 0.2488 	 0.3006 	
2025-08-27 01:27:32,241 | NDCG @5|10: 0.1826 	 0.1994
2025-08-27 01:27:32,241 | Early Stopping counter: 1 out of 10
2025-08-27 01:27:32,242 | Learning rate decay counter: 1 out of 1
2025-08-27 01:27:32,242 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:28:02,825 | Epoch 35/60 - client 1 -  Training Loss: 28.525

 25%|##5       | 1/4 [00:30<01:31, 30.58s/it]2025-08-27 01:28:15,309 | Epoch 35/60 - client 0 -  Training Loss: 27.092

 50%|#####     | 2/4 [00:43<00:39, 19.94s/it]2025-08-27 01:28:31,997 | Epoch 35/60 - client 2 -  Training Loss: 28.450

 75%|#######5  | 3/4 [00:59<00:18, 18.45s/it]2025-08-27 01:28:44,182 | Epoch 35/60 - client 3 -  Training Loss: 28.533

100%|##########| 4/4 [01:11<00:00, 15.98s/it]
100%|##########| 4/4 [01:11<00:00, 17.99s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:28:48,323 | Epoch35 Valid:
2025-08-27 01:28:48,324 | domain:Food
2025-08-27 01:28:48,324 | model_moe:
2025-08-27 01:28:48,324 | MRR: 0.3333
2025-08-27 01:28:48,325 | HR @1|5|10: 0.2303 	 0.4713 	 0.5394 	
2025-08-27 01:28:48,325 | NDCG @5|10: 0.3563 	 0.3787
2025-08-27 01:28:48,325 | domain:Kitchen
2025-08-27 01:28:48,325 | model_moe:
2025-08-27 01:28:48,326 | MRR: 0.1220
2025-08-27 01:28:48,326 | HR @1|5|10: 0.0649 	 0.1736 	 0.2279 	
2025-08-27 01:28:48,326 | NDCG @5|10: 0.1216 	 0.1392
2025-08-27 01:28:48,327 | domain:Clothing
2025-08-27 01:28:48,327 | model_moe:
2025-08-27 01:28:48,327 | MRR: 0.0283
2025-08-27 01:28:48,327 | HR @1|5|10: 0.0134 	 0.0342 	 0.0501 	
2025-08-27 01:28:48,328 | NDCG @5|10: 0.0244 	 0.0294
2025-08-27 01:28:48,328 | domain:Beauty
2025-08-27 01:28:48,328 | model_moe:
2025-08-27 01:28:48,329 | MRR: 0.2235
2025-08-27 01:28:48,329 | HR @1|5|10: 0.1471 	 0.3230 	 0.3923 	
2025-08-27 01:28:48,329 | NDCG @5|10: 0.2357 	 0.2584
2025-08-27 01:28:48,329 | 	avg_model_moe:
2025-08-27 01:28:48,330 | MRR: 0.1768
2025-08-27 01:28:48,330 | HR @1|5|10: 0.1139 	 0.2505 	 0.3024 	
2025-08-27 01:28:48,330 | NDCG @5|10: 0.1845 	 0.2014
2025-08-27 01:28:48,331 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:29:02,719 | Epoch 36/60 - client 0 -  Training Loss: 27.047

 25%|##5       | 1/4 [00:12<00:37, 12.49s/it]2025-08-27 01:29:33,308 | Epoch 36/60 - client 1 -  Training Loss: 28.474

 50%|#####     | 2/4 [00:43<00:46, 23.14s/it]2025-08-27 01:29:49,903 | Epoch 36/60 - client 2 -  Training Loss: 28.367

 75%|#######5  | 3/4 [00:59<00:20, 20.15s/it]2025-08-27 01:30:02,061 | Epoch 36/60 - client 3 -  Training Loss: 28.467

100%|##########| 4/4 [01:11<00:00, 16.99s/it]
100%|##########| 4/4 [01:11<00:00, 17.96s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.02it/s]
100%|##########| 4/4 [00:04<00:00,  1.06s/it]
2025-08-27 01:30:06,299 | Epoch36 Valid:
2025-08-27 01:30:06,300 | domain:Food
2025-08-27 01:30:06,300 | model_moe:
2025-08-27 01:30:06,300 | MRR: 0.3307
2025-08-27 01:30:06,301 | HR @1|5|10: 0.2265 	 0.4705 	 0.5371 	
2025-08-27 01:30:06,301 | NDCG @5|10: 0.3540 	 0.3760
2025-08-27 01:30:06,301 | domain:Kitchen
2025-08-27 01:30:06,302 | model_moe:
2025-08-27 01:30:06,302 | MRR: 0.1209
2025-08-27 01:30:06,302 | HR @1|5|10: 0.0631 	 0.1745 	 0.2311 	
2025-08-27 01:30:06,302 | NDCG @5|10: 0.1209 	 0.1391
2025-08-27 01:30:06,303 | domain:Clothing
2025-08-27 01:30:06,303 | model_moe:
2025-08-27 01:30:06,303 | MRR: 0.0282
2025-08-27 01:30:06,304 | HR @1|5|10: 0.0134 	 0.0281 	 0.0477 	
2025-08-27 01:30:06,304 | NDCG @5|10: 0.0220 	 0.0284
2025-08-27 01:30:06,304 | domain:Beauty
2025-08-27 01:30:06,304 | model_moe:
2025-08-27 01:30:06,305 | MRR: 0.2224
2025-08-27 01:30:06,305 | HR @1|5|10: 0.1423 	 0.3254 	 0.3947 	
2025-08-27 01:30:06,305 | NDCG @5|10: 0.2359 	 0.2584
2025-08-27 01:30:06,306 | 	avg_model_moe:
2025-08-27 01:30:06,306 | MRR: 0.1755
2025-08-27 01:30:06,306 | HR @1|5|10: 0.1113 	 0.2496 	 0.3027 	
2025-08-27 01:30:06,307 | NDCG @5|10: 0.1832 	 0.2005
2025-08-27 01:30:06,307 | Early Stopping counter: 1 out of 10
2025-08-27 01:30:06,307 | Learning rate decay counter: 1 out of 1
2025-08-27 01:30:06,308 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:30:36,915 | Epoch 37/60 - client 1 -  Training Loss: 28.427

 25%|##5       | 1/4 [00:30<01:31, 30.61s/it]2025-08-27 01:30:53,507 | Epoch 37/60 - client 2 -  Training Loss: 28.288

 50%|#####     | 2/4 [00:47<00:44, 22.36s/it]2025-08-27 01:31:05,995 | Epoch 37/60 - client 0 -  Training Loss: 27.009

 75%|#######5  | 3/4 [00:59<00:17, 17.85s/it]2025-08-27 01:31:18,153 | Epoch 37/60 - client 3 -  Training Loss: 28.413

100%|##########| 4/4 [01:11<00:00, 15.61s/it]
100%|##########| 4/4 [01:11<00:00, 17.96s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:31:22,299 | Epoch37 Valid:
2025-08-27 01:31:22,300 | domain:Food
2025-08-27 01:31:22,300 | model_moe:
2025-08-27 01:31:22,300 | MRR: 0.3356
2025-08-27 01:31:22,301 | HR @1|5|10: 0.2349 	 0.4682 	 0.5402 	
2025-08-27 01:31:22,301 | NDCG @5|10: 0.3567 	 0.3804
2025-08-27 01:31:22,301 | domain:Kitchen
2025-08-27 01:31:22,302 | model_moe:
2025-08-27 01:31:22,302 | MRR: 0.1211
2025-08-27 01:31:22,302 | HR @1|5|10: 0.0663 	 0.1713 	 0.2274 	
2025-08-27 01:31:22,302 | NDCG @5|10: 0.1202 	 0.1383
2025-08-27 01:31:22,303 | domain:Clothing
2025-08-27 01:31:22,303 | model_moe:
2025-08-27 01:31:22,303 | MRR: 0.0284
2025-08-27 01:31:22,304 | HR @1|5|10: 0.0147 	 0.0318 	 0.0501 	
2025-08-27 01:31:22,304 | NDCG @5|10: 0.0233 	 0.0293
2025-08-27 01:31:22,304 | domain:Beauty
2025-08-27 01:31:22,304 | model_moe:
2025-08-27 01:31:22,305 | MRR: 0.2236
2025-08-27 01:31:22,305 | HR @1|5|10: 0.1459 	 0.3289 	 0.3923 	
2025-08-27 01:31:22,305 | NDCG @5|10: 0.2378 	 0.2585
2025-08-27 01:31:22,306 | 	avg_model_moe:
2025-08-27 01:31:22,306 | MRR: 0.1772
2025-08-27 01:31:22,306 | HR @1|5|10: 0.1154 	 0.2501 	 0.3025 	
2025-08-27 01:31:22,306 | NDCG @5|10: 0.1845 	 0.2016
2025-08-27 01:31:22,307 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:31:36,863 | Epoch 38/60 - client 0 -  Training Loss: 26.971

 25%|##5       | 1/4 [00:12<00:37, 12.50s/it]2025-08-27 01:31:49,107 | Epoch 38/60 - client 3 -  Training Loss: 28.356

 50%|#####     | 2/4 [00:24<00:24, 12.35s/it]2025-08-27 01:32:05,738 | Epoch 38/60 - client 2 -  Training Loss: 28.211

 75%|#######5  | 3/4 [00:41<00:14, 14.30s/it]2025-08-27 01:32:36,359 | Epoch 38/60 - client 1 -  Training Loss: 28.376

100%|##########| 4/4 [01:11<00:00, 20.75s/it]
100%|##########| 4/4 [01:11<00:00, 18.00s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.01s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:32:40,511 | Epoch38 Valid:
2025-08-27 01:32:40,512 | domain:Food
2025-08-27 01:32:40,512 | model_moe:
2025-08-27 01:32:40,512 | MRR: 0.3344
2025-08-27 01:32:40,512 | HR @1|5|10: 0.2326 	 0.4698 	 0.5402 	
2025-08-27 01:32:40,513 | NDCG @5|10: 0.3563 	 0.3796
2025-08-27 01:32:40,513 | domain:Kitchen
2025-08-27 01:32:40,513 | model_moe:
2025-08-27 01:32:40,514 | MRR: 0.1219
2025-08-27 01:32:40,514 | HR @1|5|10: 0.0677 	 0.1727 	 0.2274 	
2025-08-27 01:32:40,514 | NDCG @5|10: 0.1213 	 0.1389
2025-08-27 01:32:40,514 | domain:Clothing
2025-08-27 01:32:40,515 | model_moe:
2025-08-27 01:32:40,515 | MRR: 0.0295
2025-08-27 01:32:40,515 | HR @1|5|10: 0.0159 	 0.0306 	 0.0538 	
2025-08-27 01:32:40,516 | NDCG @5|10: 0.0235 	 0.0310
2025-08-27 01:32:40,516 | domain:Beauty
2025-08-27 01:32:40,516 | model_moe:
2025-08-27 01:32:40,516 | MRR: 0.2266
2025-08-27 01:32:40,517 | HR @1|5|10: 0.1483 	 0.3278 	 0.3935 	
2025-08-27 01:32:40,517 | NDCG @5|10: 0.2396 	 0.2611
2025-08-27 01:32:40,517 | 	avg_model_moe:
2025-08-27 01:32:40,517 | MRR: 0.1781
2025-08-27 01:32:40,518 | HR @1|5|10: 0.1161 	 0.2502 	 0.3037 	
2025-08-27 01:32:40,518 | NDCG @5|10: 0.1852 	 0.2026
2025-08-27 01:32:40,518 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:33:13,257 | Epoch 39/60 - client 1 -  Training Loss: 28.326

 25%|##5       | 1/4 [00:30<01:31, 30.60s/it]2025-08-27 01:33:25,457 | Epoch 39/60 - client 3 -  Training Loss: 28.301

 50%|#####     | 2/4 [00:42<00:39, 19.78s/it]2025-08-27 01:33:38,060 | Epoch 39/60 - client 0 -  Training Loss: 26.928

 75%|#######5  | 3/4 [00:55<00:16, 16.50s/it]2025-08-27 01:33:54,673 | Epoch 39/60 - client 2 -  Training Loss: 28.126

100%|##########| 4/4 [01:12<00:00, 16.55s/it]
100%|##########| 4/4 [01:12<00:00, 18.01s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.39s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:33:58,816 | Epoch39 Valid:
2025-08-27 01:33:58,817 | domain:Food
2025-08-27 01:33:58,817 | model_moe:
2025-08-27 01:33:58,817 | MRR: 0.3350
2025-08-27 01:33:58,818 | HR @1|5|10: 0.2318 	 0.4682 	 0.5402 	
2025-08-27 01:33:58,818 | NDCG @5|10: 0.3565 	 0.3801
2025-08-27 01:33:58,818 | domain:Kitchen
2025-08-27 01:33:58,818 | model_moe:
2025-08-27 01:33:58,819 | MRR: 0.1212
2025-08-27 01:33:58,819 | HR @1|5|10: 0.0645 	 0.1736 	 0.2279 	
2025-08-27 01:33:58,819 | NDCG @5|10: 0.1210 	 0.1385
2025-08-27 01:33:58,820 | domain:Clothing
2025-08-27 01:33:58,820 | model_moe:
2025-08-27 01:33:58,820 | MRR: 0.0298
2025-08-27 01:33:58,820 | HR @1|5|10: 0.0159 	 0.0318 	 0.0526 	
2025-08-27 01:33:58,821 | NDCG @5|10: 0.0240 	 0.0309
2025-08-27 01:33:58,821 | domain:Beauty
2025-08-27 01:33:58,821 | model_moe:
2025-08-27 01:33:58,821 | MRR: 0.2245
2025-08-27 01:33:58,822 | HR @1|5|10: 0.1471 	 0.3194 	 0.3900 	
2025-08-27 01:33:58,822 | NDCG @5|10: 0.2351 	 0.2586
2025-08-27 01:33:58,822 | 	avg_model_moe:
2025-08-27 01:33:58,823 | MRR: 0.1776
2025-08-27 01:33:58,823 | HR @1|5|10: 0.1148 	 0.2482 	 0.3026 	
2025-08-27 01:33:58,823 | NDCG @5|10: 0.1841 	 0.2020
2025-08-27 01:33:58,823 | Early Stopping counter: 1 out of 10
2025-08-27 01:33:58,824 | Learning rate decay counter: 1 out of 1
2025-08-27 01:33:58,824 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:34:11,332 | Epoch 40/60 - client 0 -  Training Loss: 26.888

 25%|##5       | 1/4 [00:12<00:37, 12.51s/it]2025-08-27 01:34:27,947 | Epoch 40/60 - client 2 -  Training Loss: 28.057

 50%|#####     | 2/4 [00:29<00:29, 14.92s/it]2025-08-27 01:34:40,118 | Epoch 40/60 - client 3 -  Training Loss: 28.244

 75%|#######5  | 3/4 [00:41<00:13, 13.67s/it]2025-08-27 01:35:10,821 | Epoch 40/60 - client 1 -  Training Loss: 28.277

100%|##########| 4/4 [01:11<00:00, 20.39s/it]
100%|##########| 4/4 [01:11<00:00, 18.00s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.03s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.41s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.11s/it]
100%|##########| 4/4 [00:04<00:00,  1.05it/s]
100%|##########| 4/4 [00:04<00:00,  1.04s/it]
2025-08-27 01:35:15,008 | Epoch40 Valid:
2025-08-27 01:35:15,009 | domain:Food
2025-08-27 01:35:15,009 | model_moe:
2025-08-27 01:35:15,009 | MRR: 0.3390
2025-08-27 01:35:15,009 | HR @1|5|10: 0.2379 	 0.4698 	 0.5417 	
2025-08-27 01:35:15,010 | NDCG @5|10: 0.3598 	 0.3835
2025-08-27 01:35:15,010 | domain:Kitchen
2025-08-27 01:35:15,010 | model_moe:
2025-08-27 01:35:15,011 | MRR: 0.1209
2025-08-27 01:35:15,011 | HR @1|5|10: 0.0658 	 0.1745 	 0.2274 	
2025-08-27 01:35:15,011 | NDCG @5|10: 0.1212 	 0.1382
2025-08-27 01:35:15,011 | domain:Clothing
2025-08-27 01:35:15,012 | model_moe:
2025-08-27 01:35:15,012 | MRR: 0.0291
2025-08-27 01:35:15,012 | HR @1|5|10: 0.0147 	 0.0330 	 0.0538 	
2025-08-27 01:35:15,013 | NDCG @5|10: 0.0240 	 0.0307
2025-08-27 01:35:15,013 | domain:Beauty
2025-08-27 01:35:15,013 | model_moe:
2025-08-27 01:35:15,014 | MRR: 0.2262
2025-08-27 01:35:15,014 | HR @1|5|10: 0.1471 	 0.3278 	 0.3971 	
2025-08-27 01:35:15,014 | NDCG @5|10: 0.2394 	 0.2619
2025-08-27 01:35:15,014 | 	avg_model_moe:
2025-08-27 01:35:15,015 | MRR: 0.1788
2025-08-27 01:35:15,015 | HR @1|5|10: 0.1164 	 0.2513 	 0.3050 	
2025-08-27 01:35:15,015 | NDCG @5|10: 0.1861 	 0.2036
2025-08-27 01:35:15,015 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:35:47,425 | Epoch 41/60 - client 1 -  Training Loss: 28.228

 25%|##5       | 1/4 [00:30<01:31, 30.58s/it]2025-08-27 01:36:04,012 | Epoch 41/60 - client 2 -  Training Loss: 27.981

 50%|#####     | 2/4 [00:47<00:44, 22.35s/it]2025-08-27 01:36:16,460 | Epoch 41/60 - client 0 -  Training Loss: 26.843

 75%|#######5  | 3/4 [00:59<00:17, 17.83s/it]2025-08-27 01:36:28,472 | Epoch 41/60 - client 3 -  Training Loss: 28.183

100%|##########| 4/4 [01:11<00:00, 15.53s/it]
100%|##########| 4/4 [01:11<00:00, 17.91s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-27 01:36:32,583 | Epoch41 Valid:
2025-08-27 01:36:32,583 | domain:Food
2025-08-27 01:36:32,583 | model_moe:
2025-08-27 01:36:32,584 | MRR: 0.3365
2025-08-27 01:36:32,584 | HR @1|5|10: 0.2357 	 0.4728 	 0.5409 	
2025-08-27 01:36:32,584 | NDCG @5|10: 0.3590 	 0.3814
2025-08-27 01:36:32,585 | domain:Kitchen
2025-08-27 01:36:32,585 | model_moe:
2025-08-27 01:36:32,585 | MRR: 0.1214
2025-08-27 01:36:32,586 | HR @1|5|10: 0.0645 	 0.1754 	 0.2261 	
2025-08-27 01:36:32,586 | NDCG @5|10: 0.1218 	 0.1382
2025-08-27 01:36:32,586 | domain:Clothing
2025-08-27 01:36:32,586 | model_moe:
2025-08-27 01:36:32,587 | MRR: 0.0288
2025-08-27 01:36:32,587 | HR @1|5|10: 0.0147 	 0.0318 	 0.0513 	
2025-08-27 01:36:32,587 | NDCG @5|10: 0.0234 	 0.0298
2025-08-27 01:36:32,588 | domain:Beauty
2025-08-27 01:36:32,588 | model_moe:
2025-08-27 01:36:32,588 | MRR: 0.2268
2025-08-27 01:36:32,589 | HR @1|5|10: 0.1483 	 0.3301 	 0.3959 	
2025-08-27 01:36:32,589 | NDCG @5|10: 0.2407 	 0.2621
2025-08-27 01:36:32,589 | 	avg_model_moe:
2025-08-27 01:36:32,589 | MRR: 0.1784
2025-08-27 01:36:32,590 | HR @1|5|10: 0.1158 	 0.2525 	 0.3036 	
2025-08-27 01:36:32,590 | NDCG @5|10: 0.1862 	 0.2029
2025-08-27 01:36:32,590 | Early Stopping counter: 1 out of 10
2025-08-27 01:36:32,591 | Learning rate decay counter: 1 out of 1
2025-08-27 01:36:32,591 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:37:03,032 | Epoch 42/60 - client 1 -  Training Loss: 28.179

 25%|##5       | 1/4 [00:30<01:31, 30.44s/it]2025-08-27 01:37:19,497 | Epoch 42/60 - client 2 -  Training Loss: 27.905

 50%|#####     | 2/4 [00:46<00:44, 22.22s/it]2025-08-27 01:37:31,506 | Epoch 42/60 - client 3 -  Training Loss: 28.126

 75%|#######5  | 3/4 [00:58<00:17, 17.56s/it]2025-08-27 01:37:43,840 | Epoch 42/60 - client 0 -  Training Loss: 26.806

100%|##########| 4/4 [01:11<00:00, 15.49s/it]
100%|##########| 4/4 [01:11<00:00, 17.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-27 01:37:47,954 | Epoch42 Valid:
2025-08-27 01:37:47,954 | domain:Food
2025-08-27 01:37:47,955 | model_moe:
2025-08-27 01:37:47,955 | MRR: 0.3403
2025-08-27 01:37:47,955 | HR @1|5|10: 0.2410 	 0.4736 	 0.5440 	
2025-08-27 01:37:47,956 | NDCG @5|10: 0.3621 	 0.3852
2025-08-27 01:37:47,956 | domain:Kitchen
2025-08-27 01:37:47,956 | model_moe:
2025-08-27 01:37:47,956 | MRR: 0.1223
2025-08-27 01:37:47,957 | HR @1|5|10: 0.0668 	 0.1763 	 0.2284 	
2025-08-27 01:37:47,957 | NDCG @5|10: 0.1227 	 0.1396
2025-08-27 01:37:47,957 | domain:Clothing
2025-08-27 01:37:47,958 | model_moe:
2025-08-27 01:37:47,958 | MRR: 0.0288
2025-08-27 01:37:47,958 | HR @1|5|10: 0.0147 	 0.0293 	 0.0550 	
2025-08-27 01:37:47,958 | NDCG @5|10: 0.0225 	 0.0308
2025-08-27 01:37:47,959 | domain:Beauty
2025-08-27 01:37:47,959 | model_moe:
2025-08-27 01:37:47,959 | MRR: 0.2278
2025-08-27 01:37:47,960 | HR @1|5|10: 0.1519 	 0.3289 	 0.3983 	
2025-08-27 01:37:47,960 | NDCG @5|10: 0.2410 	 0.2634
2025-08-27 01:37:47,960 | 	avg_model_moe:
2025-08-27 01:37:47,960 | MRR: 0.1798
2025-08-27 01:37:47,961 | HR @1|5|10: 0.1186 	 0.2521 	 0.3064 	
2025-08-27 01:37:47,961 | NDCG @5|10: 0.1871 	 0.2047
2025-08-27 01:37:47,961 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:38:20,297 | Epoch 43/60 - client 1 -  Training Loss: 28.131

 25%|##5       | 1/4 [00:30<01:31, 30.36s/it]2025-08-27 01:38:36,856 | Epoch 43/60 - client 2 -  Training Loss: 27.829

 50%|#####     | 2/4 [00:46<00:44, 22.24s/it]2025-08-27 01:38:48,858 | Epoch 43/60 - client 3 -  Training Loss: 28.075

 75%|#######5  | 3/4 [00:58<00:17, 17.57s/it]2025-08-27 01:39:01,174 | Epoch 43/60 - client 0 -  Training Loss: 26.771

100%|##########| 4/4 [01:11<00:00, 15.49s/it]
100%|##########| 4/4 [01:11<00:00, 17.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:01<00:03,  1.00s/it]
 50%|#####     | 2/4 [00:02<00:02,  1.38s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.09s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:39:05,294 | Epoch43 Valid:
2025-08-27 01:39:05,294 | domain:Food
2025-08-27 01:39:05,295 | model_moe:
2025-08-27 01:39:05,295 | MRR: 0.3408
2025-08-27 01:39:05,297 | HR @1|5|10: 0.2395 	 0.4751 	 0.5455 	
2025-08-27 01:39:05,297 | NDCG @5|10: 0.3629 	 0.3860
2025-08-27 01:39:05,297 | domain:Kitchen
2025-08-27 01:39:05,298 | model_moe:
2025-08-27 01:39:05,298 | MRR: 0.1233
2025-08-27 01:39:05,298 | HR @1|5|10: 0.0668 	 0.1782 	 0.2293 	
2025-08-27 01:39:05,299 | NDCG @5|10: 0.1241 	 0.1407
2025-08-27 01:39:05,299 | domain:Clothing
2025-08-27 01:39:05,299 | model_moe:
2025-08-27 01:39:05,299 | MRR: 0.0298
2025-08-27 01:39:05,300 | HR @1|5|10: 0.0159 	 0.0293 	 0.0526 	
2025-08-27 01:39:05,300 | NDCG @5|10: 0.0231 	 0.0307
2025-08-27 01:39:05,300 | domain:Beauty
2025-08-27 01:39:05,301 | model_moe:
2025-08-27 01:39:05,301 | MRR: 0.2292
2025-08-27 01:39:05,301 | HR @1|5|10: 0.1519 	 0.3289 	 0.3971 	
2025-08-27 01:39:05,302 | NDCG @5|10: 0.2421 	 0.2641
2025-08-27 01:39:05,302 | 	avg_model_moe:
2025-08-27 01:39:05,302 | MRR: 0.1808
2025-08-27 01:39:05,303 | HR @1|5|10: 0.1185 	 0.2529 	 0.3061 	
2025-08-27 01:39:05,303 | NDCG @5|10: 0.1881 	 0.2054
2025-08-27 01:39:05,303 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:39:37,630 | Epoch 44/60 - client 1 -  Training Loss: 28.086

 25%|##5       | 1/4 [00:30<01:30, 30.28s/it]2025-08-27 01:39:49,616 | Epoch 44/60 - client 3 -  Training Loss: 28.021

 50%|#####     | 2/4 [00:42<00:39, 19.52s/it]2025-08-27 01:40:01,991 | Epoch 44/60 - client 0 -  Training Loss: 26.729

 75%|#######5  | 3/4 [00:54<00:16, 16.26s/it]2025-08-27 01:40:18,450 | Epoch 44/60 - client 2 -  Training Loss: 27.756

100%|##########| 4/4 [01:11<00:00, 16.34s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-27 01:40:22,551 | Epoch44 Valid:
2025-08-27 01:40:22,551 | domain:Food
2025-08-27 01:40:22,551 | model_moe:
2025-08-27 01:40:22,552 | MRR: 0.3418
2025-08-27 01:40:22,552 | HR @1|5|10: 0.2425 	 0.4690 	 0.5425 	
2025-08-27 01:40:22,552 | NDCG @5|10: 0.3616 	 0.3857
2025-08-27 01:40:22,553 | domain:Kitchen
2025-08-27 01:40:22,553 | model_moe:
2025-08-27 01:40:22,553 | MRR: 0.1219
2025-08-27 01:40:22,554 | HR @1|5|10: 0.0668 	 0.1713 	 0.2297 	
2025-08-27 01:40:22,554 | NDCG @5|10: 0.1206 	 0.1397
2025-08-27 01:40:22,554 | domain:Clothing
2025-08-27 01:40:22,555 | model_moe:
2025-08-27 01:40:22,555 | MRR: 0.0278
2025-08-27 01:40:22,555 | HR @1|5|10: 0.0134 	 0.0293 	 0.0501 	
2025-08-27 01:40:22,555 | NDCG @5|10: 0.0221 	 0.0287
2025-08-27 01:40:22,556 | domain:Beauty
2025-08-27 01:40:22,556 | model_moe:
2025-08-27 01:40:22,556 | MRR: 0.2293
2025-08-27 01:40:22,557 | HR @1|5|10: 0.1531 	 0.3301 	 0.3971 	
2025-08-27 01:40:22,557 | NDCG @5|10: 0.2425 	 0.2642
2025-08-27 01:40:22,557 | 	avg_model_moe:
2025-08-27 01:40:22,557 | MRR: 0.1802
2025-08-27 01:40:22,558 | HR @1|5|10: 0.1190 	 0.2499 	 0.3049 	
2025-08-27 01:40:22,558 | NDCG @5|10: 0.1867 	 0.2046
2025-08-27 01:40:22,558 | Early Stopping counter: 1 out of 10
2025-08-27 01:40:22,559 | Learning rate decay counter: 1 out of 1
2025-08-27 01:40:22,559 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:40:34,845 | Epoch 45/60 - client 0 -  Training Loss: 26.683

 25%|##5       | 1/4 [00:12<00:36, 12.29s/it]2025-08-27 01:41:05,104 | Epoch 45/60 - client 1 -  Training Loss: 28.041

 50%|#####     | 2/4 [00:42<00:45, 22.86s/it]2025-08-27 01:41:21,531 | Epoch 45/60 - client 2 -  Training Loss: 27.686

 75%|#######5  | 3/4 [00:58<00:19, 19.92s/it]2025-08-27 01:41:33,494 | Epoch 45/60 - client 3 -  Training Loss: 27.959

100%|##########| 4/4 [01:10<00:00, 16.78s/it]
100%|##########| 4/4 [01:10<00:00, 17.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.40s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.10s/it]
100%|##########| 4/4 [00:04<00:00,  1.06it/s]
100%|##########| 4/4 [00:04<00:00,  1.03s/it]
2025-08-27 01:41:37,632 | Epoch45 Valid:
2025-08-27 01:41:37,632 | domain:Food
2025-08-27 01:41:37,634 | model_moe:
2025-08-27 01:41:37,634 | MRR: 0.3388
2025-08-27 01:41:37,635 | HR @1|5|10: 0.2372 	 0.4728 	 0.5448 	
2025-08-27 01:41:37,635 | NDCG @5|10: 0.3604 	 0.3841
2025-08-27 01:41:37,635 | domain:Kitchen
2025-08-27 01:41:37,636 | model_moe:
2025-08-27 01:41:37,636 | MRR: 0.1225
2025-08-27 01:41:37,636 | HR @1|5|10: 0.0663 	 0.1782 	 0.2274 	
2025-08-27 01:41:37,636 | NDCG @5|10: 0.1234 	 0.1394
2025-08-27 01:41:37,637 | domain:Clothing
2025-08-27 01:41:37,637 | model_moe:
2025-08-27 01:41:37,637 | MRR: 0.0283
2025-08-27 01:41:37,638 | HR @1|5|10: 0.0147 	 0.0281 	 0.0452 	
2025-08-27 01:41:37,638 | NDCG @5|10: 0.0218 	 0.0275
2025-08-27 01:41:37,638 | domain:Beauty
2025-08-27 01:41:37,638 | model_moe:
2025-08-27 01:41:37,639 | MRR: 0.2312
2025-08-27 01:41:37,639 | HR @1|5|10: 0.1543 	 0.3301 	 0.3983 	
2025-08-27 01:41:37,639 | NDCG @5|10: 0.2439 	 0.2659
2025-08-27 01:41:37,640 | 	avg_model_moe:
2025-08-27 01:41:37,640 | MRR: 0.1802
2025-08-27 01:41:37,640 | HR @1|5|10: 0.1181 	 0.2523 	 0.3039 	
2025-08-27 01:41:37,640 | NDCG @5|10: 0.1874 	 0.2042
2025-08-27 01:41:37,641 | Early Stopping counter: 2 out of 10
2025-08-27 01:41:37,641 | Learning rate decay counter: 1 out of 1
2025-08-27 01:41:37,641 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:42:07,937 | Epoch 46/60 - client 1 -  Training Loss: 27.991

 25%|##5       | 1/4 [00:30<01:30, 30.30s/it]2025-08-27 01:42:20,224 | Epoch 46/60 - client 0 -  Training Loss: 26.644

 50%|#####     | 2/4 [00:42<00:39, 19.70s/it]2025-08-27 01:42:32,187 | Epoch 46/60 - client 3 -  Training Loss: 27.904

 75%|#######5  | 3/4 [00:54<00:16, 16.17s/it]2025-08-27 01:42:48,610 | Epoch 46/60 - client 2 -  Training Loss: 27.613

100%|##########| 4/4 [01:10<00:00, 16.27s/it]
100%|##########| 4/4 [01:10<00:00, 17.74s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.07it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-27 01:42:52,700 | Epoch46 Valid:
2025-08-27 01:42:52,701 | domain:Food
2025-08-27 01:42:52,701 | model_moe:
2025-08-27 01:42:52,701 | MRR: 0.3370
2025-08-27 01:42:52,702 | HR @1|5|10: 0.2349 	 0.4774 	 0.5448 	
2025-08-27 01:42:52,702 | NDCG @5|10: 0.3610 	 0.3828
2025-08-27 01:42:52,702 | domain:Kitchen
2025-08-27 01:42:52,703 | model_moe:
2025-08-27 01:42:52,703 | MRR: 0.1238
2025-08-27 01:42:52,703 | HR @1|5|10: 0.0681 	 0.1782 	 0.2311 	
2025-08-27 01:42:52,703 | NDCG @5|10: 0.1243 	 0.1414
2025-08-27 01:42:52,704 | domain:Clothing
2025-08-27 01:42:52,704 | model_moe:
2025-08-27 01:42:52,704 | MRR: 0.0288
2025-08-27 01:42:52,705 | HR @1|5|10: 0.0147 	 0.0318 	 0.0501 	
2025-08-27 01:42:52,705 | NDCG @5|10: 0.0234 	 0.0294
2025-08-27 01:42:52,705 | domain:Beauty
2025-08-27 01:42:52,706 | model_moe:
2025-08-27 01:42:52,706 | MRR: 0.2298
2025-08-27 01:42:52,706 | HR @1|5|10: 0.1519 	 0.3301 	 0.4043 	
2025-08-27 01:42:52,707 | NDCG @5|10: 0.2426 	 0.2665
2025-08-27 01:42:52,707 | 	avg_model_moe:
2025-08-27 01:42:52,707 | MRR: 0.1799
2025-08-27 01:42:52,707 | HR @1|5|10: 0.1174 	 0.2544 	 0.3076 	
2025-08-27 01:42:52,708 | NDCG @5|10: 0.1878 	 0.2050
2025-08-27 01:42:52,708 | Early Stopping counter: 3 out of 10
2025-08-27 01:42:52,708 | Learning rate decay counter: 1 out of 1
2025-08-27 01:42:52,709 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:43:04,987 | Epoch 47/60 - client 0 -  Training Loss: 26.603

 25%|##5       | 1/4 [00:12<00:36, 12.28s/it]2025-08-27 01:43:16,970 | Epoch 47/60 - client 3 -  Training Loss: 27.847

 50%|#####     | 2/4 [00:24<00:24, 12.11s/it]2025-08-27 01:43:47,211 | Epoch 47/60 - client 1 -  Training Loss: 27.942

 75%|#######5  | 3/4 [00:54<00:20, 20.39s/it]2025-08-27 01:44:03,624 | Epoch 47/60 - client 2 -  Training Loss: 27.535

100%|##########| 4/4 [01:10<00:00, 18.82s/it]
100%|##########| 4/4 [01:10<00:00, 17.73s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:44:07,685 | Epoch47 Valid:
2025-08-27 01:44:07,685 | domain:Food
2025-08-27 01:44:07,686 | model_moe:
2025-08-27 01:44:07,686 | MRR: 0.3410
2025-08-27 01:44:07,687 | HR @1|5|10: 0.2418 	 0.4713 	 0.5455 	
2025-08-27 01:44:07,687 | NDCG @5|10: 0.3617 	 0.3859
2025-08-27 01:44:07,688 | domain:Kitchen
2025-08-27 01:44:07,688 | model_moe:
2025-08-27 01:44:07,689 | MRR: 0.1243
2025-08-27 01:44:07,690 | HR @1|5|10: 0.0677 	 0.1773 	 0.2316 	
2025-08-27 01:44:07,691 | NDCG @5|10: 0.1243 	 0.1419
2025-08-27 01:44:07,691 | domain:Clothing
2025-08-27 01:44:07,691 | model_moe:
2025-08-27 01:44:07,691 | MRR: 0.0280
2025-08-27 01:44:07,692 | HR @1|5|10: 0.0134 	 0.0293 	 0.0501 	
2025-08-27 01:44:07,692 | NDCG @5|10: 0.0219 	 0.0287
2025-08-27 01:44:07,692 | domain:Beauty
2025-08-27 01:44:07,693 | model_moe:
2025-08-27 01:44:07,693 | MRR: 0.2339
2025-08-27 01:44:07,693 | HR @1|5|10: 0.1579 	 0.3421 	 0.4031 	
2025-08-27 01:44:07,693 | NDCG @5|10: 0.2500 	 0.2694
2025-08-27 01:44:07,694 | 	avg_model_moe:
2025-08-27 01:44:07,694 | MRR: 0.1818
2025-08-27 01:44:07,694 | HR @1|5|10: 0.1202 	 0.2550 	 0.3076 	
2025-08-27 01:44:07,695 | NDCG @5|10: 0.1895 	 0.2065
2025-08-27 01:44:07,695 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:44:40,179 | Epoch 48/60 - client 1 -  Training Loss: 27.899

 25%|##5       | 1/4 [00:30<01:30, 30.25s/it]2025-08-27 01:44:52,456 | Epoch 48/60 - client 0 -  Training Loss: 26.566

 50%|#####     | 2/4 [00:42<00:39, 19.68s/it]2025-08-27 01:45:04,408 | Epoch 48/60 - client 3 -  Training Loss: 27.800

 75%|#######5  | 3/4 [00:54<00:16, 16.15s/it]2025-08-27 01:45:20,799 | Epoch 48/60 - client 2 -  Training Loss: 27.472

100%|##########| 4/4 [01:10<00:00, 16.25s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:45:24,864 | Epoch48 Valid:
2025-08-27 01:45:24,864 | domain:Food
2025-08-27 01:45:24,865 | model_moe:
2025-08-27 01:45:24,865 | MRR: 0.3384
2025-08-27 01:45:24,865 | HR @1|5|10: 0.2372 	 0.4759 	 0.5432 	
2025-08-27 01:45:24,866 | NDCG @5|10: 0.3614 	 0.3834
2025-08-27 01:45:24,866 | domain:Kitchen
2025-08-27 01:45:24,866 | model_moe:
2025-08-27 01:45:24,867 | MRR: 0.1238
2025-08-27 01:45:24,867 | HR @1|5|10: 0.0681 	 0.1750 	 0.2293 	
2025-08-27 01:45:24,867 | NDCG @5|10: 0.1232 	 0.1408
2025-08-27 01:45:24,867 | domain:Clothing
2025-08-27 01:45:24,868 | model_moe:
2025-08-27 01:45:24,868 | MRR: 0.0284
2025-08-27 01:45:24,868 | HR @1|5|10: 0.0147 	 0.0342 	 0.0501 	
2025-08-27 01:45:24,869 | NDCG @5|10: 0.0241 	 0.0293
2025-08-27 01:45:24,869 | domain:Beauty
2025-08-27 01:45:24,869 | model_moe:
2025-08-27 01:45:24,870 | MRR: 0.2318
2025-08-27 01:45:24,870 | HR @1|5|10: 0.1543 	 0.3337 	 0.4019 	
2025-08-27 01:45:24,870 | NDCG @5|10: 0.2455 	 0.2674
2025-08-27 01:45:24,871 | 	avg_model_moe:
2025-08-27 01:45:24,871 | MRR: 0.1806
2025-08-27 01:45:24,871 | HR @1|5|10: 0.1186 	 0.2547 	 0.3061 	
2025-08-27 01:45:24,872 | NDCG @5|10: 0.1885 	 0.2052
2025-08-27 01:45:24,872 | Early Stopping counter: 1 out of 10
2025-08-27 01:45:24,872 | Learning rate decay counter: 1 out of 1
2025-08-27 01:45:24,873 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:45:41,267 | Epoch 49/60 - client 2 -  Training Loss: 27.404

 25%|##5       | 1/4 [00:16<00:49, 16.39s/it]2025-08-27 01:46:11,488 | Epoch 49/60 - client 1 -  Training Loss: 27.858

 50%|#####     | 2/4 [00:46<00:49, 24.53s/it]2025-08-27 01:46:23,431 | Epoch 49/60 - client 3 -  Training Loss: 27.740

 75%|#######5  | 3/4 [00:58<00:18, 18.78s/it]2025-08-27 01:46:35,697 | Epoch 49/60 - client 0 -  Training Loss: 26.528

100%|##########| 4/4 [01:10<00:00, 16.21s/it]
100%|##########| 4/4 [01:10<00:00, 17.71s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:46:39,756 | Epoch49 Valid:
2025-08-27 01:46:39,757 | domain:Food
2025-08-27 01:46:39,757 | model_moe:
2025-08-27 01:46:39,758 | MRR: 0.3417
2025-08-27 01:46:39,758 | HR @1|5|10: 0.2395 	 0.4767 	 0.5417 	
2025-08-27 01:46:39,758 | NDCG @5|10: 0.3642 	 0.3856
2025-08-27 01:46:39,759 | domain:Kitchen
2025-08-27 01:46:39,759 | model_moe:
2025-08-27 01:46:39,760 | MRR: 0.1210
2025-08-27 01:46:39,760 | HR @1|5|10: 0.0649 	 0.1727 	 0.2297 	
2025-08-27 01:46:39,760 | NDCG @5|10: 0.1206 	 0.1391
2025-08-27 01:46:39,761 | domain:Clothing
2025-08-27 01:46:39,761 | model_moe:
2025-08-27 01:46:39,761 | MRR: 0.0278
2025-08-27 01:46:39,761 | HR @1|5|10: 0.0134 	 0.0318 	 0.0489 	
2025-08-27 01:46:39,762 | NDCG @5|10: 0.0229 	 0.0285
2025-08-27 01:46:39,762 | domain:Beauty
2025-08-27 01:46:39,762 | model_moe:
2025-08-27 01:46:39,763 | MRR: 0.2332
2025-08-27 01:46:39,763 | HR @1|5|10: 0.1579 	 0.3278 	 0.3959 	
2025-08-27 01:46:39,763 | NDCG @5|10: 0.2446 	 0.2669
2025-08-27 01:46:39,764 | 	avg_model_moe:
2025-08-27 01:46:39,764 | MRR: 0.1809
2025-08-27 01:46:39,764 | HR @1|5|10: 0.1189 	 0.2522 	 0.3041 	
2025-08-27 01:46:39,764 | NDCG @5|10: 0.1881 	 0.2050
2025-08-27 01:46:39,765 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:47:09,969 | Epoch 50/60 - client 1 -  Training Loss: 27.819

 25%|##5       | 1/4 [00:30<01:30, 30.21s/it]2025-08-27 01:47:21,912 | Epoch 50/60 - client 3 -  Training Loss: 27.688

 50%|#####     | 2/4 [00:42<00:38, 19.46s/it]2025-08-27 01:47:38,307 | Epoch 50/60 - client 2 -  Training Loss: 27.337

 75%|#######5  | 3/4 [00:58<00:18, 18.06s/it]2025-08-27 01:47:50,566 | Epoch 50/60 - client 0 -  Training Loss: 26.482

100%|##########| 4/4 [01:10<00:00, 15.77s/it]
100%|##########| 4/4 [01:10<00:00, 17.70s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:47:54,624 | Epoch50 Valid:
2025-08-27 01:47:54,627 | domain:Food
2025-08-27 01:47:54,628 | model_moe:
2025-08-27 01:47:54,628 | MRR: 0.3426
2025-08-27 01:47:54,628 | HR @1|5|10: 0.2418 	 0.4744 	 0.5432 	
2025-08-27 01:47:54,629 | NDCG @5|10: 0.3639 	 0.3865
2025-08-27 01:47:54,629 | domain:Kitchen
2025-08-27 01:47:54,629 | model_moe:
2025-08-27 01:47:54,630 | MRR: 0.1241
2025-08-27 01:47:54,630 | HR @1|5|10: 0.0677 	 0.1777 	 0.2284 	
2025-08-27 01:47:54,630 | NDCG @5|10: 0.1244 	 0.1408
2025-08-27 01:47:54,630 | domain:Clothing
2025-08-27 01:47:54,631 | model_moe:
2025-08-27 01:47:54,631 | MRR: 0.0274
2025-08-27 01:47:54,631 | HR @1|5|10: 0.0122 	 0.0342 	 0.0489 	
2025-08-27 01:47:54,632 | NDCG @5|10: 0.0234 	 0.0283
2025-08-27 01:47:54,632 | domain:Beauty
2025-08-27 01:47:54,633 | model_moe:
2025-08-27 01:47:54,633 | MRR: 0.2345
2025-08-27 01:47:54,633 | HR @1|5|10: 0.1567 	 0.3337 	 0.4043 	
2025-08-27 01:47:54,634 | NDCG @5|10: 0.2476 	 0.2702
2025-08-27 01:47:54,634 | 	avg_model_moe:
2025-08-27 01:47:54,634 | MRR: 0.1821
2025-08-27 01:47:54,635 | HR @1|5|10: 0.1196 	 0.2550 	 0.3062 	
2025-08-27 01:47:54,635 | NDCG @5|10: 0.1898 	 0.2065
2025-08-27 01:47:54,635 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:48:13,148 | Epoch 51/60 - client 2 -  Training Loss: 27.270

 25%|##5       | 1/4 [00:16<00:49, 16.41s/it]2025-08-27 01:48:43,352 | Epoch 51/60 - client 1 -  Training Loss: 27.773

 50%|#####     | 2/4 [00:46<00:49, 24.52s/it]2025-08-27 01:48:55,599 | Epoch 51/60 - client 0 -  Training Loss: 26.448

 75%|#######5  | 3/4 [00:58<00:18, 18.92s/it]2025-08-27 01:49:07,526 | Epoch 51/60 - client 3 -  Training Loss: 27.640

100%|##########| 4/4 [01:10<00:00, 16.16s/it]
100%|##########| 4/4 [01:10<00:00, 17.70s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:49:11,573 | Epoch51 Valid:
2025-08-27 01:49:11,573 | domain:Food
2025-08-27 01:49:11,574 | model_moe:
2025-08-27 01:49:11,574 | MRR: 0.3412
2025-08-27 01:49:11,575 | HR @1|5|10: 0.2395 	 0.4728 	 0.5432 	
2025-08-27 01:49:11,575 | NDCG @5|10: 0.3624 	 0.3854
2025-08-27 01:49:11,575 | domain:Kitchen
2025-08-27 01:49:11,576 | model_moe:
2025-08-27 01:49:11,576 | MRR: 0.1240
2025-08-27 01:49:11,577 | HR @1|5|10: 0.0681 	 0.1777 	 0.2302 	
2025-08-27 01:49:11,577 | NDCG @5|10: 0.1243 	 0.1413
2025-08-27 01:49:11,578 | domain:Clothing
2025-08-27 01:49:11,578 | model_moe:
2025-08-27 01:49:11,578 | MRR: 0.0291
2025-08-27 01:49:11,579 | HR @1|5|10: 0.0134 	 0.0355 	 0.0501 	
2025-08-27 01:49:11,579 | NDCG @5|10: 0.0250 	 0.0298
2025-08-27 01:49:11,579 | domain:Beauty
2025-08-27 01:49:11,580 | model_moe:
2025-08-27 01:49:11,580 | MRR: 0.2347
2025-08-27 01:49:11,580 | HR @1|5|10: 0.1567 	 0.3301 	 0.3995 	
2025-08-27 01:49:11,581 | NDCG @5|10: 0.2466 	 0.2690
2025-08-27 01:49:11,581 | 	avg_model_moe:
2025-08-27 01:49:11,581 | MRR: 0.1822
2025-08-27 01:49:11,582 | HR @1|5|10: 0.1194 	 0.2540 	 0.3058 	
2025-08-27 01:49:11,582 | NDCG @5|10: 0.1896 	 0.2064
2025-08-27 01:49:11,582 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:49:25,835 | Epoch 52/60 - client 0 -  Training Loss: 26.416

 25%|##5       | 1/4 [00:12<00:36, 12.26s/it]2025-08-27 01:49:37,780 | Epoch 52/60 - client 3 -  Training Loss: 27.591

 50%|#####     | 2/4 [00:24<00:24, 12.07s/it]2025-08-27 01:49:54,167 | Epoch 52/60 - client 2 -  Training Loss: 27.202

 75%|#######5  | 3/4 [00:40<00:14, 14.04s/it]2025-08-27 01:50:24,377 | Epoch 52/60 - client 1 -  Training Loss: 27.732

100%|##########| 4/4 [01:10<00:00, 20.43s/it]
100%|##########| 4/4 [01:10<00:00, 17.70s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:50:28,427 | Epoch52 Valid:
2025-08-27 01:50:28,428 | domain:Food
2025-08-27 01:50:28,428 | model_moe:
2025-08-27 01:50:28,428 | MRR: 0.3421
2025-08-27 01:50:28,429 | HR @1|5|10: 0.2395 	 0.4744 	 0.5440 	
2025-08-27 01:50:28,429 | NDCG @5|10: 0.3636 	 0.3863
2025-08-27 01:50:28,429 | domain:Kitchen
2025-08-27 01:50:28,430 | model_moe:
2025-08-27 01:50:28,430 | MRR: 0.1243
2025-08-27 01:50:28,430 | HR @1|5|10: 0.0691 	 0.1777 	 0.2330 	
2025-08-27 01:50:28,431 | NDCG @5|10: 0.1245 	 0.1423
2025-08-27 01:50:28,431 | domain:Clothing
2025-08-27 01:50:28,431 | model_moe:
2025-08-27 01:50:28,432 | MRR: 0.0285
2025-08-27 01:50:28,432 | HR @1|5|10: 0.0134 	 0.0355 	 0.0465 	
2025-08-27 01:50:28,432 | NDCG @5|10: 0.0248 	 0.0284
2025-08-27 01:50:28,433 | domain:Beauty
2025-08-27 01:50:28,433 | model_moe:
2025-08-27 01:50:28,433 | MRR: 0.2354
2025-08-27 01:50:28,434 | HR @1|5|10: 0.1579 	 0.3337 	 0.4007 	
2025-08-27 01:50:28,434 | NDCG @5|10: 0.2483 	 0.2698
2025-08-27 01:50:28,434 | 	avg_model_moe:
2025-08-27 01:50:28,435 | MRR: 0.1826
2025-08-27 01:50:28,435 | HR @1|5|10: 0.1200 	 0.2553 	 0.3060 	
2025-08-27 01:50:28,436 | NDCG @5|10: 0.1903 	 0.2067
2025-08-27 01:50:28,436 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:50:42,596 | Epoch 53/60 - client 3 -  Training Loss: 27.545

 25%|##5       | 1/4 [00:11<00:35, 11.95s/it]2025-08-27 01:50:58,997 | Epoch 53/60 - client 2 -  Training Loss: 27.138

 50%|#####     | 2/4 [00:28<00:29, 14.57s/it]2025-08-27 01:51:29,226 | Epoch 53/60 - client 1 -  Training Loss: 27.686

 75%|#######5  | 3/4 [00:58<00:21, 21.72s/it]2025-08-27 01:51:41,477 | Epoch 53/60 - client 0 -  Training Loss: 26.386

100%|##########| 4/4 [01:10<00:00, 17.98s/it]
100%|##########| 4/4 [01:10<00:00, 17.71s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.01it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:51:45,543 | Epoch53 Valid:
2025-08-27 01:51:45,544 | domain:Food
2025-08-27 01:51:45,544 | model_moe:
2025-08-27 01:51:45,544 | MRR: 0.3416
2025-08-27 01:51:45,544 | HR @1|5|10: 0.2402 	 0.4751 	 0.5425 	
2025-08-27 01:51:45,545 | NDCG @5|10: 0.3635 	 0.3856
2025-08-27 01:51:45,545 | domain:Kitchen
2025-08-27 01:51:45,545 | model_moe:
2025-08-27 01:51:45,546 | MRR: 0.1246
2025-08-27 01:51:45,546 | HR @1|5|10: 0.0700 	 0.1740 	 0.2270 	
2025-08-27 01:51:45,546 | NDCG @5|10: 0.1236 	 0.1408
2025-08-27 01:51:45,546 | domain:Clothing
2025-08-27 01:51:45,547 | model_moe:
2025-08-27 01:51:45,547 | MRR: 0.0296
2025-08-27 01:51:45,547 | HR @1|5|10: 0.0147 	 0.0342 	 0.0489 	
2025-08-27 01:51:45,548 | NDCG @5|10: 0.0250 	 0.0299
2025-08-27 01:51:45,548 | domain:Beauty
2025-08-27 01:51:45,548 | model_moe:
2025-08-27 01:51:45,548 | MRR: 0.2343
2025-08-27 01:51:45,549 | HR @1|5|10: 0.1555 	 0.3313 	 0.3995 	
2025-08-27 01:51:45,549 | NDCG @5|10: 0.2466 	 0.2688
2025-08-27 01:51:45,549 | 	avg_model_moe:
2025-08-27 01:51:45,550 | MRR: 0.1825
2025-08-27 01:51:45,550 | HR @1|5|10: 0.1201 	 0.2537 	 0.3045 	
2025-08-27 01:51:45,550 | NDCG @5|10: 0.1897 	 0.2063
2025-08-27 01:51:45,550 | Early Stopping counter: 1 out of 10
2025-08-27 01:51:45,551 | Learning rate decay counter: 1 out of 1
2025-08-27 01:51:45,551 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:52:15,761 | Epoch 54/60 - client 1 -  Training Loss: 27.647

 25%|##5       | 1/4 [00:30<01:30, 30.21s/it]2025-08-27 01:52:27,687 | Epoch 54/60 - client 3 -  Training Loss: 27.497

 50%|#####     | 2/4 [00:42<00:38, 19.46s/it]2025-08-27 01:52:44,081 | Epoch 54/60 - client 2 -  Training Loss: 27.078

 75%|#######5  | 3/4 [00:58<00:18, 18.06s/it]2025-08-27 01:52:56,351 | Epoch 54/60 - client 0 -  Training Loss: 26.350

100%|##########| 4/4 [01:10<00:00, 15.77s/it]
100%|##########| 4/4 [01:10<00:00, 17.70s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:53:00,397 | Epoch54 Valid:
2025-08-27 01:53:00,397 | domain:Food
2025-08-27 01:53:00,397 | model_moe:
2025-08-27 01:53:00,398 | MRR: 0.3421
2025-08-27 01:53:00,398 | HR @1|5|10: 0.2410 	 0.4736 	 0.5440 	
2025-08-27 01:53:00,398 | NDCG @5|10: 0.3632 	 0.3864
2025-08-27 01:53:00,399 | domain:Kitchen
2025-08-27 01:53:00,399 | model_moe:
2025-08-27 01:53:00,399 | MRR: 0.1254
2025-08-27 01:53:00,399 | HR @1|5|10: 0.0704 	 0.1763 	 0.2307 	
2025-08-27 01:53:00,400 | NDCG @5|10: 0.1248 	 0.1424
2025-08-27 01:53:00,400 | domain:Clothing
2025-08-27 01:53:00,400 | model_moe:
2025-08-27 01:53:00,401 | MRR: 0.0281
2025-08-27 01:53:00,401 | HR @1|5|10: 0.0122 	 0.0342 	 0.0465 	
2025-08-27 01:53:00,401 | NDCG @5|10: 0.0242 	 0.0281
2025-08-27 01:53:00,402 | domain:Beauty
2025-08-27 01:53:00,402 | model_moe:
2025-08-27 01:53:00,402 | MRR: 0.2338
2025-08-27 01:53:00,402 | HR @1|5|10: 0.1531 	 0.3337 	 0.3971 	
2025-08-27 01:53:00,403 | NDCG @5|10: 0.2471 	 0.2678
2025-08-27 01:53:00,403 | 	avg_model_moe:
2025-08-27 01:53:00,403 | MRR: 0.1824
2025-08-27 01:53:00,404 | HR @1|5|10: 0.1192 	 0.2545 	 0.3046 	
2025-08-27 01:53:00,404 | NDCG @5|10: 0.1898 	 0.2062
2025-08-27 01:53:00,404 | Early Stopping counter: 2 out of 10
2025-08-27 01:53:00,404 | Learning rate decay counter: 1 out of 1
2025-08-27 01:53:00,405 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:53:30,604 | Epoch 55/60 - client 1 -  Training Loss: 27.614

 25%|##5       | 1/4 [00:30<01:30, 30.20s/it]2025-08-27 01:53:42,854 | Epoch 55/60 - client 0 -  Training Loss: 26.312

 50%|#####     | 2/4 [00:42<00:39, 19.64s/it]2025-08-27 01:53:59,249 | Epoch 55/60 - client 2 -  Training Loss: 27.025

 75%|#######5  | 3/4 [00:58<00:18, 18.16s/it]2025-08-27 01:54:11,182 | Epoch 55/60 - client 3 -  Training Loss: 27.447

100%|##########| 4/4 [01:10<00:00, 15.70s/it]
100%|##########| 4/4 [01:10<00:00, 17.69s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:54:15,239 | Epoch55 Valid:
2025-08-27 01:54:15,240 | domain:Food
2025-08-27 01:54:15,240 | model_moe:
2025-08-27 01:54:15,240 | MRR: 0.3388
2025-08-27 01:54:15,241 | HR @1|5|10: 0.2364 	 0.4713 	 0.5440 	
2025-08-27 01:54:15,241 | NDCG @5|10: 0.3602 	 0.3839
2025-08-27 01:54:15,241 | domain:Kitchen
2025-08-27 01:54:15,242 | model_moe:
2025-08-27 01:54:15,242 | MRR: 0.1233
2025-08-27 01:54:15,242 | HR @1|5|10: 0.0672 	 0.1740 	 0.2330 	
2025-08-27 01:54:15,243 | NDCG @5|10: 0.1224 	 0.1415
2025-08-27 01:54:15,243 | domain:Clothing
2025-08-27 01:54:15,243 | model_moe:
2025-08-27 01:54:15,243 | MRR: 0.0290
2025-08-27 01:54:15,245 | HR @1|5|10: 0.0147 	 0.0342 	 0.0489 	
2025-08-27 01:54:15,245 | NDCG @5|10: 0.0247 	 0.0295
2025-08-27 01:54:15,245 | domain:Beauty
2025-08-27 01:54:15,246 | model_moe:
2025-08-27 01:54:15,246 | MRR: 0.2369
2025-08-27 01:54:15,246 | HR @1|5|10: 0.1591 	 0.3337 	 0.4019 	
2025-08-27 01:54:15,247 | NDCG @5|10: 0.2492 	 0.2714
2025-08-27 01:54:15,248 | 	avg_model_moe:
2025-08-27 01:54:15,248 | MRR: 0.1820
2025-08-27 01:54:15,249 | HR @1|5|10: 0.1193 	 0.2533 	 0.3069 	
2025-08-27 01:54:15,249 | NDCG @5|10: 0.1891 	 0.2066
2025-08-27 01:54:15,249 | Early Stopping counter: 3 out of 10
2025-08-27 01:54:15,250 | Learning rate decay counter: 1 out of 1
2025-08-27 01:54:15,250 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:54:31,670 | Epoch 56/60 - client 2 -  Training Loss: 26.957

 25%|##5       | 1/4 [00:16<00:49, 16.42s/it]2025-08-27 01:55:01,907 | Epoch 56/60 - client 1 -  Training Loss: 27.575

 50%|#####     | 2/4 [00:46<00:49, 24.55s/it]2025-08-27 01:55:14,178 | Epoch 56/60 - client 0 -  Training Loss: 26.271

 75%|#######5  | 3/4 [00:58<00:18, 18.94s/it]2025-08-27 01:55:26,125 | Epoch 56/60 - client 3 -  Training Loss: 27.393

100%|##########| 4/4 [01:10<00:00, 16.18s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:55:30,172 | Epoch56 Valid:
2025-08-27 01:55:30,172 | domain:Food
2025-08-27 01:55:30,172 | model_moe:
2025-08-27 01:55:30,173 | MRR: 0.3404
2025-08-27 01:55:30,173 | HR @1|5|10: 0.2379 	 0.4713 	 0.5417 	
2025-08-27 01:55:30,173 | NDCG @5|10: 0.3613 	 0.3843
2025-08-27 01:55:30,174 | domain:Kitchen
2025-08-27 01:55:30,174 | model_moe:
2025-08-27 01:55:30,174 | MRR: 0.1257
2025-08-27 01:55:30,175 | HR @1|5|10: 0.0714 	 0.1745 	 0.2320 	
2025-08-27 01:55:30,175 | NDCG @5|10: 0.1241 	 0.1429
2025-08-27 01:55:30,175 | domain:Clothing
2025-08-27 01:55:30,175 | model_moe:
2025-08-27 01:55:30,176 | MRR: 0.0265
2025-08-27 01:55:30,176 | HR @1|5|10: 0.0122 	 0.0330 	 0.0440 	
2025-08-27 01:55:30,176 | NDCG @5|10: 0.0227 	 0.0262
2025-08-27 01:55:30,177 | domain:Beauty
2025-08-27 01:55:30,178 | model_moe:
2025-08-27 01:55:30,179 | MRR: 0.2378
2025-08-27 01:55:30,179 | HR @1|5|10: 0.1603 	 0.3325 	 0.4007 	
2025-08-27 01:55:30,179 | NDCG @5|10: 0.2495 	 0.2716
2025-08-27 01:55:30,179 | 	avg_model_moe:
2025-08-27 01:55:30,180 | MRR: 0.1826
2025-08-27 01:55:30,180 | HR @1|5|10: 0.1205 	 0.2528 	 0.3046 	
2025-08-27 01:55:30,181 | NDCG @5|10: 0.1894 	 0.2063
2025-08-27 01:55:30,182 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:55:48,670 | Epoch 57/60 - client 2 -  Training Loss: 26.896

 25%|##5       | 1/4 [00:16<00:49, 16.42s/it]2025-08-27 01:56:00,945 | Epoch 57/60 - client 0 -  Training Loss: 26.242

 50%|#####     | 2/4 [00:28<00:27, 13.98s/it]2025-08-27 01:56:31,171 | Epoch 57/60 - client 1 -  Training Loss: 27.536

 75%|#######5  | 3/4 [00:58<00:21, 21.40s/it]2025-08-27 01:56:43,124 | Epoch 57/60 - client 3 -  Training Loss: 27.345

100%|##########| 4/4 [01:10<00:00, 17.67s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.08s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:56:47,194 | Epoch57 Valid:
2025-08-27 01:56:47,195 | domain:Food
2025-08-27 01:56:47,195 | model_moe:
2025-08-27 01:56:47,196 | MRR: 0.3436
2025-08-27 01:56:47,196 | HR @1|5|10: 0.2441 	 0.4736 	 0.5425 	
2025-08-27 01:56:47,196 | NDCG @5|10: 0.3644 	 0.3869
2025-08-27 01:56:47,197 | domain:Kitchen
2025-08-27 01:56:47,197 | model_moe:
2025-08-27 01:56:47,197 | MRR: 0.1244
2025-08-27 01:56:47,197 | HR @1|5|10: 0.0691 	 0.1750 	 0.2343 	
2025-08-27 01:56:47,198 | NDCG @5|10: 0.1235 	 0.1426
2025-08-27 01:56:47,198 | domain:Clothing
2025-08-27 01:56:47,198 | model_moe:
2025-08-27 01:56:47,199 | MRR: 0.0272
2025-08-27 01:56:47,199 | HR @1|5|10: 0.0122 	 0.0330 	 0.0477 	
2025-08-27 01:56:47,199 | NDCG @5|10: 0.0229 	 0.0278
2025-08-27 01:56:47,200 | domain:Beauty
2025-08-27 01:56:47,200 | model_moe:
2025-08-27 01:56:47,200 | MRR: 0.2390
2025-08-27 01:56:47,200 | HR @1|5|10: 0.1627 	 0.3349 	 0.4031 	
2025-08-27 01:56:47,201 | NDCG @5|10: 0.2510 	 0.2732
2025-08-27 01:56:47,201 | 	avg_model_moe:
2025-08-27 01:56:47,201 | MRR: 0.1836
2025-08-27 01:56:47,202 | HR @1|5|10: 0.1220 	 0.2541 	 0.3069 	
2025-08-27 01:56:47,202 | NDCG @5|10: 0.1905 	 0.2076
2025-08-27 01:56:47,202 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:57:19,407 | Epoch 58/60 - client 1 -  Training Loss: 27.492

 25%|##5       | 1/4 [00:30<01:30, 30.22s/it]2025-08-27 01:57:35,814 | Epoch 58/60 - client 2 -  Training Loss: 26.834

 50%|#####     | 2/4 [00:46<00:44, 22.23s/it]2025-08-27 01:57:47,957 | Epoch 58/60 - client 3 -  Training Loss: 27.309

 75%|#######5  | 3/4 [00:58<00:17, 17.52s/it]2025-08-27 01:58:00,220 | Epoch 58/60 - client 0 -  Training Loss: 26.210

100%|##########| 4/4 [01:11<00:00, 15.45s/it]
100%|##########| 4/4 [01:11<00:00, 17.76s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:58:04,279 | Epoch58 Valid:
2025-08-27 01:58:04,279 | domain:Food
2025-08-27 01:58:04,280 | model_moe:
2025-08-27 01:58:04,280 | MRR: 0.3413
2025-08-27 01:58:04,280 | HR @1|5|10: 0.2379 	 0.4751 	 0.5440 	
2025-08-27 01:58:04,281 | NDCG @5|10: 0.3630 	 0.3856
2025-08-27 01:58:04,281 | domain:Kitchen
2025-08-27 01:58:04,281 | model_moe:
2025-08-27 01:58:04,281 | MRR: 0.1247
2025-08-27 01:58:04,282 | HR @1|5|10: 0.0691 	 0.1763 	 0.2339 	
2025-08-27 01:58:04,282 | NDCG @5|10: 0.1242 	 0.1427
2025-08-27 01:58:04,282 | domain:Clothing
2025-08-27 01:58:04,283 | model_moe:
2025-08-27 01:58:04,283 | MRR: 0.0269
2025-08-27 01:58:04,283 | HR @1|5|10: 0.0110 	 0.0306 	 0.0465 	
2025-08-27 01:58:04,284 | NDCG @5|10: 0.0220 	 0.0273
2025-08-27 01:58:04,284 | domain:Beauty
2025-08-27 01:58:04,284 | model_moe:
2025-08-27 01:58:04,284 | MRR: 0.2378
2025-08-27 01:58:04,285 | HR @1|5|10: 0.1615 	 0.3289 	 0.3959 	
2025-08-27 01:58:04,285 | NDCG @5|10: 0.2486 	 0.2703
2025-08-27 01:58:04,285 | 	avg_model_moe:
2025-08-27 01:58:04,286 | MRR: 0.1827
2025-08-27 01:58:04,286 | HR @1|5|10: 0.1199 	 0.2527 	 0.3051 	
2025-08-27 01:58:04,286 | NDCG @5|10: 0.1895 	 0.2065
2025-08-27 01:58:04,286 | Early Stopping counter: 1 out of 10
2025-08-27 01:58:04,287 | Learning rate decay counter: 1 out of 1
2025-08-27 01:58:04,287 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:58:34,516 | Epoch 59/60 - client 1 -  Training Loss: 27.451

 25%|##5       | 1/4 [00:30<01:30, 30.23s/it]2025-08-27 01:58:50,909 | Epoch 59/60 - client 2 -  Training Loss: 26.768

 50%|#####     | 2/4 [00:46<00:44, 22.09s/it]2025-08-27 01:59:02,832 | Epoch 59/60 - client 3 -  Training Loss: 27.262

 75%|#######5  | 3/4 [00:58<00:17, 17.45s/it]2025-08-27 01:59:15,098 | Epoch 59/60 - client 0 -  Training Loss: 26.182

100%|##########| 4/4 [01:10<00:00, 15.40s/it]
100%|##########| 4/4 [01:10<00:00, 17.70s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 01:59:19,144 | Epoch59 Valid:
2025-08-27 01:59:19,145 | domain:Food
2025-08-27 01:59:19,145 | model_moe:
2025-08-27 01:59:19,145 | MRR: 0.3406
2025-08-27 01:59:19,146 | HR @1|5|10: 0.2387 	 0.4728 	 0.5463 	
2025-08-27 01:59:19,146 | NDCG @5|10: 0.3618 	 0.3857
2025-08-27 01:59:19,146 | domain:Kitchen
2025-08-27 01:59:19,146 | model_moe:
2025-08-27 01:59:19,147 | MRR: 0.1231
2025-08-27 01:59:19,147 | HR @1|5|10: 0.0668 	 0.1745 	 0.2353 	
2025-08-27 01:59:19,147 | NDCG @5|10: 0.1221 	 0.1418
2025-08-27 01:59:19,148 | domain:Clothing
2025-08-27 01:59:19,148 | model_moe:
2025-08-27 01:59:19,148 | MRR: 0.0273
2025-08-27 01:59:19,148 | HR @1|5|10: 0.0122 	 0.0293 	 0.0440 	
2025-08-27 01:59:19,149 | NDCG @5|10: 0.0219 	 0.0268
2025-08-27 01:59:19,149 | domain:Beauty
2025-08-27 01:59:19,149 | model_moe:
2025-08-27 01:59:19,150 | MRR: 0.2384
2025-08-27 01:59:19,150 | HR @1|5|10: 0.1615 	 0.3325 	 0.3983 	
2025-08-27 01:59:19,150 | NDCG @5|10: 0.2503 	 0.2715
2025-08-27 01:59:19,150 | 	avg_model_moe:
2025-08-27 01:59:19,151 | MRR: 0.1823
2025-08-27 01:59:19,151 | HR @1|5|10: 0.1198 	 0.2523 	 0.3060 	
2025-08-27 01:59:19,151 | NDCG @5|10: 0.1890 	 0.2065
2025-08-27 01:59:19,152 | Early Stopping counter: 2 out of 10
2025-08-27 01:59:19,152 | Learning rate decay counter: 1 out of 1
2025-08-27 01:59:19,152 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 01:59:31,075 | Epoch 60/60 - client 3 -  Training Loss: 27.226

 25%|##5       | 1/4 [00:11<00:35, 11.92s/it]2025-08-27 02:00:01,298 | Epoch 60/60 - client 1 -  Training Loss: 27.415

 50%|#####     | 2/4 [00:42<00:45, 22.69s/it]2025-08-27 02:00:13,561 | Epoch 60/60 - client 0 -  Training Loss: 26.151

 75%|#######5  | 3/4 [00:54<00:17, 17.93s/it]2025-08-27 02:00:29,963 | Epoch 60/60 - client 2 -  Training Loss: 26.721

100%|##########| 4/4 [01:10<00:00, 17.33s/it]
100%|##########| 4/4 [01:10<00:00, 17.70s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.36s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.07s/it]
100%|##########| 4/4 [00:04<00:00,  1.08it/s]
100%|##########| 4/4 [00:04<00:00,  1.01s/it]
2025-08-27 02:00:34,023 | Epoch60 Valid:
2025-08-27 02:00:34,023 | domain:Food
2025-08-27 02:00:34,023 | model_moe:
2025-08-27 02:00:34,024 | MRR: 0.3405
2025-08-27 02:00:34,024 | HR @1|5|10: 0.2379 	 0.4744 	 0.5432 	
2025-08-27 02:00:34,024 | NDCG @5|10: 0.3624 	 0.3847
2025-08-27 02:00:34,025 | domain:Kitchen
2025-08-27 02:00:34,025 | model_moe:
2025-08-27 02:00:34,025 | MRR: 0.1239
2025-08-27 02:00:34,025 | HR @1|5|10: 0.0691 	 0.1782 	 0.2334 	
2025-08-27 02:00:34,026 | NDCG @5|10: 0.1243 	 0.1420
2025-08-27 02:00:34,026 | domain:Clothing
2025-08-27 02:00:34,026 | model_moe:
2025-08-27 02:00:34,027 | MRR: 0.0271
2025-08-27 02:00:34,027 | HR @1|5|10: 0.0134 	 0.0281 	 0.0465 	
2025-08-27 02:00:34,027 | NDCG @5|10: 0.0213 	 0.0273
2025-08-27 02:00:34,027 | domain:Beauty
2025-08-27 02:00:34,028 | model_moe:
2025-08-27 02:00:34,028 | MRR: 0.2393
2025-08-27 02:00:34,028 | HR @1|5|10: 0.1627 	 0.3289 	 0.3923 	
2025-08-27 02:00:34,028 | NDCG @5|10: 0.2497 	 0.2704
2025-08-27 02:00:34,029 | 	avg_model_moe:
2025-08-27 02:00:34,029 | MRR: 0.1827
2025-08-27 02:00:34,029 | HR @1|5|10: 0.1208 	 0.2524 	 0.3039 	
2025-08-27 02:00:34,030 | NDCG @5|10: 0.1894 	 0.2061
2025-08-27 02:00:34,030 | Early Stopping counter: 3 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:02<00:06,  2.09s/it]
 50%|#####     | 2/4 [00:05<00:05,  2.78s/it]
 75%|#######5  | 3/4 [00:07<00:02,  2.60s/it]
100%|##########| 4/4 [00:09<00:00,  2.28s/it]
100%|##########| 4/4 [00:09<00:00,  2.38s/it]
2025-08-27 02:00:43,570 | Test:
2025-08-27 02:00:43,571 | domain:Food
2025-08-27 02:00:43,571 | model_moe:
2025-08-27 02:00:43,571 | MRR: 0.2801
2025-08-27 02:00:43,572 | HR @1|5|10: 0.1862 	 0.3956 	 0.4827 	
2025-08-27 02:00:43,572 | NDCG @5|10: 0.2949 	 0.3230
2025-08-27 02:00:43,572 | domain:Kitchen
2025-08-27 02:00:43,573 | model_moe:
2025-08-27 02:00:43,573 | MRR: 0.1162
2025-08-27 02:00:43,573 | HR @1|5|10: 0.0639 	 0.1624 	 0.2329 	
2025-08-27 02:00:43,573 | NDCG @5|10: 0.1134 	 0.1362
2025-08-27 02:00:43,574 | domain:Clothing
2025-08-27 02:00:43,574 | model_moe:
2025-08-27 02:00:43,574 | MRR: 0.0259
2025-08-27 02:00:43,575 | HR @1|5|10: 0.0139 	 0.0266 	 0.0335 	
2025-08-27 02:00:43,575 | NDCG @5|10: 0.0209 	 0.0232
2025-08-27 02:00:43,575 | domain:Beauty
2025-08-27 02:00:43,575 | model_moe:
2025-08-27 02:00:43,576 | MRR: 0.1892
2025-08-27 02:00:43,576 | HR @1|5|10: 0.1053 	 0.2901 	 0.3614 	
2025-08-27 02:00:43,576 | NDCG @5|10: 0.2013 	 0.2241
2025-08-27 02:00:43,576 | 	avg_model_moe:
2025-08-27 02:00:43,577 | MRR: 0.1529
2025-08-27 02:00:43,577 | HR @1|5|10: 0.0923 	 0.2187 	 0.2776 	
2025-08-27 02:00:43,577 | NDCG @5|10: 0.1576 	 0.1766
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 02:03:36,333 | Running with the following configs:
	domains : ['Movies', 'Books', 'Games']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 02:04:03,232 | Epoch 1/40 - client 2 -  Training Loss: 25.625

 33%|###3      | 1/3 [00:26<00:53, 26.85s/it]2025-08-27 02:07:18,735 | Epoch 1/40 - client 1 -  Training Loss: 27.121

 67%|######6   | 2/3 [03:42<02:06, 126.06s/it]2025-08-27 02:09:33,906 | Epoch 1/40 - client 0 -  Training Loss: 28.060

100%|##########| 3/3 [05:57<00:00, 130.22s/it]
100%|##########| 3/3 [05:57<00:00, 119.17s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.69s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.20s/it]
100%|##########| 3/3 [00:15<00:00,  4.45s/it]
100%|##########| 3/3 [00:15<00:00,  5.14s/it]
2025-08-27 02:09:49,337 | Epoch1 Valid:
2025-08-27 02:09:49,337 | domain:Movies
2025-08-27 02:09:49,338 | model_moe:
2025-08-27 02:09:49,338 | MRR: 0.0332
2025-08-27 02:09:49,338 | HR @1|5|10: 0.0151 	 0.0377 	 0.0580 	
2025-08-27 02:09:49,338 | NDCG @5|10: 0.0264 	 0.0328
2025-08-27 02:09:49,339 | domain:Books
2025-08-27 02:09:49,339 | model_moe:
2025-08-27 02:09:49,339 | MRR: 0.0142
2025-08-27 02:09:49,340 | HR @1|5|10: 0.0076 	 0.0141 	 0.0185 	
2025-08-27 02:09:49,340 | NDCG @5|10: 0.0109 	 0.0123
2025-08-27 02:09:49,340 | domain:Games
2025-08-27 02:09:49,340 | model_moe:
2025-08-27 02:09:49,341 | MRR: 0.0387
2025-08-27 02:09:49,341 | HR @1|5|10: 0.0218 	 0.0415 	 0.0640 	
2025-08-27 02:09:49,341 | NDCG @5|10: 0.0321 	 0.0395
2025-08-27 02:09:49,342 | 	avg_model_moe:
2025-08-27 02:09:49,342 | MRR: 0.0287
2025-08-27 02:09:49,342 | HR @1|5|10: 0.0148 	 0.0311 	 0.0469 	
2025-08-27 02:09:49,342 | NDCG @5|10: 0.0231 	 0.0282
2025-08-27 02:09:49,343 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:12:05,511 | Epoch 2/40 - client 0 -  Training Loss: 26.006

 33%|###3      | 1/3 [02:14<04:28, 134.31s/it]2025-08-27 02:12:18,285 | Epoch 2/40 - client 2 -  Training Loss: 23.767

 67%|######6   | 2/3 [02:27<01:02, 62.82s/it] 2025-08-27 02:15:32,337 | Epoch 2/40 - client 1 -  Training Loss: 25.259

100%|##########| 3/3 [05:41<00:00, 122.74s/it]
100%|##########| 3/3 [05:41<00:00, 113.71s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.52s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.01s/it]
100%|##########| 3/3 [00:15<00:00,  4.35s/it]
100%|##########| 3/3 [00:15<00:00,  5.02s/it]
2025-08-27 02:15:47,402 | Epoch2 Valid:
2025-08-27 02:15:47,402 | domain:Movies
2025-08-27 02:15:47,403 | model_moe:
2025-08-27 02:15:47,403 | MRR: 0.0857
2025-08-27 02:15:47,403 | HR @1|5|10: 0.0429 	 0.1135 	 0.1607 	
2025-08-27 02:15:47,404 | NDCG @5|10: 0.0787 	 0.0939
2025-08-27 02:15:47,404 | domain:Books
2025-08-27 02:15:47,404 | model_moe:
2025-08-27 02:15:47,404 | MRR: 0.0630
2025-08-27 02:15:47,405 | HR @1|5|10: 0.0330 	 0.0783 	 0.1133 	
2025-08-27 02:15:47,405 | NDCG @5|10: 0.0558 	 0.0670
2025-08-27 02:15:47,405 | domain:Games
2025-08-27 02:15:47,405 | model_moe:
2025-08-27 02:15:47,406 | MRR: 0.0359
2025-08-27 02:15:47,406 | HR @1|5|10: 0.0167 	 0.0429 	 0.0655 	
2025-08-27 02:15:47,406 | NDCG @5|10: 0.0304 	 0.0376
2025-08-27 02:15:47,407 | 	avg_model_moe:
2025-08-27 02:15:47,407 | MRR: 0.0615
2025-08-27 02:15:47,407 | HR @1|5|10: 0.0309 	 0.0783 	 0.1132 	
2025-08-27 02:15:47,407 | NDCG @5|10: 0.0550 	 0.0661
2025-08-27 02:15:47,408 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:18:04,434 | Epoch 3/40 - client 0 -  Training Loss: 25.458

 33%|###3      | 1/3 [02:14<04:29, 134.98s/it]2025-08-27 02:21:19,402 | Epoch 3/40 - client 1 -  Training Loss: 24.731

 67%|######6   | 2/3 [05:29<02:50, 170.27s/it]2025-08-27 02:21:32,350 | Epoch 3/40 - client 2 -  Training Loss: 23.169

100%|##########| 3/3 [05:42<00:00, 98.43s/it] 
100%|##########| 3/3 [05:42<00:00, 114.30s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.52s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.04s/it]
100%|##########| 3/3 [00:15<00:00,  4.37s/it]
100%|##########| 3/3 [00:15<00:00,  5.04s/it]
2025-08-27 02:21:47,486 | Epoch3 Valid:
2025-08-27 02:21:47,487 | domain:Movies
2025-08-27 02:21:47,487 | model_moe:
2025-08-27 02:21:47,487 | MRR: 0.1065
2025-08-27 02:21:47,488 | HR @1|5|10: 0.0558 	 0.1413 	 0.1999 	
2025-08-27 02:21:47,488 | NDCG @5|10: 0.0998 	 0.1188
2025-08-27 02:21:47,488 | domain:Books
2025-08-27 02:21:47,488 | model_moe:
2025-08-27 02:21:47,489 | MRR: 0.0794
2025-08-27 02:21:47,489 | HR @1|5|10: 0.0420 	 0.1015 	 0.1428 	
2025-08-27 02:21:47,489 | NDCG @5|10: 0.0726 	 0.0859
2025-08-27 02:21:47,490 | domain:Games
2025-08-27 02:21:47,490 | model_moe:
2025-08-27 02:21:47,490 | MRR: 0.0421
2025-08-27 02:21:47,490 | HR @1|5|10: 0.0218 	 0.0546 	 0.0713 	
2025-08-27 02:21:47,491 | NDCG @5|10: 0.0383 	 0.0437
2025-08-27 02:21:47,491 | 	avg_model_moe:
2025-08-27 02:21:47,491 | MRR: 0.0760
2025-08-27 02:21:47,491 | HR @1|5|10: 0.0399 	 0.0991 	 0.1380 	
2025-08-27 02:21:47,492 | NDCG @5|10: 0.0703 	 0.0828
2025-08-27 02:21:47,492 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:25:03,378 | Epoch 4/40 - client 1 -  Training Loss: 24.326

 33%|###3      | 1/3 [03:14<06:28, 194.06s/it]2025-08-27 02:27:17,816 | Epoch 4/40 - client 0 -  Training Loss: 25.053

 67%|######6   | 2/3 [05:28<02:38, 158.99s/it]2025-08-27 02:27:30,566 | Epoch 4/40 - client 2 -  Training Loss: 22.823

100%|##########| 3/3 [05:41<00:00, 92.21s/it] 
100%|##########| 3/3 [05:41<00:00, 113.75s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.50s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.10s/it]
100%|##########| 3/3 [00:15<00:00,  4.40s/it]
100%|##########| 3/3 [00:15<00:00,  5.07s/it]
2025-08-27 02:27:45,780 | Epoch4 Valid:
2025-08-27 02:27:45,780 | domain:Movies
2025-08-27 02:27:45,780 | model_moe:
2025-08-27 02:27:45,781 | MRR: 0.1235
2025-08-27 02:27:45,781 | HR @1|5|10: 0.0683 	 0.1656 	 0.2269 	
2025-08-27 02:27:45,781 | NDCG @5|10: 0.1182 	 0.1380
2025-08-27 02:27:45,782 | domain:Books
2025-08-27 02:27:45,782 | model_moe:
2025-08-27 02:27:45,782 | MRR: 0.0944
2025-08-27 02:27:45,783 | HR @1|5|10: 0.0507 	 0.1233 	 0.1743 	
2025-08-27 02:27:45,783 | NDCG @5|10: 0.0876 	 0.1039
2025-08-27 02:27:45,784 | domain:Games
2025-08-27 02:27:45,785 | model_moe:
2025-08-27 02:27:45,785 | MRR: 0.0466
2025-08-27 02:27:45,785 | HR @1|5|10: 0.0269 	 0.0590 	 0.0793 	
2025-08-27 02:27:45,785 | NDCG @5|10: 0.0424 	 0.0489
2025-08-27 02:27:45,786 | 	avg_model_moe:
2025-08-27 02:27:45,786 | MRR: 0.0882
2025-08-27 02:27:45,786 | HR @1|5|10: 0.0487 	 0.1159 	 0.1602 	
2025-08-27 02:27:45,787 | NDCG @5|10: 0.0827 	 0.0969
2025-08-27 02:27:45,787 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:31:01,220 | Epoch 5/40 - client 1 -  Training Loss: 23.961

 33%|###3      | 1/3 [03:13<06:27, 193.60s/it]2025-08-27 02:31:14,130 | Epoch 5/40 - client 2 -  Training Loss: 22.558

 67%|######6   | 2/3 [03:26<01:27, 87.31s/it] 2025-08-27 02:33:28,931 | Epoch 5/40 - client 0 -  Training Loss: 24.725

100%|##########| 3/3 [05:41<00:00, 109.00s/it]
100%|##########| 3/3 [05:41<00:00, 113.77s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.55s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.04s/it]
100%|##########| 3/3 [00:15<00:00,  4.36s/it]
100%|##########| 3/3 [00:15<00:00,  5.04s/it]
2025-08-27 02:33:44,052 | Epoch5 Valid:
2025-08-27 02:33:44,053 | domain:Movies
2025-08-27 02:33:44,053 | model_moe:
2025-08-27 02:33:44,053 | MRR: 0.1378
2025-08-27 02:33:44,054 | HR @1|5|10: 0.0793 	 0.1860 	 0.2511 	
2025-08-27 02:33:44,054 | NDCG @5|10: 0.1338 	 0.1547
2025-08-27 02:33:44,054 | domain:Books
2025-08-27 02:33:44,055 | model_moe:
2025-08-27 02:33:44,055 | MRR: 0.1099
2025-08-27 02:33:44,055 | HR @1|5|10: 0.0603 	 0.1440 	 0.2044 	
2025-08-27 02:33:44,055 | NDCG @5|10: 0.1033 	 0.1227
2025-08-27 02:33:44,056 | domain:Games
2025-08-27 02:33:44,056 | model_moe:
2025-08-27 02:33:44,056 | MRR: 0.0498
2025-08-27 02:33:44,056 | HR @1|5|10: 0.0284 	 0.0611 	 0.0808 	
2025-08-27 02:33:44,057 | NDCG @5|10: 0.0450 	 0.0513
2025-08-27 02:33:44,057 | 	avg_model_moe:
2025-08-27 02:33:44,057 | MRR: 0.0992
2025-08-27 02:33:44,058 | HR @1|5|10: 0.0560 	 0.1304 	 0.1788 	
2025-08-27 02:33:44,058 | NDCG @5|10: 0.0940 	 0.1096
2025-08-27 02:33:44,058 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:37:00,674 | Epoch 6/40 - client 1 -  Training Loss: 23.650

 33%|###3      | 1/3 [03:14<06:29, 194.55s/it]2025-08-27 02:39:15,938 | Epoch 6/40 - client 0 -  Training Loss: 24.453

 67%|######6   | 2/3 [05:29<02:39, 159.68s/it]2025-08-27 02:39:28,911 | Epoch 6/40 - client 2 -  Training Loss: 22.348

100%|##########| 3/3 [05:42<00:00, 92.69s/it] 
100%|##########| 3/3 [05:42<00:00, 114.26s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.57s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.17s/it]
100%|##########| 3/3 [00:15<00:00,  4.44s/it]
100%|##########| 3/3 [00:15<00:00,  5.12s/it]
2025-08-27 02:39:44,272 | Epoch6 Valid:
2025-08-27 02:39:44,272 | domain:Movies
2025-08-27 02:39:44,273 | model_moe:
2025-08-27 02:39:44,273 | MRR: 0.1492
2025-08-27 02:39:44,273 | HR @1|5|10: 0.0872 	 0.2035 	 0.2711 	
2025-08-27 02:39:44,274 | NDCG @5|10: 0.1465 	 0.1683
2025-08-27 02:39:44,274 | domain:Books
2025-08-27 02:39:44,274 | model_moe:
2025-08-27 02:39:44,274 | MRR: 0.1215
2025-08-27 02:39:44,275 | HR @1|5|10: 0.0666 	 0.1605 	 0.2279 	
2025-08-27 02:39:44,275 | NDCG @5|10: 0.1153 	 0.1370
2025-08-27 02:39:44,275 | domain:Games
2025-08-27 02:39:44,275 | model_moe:
2025-08-27 02:39:44,276 | MRR: 0.0556
2025-08-27 02:39:44,276 | HR @1|5|10: 0.0342 	 0.0691 	 0.0888 	
2025-08-27 02:39:44,276 | NDCG @5|10: 0.0514 	 0.0578
2025-08-27 02:39:44,277 | 	avg_model_moe:
2025-08-27 02:39:44,277 | MRR: 0.1087
2025-08-27 02:39:44,277 | HR @1|5|10: 0.0627 	 0.1444 	 0.1959 	
2025-08-27 02:39:44,277 | NDCG @5|10: 0.1044 	 0.1210
2025-08-27 02:39:44,278 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:42:01,288 | Epoch 7/40 - client 0 -  Training Loss: 24.228

 33%|###3      | 1/3 [02:15<04:30, 135.23s/it]2025-08-27 02:45:16,154 | Epoch 7/40 - client 1 -  Training Loss: 23.371

 67%|######6   | 2/3 [05:30<02:50, 170.31s/it]2025-08-27 02:45:29,078 | Epoch 7/40 - client 2 -  Training Loss: 22.153

100%|##########| 3/3 [05:43<00:00, 98.44s/it] 
100%|##########| 3/3 [05:43<00:00, 114.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.57s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.07s/it]
100%|##########| 3/3 [00:15<00:00,  4.39s/it]
100%|##########| 3/3 [00:15<00:00,  5.06s/it]
2025-08-27 02:45:44,272 | Epoch7 Valid:
2025-08-27 02:45:44,272 | domain:Movies
2025-08-27 02:45:44,272 | model_moe:
2025-08-27 02:45:44,273 | MRR: 0.1573
2025-08-27 02:45:44,273 | HR @1|5|10: 0.0927 	 0.2153 	 0.2857 	
2025-08-27 02:45:44,273 | NDCG @5|10: 0.1553 	 0.1780
2025-08-27 02:45:44,274 | domain:Books
2025-08-27 02:45:44,274 | model_moe:
2025-08-27 02:45:44,274 | MRR: 0.1327
2025-08-27 02:45:44,274 | HR @1|5|10: 0.0749 	 0.1798 	 0.2487 	
2025-08-27 02:45:44,275 | NDCG @5|10: 0.1283 	 0.1505
2025-08-27 02:45:44,275 | domain:Games
2025-08-27 02:45:44,275 | model_moe:
2025-08-27 02:45:44,275 | MRR: 0.0581
2025-08-27 02:45:44,276 | HR @1|5|10: 0.0364 	 0.0721 	 0.0917 	
2025-08-27 02:45:44,276 | NDCG @5|10: 0.0535 	 0.0599
2025-08-27 02:45:44,276 | 	avg_model_moe:
2025-08-27 02:45:44,277 | MRR: 0.1160
2025-08-27 02:45:44,277 | HR @1|5|10: 0.0680 	 0.1557 	 0.2087 	
2025-08-27 02:45:44,277 | NDCG @5|10: 0.1123 	 0.1294
2025-08-27 02:45:44,277 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:48:00,941 | Epoch 8/40 - client 0 -  Training Loss: 24.015

 33%|###3      | 1/3 [02:14<04:29, 134.81s/it]2025-08-27 02:48:13,902 | Epoch 8/40 - client 2 -  Training Loss: 21.932

 67%|######6   | 2/3 [02:27<01:03, 63.13s/it] 2025-08-27 02:51:27,704 | Epoch 8/40 - client 1 -  Training Loss: 23.085

100%|##########| 3/3 [05:41<00:00, 122.80s/it]
100%|##########| 3/3 [05:41<00:00, 113.86s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.80s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.21s/it]
100%|##########| 3/3 [00:15<00:00,  4.45s/it]
100%|##########| 3/3 [00:15<00:00,  5.16s/it]
2025-08-27 02:51:43,190 | Epoch8 Valid:
2025-08-27 02:51:43,190 | domain:Movies
2025-08-27 02:51:43,191 | model_moe:
2025-08-27 02:51:43,191 | MRR: 0.1639
2025-08-27 02:51:43,191 | HR @1|5|10: 0.0963 	 0.2246 	 0.2963 	
2025-08-27 02:51:43,192 | NDCG @5|10: 0.1622 	 0.1853
2025-08-27 02:51:43,192 | domain:Books
2025-08-27 02:51:43,192 | model_moe:
2025-08-27 02:51:43,192 | MRR: 0.1378
2025-08-27 02:51:43,193 | HR @1|5|10: 0.0766 	 0.1892 	 0.2585 	
2025-08-27 02:51:43,193 | NDCG @5|10: 0.1340 	 0.1564
2025-08-27 02:51:43,193 | domain:Games
2025-08-27 02:51:43,193 | model_moe:
2025-08-27 02:51:43,194 | MRR: 0.0644
2025-08-27 02:51:43,194 | HR @1|5|10: 0.0408 	 0.0801 	 0.0983 	
2025-08-27 02:51:43,194 | NDCG @5|10: 0.0606 	 0.0665
2025-08-27 02:51:43,195 | 	avg_model_moe:
2025-08-27 02:51:43,195 | MRR: 0.1220
2025-08-27 02:51:43,195 | HR @1|5|10: 0.0712 	 0.1646 	 0.2177 	
2025-08-27 02:51:43,195 | NDCG @5|10: 0.1189 	 0.1361
2025-08-27 02:51:43,196 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 02:51:57,950 | Epoch 9/40 - client 2 -  Training Loss: 21.712

 33%|###3      | 1/3 [00:12<00:25, 12.76s/it]2025-08-27 02:54:12,159 | Epoch 9/40 - client 0 -  Training Loss: 23.788

 67%|######6   | 2/3 [02:26<01:24, 84.20s/it]2025-08-27 02:57:26,094 | Epoch 9/40 - client 1 -  Training Loss: 22.799

100%|##########| 3/3 [05:40<00:00, 134.31s/it]
100%|##########| 3/3 [05:40<00:00, 113.63s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.52s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.01s/it]
100%|##########| 3/3 [00:15<00:00,  4.34s/it]
100%|##########| 3/3 [00:15<00:00,  5.02s/it]
2025-08-27 02:57:41,153 | Epoch9 Valid:
2025-08-27 02:57:41,153 | domain:Movies
2025-08-27 02:57:41,153 | model_moe:
2025-08-27 02:57:41,154 | MRR: 0.1692
2025-08-27 02:57:41,154 | HR @1|5|10: 0.0987 	 0.2327 	 0.3073 	
2025-08-27 02:57:41,154 | NDCG @5|10: 0.1680 	 0.1921
2025-08-27 02:57:41,154 | domain:Books
2025-08-27 02:57:41,155 | model_moe:
2025-08-27 02:57:41,155 | MRR: 0.1443
2025-08-27 02:57:41,155 | HR @1|5|10: 0.0815 	 0.1994 	 0.2681 	
2025-08-27 02:57:41,156 | NDCG @5|10: 0.1415 	 0.1636
2025-08-27 02:57:41,156 | domain:Games
2025-08-27 02:57:41,156 | model_moe:
2025-08-27 02:57:41,156 | MRR: 0.0662
2025-08-27 02:57:41,157 | HR @1|5|10: 0.0408 	 0.0815 	 0.1092 	
2025-08-27 02:57:41,157 | NDCG @5|10: 0.0614 	 0.0703
2025-08-27 02:57:41,157 | 	avg_model_moe:
2025-08-27 02:57:41,158 | MRR: 0.1266
2025-08-27 02:57:41,158 | HR @1|5|10: 0.0736 	 0.1712 	 0.2282 	
2025-08-27 02:57:41,158 | NDCG @5|10: 0.1236 	 0.1420
2025-08-27 02:57:41,158 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:00:56,810 | Epoch 10/40 - client 1 -  Training Loss: 22.525

 33%|###3      | 1/3 [03:13<06:27, 193.78s/it]2025-08-27 03:03:10,856 | Epoch 10/40 - client 0 -  Training Loss: 23.568

 67%|######6   | 2/3 [05:27<02:38, 158.64s/it]2025-08-27 03:03:23,472 | Epoch 10/40 - client 2 -  Training Loss: 21.507

100%|##########| 3/3 [05:40<00:00, 91.96s/it] 
100%|##########| 3/3 [05:40<00:00, 113.48s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.45s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.93s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-27 03:03:38,376 | Epoch10 Valid:
2025-08-27 03:03:38,377 | domain:Movies
2025-08-27 03:03:38,377 | model_moe:
2025-08-27 03:03:38,377 | MRR: 0.1735
2025-08-27 03:03:38,377 | HR @1|5|10: 0.1018 	 0.2410 	 0.3134 	
2025-08-27 03:03:38,378 | NDCG @5|10: 0.1735 	 0.1969
2025-08-27 03:03:38,378 | domain:Books
2025-08-27 03:03:38,378 | model_moe:
2025-08-27 03:03:38,379 | MRR: 0.1510
2025-08-27 03:03:38,379 | HR @1|5|10: 0.0865 	 0.2078 	 0.2790 	
2025-08-27 03:03:38,379 | NDCG @5|10: 0.1483 	 0.1713
2025-08-27 03:03:38,379 | domain:Games
2025-08-27 03:03:38,380 | model_moe:
2025-08-27 03:03:38,380 | MRR: 0.0732
2025-08-27 03:03:38,380 | HR @1|5|10: 0.0473 	 0.0888 	 0.1143 	
2025-08-27 03:03:38,381 | NDCG @5|10: 0.0683 	 0.0766
2025-08-27 03:03:38,381 | 	avg_model_moe:
2025-08-27 03:03:38,381 | MRR: 0.1325
2025-08-27 03:03:38,383 | HR @1|5|10: 0.0785 	 0.1792 	 0.2356 	
2025-08-27 03:03:38,383 | NDCG @5|10: 0.1300 	 0.1483
2025-08-27 03:03:38,383 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:03:52,992 | Epoch 11/40 - client 2 -  Training Loss: 21.295

 33%|###3      | 1/3 [00:12<00:25, 12.76s/it]2025-08-27 03:06:07,371 | Epoch 11/40 - client 0 -  Training Loss: 23.365

 67%|######6   | 2/3 [02:27<01:24, 84.30s/it]2025-08-27 03:09:20,879 | Epoch 11/40 - client 1 -  Training Loss: 22.256

100%|##########| 3/3 [05:40<00:00, 134.17s/it]
100%|##########| 3/3 [05:40<00:00, 113.55s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.48s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.00s/it]
100%|##########| 3/3 [00:15<00:00,  4.34s/it]
100%|##########| 3/3 [00:15<00:00,  5.01s/it]
2025-08-27 03:09:35,941 | Epoch11 Valid:
2025-08-27 03:09:35,942 | domain:Movies
2025-08-27 03:09:35,942 | model_moe:
2025-08-27 03:09:35,942 | MRR: 0.1763
2025-08-27 03:09:35,943 | HR @1|5|10: 0.1045 	 0.2436 	 0.3178 	
2025-08-27 03:09:35,943 | NDCG @5|10: 0.1761 	 0.2001
2025-08-27 03:09:35,943 | domain:Books
2025-08-27 03:09:35,943 | model_moe:
2025-08-27 03:09:35,944 | MRR: 0.1559
2025-08-27 03:09:35,944 | HR @1|5|10: 0.0907 	 0.2136 	 0.2858 	
2025-08-27 03:09:35,944 | NDCG @5|10: 0.1535 	 0.1768
2025-08-27 03:09:35,944 | domain:Games
2025-08-27 03:09:35,945 | model_moe:
2025-08-27 03:09:35,945 | MRR: 0.0755
2025-08-27 03:09:35,945 | HR @1|5|10: 0.0466 	 0.0961 	 0.1157 	
2025-08-27 03:09:35,946 | NDCG @5|10: 0.0723 	 0.0785
2025-08-27 03:09:35,948 | 	avg_model_moe:
2025-08-27 03:09:35,948 | MRR: 0.1359
2025-08-27 03:09:35,949 | HR @1|5|10: 0.0806 	 0.1844 	 0.2398 	
2025-08-27 03:09:35,949 | NDCG @5|10: 0.1339 	 0.1518
2025-08-27 03:09:35,949 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:09:50,486 | Epoch 12/40 - client 2 -  Training Loss: 21.089

 33%|###3      | 1/3 [00:12<00:25, 12.74s/it]2025-08-27 03:13:03,912 | Epoch 12/40 - client 1 -  Training Loss: 21.992

 67%|######6   | 2/3 [03:26<01:59, 119.03s/it]2025-08-27 03:15:17,935 | Epoch 12/40 - client 0 -  Training Loss: 23.163

100%|##########| 3/3 [05:40<00:00, 125.87s/it]
100%|##########| 3/3 [05:40<00:00, 113.40s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.56s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.08s/it]
100%|##########| 3/3 [00:15<00:00,  4.38s/it]
100%|##########| 3/3 [00:15<00:00,  5.05s/it]
2025-08-27 03:15:33,111 | Epoch12 Valid:
2025-08-27 03:15:33,111 | domain:Movies
2025-08-27 03:15:33,112 | model_moe:
2025-08-27 03:15:33,112 | MRR: 0.1789
2025-08-27 03:15:33,112 | HR @1|5|10: 0.1064 	 0.2496 	 0.3204 	
2025-08-27 03:15:33,113 | NDCG @5|10: 0.1797 	 0.2026
2025-08-27 03:15:33,113 | domain:Books
2025-08-27 03:15:33,113 | model_moe:
2025-08-27 03:15:33,114 | MRR: 0.1592
2025-08-27 03:15:33,114 | HR @1|5|10: 0.0929 	 0.2182 	 0.2940 	
2025-08-27 03:15:33,114 | NDCG @5|10: 0.1568 	 0.1812
2025-08-27 03:15:33,116 | domain:Games
2025-08-27 03:15:33,116 | model_moe:
2025-08-27 03:15:33,116 | MRR: 0.0773
2025-08-27 03:15:33,116 | HR @1|5|10: 0.0488 	 0.0932 	 0.1230 	
2025-08-27 03:15:33,117 | NDCG @5|10: 0.0719 	 0.0815
2025-08-27 03:15:33,117 | 	avg_model_moe:
2025-08-27 03:15:33,117 | MRR: 0.1385
2025-08-27 03:15:33,118 | HR @1|5|10: 0.0827 	 0.1870 	 0.2458 	
2025-08-27 03:15:33,118 | NDCG @5|10: 0.1361 	 0.1551
2025-08-27 03:15:33,118 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:17:48,752 | Epoch 13/40 - client 0 -  Training Loss: 22.978

 33%|###3      | 1/3 [02:13<04:27, 133.81s/it]2025-08-27 03:18:01,439 | Epoch 13/40 - client 2 -  Training Loss: 20.904

 67%|######6   | 2/3 [02:26<01:02, 62.56s/it] 2025-08-27 03:21:14,736 | Epoch 13/40 - client 1 -  Training Loss: 21.749

100%|##########| 3/3 [05:39<00:00, 122.26s/it]
100%|##########| 3/3 [05:39<00:00, 113.26s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.43s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.94s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-27 03:21:29,628 | Epoch13 Valid:
2025-08-27 03:21:29,629 | domain:Movies
2025-08-27 03:21:29,629 | model_moe:
2025-08-27 03:21:29,629 | MRR: 0.1810
2025-08-27 03:21:29,629 | HR @1|5|10: 0.1075 	 0.2512 	 0.3237 	
2025-08-27 03:21:29,630 | NDCG @5|10: 0.1815 	 0.2050
2025-08-27 03:21:29,630 | domain:Books
2025-08-27 03:21:29,630 | model_moe:
2025-08-27 03:21:29,631 | MRR: 0.1627
2025-08-27 03:21:29,631 | HR @1|5|10: 0.0956 	 0.2201 	 0.2976 	
2025-08-27 03:21:29,631 | NDCG @5|10: 0.1597 	 0.1848
2025-08-27 03:21:29,631 | domain:Games
2025-08-27 03:21:29,632 | model_moe:
2025-08-27 03:21:29,632 | MRR: 0.0805
2025-08-27 03:21:29,632 | HR @1|5|10: 0.0502 	 0.0990 	 0.1274 	
2025-08-27 03:21:29,633 | NDCG @5|10: 0.0757 	 0.0849
2025-08-27 03:21:29,633 | 	avg_model_moe:
2025-08-27 03:21:29,633 | MRR: 0.1414
2025-08-27 03:21:29,634 | HR @1|5|10: 0.0844 	 0.1901 	 0.2496 	
2025-08-27 03:21:29,634 | NDCG @5|10: 0.1390 	 0.1582
2025-08-27 03:21:29,634 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:21:44,040 | Epoch 14/40 - client 2 -  Training Loss: 20.744

 33%|###3      | 1/3 [00:12<00:25, 12.58s/it]2025-08-27 03:23:56,947 | Epoch 14/40 - client 0 -  Training Loss: 22.786

 67%|######6   | 2/3 [02:25<01:23, 83.36s/it]2025-08-27 03:27:09,096 | Epoch 14/40 - client 1 -  Training Loss: 21.511

100%|##########| 3/3 [05:37<00:00, 133.04s/it]
100%|##########| 3/3 [05:37<00:00, 112.54s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.43s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.91s/it]
100%|##########| 3/3 [00:14<00:00,  4.27s/it]
100%|##########| 3/3 [00:14<00:00,  4.94s/it]
2025-08-27 03:27:23,916 | Epoch14 Valid:
2025-08-27 03:27:23,916 | domain:Movies
2025-08-27 03:27:23,917 | model_moe:
2025-08-27 03:27:23,917 | MRR: 0.1828
2025-08-27 03:27:23,917 | HR @1|5|10: 0.1099 	 0.2534 	 0.3260 	
2025-08-27 03:27:23,917 | NDCG @5|10: 0.1836 	 0.2070
2025-08-27 03:27:23,918 | domain:Books
2025-08-27 03:27:23,918 | model_moe:
2025-08-27 03:27:23,918 | MRR: 0.1635
2025-08-27 03:27:23,919 | HR @1|5|10: 0.0953 	 0.2239 	 0.3013 	
2025-08-27 03:27:23,919 | NDCG @5|10: 0.1613 	 0.1864
2025-08-27 03:27:23,919 | domain:Games
2025-08-27 03:27:23,919 | model_moe:
2025-08-27 03:27:23,920 | MRR: 0.0845
2025-08-27 03:27:23,920 | HR @1|5|10: 0.0546 	 0.1033 	 0.1325 	
2025-08-27 03:27:23,920 | NDCG @5|10: 0.0795 	 0.0890
2025-08-27 03:27:23,920 | 	avg_model_moe:
2025-08-27 03:27:23,921 | MRR: 0.1436
2025-08-27 03:27:23,921 | HR @1|5|10: 0.0866 	 0.1935 	 0.2533 	
2025-08-27 03:27:23,921 | NDCG @5|10: 0.1415 	 0.1608
2025-08-27 03:27:23,922 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:29:39,176 | Epoch 15/40 - client 0 -  Training Loss: 22.604

 33%|###3      | 1/3 [02:13<04:26, 133.29s/it]2025-08-27 03:29:51,776 | Epoch 15/40 - client 2 -  Training Loss: 20.592

 67%|######6   | 2/3 [02:25<01:02, 62.30s/it] 2025-08-27 03:33:04,401 | Epoch 15/40 - client 1 -  Training Loss: 21.276

100%|##########| 3/3 [05:38<00:00, 121.81s/it]
100%|##########| 3/3 [05:38<00:00, 112.84s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.43s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.92s/it]
100%|##########| 3/3 [00:14<00:00,  4.28s/it]
100%|##########| 3/3 [00:14<00:00,  4.94s/it]
2025-08-27 03:33:19,251 | Epoch15 Valid:
2025-08-27 03:33:19,252 | domain:Movies
2025-08-27 03:33:19,252 | model_moe:
2025-08-27 03:33:19,252 | MRR: 0.1840
2025-08-27 03:33:19,253 | HR @1|5|10: 0.1107 	 0.2534 	 0.3289 	
2025-08-27 03:33:19,253 | NDCG @5|10: 0.1843 	 0.2087
2025-08-27 03:33:19,253 | domain:Books
2025-08-27 03:33:19,254 | model_moe:
2025-08-27 03:33:19,254 | MRR: 0.1652
2025-08-27 03:33:19,254 | HR @1|5|10: 0.0976 	 0.2248 	 0.3015 	
2025-08-27 03:33:19,254 | NDCG @5|10: 0.1628 	 0.1877
2025-08-27 03:33:19,255 | domain:Games
2025-08-27 03:33:19,255 | model_moe:
2025-08-27 03:33:19,255 | MRR: 0.0849
2025-08-27 03:33:19,255 | HR @1|5|10: 0.0546 	 0.1026 	 0.1368 	
2025-08-27 03:33:19,256 | NDCG @5|10: 0.0794 	 0.0906
2025-08-27 03:33:19,256 | 	avg_model_moe:
2025-08-27 03:33:19,256 | MRR: 0.1447
2025-08-27 03:33:19,257 | HR @1|5|10: 0.0876 	 0.1936 	 0.2557 	
2025-08-27 03:33:19,257 | NDCG @5|10: 0.1422 	 0.1623
2025-08-27 03:33:19,257 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:33:33,992 | Epoch 16/40 - client 2 -  Training Loss: 20.451

 33%|###3      | 1/3 [00:12<00:25, 12.66s/it]2025-08-27 03:36:46,605 | Epoch 16/40 - client 1 -  Training Loss: 21.047

 67%|######6   | 2/3 [03:25<01:58, 118.52s/it]2025-08-27 03:39:00,030 | Epoch 16/40 - client 0 -  Training Loss: 22.429

100%|##########| 3/3 [05:38<00:00, 125.33s/it]
100%|##########| 3/3 [05:38<00:00, 112.90s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.48s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.99s/it]
100%|##########| 3/3 [00:14<00:00,  4.32s/it]
100%|##########| 3/3 [00:14<00:00,  4.99s/it]
2025-08-27 03:39:15,023 | Epoch16 Valid:
2025-08-27 03:39:15,023 | domain:Movies
2025-08-27 03:39:15,024 | model_moe:
2025-08-27 03:39:15,024 | MRR: 0.1850
2025-08-27 03:39:15,024 | HR @1|5|10: 0.1113 	 0.2556 	 0.3305 	
2025-08-27 03:39:15,025 | NDCG @5|10: 0.1856 	 0.2098
2025-08-27 03:39:15,027 | domain:Books
2025-08-27 03:39:15,028 | model_moe:
2025-08-27 03:39:15,028 | MRR: 0.1664
2025-08-27 03:39:15,028 | HR @1|5|10: 0.0989 	 0.2261 	 0.3035 	
2025-08-27 03:39:15,028 | NDCG @5|10: 0.1641 	 0.1891
2025-08-27 03:39:15,029 | domain:Games
2025-08-27 03:39:15,029 | model_moe:
2025-08-27 03:39:15,029 | MRR: 0.0842
2025-08-27 03:39:15,030 | HR @1|5|10: 0.0502 	 0.1077 	 0.1426 	
2025-08-27 03:39:15,030 | NDCG @5|10: 0.0802 	 0.0915
2025-08-27 03:39:15,030 | 	avg_model_moe:
2025-08-27 03:39:15,030 | MRR: 0.1452
2025-08-27 03:39:15,031 | HR @1|5|10: 0.0868 	 0.1965 	 0.2589 	
2025-08-27 03:39:15,031 | NDCG @5|10: 0.1433 	 0.1635
2025-08-27 03:39:15,032 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:39:29,582 | Epoch 17/40 - client 2 -  Training Loss: 20.299

 33%|###3      | 1/3 [00:12<00:25, 12.65s/it]2025-08-27 03:42:42,198 | Epoch 17/40 - client 1 -  Training Loss: 20.834

 67%|######6   | 2/3 [03:25<01:58, 118.52s/it]2025-08-27 03:44:55,863 | Epoch 17/40 - client 0 -  Training Loss: 22.258

100%|##########| 3/3 [05:38<00:00, 125.43s/it]
100%|##########| 3/3 [05:38<00:00, 112.98s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.47s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.95s/it]
100%|##########| 3/3 [00:14<00:00,  4.30s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-27 03:45:10,777 | Epoch17 Valid:
2025-08-27 03:45:10,778 | domain:Movies
2025-08-27 03:45:10,778 | model_moe:
2025-08-27 03:45:10,778 | MRR: 0.1850
2025-08-27 03:45:10,778 | HR @1|5|10: 0.1107 	 0.2564 	 0.3278 	
2025-08-27 03:45:10,779 | NDCG @5|10: 0.1860 	 0.2091
2025-08-27 03:45:10,779 | domain:Books
2025-08-27 03:45:10,779 | model_moe:
2025-08-27 03:45:10,780 | MRR: 0.1663
2025-08-27 03:45:10,780 | HR @1|5|10: 0.0984 	 0.2277 	 0.3044 	
2025-08-27 03:45:10,780 | NDCG @5|10: 0.1645 	 0.1894
2025-08-27 03:45:10,780 | domain:Games
2025-08-27 03:45:10,781 | model_moe:
2025-08-27 03:45:10,781 | MRR: 0.0877
2025-08-27 03:45:10,781 | HR @1|5|10: 0.0539 	 0.1092 	 0.1492 	
2025-08-27 03:45:10,782 | NDCG @5|10: 0.0828 	 0.0958
2025-08-27 03:45:10,782 | 	avg_model_moe:
2025-08-27 03:45:10,782 | MRR: 0.1463
2025-08-27 03:45:10,785 | HR @1|5|10: 0.0876 	 0.1978 	 0.2605 	
2025-08-27 03:45:10,785 | NDCG @5|10: 0.1445 	 0.1648
2025-08-27 03:45:10,785 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:47:26,304 | Epoch 18/40 - client 0 -  Training Loss: 22.098

 33%|###3      | 1/3 [02:13<04:26, 133.45s/it]2025-08-27 03:50:39,037 | Epoch 18/40 - client 1 -  Training Loss: 20.639

 67%|######6   | 2/3 [05:26<02:48, 168.32s/it]2025-08-27 03:50:51,669 | Epoch 18/40 - client 2 -  Training Loss: 20.164

100%|##########| 3/3 [05:38<00:00, 97.23s/it] 
100%|##########| 3/3 [05:38<00:00, 112.94s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.44s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.93s/it]
100%|##########| 3/3 [00:14<00:00,  4.29s/it]
100%|##########| 3/3 [00:14<00:00,  4.95s/it]
2025-08-27 03:51:06,545 | Epoch18 Valid:
2025-08-27 03:51:06,545 | domain:Movies
2025-08-27 03:51:06,545 | model_moe:
2025-08-27 03:51:06,546 | MRR: 0.1854
2025-08-27 03:51:06,546 | HR @1|5|10: 0.1109 	 0.2550 	 0.3292 	
2025-08-27 03:51:06,546 | NDCG @5|10: 0.1857 	 0.2098
2025-08-27 03:51:06,546 | domain:Books
2025-08-27 03:51:06,547 | model_moe:
2025-08-27 03:51:06,547 | MRR: 0.1650
2025-08-27 03:51:06,547 | HR @1|5|10: 0.0968 	 0.2268 	 0.3016 	
2025-08-27 03:51:06,548 | NDCG @5|10: 0.1634 	 0.1876
2025-08-27 03:51:06,549 | domain:Games
2025-08-27 03:51:06,549 | model_moe:
2025-08-27 03:51:06,549 | MRR: 0.0884
2025-08-27 03:51:06,550 | HR @1|5|10: 0.0553 	 0.1114 	 0.1507 	
2025-08-27 03:51:06,550 | NDCG @5|10: 0.0839 	 0.0966
2025-08-27 03:51:06,550 | 	avg_model_moe:
2025-08-27 03:51:06,551 | MRR: 0.1463
2025-08-27 03:51:06,551 | HR @1|5|10: 0.0877 	 0.1977 	 0.2605 	
2025-08-27 03:51:06,551 | NDCG @5|10: 0.1443 	 0.1647
2025-08-27 03:51:06,552 | Early Stopping counter: 1 out of 5
2025-08-27 03:51:06,552 | Learning rate decay counter: 1 out of 1
2025-08-27 03:51:06,552 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:51:19,275 | Epoch 19/40 - client 2 -  Training Loss: 20.028

 33%|###3      | 1/3 [00:12<00:25, 12.72s/it]2025-08-27 03:54:31,859 | Epoch 19/40 - client 1 -  Training Loss: 20.464

 67%|######6   | 2/3 [03:25<01:58, 118.52s/it]2025-08-27 03:56:45,421 | Epoch 19/40 - client 0 -  Training Loss: 21.952

100%|##########| 3/3 [05:38<00:00, 125.39s/it]
100%|##########| 3/3 [05:38<00:00, 112.96s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.46s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.94s/it]
100%|##########| 3/3 [00:14<00:00,  4.29s/it]
100%|##########| 3/3 [00:14<00:00,  4.96s/it]
2025-08-27 03:57:00,311 | Epoch19 Valid:
2025-08-27 03:57:00,311 | domain:Movies
2025-08-27 03:57:00,312 | model_moe:
2025-08-27 03:57:00,312 | MRR: 0.1861
2025-08-27 03:57:00,312 | HR @1|5|10: 0.1124 	 0.2566 	 0.3304 	
2025-08-27 03:57:00,312 | NDCG @5|10: 0.1869 	 0.2106
2025-08-27 03:57:00,313 | domain:Books
2025-08-27 03:57:00,313 | model_moe:
2025-08-27 03:57:00,313 | MRR: 0.1649
2025-08-27 03:57:00,313 | HR @1|5|10: 0.0967 	 0.2270 	 0.3000 	
2025-08-27 03:57:00,314 | NDCG @5|10: 0.1635 	 0.1871
2025-08-27 03:57:00,314 | domain:Games
2025-08-27 03:57:00,314 | model_moe:
2025-08-27 03:57:00,315 | MRR: 0.0900
2025-08-27 03:57:00,315 | HR @1|5|10: 0.0560 	 0.1135 	 0.1514 	
2025-08-27 03:57:00,315 | NDCG @5|10: 0.0857 	 0.0978
2025-08-27 03:57:00,315 | 	avg_model_moe:
2025-08-27 03:57:00,316 | MRR: 0.1470
2025-08-27 03:57:00,316 | HR @1|5|10: 0.0884 	 0.1990 	 0.2606 	
2025-08-27 03:57:00,316 | NDCG @5|10: 0.1453 	 0.1652
2025-08-27 03:57:00,317 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 03:57:14,786 | Epoch 20/40 - client 2 -  Training Loss: 19.914

 33%|###3      | 1/3 [00:12<00:24, 12.46s/it]2025-08-27 03:59:27,459 | Epoch 20/40 - client 0 -  Training Loss: 21.802

 67%|######6   | 2/3 [02:25<01:23, 83.17s/it]2025-08-27 04:02:39,368 | Epoch 20/40 - client 1 -  Training Loss: 20.298

100%|##########| 3/3 [05:37<00:00, 132.82s/it]
100%|##########| 3/3 [05:37<00:00, 112.35s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.41s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.88s/it]
100%|##########| 3/3 [00:14<00:00,  4.26s/it]
100%|##########| 3/3 [00:14<00:00,  4.92s/it]
2025-08-27 04:02:54,131 | Epoch20 Valid:
2025-08-27 04:02:54,132 | domain:Movies
2025-08-27 04:02:54,132 | model_moe:
2025-08-27 04:02:54,132 | MRR: 0.1852
2025-08-27 04:02:54,133 | HR @1|5|10: 0.1115 	 0.2531 	 0.3270 	
2025-08-27 04:02:54,133 | NDCG @5|10: 0.1851 	 0.2091
2025-08-27 04:02:54,133 | domain:Books
2025-08-27 04:02:54,133 | model_moe:
2025-08-27 04:02:54,134 | MRR: 0.1637
2025-08-27 04:02:54,134 | HR @1|5|10: 0.0956 	 0.2249 	 0.3023 	
2025-08-27 04:02:54,134 | NDCG @5|10: 0.1619 	 0.1869
2025-08-27 04:02:54,135 | domain:Games
2025-08-27 04:02:54,135 | model_moe:
2025-08-27 04:02:54,135 | MRR: 0.0892
2025-08-27 04:02:54,135 | HR @1|5|10: 0.0553 	 0.1179 	 0.1536 	
2025-08-27 04:02:54,136 | NDCG @5|10: 0.0863 	 0.0979
2025-08-27 04:02:54,136 | 	avg_model_moe:
2025-08-27 04:02:54,136 | MRR: 0.1460
2025-08-27 04:02:54,136 | HR @1|5|10: 0.0875 	 0.1986 	 0.2610 	
2025-08-27 04:02:54,137 | NDCG @5|10: 0.1444 	 0.1646
2025-08-27 04:02:54,137 | Early Stopping counter: 1 out of 5
2025-08-27 04:02:54,137 | Learning rate decay counter: 1 out of 1
2025-08-27 04:02:54,137 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:03:06,637 | Epoch 21/40 - client 2 -  Training Loss: 19.803

 33%|###3      | 1/3 [00:12<00:24, 12.50s/it]2025-08-27 04:05:19,546 | Epoch 21/40 - client 0 -  Training Loss: 21.666

 67%|######6   | 2/3 [02:25<01:23, 83.33s/it]2025-08-27 04:08:31,643 | Epoch 21/40 - client 1 -  Training Loss: 20.144

100%|##########| 3/3 [05:37<00:00, 133.00s/it]
100%|##########| 3/3 [05:37<00:00, 112.51s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.42s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.91s/it]
100%|##########| 3/3 [00:14<00:00,  4.27s/it]
100%|##########| 3/3 [00:14<00:00,  4.93s/it]
2025-08-27 04:08:46,465 | Epoch21 Valid:
2025-08-27 04:08:46,466 | domain:Movies
2025-08-27 04:08:46,466 | model_moe:
2025-08-27 04:08:46,466 | MRR: 0.1851
2025-08-27 04:08:46,466 | HR @1|5|10: 0.1102 	 0.2552 	 0.3295 	
2025-08-27 04:08:46,467 | NDCG @5|10: 0.1858 	 0.2097
2025-08-27 04:08:46,467 | domain:Books
2025-08-27 04:08:46,467 | model_moe:
2025-08-27 04:08:46,468 | MRR: 0.1634
2025-08-27 04:08:46,469 | HR @1|5|10: 0.0949 	 0.2256 	 0.2997 	
2025-08-27 04:08:46,469 | NDCG @5|10: 0.1619 	 0.1860
2025-08-27 04:08:46,470 | domain:Games
2025-08-27 04:08:46,470 | model_moe:
2025-08-27 04:08:46,470 | MRR: 0.0910
2025-08-27 04:08:46,470 | HR @1|5|10: 0.0575 	 0.1157 	 0.1514 	
2025-08-27 04:08:46,471 | NDCG @5|10: 0.0869 	 0.0985
2025-08-27 04:08:46,472 | 	avg_model_moe:
2025-08-27 04:08:46,472 | MRR: 0.1465
2025-08-27 04:08:46,473 | HR @1|5|10: 0.0875 	 0.1988 	 0.2602 	
2025-08-27 04:08:46,473 | NDCG @5|10: 0.1449 	 0.1647
2025-08-27 04:08:46,473 | Early Stopping counter: 2 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:10:59,324 | Epoch 22/40 - client 0 -  Training Loss: 21.535

 33%|###3      | 1/3 [02:12<04:25, 132.86s/it]2025-08-27 04:11:11,832 | Epoch 22/40 - client 2 -  Training Loss: 19.706

 67%|######6   | 2/3 [02:25<01:02, 62.06s/it] 2025-08-27 04:14:23,857 | Epoch 22/40 - client 1 -  Training Loss: 20.002

100%|##########| 3/3 [05:37<00:00, 121.41s/it]
100%|##########| 3/3 [05:37<00:00, 112.46s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.42s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.91s/it]
100%|##########| 3/3 [00:14<00:00,  4.27s/it]
100%|##########| 3/3 [00:14<00:00,  4.94s/it]
2025-08-27 04:14:38,697 | Epoch22 Valid:
2025-08-27 04:14:38,698 | domain:Movies
2025-08-27 04:14:38,703 | model_moe:
2025-08-27 04:14:38,703 | MRR: 0.1844
2025-08-27 04:14:38,703 | HR @1|5|10: 0.1111 	 0.2522 	 0.3285 	
2025-08-27 04:14:38,703 | NDCG @5|10: 0.1843 	 0.2089
2025-08-27 04:14:38,704 | domain:Books
2025-08-27 04:14:38,704 | model_moe:
2025-08-27 04:14:38,704 | MRR: 0.1634
2025-08-27 04:14:38,705 | HR @1|5|10: 0.0961 	 0.2207 	 0.2998 	
2025-08-27 04:14:38,705 | NDCG @5|10: 0.1603 	 0.1861
2025-08-27 04:14:38,705 | domain:Games
2025-08-27 04:14:38,705 | model_moe:
2025-08-27 04:14:38,706 | MRR: 0.0892
2025-08-27 04:14:38,706 | HR @1|5|10: 0.0539 	 0.1143 	 0.1550 	
2025-08-27 04:14:38,706 | NDCG @5|10: 0.0850 	 0.0981
2025-08-27 04:14:38,708 | 	avg_model_moe:
2025-08-27 04:14:38,709 | MRR: 0.1457
2025-08-27 04:14:38,709 | HR @1|5|10: 0.0870 	 0.1957 	 0.2611 	
2025-08-27 04:14:38,709 | NDCG @5|10: 0.1432 	 0.1644
2025-08-27 04:14:38,709 | Early Stopping counter: 3 out of 5
2025-08-27 04:14:38,710 | Learning rate decay counter: 1 out of 1
2025-08-27 04:14:38,710 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:14:51,222 | Epoch 23/40 - client 2 -  Training Loss: 19.594

 33%|###3      | 1/3 [00:12<00:25, 12.51s/it]2025-08-27 04:18:03,264 | Epoch 23/40 - client 1 -  Training Loss: 19.872

 67%|######6   | 2/3 [03:24<01:58, 118.12s/it]2025-08-27 04:20:16,145 | Epoch 23/40 - client 0 -  Training Loss: 21.413

100%|##########| 3/3 [05:37<00:00, 124.86s/it]
100%|##########| 3/3 [05:37<00:00, 112.48s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.42s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.92s/it]
100%|##########| 3/3 [00:14<00:00,  4.27s/it]
100%|##########| 3/3 [00:14<00:00,  4.93s/it]
2025-08-27 04:20:30,961 | Epoch23 Valid:
2025-08-27 04:20:30,963 | domain:Movies
2025-08-27 04:20:30,963 | model_moe:
2025-08-27 04:20:30,963 | MRR: 0.1842
2025-08-27 04:20:30,963 | HR @1|5|10: 0.1100 	 0.2526 	 0.3274 	
2025-08-27 04:20:30,964 | NDCG @5|10: 0.1843 	 0.2085
2025-08-27 04:20:30,964 | domain:Books
2025-08-27 04:20:30,964 | model_moe:
2025-08-27 04:20:30,965 | MRR: 0.1622
2025-08-27 04:20:30,965 | HR @1|5|10: 0.0948 	 0.2210 	 0.2983 	
2025-08-27 04:20:30,965 | NDCG @5|10: 0.1598 	 0.1849
2025-08-27 04:20:30,965 | domain:Games
2025-08-27 04:20:30,966 | model_moe:
2025-08-27 04:20:30,966 | MRR: 0.0901
2025-08-27 04:20:30,966 | HR @1|5|10: 0.0546 	 0.1186 	 0.1521 	
2025-08-27 04:20:30,966 | NDCG @5|10: 0.0872 	 0.0978
2025-08-27 04:20:30,967 | 	avg_model_moe:
2025-08-27 04:20:30,967 | MRR: 0.1455
2025-08-27 04:20:30,967 | HR @1|5|10: 0.0865 	 0.1974 	 0.2593 	
2025-08-27 04:20:30,967 | NDCG @5|10: 0.1438 	 0.1637
2025-08-27 04:20:30,968 | Early Stopping counter: 4 out of 5
2025-08-27 04:20:30,968 | Learning rate decay counter: 1 out of 1
2025-08-27 04:20:30,968 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:23:42,740 | Epoch 24/40 - client 1 -  Training Loss: 19.746

 33%|###3      | 1/3 [03:11<06:23, 191.77s/it]2025-08-27 04:25:55,493 | Epoch 24/40 - client 0 -  Training Loss: 21.290

 67%|######6   | 2/3 [05:24<02:37, 157.05s/it]2025-08-27 04:26:07,956 | Epoch 24/40 - client 2 -  Training Loss: 19.502

100%|##########| 3/3 [05:36<00:00, 91.03s/it] 
100%|##########| 3/3 [05:36<00:00, 112.33s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.39s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.87s/it]
100%|##########| 3/3 [00:14<00:00,  4.35s/it]
100%|##########| 3/3 [00:14<00:00,  4.98s/it]
2025-08-27 04:26:22,915 | Epoch24 Valid:
2025-08-27 04:26:22,915 | domain:Movies
2025-08-27 04:26:22,915 | model_moe:
2025-08-27 04:26:22,916 | MRR: 0.1836
2025-08-27 04:26:22,916 | HR @1|5|10: 0.1109 	 0.2511 	 0.3260 	
2025-08-27 04:26:22,916 | NDCG @5|10: 0.1835 	 0.2077
2025-08-27 04:26:22,917 | domain:Books
2025-08-27 04:26:22,917 | model_moe:
2025-08-27 04:26:22,917 | MRR: 0.1617
2025-08-27 04:26:22,917 | HR @1|5|10: 0.0946 	 0.2203 	 0.2981 	
2025-08-27 04:26:22,918 | NDCG @5|10: 0.1593 	 0.1844
2025-08-27 04:26:22,918 | domain:Games
2025-08-27 04:26:22,918 | model_moe:
2025-08-27 04:26:22,918 | MRR: 0.0902
2025-08-27 04:26:22,919 | HR @1|5|10: 0.0539 	 0.1150 	 0.1572 	
2025-08-27 04:26:22,919 | NDCG @5|10: 0.0858 	 0.0994
2025-08-27 04:26:22,919 | 	avg_model_moe:
2025-08-27 04:26:22,919 | MRR: 0.1452
2025-08-27 04:26:22,920 | HR @1|5|10: 0.0864 	 0.1955 	 0.2604 	
2025-08-27 04:26:22,920 | NDCG @5|10: 0.1429 	 0.1638
2025-08-27 04:26:22,920 | Early Stopping counter: 5 out of 5
2025-08-27 04:26:22,921 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:10<00:20, 10.04s/it]
 67%|######6   | 2/3 [00:21<00:11, 11.01s/it]
100%|##########| 3/3 [00:24<00:00,  7.13s/it]
100%|##########| 3/3 [00:24<00:00,  8.08s/it]
2025-08-27 04:26:47,154 | Test:
2025-08-27 04:26:47,154 | domain:Movies
2025-08-27 04:26:47,154 | model_moe:
2025-08-27 04:26:47,155 | MRR: 0.1832
2025-08-27 04:26:47,155 | HR @1|5|10: 0.1099 	 0.2521 	 0.3291 	
2025-08-27 04:26:47,155 | NDCG @5|10: 0.1837 	 0.2086
2025-08-27 04:26:47,155 | domain:Books
2025-08-27 04:26:47,156 | model_moe:
2025-08-27 04:26:47,156 | MRR: 0.1355
2025-08-27 04:26:47,156 | HR @1|5|10: 0.0803 	 0.1792 	 0.2462 	
2025-08-27 04:26:47,157 | NDCG @5|10: 0.1310 	 0.1528
2025-08-27 04:26:47,157 | domain:Games
2025-08-27 04:26:47,157 | model_moe:
2025-08-27 04:26:47,157 | MRR: 0.0643
2025-08-27 04:26:47,158 | HR @1|5|10: 0.0374 	 0.0810 	 0.1087 	
2025-08-27 04:26:47,158 | NDCG @5|10: 0.0600 	 0.0688
2025-08-27 04:26:47,158 | 	avg_model_moe:
2025-08-27 04:26:47,158 | MRR: 0.1276
2025-08-27 04:26:47,159 | HR @1|5|10: 0.0759 	 0.1708 	 0.2280 	
2025-08-27 04:26:47,159 | NDCG @5|10: 0.1249 	 0.1434
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 04:29:51,305 | Running with the following configs:
	domains : ['Sports', 'Garden', 'Home']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 0.1
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 04:30:29,277 | Epoch 1/40 - client 1 -  Training Loss: 13.786

 33%|###3      | 1/3 [00:37<01:15, 37.72s/it]2025-08-27 04:32:15,604 | Epoch 1/40 - client 2 -  Training Loss: 15.907

 67%|######6   | 2/3 [02:24<01:18, 78.08s/it]2025-08-27 04:35:18,564 | Epoch 1/40 - client 0 -  Training Loss: 16.518

100%|##########| 3/3 [05:27<00:00, 125.97s/it]
100%|##########| 3/3 [05:27<00:00, 109.00s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.71s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.24s/it]
100%|##########| 3/3 [00:18<00:00,  5.85s/it]
100%|##########| 3/3 [00:18<00:00,  6.13s/it]
2025-08-27 04:35:36,993 | Epoch1 Valid:
2025-08-27 04:35:36,994 | domain:Sports
2025-08-27 04:35:36,994 | model_moe:
2025-08-27 04:35:36,994 | MRR: 0.0263
2025-08-27 04:35:36,995 | HR @1|5|10: 0.0155 	 0.0283 	 0.0381 	
2025-08-27 04:35:36,995 | NDCG @5|10: 0.0220 	 0.0251
2025-08-27 04:35:36,995 | domain:Garden
2025-08-27 04:35:36,996 | model_moe:
2025-08-27 04:35:36,996 | MRR: 0.0322
2025-08-27 04:35:36,996 | HR @1|5|10: 0.0182 	 0.0371 	 0.0498 	
2025-08-27 04:35:36,996 | NDCG @5|10: 0.0278 	 0.0318
2025-08-27 04:35:36,997 | domain:Home
2025-08-27 04:35:36,997 | model_moe:
2025-08-27 04:35:36,997 | MRR: 0.0340
2025-08-27 04:35:36,997 | HR @1|5|10: 0.0228 	 0.0362 	 0.0452 	
2025-08-27 04:35:36,998 | NDCG @5|10: 0.0298 	 0.0327
2025-08-27 04:35:36,998 | 	avg_model_moe:
2025-08-27 04:35:36,998 | MRR: 0.0308
2025-08-27 04:35:36,998 | HR @1|5|10: 0.0188 	 0.0339 	 0.0444 	
2025-08-27 04:35:36,999 | NDCG @5|10: 0.0265 	 0.0298
2025-08-27 04:35:36,999 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:37:25,947 | Epoch 2/40 - client 2 -  Training Loss: 13.452

 33%|###3      | 1/3 [01:46<03:32, 106.27s/it]2025-08-27 04:40:28,802 | Epoch 2/40 - client 0 -  Training Loss: 14.048

 67%|######6   | 2/3 [04:49<02:31, 151.32s/it]2025-08-27 04:40:49,714 | Epoch 2/40 - client 1 -  Training Loss: 11.315

100%|##########| 3/3 [05:10<00:00, 91.77s/it] 
100%|##########| 3/3 [05:10<00:00, 103.35s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.61s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.23s/it]
100%|##########| 3/3 [00:18<00:00,  5.95s/it]
100%|##########| 3/3 [00:18<00:00,  6.19s/it]
2025-08-27 04:41:08,307 | Epoch2 Valid:
2025-08-27 04:41:08,308 | domain:Sports
2025-08-27 04:41:08,308 | model_moe:
2025-08-27 04:41:08,308 | MRR: 0.0546
2025-08-27 04:41:08,309 | HR @1|5|10: 0.0408 	 0.0595 	 0.0700 	
2025-08-27 04:41:08,309 | NDCG @5|10: 0.0506 	 0.0540
2025-08-27 04:41:08,309 | domain:Garden
2025-08-27 04:41:08,310 | model_moe:
2025-08-27 04:41:08,310 | MRR: 0.0461
2025-08-27 04:41:08,310 | HR @1|5|10: 0.0296 	 0.0540 	 0.0651 	
2025-08-27 04:41:08,310 | NDCG @5|10: 0.0424 	 0.0460
2025-08-27 04:41:08,311 | domain:Home
2025-08-27 04:41:08,311 | model_moe:
2025-08-27 04:41:08,311 | MRR: 0.0500
2025-08-27 04:41:08,312 | HR @1|5|10: 0.0366 	 0.0540 	 0.0661 	
2025-08-27 04:41:08,312 | NDCG @5|10: 0.0455 	 0.0494
2025-08-27 04:41:08,314 | 	avg_model_moe:
2025-08-27 04:41:08,315 | MRR: 0.0502
2025-08-27 04:41:08,315 | HR @1|5|10: 0.0357 	 0.0558 	 0.0670 	
2025-08-27 04:41:08,315 | NDCG @5|10: 0.0462 	 0.0498
2025-08-27 04:41:08,315 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:42:57,013 | Epoch 3/40 - client 2 -  Training Loss: 12.281

 33%|###3      | 1/3 [01:45<03:31, 105.93s/it]2025-08-27 04:45:59,852 | Epoch 3/40 - client 0 -  Training Loss: 12.654

 67%|######6   | 2/3 [04:48<02:31, 151.17s/it]2025-08-27 04:46:20,650 | Epoch 3/40 - client 1 -  Training Loss: 10.643

100%|##########| 3/3 [05:09<00:00, 91.64s/it] 
100%|##########| 3/3 [05:09<00:00, 103.19s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.46s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.13s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.04s/it]
2025-08-27 04:46:38,784 | Epoch3 Valid:
2025-08-27 04:46:38,785 | domain:Sports
2025-08-27 04:46:38,785 | model_moe:
2025-08-27 04:46:38,785 | MRR: 0.0629
2025-08-27 04:46:38,786 | HR @1|5|10: 0.0496 	 0.0668 	 0.0775 	
2025-08-27 04:46:38,786 | NDCG @5|10: 0.0585 	 0.0620
2025-08-27 04:46:38,786 | domain:Garden
2025-08-27 04:46:38,786 | model_moe:
2025-08-27 04:46:38,787 | MRR: 0.0565
2025-08-27 04:46:38,787 | HR @1|5|10: 0.0384 	 0.0657 	 0.0774 	
2025-08-27 04:46:38,787 | NDCG @5|10: 0.0531 	 0.0568
2025-08-27 04:46:38,787 | domain:Home
2025-08-27 04:46:38,788 | model_moe:
2025-08-27 04:46:38,788 | MRR: 0.0572
2025-08-27 04:46:38,788 | HR @1|5|10: 0.0438 	 0.0614 	 0.0726 	
2025-08-27 04:46:38,788 | NDCG @5|10: 0.0530 	 0.0565
2025-08-27 04:46:38,789 | 	avg_model_moe:
2025-08-27 04:46:38,789 | MRR: 0.0589
2025-08-27 04:46:38,789 | HR @1|5|10: 0.0440 	 0.0646 	 0.0758 	
2025-08-27 04:46:38,789 | NDCG @5|10: 0.0549 	 0.0584
2025-08-27 04:46:38,790 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:48:27,463 | Epoch 4/40 - client 2 -  Training Loss: 11.097

 33%|###3      | 1/3 [01:46<03:32, 106.29s/it]2025-08-27 04:48:48,498 | Epoch 4/40 - client 1 -  Training Loss: 9.929

 67%|######6   | 2/3 [02:07<00:56, 56.14s/it] 2025-08-27 04:51:51,487 | Epoch 4/40 - client 0 -  Training Loss: 11.337

100%|##########| 3/3 [05:10<00:00, 114.06s/it]
100%|##########| 3/3 [05:10<00:00, 103.44s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.58s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.19s/it]
100%|##########| 3/3 [00:18<00:00,  5.80s/it]
100%|##########| 3/3 [00:18<00:00,  6.08s/it]
2025-08-27 04:52:09,734 | Epoch4 Valid:
2025-08-27 04:52:09,735 | domain:Sports
2025-08-27 04:52:09,735 | model_moe:
2025-08-27 04:52:09,735 | MRR: 0.0727
2025-08-27 04:52:09,736 | HR @1|5|10: 0.0581 	 0.0765 	 0.0910 	
2025-08-27 04:52:09,736 | NDCG @5|10: 0.0677 	 0.0723
2025-08-27 04:52:09,736 | domain:Garden
2025-08-27 04:52:09,736 | model_moe:
2025-08-27 04:52:09,737 | MRR: 0.0643
2025-08-27 04:52:09,737 | HR @1|5|10: 0.0468 	 0.0712 	 0.0869 	
2025-08-27 04:52:09,737 | NDCG @5|10: 0.0601 	 0.0651
2025-08-27 04:52:09,738 | domain:Home
2025-08-27 04:52:09,738 | model_moe:
2025-08-27 04:52:09,738 | MRR: 0.0649
2025-08-27 04:52:09,738 | HR @1|5|10: 0.0507 	 0.0687 	 0.0816 	
2025-08-27 04:52:09,739 | NDCG @5|10: 0.0600 	 0.0642
2025-08-27 04:52:09,739 | 	avg_model_moe:
2025-08-27 04:52:09,739 | MRR: 0.0673
2025-08-27 04:52:09,740 | HR @1|5|10: 0.0519 	 0.0722 	 0.0865 	
2025-08-27 04:52:09,740 | NDCG @5|10: 0.0626 	 0.0672
2025-08-27 04:52:09,740 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 04:55:15,350 | Epoch 5/40 - client 0 -  Training Loss: 9.939

 33%|###3      | 1/3 [03:02<06:05, 182.91s/it]2025-08-27 04:55:36,148 | Epoch 5/40 - client 1 -  Training Loss: 8.901

 67%|######6   | 2/3 [03:23<01:27, 87.55s/it] 2025-08-27 04:57:22,356 | Epoch 5/40 - client 2 -  Training Loss: 9.787

100%|##########| 3/3 [05:09<00:00, 96.07s/it]
100%|##########| 3/3 [05:09<00:00, 103.30s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.47s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.13s/it]
100%|##########| 3/3 [00:18<00:00,  5.75s/it]
100%|##########| 3/3 [00:18<00:00,  6.01s/it]
2025-08-27 04:57:40,417 | Epoch5 Valid:
2025-08-27 04:57:40,417 | domain:Sports
2025-08-27 04:57:40,417 | model_moe:
2025-08-27 04:57:40,418 | MRR: 0.0804
2025-08-27 04:57:40,418 | HR @1|5|10: 0.0652 	 0.0845 	 0.0990 	
2025-08-27 04:57:40,418 | NDCG @5|10: 0.0751 	 0.0798
2025-08-27 04:57:40,418 | domain:Garden
2025-08-27 04:57:40,419 | model_moe:
2025-08-27 04:57:40,419 | MRR: 0.0703
2025-08-27 04:57:40,419 | HR @1|5|10: 0.0540 	 0.0758 	 0.0911 	
2025-08-27 04:57:40,420 | NDCG @5|10: 0.0656 	 0.0706
2025-08-27 04:57:40,420 | domain:Home
2025-08-27 04:57:40,420 | model_moe:
2025-08-27 04:57:40,420 | MRR: 0.0718
2025-08-27 04:57:40,421 | HR @1|5|10: 0.0571 	 0.0772 	 0.0920 	
2025-08-27 04:57:40,421 | NDCG @5|10: 0.0673 	 0.0720
2025-08-27 04:57:40,421 | 	avg_model_moe:
2025-08-27 04:57:40,421 | MRR: 0.0742
2025-08-27 04:57:40,422 | HR @1|5|10: 0.0587 	 0.0792 	 0.0940 	
2025-08-27 04:57:40,422 | NDCG @5|10: 0.0693 	 0.0741
2025-08-27 04:57:40,422 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:00:45,190 | Epoch 6/40 - client 0 -  Training Loss: 8.652

 33%|###3      | 1/3 [03:02<06:04, 182.32s/it]2025-08-27 05:01:05,734 | Epoch 6/40 - client 1 -  Training Loss: 7.874

 67%|######6   | 2/3 [03:22<01:27, 87.15s/it] 2025-08-27 05:02:51,487 | Epoch 6/40 - client 2 -  Training Loss: 8.551

100%|##########| 3/3 [05:08<00:00, 95.64s/it]
100%|##########| 3/3 [05:08<00:00, 102.87s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.49s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.13s/it]
100%|##########| 3/3 [00:18<00:00,  5.75s/it]
100%|##########| 3/3 [00:18<00:00,  6.02s/it]
2025-08-27 05:03:09,565 | Epoch6 Valid:
2025-08-27 05:03:09,565 | domain:Sports
2025-08-27 05:03:09,566 | model_moe:
2025-08-27 05:03:09,566 | MRR: 0.0859
2025-08-27 05:03:09,566 | HR @1|5|10: 0.0704 	 0.0907 	 0.1049 	
2025-08-27 05:03:09,566 | NDCG @5|10: 0.0810 	 0.0855
2025-08-27 05:03:09,567 | domain:Garden
2025-08-27 05:03:09,567 | model_moe:
2025-08-27 05:03:09,567 | MRR: 0.0763
2025-08-27 05:03:09,568 | HR @1|5|10: 0.0579 	 0.0859 	 0.0999 	
2025-08-27 05:03:09,568 | NDCG @5|10: 0.0729 	 0.0773
2025-08-27 05:03:09,568 | domain:Home
2025-08-27 05:03:09,568 | model_moe:
2025-08-27 05:03:09,569 | MRR: 0.0756
2025-08-27 05:03:09,569 | HR @1|5|10: 0.0601 	 0.0818 	 0.0962 	
2025-08-27 05:03:09,569 | NDCG @5|10: 0.0713 	 0.0759
2025-08-27 05:03:09,569 | 	avg_model_moe:
2025-08-27 05:03:09,570 | MRR: 0.0793
2025-08-27 05:03:09,570 | HR @1|5|10: 0.0628 	 0.0862 	 0.1003 	
2025-08-27 05:03:09,570 | NDCG @5|10: 0.0751 	 0.0796
2025-08-27 05:03:09,570 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:04:57,635 | Epoch 7/40 - client 2 -  Training Loss: 7.559

 33%|###3      | 1/3 [01:45<03:31, 105.66s/it]2025-08-27 05:08:00,676 | Epoch 7/40 - client 0 -  Training Loss: 7.652

 67%|######6   | 2/3 [04:48<02:31, 151.18s/it]2025-08-27 05:08:21,198 | Epoch 7/40 - client 1 -  Training Loss: 7.006

100%|##########| 3/3 [05:09<00:00, 91.52s/it] 
100%|##########| 3/3 [05:09<00:00, 103.08s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.48s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.12s/it]
100%|##########| 3/3 [00:18<00:00,  5.79s/it]
100%|##########| 3/3 [00:18<00:00,  6.04s/it]
2025-08-27 05:08:39,344 | Epoch7 Valid:
2025-08-27 05:08:39,344 | domain:Sports
2025-08-27 05:08:39,344 | model_moe:
2025-08-27 05:08:39,345 | MRR: 0.0879
2025-08-27 05:08:39,345 | HR @1|5|10: 0.0719 	 0.0940 	 0.1089 	
2025-08-27 05:08:39,345 | NDCG @5|10: 0.0831 	 0.0879
2025-08-27 05:08:39,346 | domain:Garden
2025-08-27 05:08:39,346 | model_moe:
2025-08-27 05:08:39,346 | MRR: 0.0839
2025-08-27 05:08:39,347 | HR @1|5|10: 0.0651 	 0.0930 	 0.1096 	
2025-08-27 05:08:39,347 | NDCG @5|10: 0.0801 	 0.0855
2025-08-27 05:08:39,347 | domain:Home
2025-08-27 05:08:39,347 | model_moe:
2025-08-27 05:08:39,348 | MRR: 0.0782
2025-08-27 05:08:39,348 | HR @1|5|10: 0.0624 	 0.0837 	 0.0997 	
2025-08-27 05:08:39,348 | NDCG @5|10: 0.0737 	 0.0788
2025-08-27 05:08:39,348 | 	avg_model_moe:
2025-08-27 05:08:39,349 | MRR: 0.0833
2025-08-27 05:08:39,349 | HR @1|5|10: 0.0665 	 0.0902 	 0.1061 	
2025-08-27 05:08:39,349 | NDCG @5|10: 0.0790 	 0.0841
2025-08-27 05:08:39,350 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:10:28,017 | Epoch 8/40 - client 2 -  Training Loss: 6.852

 33%|###3      | 1/3 [01:45<03:31, 106.00s/it]2025-08-27 05:10:49,040 | Epoch 8/40 - client 1 -  Training Loss: 6.321

 67%|######6   | 2/3 [02:07<00:56, 56.01s/it] 2025-08-27 05:13:51,472 | Epoch 8/40 - client 0 -  Training Loss: 6.959

100%|##########| 3/3 [05:09<00:00, 113.74s/it]
100%|##########| 3/3 [05:09<00:00, 103.15s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.62s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.23s/it]
100%|##########| 3/3 [00:18<00:00,  5.91s/it]
100%|##########| 3/3 [00:18<00:00,  6.16s/it]
2025-08-27 05:14:09,976 | Epoch8 Valid:
2025-08-27 05:14:09,976 | domain:Sports
2025-08-27 05:14:09,978 | model_moe:
2025-08-27 05:14:09,978 | MRR: 0.0889
2025-08-27 05:14:09,978 | HR @1|5|10: 0.0725 	 0.0949 	 0.1105 	
2025-08-27 05:14:09,979 | NDCG @5|10: 0.0840 	 0.0890
2025-08-27 05:14:09,979 | domain:Garden
2025-08-27 05:14:09,979 | model_moe:
2025-08-27 05:14:09,979 | MRR: 0.0870
2025-08-27 05:14:09,980 | HR @1|5|10: 0.0680 	 0.0979 	 0.1132 	
2025-08-27 05:14:09,980 | NDCG @5|10: 0.0837 	 0.0885
2025-08-27 05:14:09,980 | domain:Home
2025-08-27 05:14:09,981 | model_moe:
2025-08-27 05:14:09,981 | MRR: 0.0791
2025-08-27 05:14:09,981 | HR @1|5|10: 0.0633 	 0.0852 	 0.1011 	
2025-08-27 05:14:09,981 | NDCG @5|10: 0.0748 	 0.0799
2025-08-27 05:14:09,982 | 	avg_model_moe:
2025-08-27 05:14:09,982 | MRR: 0.0850
2025-08-27 05:14:09,982 | HR @1|5|10: 0.0679 	 0.0927 	 0.1083 	
2025-08-27 05:14:09,982 | NDCG @5|10: 0.0808 	 0.0858
2025-08-27 05:14:09,983 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:14:33,353 | Epoch 9/40 - client 1 -  Training Loss: 5.783

 33%|###3      | 1/3 [00:20<00:41, 20.57s/it]2025-08-27 05:16:18,897 | Epoch 9/40 - client 2 -  Training Loss: 6.331

 67%|######6   | 2/3 [02:06<01:10, 70.55s/it]2025-08-27 05:19:20,856 | Epoch 9/40 - client 0 -  Training Loss: 6.455

100%|##########| 3/3 [05:08<00:00, 121.43s/it]
100%|##########| 3/3 [05:08<00:00, 102.69s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.72s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.23s/it]
100%|##########| 3/3 [00:18<00:00,  5.79s/it]
100%|##########| 3/3 [00:18<00:00,  6.09s/it]
2025-08-27 05:19:39,146 | Epoch9 Valid:
2025-08-27 05:19:39,147 | domain:Sports
2025-08-27 05:19:39,147 | model_moe:
2025-08-27 05:19:39,148 | MRR: 0.0897
2025-08-27 05:19:39,148 | HR @1|5|10: 0.0722 	 0.0966 	 0.1137 	
2025-08-27 05:19:39,148 | NDCG @5|10: 0.0847 	 0.0902
2025-08-27 05:19:39,148 | domain:Garden
2025-08-27 05:19:39,149 | model_moe:
2025-08-27 05:19:39,149 | MRR: 0.0902
2025-08-27 05:19:39,149 | HR @1|5|10: 0.0703 	 0.1005 	 0.1187 	
2025-08-27 05:19:39,150 | NDCG @5|10: 0.0864 	 0.0923
2025-08-27 05:19:39,150 | domain:Home
2025-08-27 05:19:39,150 | model_moe:
2025-08-27 05:19:39,150 | MRR: 0.0793
2025-08-27 05:19:39,151 | HR @1|5|10: 0.0629 	 0.0864 	 0.1010 	
2025-08-27 05:19:39,151 | NDCG @5|10: 0.0753 	 0.0800
2025-08-27 05:19:39,151 | 	avg_model_moe:
2025-08-27 05:19:39,151 | MRR: 0.0864
2025-08-27 05:19:39,152 | HR @1|5|10: 0.0685 	 0.0945 	 0.1112 	
2025-08-27 05:19:39,152 | NDCG @5|10: 0.0821 	 0.0875
2025-08-27 05:19:39,152 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:21:27,578 | Epoch 10/40 - client 2 -  Training Loss: 5.922

 33%|###3      | 1/3 [01:45<03:31, 105.54s/it]2025-08-27 05:21:48,034 | Epoch 10/40 - client 1 -  Training Loss: 5.353

 67%|######6   | 2/3 [02:05<00:55, 55.49s/it] 2025-08-27 05:24:50,139 | Epoch 10/40 - client 0 -  Training Loss: 6.054

100%|##########| 3/3 [05:08<00:00, 113.31s/it]
100%|##########| 3/3 [05:08<00:00, 102.70s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.46s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.12s/it]
100%|##########| 3/3 [00:18<00:00,  5.74s/it]
100%|##########| 3/3 [00:18<00:00,  6.00s/it]
2025-08-27 05:25:08,170 | Epoch10 Valid:
2025-08-27 05:25:08,171 | domain:Sports
2025-08-27 05:25:08,171 | model_moe:
2025-08-27 05:25:08,171 | MRR: 0.0904
2025-08-27 05:25:08,174 | HR @1|5|10: 0.0730 	 0.0969 	 0.1136 	
2025-08-27 05:25:08,174 | NDCG @5|10: 0.0853 	 0.0907
2025-08-27 05:25:08,175 | domain:Garden
2025-08-27 05:25:08,175 | model_moe:
2025-08-27 05:25:08,175 | MRR: 0.0911
2025-08-27 05:25:08,175 | HR @1|5|10: 0.0699 	 0.1038 	 0.1226 	
2025-08-27 05:25:08,176 | NDCG @5|10: 0.0880 	 0.0940
2025-08-27 05:25:08,176 | domain:Home
2025-08-27 05:25:08,176 | model_moe:
2025-08-27 05:25:08,177 | MRR: 0.0793
2025-08-27 05:25:08,177 | HR @1|5|10: 0.0625 	 0.0856 	 0.1005 	
2025-08-27 05:25:08,177 | NDCG @5|10: 0.0750 	 0.0798
2025-08-27 05:25:08,177 | 	avg_model_moe:
2025-08-27 05:25:08,178 | MRR: 0.0869
2025-08-27 05:25:08,180 | HR @1|5|10: 0.0685 	 0.0954 	 0.1123 	
2025-08-27 05:25:08,180 | NDCG @5|10: 0.0828 	 0.0882
2025-08-27 05:25:08,181 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:28:13,700 | Epoch 11/40 - client 0 -  Training Loss: 5.728

 33%|###3      | 1/3 [03:02<06:04, 182.39s/it]2025-08-27 05:28:34,172 | Epoch 11/40 - client 1 -  Training Loss: 5.003

 67%|######6   | 2/3 [03:22<01:27, 87.14s/it] 2025-08-27 05:30:19,951 | Epoch 11/40 - client 2 -  Training Loss: 5.589

100%|##########| 3/3 [05:08<00:00, 95.65s/it]
100%|##########| 3/3 [05:08<00:00, 102.88s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.47s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.12s/it]
100%|##########| 3/3 [00:17<00:00,  5.72s/it]
100%|##########| 3/3 [00:17<00:00,  6.00s/it]
2025-08-27 05:30:37,962 | Epoch11 Valid:
2025-08-27 05:30:37,962 | domain:Sports
2025-08-27 05:30:37,962 | model_moe:
2025-08-27 05:30:37,963 | MRR: 0.0901
2025-08-27 05:30:37,963 | HR @1|5|10: 0.0718 	 0.0969 	 0.1148 	
2025-08-27 05:30:37,963 | NDCG @5|10: 0.0848 	 0.0906
2025-08-27 05:30:37,963 | domain:Garden
2025-08-27 05:30:37,964 | model_moe:
2025-08-27 05:30:37,964 | MRR: 0.0916
2025-08-27 05:30:37,964 | HR @1|5|10: 0.0696 	 0.1061 	 0.1233 	
2025-08-27 05:30:37,965 | NDCG @5|10: 0.0891 	 0.0946
2025-08-27 05:30:37,965 | domain:Home
2025-08-27 05:30:37,965 | model_moe:
2025-08-27 05:30:37,968 | MRR: 0.0789
2025-08-27 05:30:37,968 | HR @1|5|10: 0.0617 	 0.0863 	 0.1007 	
2025-08-27 05:30:37,970 | NDCG @5|10: 0.0749 	 0.0795
2025-08-27 05:30:37,971 | 	avg_model_moe:
2025-08-27 05:30:37,971 | MRR: 0.0868
2025-08-27 05:30:37,971 | HR @1|5|10: 0.0677 	 0.0964 	 0.1129 	
2025-08-27 05:30:37,973 | NDCG @5|10: 0.0829 	 0.0882
2025-08-27 05:30:37,974 | Early Stopping counter: 1 out of 5
2025-08-27 05:30:37,974 | Learning rate decay counter: 1 out of 1
2025-08-27 05:30:37,974 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:30:58,748 | Epoch 12/40 - client 1 -  Training Loss: 4.719

 33%|###3      | 1/3 [00:20<00:41, 20.77s/it]2025-08-27 05:32:44,366 | Epoch 12/40 - client 2 -  Training Loss: 5.306

 67%|######6   | 2/3 [02:06<01:10, 70.68s/it]2025-08-27 05:35:46,844 | Epoch 12/40 - client 0 -  Training Loss: 5.445

100%|##########| 3/3 [05:08<00:00, 121.73s/it]
100%|##########| 3/3 [05:08<00:00, 102.96s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.55s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.19s/it]
100%|##########| 3/3 [00:18<00:00,  5.84s/it]
100%|##########| 3/3 [00:18<00:00,  6.10s/it]
2025-08-27 05:36:05,152 | Epoch12 Valid:
2025-08-27 05:36:05,153 | domain:Sports
2025-08-27 05:36:05,153 | model_moe:
2025-08-27 05:36:05,153 | MRR: 0.0904
2025-08-27 05:36:05,154 | HR @1|5|10: 0.0712 	 0.0972 	 0.1161 	
2025-08-27 05:36:05,154 | NDCG @5|10: 0.0849 	 0.0910
2025-08-27 05:36:05,154 | domain:Garden
2025-08-27 05:36:05,155 | model_moe:
2025-08-27 05:36:05,155 | MRR: 0.0902
2025-08-27 05:36:05,155 | HR @1|5|10: 0.0673 	 0.1057 	 0.1233 	
2025-08-27 05:36:05,156 | NDCG @5|10: 0.0879 	 0.0936
2025-08-27 05:36:05,156 | domain:Home
2025-08-27 05:36:05,156 | model_moe:
2025-08-27 05:36:05,156 | MRR: 0.0789
2025-08-27 05:36:05,157 | HR @1|5|10: 0.0613 	 0.0878 	 0.1015 	
2025-08-27 05:36:05,157 | NDCG @5|10: 0.0753 	 0.0797
2025-08-27 05:36:05,159 | 	avg_model_moe:
2025-08-27 05:36:05,159 | MRR: 0.0865
2025-08-27 05:36:05,159 | HR @1|5|10: 0.0666 	 0.0969 	 0.1136 	
2025-08-27 05:36:05,159 | NDCG @5|10: 0.0827 	 0.0881
2025-08-27 05:36:05,160 | Early Stopping counter: 2 out of 5
2025-08-27 05:36:05,160 | Learning rate decay counter: 1 out of 1
2025-08-27 05:36:05,160 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:39:06,958 | Epoch 13/40 - client 0 -  Training Loss: 5.198

 33%|###3      | 1/3 [03:01<06:03, 181.80s/it]2025-08-27 05:39:27,646 | Epoch 13/40 - client 1 -  Training Loss: 4.477

 67%|######6   | 2/3 [03:22<01:27, 87.03s/it] 2025-08-27 05:41:13,052 | Epoch 13/40 - client 2 -  Training Loss: 5.060

100%|##########| 3/3 [05:07<00:00, 95.42s/it]
100%|##########| 3/3 [05:07<00:00, 102.63s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.48s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.12s/it]
100%|##########| 3/3 [00:17<00:00,  5.73s/it]
100%|##########| 3/3 [00:18<00:00,  6.00s/it]
2025-08-27 05:41:31,064 | Epoch13 Valid:
2025-08-27 05:41:31,065 | domain:Sports
2025-08-27 05:41:31,065 | model_moe:
2025-08-27 05:41:31,065 | MRR: 0.0899
2025-08-27 05:41:31,066 | HR @1|5|10: 0.0705 	 0.0976 	 0.1173 	
2025-08-27 05:41:31,066 | NDCG @5|10: 0.0846 	 0.0909
2025-08-27 05:41:31,066 | domain:Garden
2025-08-27 05:41:31,067 | model_moe:
2025-08-27 05:41:31,067 | MRR: 0.0917
2025-08-27 05:41:31,067 | HR @1|5|10: 0.0693 	 0.1064 	 0.1265 	
2025-08-27 05:41:31,067 | NDCG @5|10: 0.0889 	 0.0954
2025-08-27 05:41:31,068 | domain:Home
2025-08-27 05:41:31,068 | model_moe:
2025-08-27 05:41:31,068 | MRR: 0.0783
2025-08-27 05:41:31,068 | HR @1|5|10: 0.0608 	 0.0856 	 0.1013 	
2025-08-27 05:41:31,069 | NDCG @5|10: 0.0741 	 0.0791
2025-08-27 05:41:31,069 | 	avg_model_moe:
2025-08-27 05:41:31,069 | MRR: 0.0866
2025-08-27 05:41:31,070 | HR @1|5|10: 0.0669 	 0.0965 	 0.1150 	
2025-08-27 05:41:31,070 | NDCG @5|10: 0.0825 	 0.0885
2025-08-27 05:41:31,070 | Early Stopping counter: 3 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:44:32,628 | Epoch 14/40 - client 0 -  Training Loss: 4.980

 33%|###3      | 1/3 [03:01<06:03, 181.57s/it]2025-08-27 05:46:17,921 | Epoch 14/40 - client 2 -  Training Loss: 4.847

 67%|######6   | 2/3 [04:46<02:16, 136.70s/it]2025-08-27 05:46:38,325 | Epoch 14/40 - client 1 -  Training Loss: 4.275

100%|##########| 3/3 [05:07<00:00, 83.59s/it] 
100%|##########| 3/3 [05:07<00:00, 102.42s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.41s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.08s/it]
100%|##########| 3/3 [00:17<00:00,  5.68s/it]
100%|##########| 3/3 [00:17<00:00,  5.95s/it]
2025-08-27 05:46:56,194 | Epoch14 Valid:
2025-08-27 05:46:56,194 | domain:Sports
2025-08-27 05:46:56,196 | model_moe:
2025-08-27 05:46:56,196 | MRR: 0.0896
2025-08-27 05:46:56,196 | HR @1|5|10: 0.0692 	 0.0985 	 0.1191 	
2025-08-27 05:46:56,197 | NDCG @5|10: 0.0845 	 0.0911
2025-08-27 05:46:56,197 | domain:Garden
2025-08-27 05:46:56,197 | model_moe:
2025-08-27 05:46:56,198 | MRR: 0.0929
2025-08-27 05:46:56,199 | HR @1|5|10: 0.0703 	 0.1077 	 0.1275 	
2025-08-27 05:46:56,199 | NDCG @5|10: 0.0901 	 0.0965
2025-08-27 05:46:56,200 | domain:Home
2025-08-27 05:46:56,200 | model_moe:
2025-08-27 05:46:56,200 | MRR: 0.0778
2025-08-27 05:46:56,201 | HR @1|5|10: 0.0601 	 0.0862 	 0.1019 	
2025-08-27 05:46:56,201 | NDCG @5|10: 0.0738 	 0.0788
2025-08-27 05:46:56,202 | 	avg_model_moe:
2025-08-27 05:46:56,203 | MRR: 0.0868
2025-08-27 05:46:56,203 | HR @1|5|10: 0.0665 	 0.0975 	 0.1162 	
2025-08-27 05:46:56,203 | NDCG @5|10: 0.0828 	 0.0888
2025-08-27 05:46:56,203 | Early Stopping counter: 4 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 05:49:57,577 | Epoch 15/40 - client 0 -  Training Loss: 4.784

 33%|###3      | 1/3 [03:01<06:02, 181.38s/it]2025-08-27 05:51:42,652 | Epoch 15/40 - client 2 -  Training Loss: 4.657

 67%|######6   | 2/3 [04:46<02:16, 136.49s/it]2025-08-27 05:52:02,981 | Epoch 15/40 - client 1 -  Training Loss: 4.101

100%|##########| 3/3 [05:06<00:00, 83.45s/it] 
100%|##########| 3/3 [05:06<00:00, 102.26s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.31s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.02s/it]
100%|##########| 3/3 [00:17<00:00,  5.64s/it]
100%|##########| 3/3 [00:17<00:00,  5.90s/it]
2025-08-27 05:52:20,715 | Epoch15 Valid:
2025-08-27 05:52:20,717 | domain:Sports
2025-08-27 05:52:20,717 | model_moe:
2025-08-27 05:52:20,717 | MRR: 0.0890
2025-08-27 05:52:20,718 | HR @1|5|10: 0.0683 	 0.0978 	 0.1193 	
2025-08-27 05:52:20,718 | NDCG @5|10: 0.0837 	 0.0907
2025-08-27 05:52:20,718 | domain:Garden
2025-08-27 05:52:20,719 | model_moe:
2025-08-27 05:52:20,722 | MRR: 0.0930
2025-08-27 05:52:20,723 | HR @1|5|10: 0.0699 	 0.1083 	 0.1278 	
2025-08-27 05:52:20,723 | NDCG @5|10: 0.0903 	 0.0966
2025-08-27 05:52:20,723 | domain:Home
2025-08-27 05:52:20,723 | model_moe:
2025-08-27 05:52:20,724 | MRR: 0.0765
2025-08-27 05:52:20,724 | HR @1|5|10: 0.0581 	 0.0859 	 0.1007 	
2025-08-27 05:52:20,726 | NDCG @5|10: 0.0728 	 0.0776
2025-08-27 05:52:20,727 | 	avg_model_moe:
2025-08-27 05:52:20,727 | MRR: 0.0862
2025-08-27 05:52:20,727 | HR @1|5|10: 0.0654 	 0.0973 	 0.1160 	
2025-08-27 05:52:20,727 | NDCG @5|10: 0.0823 	 0.0883
2025-08-27 05:52:20,728 | Early Stopping counter: 5 out of 5
2025-08-27 05:52:20,728 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:14<00:29, 14.76s/it]
 67%|######6   | 2/3 [00:18<00:08,  8.14s/it]
100%|##########| 3/3 [00:28<00:00,  8.97s/it]
100%|##########| 3/3 [00:28<00:00,  9.41s/it]
2025-08-27 05:52:48,955 | Test:
2025-08-27 05:52:48,955 | domain:Sports
2025-08-27 05:52:48,955 | model_moe:
2025-08-27 05:52:48,956 | MRR: 0.0677
2025-08-27 05:52:48,956 | HR @1|5|10: 0.0532 	 0.0727 	 0.0871 	
2025-08-27 05:52:48,956 | NDCG @5|10: 0.0635 	 0.0681
2025-08-27 05:52:48,957 | domain:Garden
2025-08-27 05:52:48,957 | model_moe:
2025-08-27 05:52:48,957 | MRR: 0.0753
2025-08-27 05:52:48,957 | HR @1|5|10: 0.0601 	 0.0813 	 0.0996 	
2025-08-27 05:52:48,958 | NDCG @5|10: 0.0711 	 0.0770
2025-08-27 05:52:48,958 | domain:Home
2025-08-27 05:52:48,958 | model_moe:
2025-08-27 05:52:48,959 | MRR: 0.0592
2025-08-27 05:52:48,959 | HR @1|5|10: 0.0454 	 0.0651 	 0.0764 	
2025-08-27 05:52:48,959 | NDCG @5|10: 0.0558 	 0.0594
2025-08-27 05:52:48,959 | 	avg_model_moe:
2025-08-27 05:52:48,960 | MRR: 0.0674
2025-08-27 05:52:48,960 | HR @1|5|10: 0.0529 	 0.0730 	 0.0877 	
2025-08-27 05:52:48,960 | NDCG @5|10: 0.0635 	 0.0682
