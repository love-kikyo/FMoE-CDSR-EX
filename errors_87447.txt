gate_loss + graph_encoder迁移
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 14:25:42,246 | Running with the following configs:
	domains : ['Food', 'Kitchen', 'Clothing', 'Beauty']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 60
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 10
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 1.0
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/4 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 14:26:19,253 | Epoch 1/60 - client 1 -  Training Loss: 48.834

 25%|##5       | 1/4 [00:36<01:50, 37.00s/it]2025-08-27 14:26:31,462 | Epoch 1/60 - client 0 -  Training Loss: 44.545

 50%|#####     | 2/4 [00:49<00:44, 22.42s/it]2025-08-27 14:26:47,819 | Epoch 1/60 - client 2 -  Training Loss: 50.634

 75%|#######5  | 3/4 [01:05<00:19, 19.65s/it]2025-08-27 14:26:59,868 | Epoch 1/60 - client 3 -  Training Loss: 50.259

100%|##########| 4/4 [01:17<00:00, 16.65s/it]
100%|##########| 4/4 [01:17<00:00, 19.40s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:27:03,777 | Epoch1 Valid:
2025-08-27 14:27:03,778 | domain:Food
2025-08-27 14:27:03,778 | model_moe:
2025-08-27 14:27:03,779 | MRR: 0.2793
2025-08-27 14:27:03,779 | HR @1|5|10: 0.1867 	 0.3902 	 0.4759 	
2025-08-27 14:27:03,779 | NDCG @5|10: 0.2926 	 0.3205
2025-08-27 14:27:03,779 | domain:Kitchen
2025-08-27 14:27:03,780 | model_moe:
2025-08-27 14:27:03,780 | MRR: 0.0397
2025-08-27 14:27:03,780 | HR @1|5|10: 0.0152 	 0.0506 	 0.0787 	
2025-08-27 14:27:03,781 | NDCG @5|10: 0.0329 	 0.0420
2025-08-27 14:27:03,781 | domain:Clothing
2025-08-27 14:27:03,781 | model_moe:
2025-08-27 14:27:03,781 | MRR: 0.0109
2025-08-27 14:27:03,782 | HR @1|5|10: 0.0037 	 0.0098 	 0.0134 	
2025-08-27 14:27:03,782 | NDCG @5|10: 0.0064 	 0.0075
2025-08-27 14:27:03,782 | domain:Beauty
2025-08-27 14:27:03,783 | model_moe:
2025-08-27 14:27:03,783 | MRR: 0.1422
2025-08-27 14:27:03,783 | HR @1|5|10: 0.0873 	 0.1854 	 0.2584 	
2025-08-27 14:27:03,784 | NDCG @5|10: 0.1381 	 0.1615
2025-08-27 14:27:03,784 | 	avg_model_moe:
2025-08-27 14:27:03,784 | MRR: 0.1180
2025-08-27 14:27:03,784 | HR @1|5|10: 0.0732 	 0.1590 	 0.2066 	
2025-08-27 14:27:03,785 | NDCG @5|10: 0.1175 	 0.1329
2025-08-27 14:27:03,785 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:27:22,670 | Epoch 2/60 - client 2 -  Training Loss: 48.580

 25%|##5       | 1/4 [00:16<00:49, 16.50s/it]2025-08-27 14:27:34,715 | Epoch 2/60 - client 3 -  Training Loss: 47.927

 50%|#####     | 2/4 [00:28<00:27, 13.88s/it]2025-08-27 14:28:05,285 | Epoch 2/60 - client 1 -  Training Loss: 48.104

 75%|#######5  | 3/4 [00:59<00:21, 21.50s/it]2025-08-27 14:28:17,640 | Epoch 2/60 - client 0 -  Training Loss: 42.602

100%|##########| 4/4 [01:11<00:00, 17.89s/it]
100%|##########| 4/4 [01:11<00:00, 17.87s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:28:21,533 | Epoch2 Valid:
2025-08-27 14:28:21,533 | domain:Food
2025-08-27 14:28:21,533 | model_moe:
2025-08-27 14:28:21,534 | MRR: 0.3093
2025-08-27 14:28:21,534 | HR @1|5|10: 0.2112 	 0.4277 	 0.5126 	
2025-08-27 14:28:21,534 | NDCG @5|10: 0.3255 	 0.3530
2025-08-27 14:28:21,534 | domain:Kitchen
2025-08-27 14:28:21,535 | model_moe:
2025-08-27 14:28:21,535 | MRR: 0.0680
2025-08-27 14:28:21,535 | HR @1|5|10: 0.0304 	 0.0902 	 0.1377 	
2025-08-27 14:28:21,536 | NDCG @5|10: 0.0605 	 0.0758
2025-08-27 14:28:21,536 | domain:Clothing
2025-08-27 14:28:21,536 | model_moe:
2025-08-27 14:28:21,536 | MRR: 0.0243
2025-08-27 14:28:21,537 | HR @1|5|10: 0.0134 	 0.0232 	 0.0367 	
2025-08-27 14:28:21,537 | NDCG @5|10: 0.0184 	 0.0227
2025-08-27 14:28:21,537 | domain:Beauty
2025-08-27 14:28:21,538 | model_moe:
2025-08-27 14:28:21,538 | MRR: 0.1797
2025-08-27 14:28:21,538 | HR @1|5|10: 0.1112 	 0.2536 	 0.3313 	
2025-08-27 14:28:21,539 | NDCG @5|10: 0.1843 	 0.2092
2025-08-27 14:28:21,539 | 	avg_model_moe:
2025-08-27 14:28:21,539 | MRR: 0.1453
2025-08-27 14:28:21,539 | HR @1|5|10: 0.0916 	 0.1987 	 0.2546 	
2025-08-27 14:28:21,540 | NDCG @5|10: 0.1472 	 0.1652
2025-08-27 14:28:21,540 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:28:39,713 | Epoch 3/60 - client 2 -  Training Loss: 46.774

 25%|##5       | 1/4 [00:16<00:48, 16.33s/it]2025-08-27 14:29:10,018 | Epoch 3/60 - client 1 -  Training Loss: 47.308

 50%|#####     | 2/4 [00:46<00:49, 24.55s/it]2025-08-27 14:29:22,255 | Epoch 3/60 - client 0 -  Training Loss: 41.288

 75%|#######5  | 3/4 [00:58<00:18, 18.93s/it]2025-08-27 14:29:34,136 | Epoch 3/60 - client 3 -  Training Loss: 46.181

100%|##########| 4/4 [01:10<00:00, 16.15s/it]
100%|##########| 4/4 [01:10<00:00, 17.69s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:29:38,010 | Epoch3 Valid:
2025-08-27 14:29:38,011 | domain:Food
2025-08-27 14:29:38,011 | model_moe:
2025-08-27 14:29:38,011 | MRR: 0.3202
2025-08-27 14:29:38,012 | HR @1|5|10: 0.2173 	 0.4445 	 0.5241 	
2025-08-27 14:29:38,012 | NDCG @5|10: 0.3385 	 0.3648
2025-08-27 14:29:38,012 | domain:Kitchen
2025-08-27 14:29:38,012 | model_moe:
2025-08-27 14:29:38,013 | MRR: 0.0754
2025-08-27 14:29:38,013 | HR @1|5|10: 0.0359 	 0.1013 	 0.1492 	
2025-08-27 14:29:38,013 | NDCG @5|10: 0.0690 	 0.0845
2025-08-27 14:29:38,013 | domain:Clothing
2025-08-27 14:29:38,014 | model_moe:
2025-08-27 14:29:38,014 | MRR: 0.0242
2025-08-27 14:29:38,014 | HR @1|5|10: 0.0122 	 0.0232 	 0.0428 	
2025-08-27 14:29:38,014 | NDCG @5|10: 0.0182 	 0.0243
2025-08-27 14:29:38,015 | domain:Beauty
2025-08-27 14:29:38,015 | model_moe:
2025-08-27 14:29:38,015 | MRR: 0.2052
2025-08-27 14:29:38,016 | HR @1|5|10: 0.1352 	 0.2787 	 0.3481 	
2025-08-27 14:29:38,016 | NDCG @5|10: 0.2100 	 0.2329
2025-08-27 14:29:38,016 | 	avg_model_moe:
2025-08-27 14:29:38,016 | MRR: 0.1563
2025-08-27 14:29:38,017 | HR @1|5|10: 0.1001 	 0.2119 	 0.2660 	
2025-08-27 14:29:38,017 | NDCG @5|10: 0.1589 	 0.1766
2025-08-27 14:29:38,017 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:29:56,400 | Epoch 4/60 - client 2 -  Training Loss: 45.227

 25%|##5       | 1/4 [00:16<00:49, 16.34s/it]2025-08-27 14:30:08,296 | Epoch 4/60 - client 3 -  Training Loss: 44.857

 50%|#####     | 2/4 [00:28<00:27, 13.73s/it]2025-08-27 14:30:20,524 | Epoch 4/60 - client 0 -  Training Loss: 40.252

 75%|#######5  | 3/4 [00:40<00:13, 13.04s/it]2025-08-27 14:30:51,270 | Epoch 4/60 - client 1 -  Training Loss: 46.300

100%|##########| 4/4 [01:11<00:00, 20.03s/it]
100%|##########| 4/4 [01:11<00:00, 17.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:30:55,160 | Epoch4 Valid:
2025-08-27 14:30:55,161 | domain:Food
2025-08-27 14:30:55,161 | model_moe:
2025-08-27 14:30:55,161 | MRR: 0.3287
2025-08-27 14:30:55,162 | HR @1|5|10: 0.2257 	 0.4583 	 0.5226 	
2025-08-27 14:30:55,162 | NDCG @5|10: 0.3497 	 0.3709
2025-08-27 14:30:55,162 | domain:Kitchen
2025-08-27 14:30:55,163 | model_moe:
2025-08-27 14:30:55,163 | MRR: 0.0810
2025-08-27 14:30:55,163 | HR @1|5|10: 0.0419 	 0.1082 	 0.1542 	
2025-08-27 14:30:55,163 | NDCG @5|10: 0.0752 	 0.0899
2025-08-27 14:30:55,164 | domain:Clothing
2025-08-27 14:30:55,164 | model_moe:
2025-08-27 14:30:55,164 | MRR: 0.0280
2025-08-27 14:30:55,164 | HR @1|5|10: 0.0171 	 0.0293 	 0.0391 	
2025-08-27 14:30:55,165 | NDCG @5|10: 0.0233 	 0.0264
2025-08-27 14:30:55,165 | domain:Beauty
2025-08-27 14:30:55,165 | model_moe:
2025-08-27 14:30:55,166 | MRR: 0.2145
2025-08-27 14:30:55,166 | HR @1|5|10: 0.1447 	 0.2955 	 0.3600 	
2025-08-27 14:30:55,166 | NDCG @5|10: 0.2225 	 0.2432
2025-08-27 14:30:55,166 | 	avg_model_moe:
2025-08-27 14:30:55,167 | MRR: 0.1630
2025-08-27 14:30:55,167 | HR @1|5|10: 0.1074 	 0.2228 	 0.2690 	
2025-08-27 14:30:55,167 | NDCG @5|10: 0.1677 	 0.1826
2025-08-27 14:30:55,167 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:31:09,354 | Epoch 5/60 - client 0 -  Training Loss: 39.430

 25%|##5       | 1/4 [00:12<00:37, 12.34s/it]2025-08-27 14:31:25,816 | Epoch 5/60 - client 2 -  Training Loss: 43.932

 50%|#####     | 2/4 [00:28<00:29, 14.77s/it]2025-08-27 14:31:56,330 | Epoch 5/60 - client 1 -  Training Loss: 45.334

 75%|#######5  | 3/4 [00:59<00:21, 21.96s/it]2025-08-27 14:32:08,399 | Epoch 5/60 - client 3 -  Training Loss: 43.795

100%|##########| 4/4 [01:11<00:00, 18.05s/it]
100%|##########| 4/4 [01:11<00:00, 17.85s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:32:12,309 | Epoch5 Valid:
2025-08-27 14:32:12,310 | domain:Food
2025-08-27 14:32:12,310 | model_moe:
2025-08-27 14:32:12,310 | MRR: 0.3321
2025-08-27 14:32:12,311 | HR @1|5|10: 0.2272 	 0.4621 	 0.5264 	
2025-08-27 14:32:12,311 | NDCG @5|10: 0.3533 	 0.3747
2025-08-27 14:32:12,311 | domain:Kitchen
2025-08-27 14:32:12,312 | model_moe:
2025-08-27 14:32:12,312 | MRR: 0.0855
2025-08-27 14:32:12,312 | HR @1|5|10: 0.0451 	 0.1133 	 0.1579 	
2025-08-27 14:32:12,312 | NDCG @5|10: 0.0799 	 0.0942
2025-08-27 14:32:12,313 | domain:Clothing
2025-08-27 14:32:12,313 | model_moe:
2025-08-27 14:32:12,313 | MRR: 0.0251
2025-08-27 14:32:12,314 | HR @1|5|10: 0.0134 	 0.0232 	 0.0403 	
2025-08-27 14:32:12,314 | NDCG @5|10: 0.0191 	 0.0246
2025-08-27 14:32:12,314 | domain:Beauty
2025-08-27 14:32:12,314 | model_moe:
2025-08-27 14:32:12,315 | MRR: 0.2203
2025-08-27 14:32:12,315 | HR @1|5|10: 0.1483 	 0.3002 	 0.3684 	
2025-08-27 14:32:12,315 | NDCG @5|10: 0.2278 	 0.2503
2025-08-27 14:32:12,316 | 	avg_model_moe:
2025-08-27 14:32:12,316 | MRR: 0.1657
2025-08-27 14:32:12,316 | HR @1|5|10: 0.1085 	 0.2247 	 0.2733 	
2025-08-27 14:32:12,316 | NDCG @5|10: 0.1700 	 0.1859
2025-08-27 14:32:12,317 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:32:44,350 | Epoch 6/60 - client 1 -  Training Loss: 44.271

 25%|##5       | 1/4 [00:30<01:30, 30.21s/it]2025-08-27 14:33:00,792 | Epoch 6/60 - client 2 -  Training Loss: 42.671

 50%|#####     | 2/4 [00:46<00:44, 22.11s/it]2025-08-27 14:33:12,985 | Epoch 6/60 - client 0 -  Training Loss: 38.651

 75%|#######5  | 3/4 [00:58<00:17, 17.58s/it]2025-08-27 14:33:24,847 | Epoch 6/60 - client 3 -  Training Loss: 42.775

100%|##########| 4/4 [01:10<00:00, 15.32s/it]
100%|##########| 4/4 [01:10<00:00, 17.68s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:33:28,692 | Epoch6 Valid:
2025-08-27 14:33:28,693 | domain:Food
2025-08-27 14:33:28,693 | model_moe:
2025-08-27 14:33:28,694 | MRR: 0.3334
2025-08-27 14:33:28,694 | HR @1|5|10: 0.2303 	 0.4629 	 0.5256 	
2025-08-27 14:33:28,694 | NDCG @5|10: 0.3549 	 0.3756
2025-08-27 14:33:28,694 | domain:Kitchen
2025-08-27 14:33:28,695 | model_moe:
2025-08-27 14:33:28,695 | MRR: 0.0889
2025-08-27 14:33:28,695 | HR @1|5|10: 0.0479 	 0.1174 	 0.1634 	
2025-08-27 14:33:28,696 | NDCG @5|10: 0.0834 	 0.0981
2025-08-27 14:33:28,696 | domain:Clothing
2025-08-27 14:33:28,696 | model_moe:
2025-08-27 14:33:28,697 | MRR: 0.0252
2025-08-27 14:33:28,697 | HR @1|5|10: 0.0147 	 0.0269 	 0.0379 	
2025-08-27 14:33:28,697 | NDCG @5|10: 0.0206 	 0.0242
2025-08-27 14:33:28,697 | domain:Beauty
2025-08-27 14:33:28,698 | model_moe:
2025-08-27 14:33:28,698 | MRR: 0.2243
2025-08-27 14:33:28,698 | HR @1|5|10: 0.1519 	 0.3182 	 0.3696 	
2025-08-27 14:33:28,699 | NDCG @5|10: 0.2370 	 0.2536
2025-08-27 14:33:28,699 | 	avg_model_moe:
2025-08-27 14:33:28,699 | MRR: 0.1679
2025-08-27 14:33:28,699 | HR @1|5|10: 0.1112 	 0.2313 	 0.2741 	
2025-08-27 14:33:28,700 | NDCG @5|10: 0.1740 	 0.1879
2025-08-27 14:33:28,700 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:33:43,048 | Epoch 7/60 - client 0 -  Training Loss: 37.959

 25%|##5       | 1/4 [00:12<00:37, 12.41s/it]2025-08-27 14:33:55,104 | Epoch 7/60 - client 3 -  Training Loss: 41.871

 50%|#####     | 2/4 [00:24<00:24, 12.20s/it]2025-08-27 14:34:11,596 | Epoch 7/60 - client 2 -  Training Loss: 41.503

 75%|#######5  | 3/4 [00:40<00:14, 14.16s/it]2025-08-27 14:34:42,061 | Epoch 7/60 - client 1 -  Training Loss: 43.255

100%|##########| 4/4 [01:11<00:00, 20.60s/it]
100%|##########| 4/4 [01:11<00:00, 17.86s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.37s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.06s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-27 14:34:46,045 | Epoch7 Valid:
2025-08-27 14:34:46,045 | domain:Food
2025-08-27 14:34:46,045 | model_moe:
2025-08-27 14:34:46,046 | MRR: 0.3333
2025-08-27 14:34:46,046 | HR @1|5|10: 0.2288 	 0.4660 	 0.5272 	
2025-08-27 14:34:46,046 | NDCG @5|10: 0.3562 	 0.3763
2025-08-27 14:34:46,047 | domain:Kitchen
2025-08-27 14:34:46,047 | model_moe:
2025-08-27 14:34:46,047 | MRR: 0.0888
2025-08-27 14:34:46,047 | HR @1|5|10: 0.0451 	 0.1206 	 0.1653 	
2025-08-27 14:34:46,048 | NDCG @5|10: 0.0845 	 0.0989
2025-08-27 14:34:46,048 | domain:Clothing
2025-08-27 14:34:46,048 | model_moe:
2025-08-27 14:34:46,049 | MRR: 0.0272
2025-08-27 14:34:46,049 | HR @1|5|10: 0.0171 	 0.0293 	 0.0403 	
2025-08-27 14:34:46,049 | NDCG @5|10: 0.0229 	 0.0265
2025-08-27 14:34:46,049 | domain:Beauty
2025-08-27 14:34:46,050 | model_moe:
2025-08-27 14:34:46,050 | MRR: 0.2261
2025-08-27 14:34:46,050 | HR @1|5|10: 0.1555 	 0.3122 	 0.3756 	
2025-08-27 14:34:46,051 | NDCG @5|10: 0.2359 	 0.2566
2025-08-27 14:34:46,051 | 	avg_model_moe:
2025-08-27 14:34:46,051 | MRR: 0.1689
2025-08-27 14:34:46,051 | HR @1|5|10: 0.1116 	 0.2320 	 0.2771 	
2025-08-27 14:34:46,052 | NDCG @5|10: 0.1749 	 0.1896
2025-08-27 14:34:46,052 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:35:00,160 | Epoch 8/60 - client 0 -  Training Loss: 37.348

 25%|##5       | 1/4 [00:12<00:36, 12.18s/it]2025-08-27 14:35:12,033 | Epoch 8/60 - client 3 -  Training Loss: 41.046

 50%|#####     | 2/4 [00:24<00:24, 12.00s/it]2025-08-27 14:35:42,198 | Epoch 8/60 - client 1 -  Training Loss: 42.311

 75%|#######5  | 3/4 [00:54<00:20, 20.29s/it]2025-08-27 14:35:58,503 | Epoch 8/60 - client 2 -  Training Loss: 40.441

100%|##########| 4/4 [01:10<00:00, 18.72s/it]
100%|##########| 4/4 [01:10<00:00, 17.63s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:36:02,350 | Epoch8 Valid:
2025-08-27 14:36:02,350 | domain:Food
2025-08-27 14:36:02,350 | model_moe:
2025-08-27 14:36:02,351 | MRR: 0.3409
2025-08-27 14:36:02,351 | HR @1|5|10: 0.2433 	 0.4728 	 0.5241 	
2025-08-27 14:36:02,351 | NDCG @5|10: 0.3644 	 0.3812
2025-08-27 14:36:02,352 | domain:Kitchen
2025-08-27 14:36:02,352 | model_moe:
2025-08-27 14:36:02,352 | MRR: 0.0922
2025-08-27 14:36:02,352 | HR @1|5|10: 0.0520 	 0.1229 	 0.1634 	
2025-08-27 14:36:02,353 | NDCG @5|10: 0.0880 	 0.1011
2025-08-27 14:36:02,353 | domain:Clothing
2025-08-27 14:36:02,353 | model_moe:
2025-08-27 14:36:02,354 | MRR: 0.0249
2025-08-27 14:36:02,354 | HR @1|5|10: 0.0134 	 0.0257 	 0.0416 	
2025-08-27 14:36:02,354 | NDCG @5|10: 0.0199 	 0.0251
2025-08-27 14:36:02,355 | domain:Beauty
2025-08-27 14:36:02,355 | model_moe:
2025-08-27 14:36:02,355 | MRR: 0.2285
2025-08-27 14:36:02,355 | HR @1|5|10: 0.1567 	 0.3122 	 0.3780 	
2025-08-27 14:36:02,356 | NDCG @5|10: 0.2375 	 0.2591
2025-08-27 14:36:02,356 | 	avg_model_moe:
2025-08-27 14:36:02,356 | MRR: 0.1716
2025-08-27 14:36:02,357 | HR @1|5|10: 0.1164 	 0.2334 	 0.2768 	
2025-08-27 14:36:02,357 | NDCG @5|10: 0.1775 	 0.1916
2025-08-27 14:36:02,357 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:36:34,777 | Epoch 9/60 - client 1 -  Training Loss: 41.468

 25%|##5       | 1/4 [00:30<01:31, 30.48s/it]2025-08-27 14:36:51,323 | Epoch 9/60 - client 2 -  Training Loss: 39.457

 50%|#####     | 2/4 [00:47<00:44, 22.28s/it]2025-08-27 14:37:03,657 | Epoch 9/60 - client 0 -  Training Loss: 36.773

 75%|#######5  | 3/4 [00:59<00:17, 17.74s/it]2025-08-27 14:37:15,688 | Epoch 9/60 - client 3 -  Training Loss: 40.276

100%|##########| 4/4 [01:11<00:00, 15.49s/it]
100%|##########| 4/4 [01:11<00:00, 17.85s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 14:37:19,617 | Epoch9 Valid:
2025-08-27 14:37:19,618 | domain:Food
2025-08-27 14:37:19,618 | model_moe:
2025-08-27 14:37:19,619 | MRR: 0.3377
2025-08-27 14:37:19,619 | HR @1|5|10: 0.2372 	 0.4667 	 0.5241 	
2025-08-27 14:37:19,619 | NDCG @5|10: 0.3599 	 0.3789
2025-08-27 14:37:19,619 | domain:Kitchen
2025-08-27 14:37:19,620 | model_moe:
2025-08-27 14:37:19,620 | MRR: 0.0915
2025-08-27 14:37:19,620 | HR @1|5|10: 0.0502 	 0.1238 	 0.1634 	
2025-08-27 14:37:19,621 | NDCG @5|10: 0.0878 	 0.1005
2025-08-27 14:37:19,621 | domain:Clothing
2025-08-27 14:37:19,621 | model_moe:
2025-08-27 14:37:19,622 | MRR: 0.0240
2025-08-27 14:37:19,622 | HR @1|5|10: 0.0122 	 0.0269 	 0.0367 	
2025-08-27 14:37:19,622 | NDCG @5|10: 0.0199 	 0.0231
2025-08-27 14:37:19,622 | domain:Beauty
2025-08-27 14:37:19,623 | model_moe:
2025-08-27 14:37:19,623 | MRR: 0.2306
2025-08-27 14:37:19,623 | HR @1|5|10: 0.1615 	 0.3086 	 0.3744 	
2025-08-27 14:37:19,624 | NDCG @5|10: 0.2380 	 0.2596
2025-08-27 14:37:19,624 | 	avg_model_moe:
2025-08-27 14:37:19,624 | MRR: 0.1710
2025-08-27 14:37:19,624 | HR @1|5|10: 0.1153 	 0.2315 	 0.2747 	
2025-08-27 14:37:19,625 | NDCG @5|10: 0.1764 	 0.1905
2025-08-27 14:37:19,625 | Early Stopping counter: 1 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:37:50,055 | Epoch 10/60 - client 1 -  Training Loss: 40.716

 25%|##5       | 1/4 [00:30<01:31, 30.43s/it]2025-08-27 14:38:02,436 | Epoch 10/60 - client 0 -  Training Loss: 36.244

 50%|#####     | 2/4 [00:42<00:39, 19.82s/it]2025-08-27 14:38:14,460 | Epoch 10/60 - client 3 -  Training Loss: 39.566

 75%|#######5  | 3/4 [00:54<00:16, 16.26s/it]2025-08-27 14:38:30,926 | Epoch 10/60 - client 2 -  Training Loss: 38.542

100%|##########| 4/4 [01:11<00:00, 16.34s/it]
100%|##########| 4/4 [01:11<00:00, 17.83s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.03it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.09it/s]
100%|##########| 4/4 [00:03<00:00,  1.00it/s]
2025-08-27 14:38:34,934 | Epoch10 Valid:
2025-08-27 14:38:34,935 | domain:Food
2025-08-27 14:38:34,935 | model_moe:
2025-08-27 14:38:34,935 | MRR: 0.3423
2025-08-27 14:38:34,936 | HR @1|5|10: 0.2425 	 0.4682 	 0.5310 	
2025-08-27 14:38:34,936 | NDCG @5|10: 0.3637 	 0.3843
2025-08-27 14:38:34,936 | domain:Kitchen
2025-08-27 14:38:34,936 | model_moe:
2025-08-27 14:38:34,937 | MRR: 0.0950
2025-08-27 14:38:34,937 | HR @1|5|10: 0.0539 	 0.1252 	 0.1648 	
2025-08-27 14:38:34,937 | NDCG @5|10: 0.0909 	 0.1035
2025-08-27 14:38:34,938 | domain:Clothing
2025-08-27 14:38:34,938 | model_moe:
2025-08-27 14:38:34,938 | MRR: 0.0240
2025-08-27 14:38:34,938 | HR @1|5|10: 0.0122 	 0.0244 	 0.0403 	
2025-08-27 14:38:34,939 | NDCG @5|10: 0.0192 	 0.0243
2025-08-27 14:38:34,939 | domain:Beauty
2025-08-27 14:38:34,939 | model_moe:
2025-08-27 14:38:34,940 | MRR: 0.2306
2025-08-27 14:38:34,940 | HR @1|5|10: 0.1567 	 0.3206 	 0.3732 	
2025-08-27 14:38:34,940 | NDCG @5|10: 0.2420 	 0.2593
2025-08-27 14:38:34,941 | 	avg_model_moe:
2025-08-27 14:38:34,941 | MRR: 0.1730
2025-08-27 14:38:34,941 | HR @1|5|10: 0.1163 	 0.2346 	 0.2773 	
2025-08-27 14:38:34,941 | NDCG @5|10: 0.1789 	 0.1928
2025-08-27 14:38:34,942 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:38:49,242 | Epoch 11/60 - client 0 -  Training Loss: 35.745

 25%|##5       | 1/4 [00:12<00:37, 12.36s/it]2025-08-27 14:39:01,247 | Epoch 11/60 - client 3 -  Training Loss: 38.893

 50%|#####     | 2/4 [00:24<00:24, 12.15s/it]2025-08-27 14:39:17,684 | Epoch 11/60 - client 2 -  Training Loss: 37.660

 75%|#######5  | 3/4 [00:40<00:14, 14.11s/it]2025-08-27 14:39:48,078 | Epoch 11/60 - client 1 -  Training Loss: 40.028

100%|##########| 4/4 [01:11<00:00, 20.54s/it]
100%|##########| 4/4 [01:11<00:00, 17.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:39:51,970 | Epoch11 Valid:
2025-08-27 14:39:51,970 | domain:Food
2025-08-27 14:39:51,970 | model_moe:
2025-08-27 14:39:51,971 | MRR: 0.3463
2025-08-27 14:39:51,971 | HR @1|5|10: 0.2487 	 0.4736 	 0.5325 	
2025-08-27 14:39:51,971 | NDCG @5|10: 0.3683 	 0.3877
2025-08-27 14:39:51,971 | domain:Kitchen
2025-08-27 14:39:51,972 | model_moe:
2025-08-27 14:39:51,972 | MRR: 0.0954
2025-08-27 14:39:51,972 | HR @1|5|10: 0.0534 	 0.1262 	 0.1685 	
2025-08-27 14:39:51,973 | NDCG @5|10: 0.0911 	 0.1048
2025-08-27 14:39:51,973 | domain:Clothing
2025-08-27 14:39:51,973 | model_moe:
2025-08-27 14:39:51,973 | MRR: 0.0231
2025-08-27 14:39:51,974 | HR @1|5|10: 0.0110 	 0.0244 	 0.0428 	
2025-08-27 14:39:51,974 | NDCG @5|10: 0.0184 	 0.0242
2025-08-27 14:39:51,974 | domain:Beauty
2025-08-27 14:39:51,975 | model_moe:
2025-08-27 14:39:51,975 | MRR: 0.2352
2025-08-27 14:39:51,975 | HR @1|5|10: 0.1675 	 0.3194 	 0.3720 	
2025-08-27 14:39:51,975 | NDCG @5|10: 0.2450 	 0.2623
2025-08-27 14:39:51,976 | 	avg_model_moe:
2025-08-27 14:39:51,976 | MRR: 0.1750
2025-08-27 14:39:51,976 | HR @1|5|10: 0.1201 	 0.2359 	 0.2790 	
2025-08-27 14:39:51,977 | NDCG @5|10: 0.1807 	 0.1948
2025-08-27 14:39:51,977 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:40:05,753 | Epoch 12/60 - client 3 -  Training Loss: 38.258

 25%|##5       | 1/4 [00:11<00:35, 11.96s/it]2025-08-27 14:40:18,063 | Epoch 12/60 - client 0 -  Training Loss: 35.271

 50%|#####     | 2/4 [00:24<00:24, 12.17s/it]2025-08-27 14:40:34,590 | Epoch 12/60 - client 2 -  Training Loss: 36.849

 75%|#######5  | 3/4 [00:40<00:14, 14.16s/it]2025-08-27 14:41:05,034 | Epoch 12/60 - client 1 -  Training Loss: 39.371

100%|##########| 4/4 [01:11<00:00, 20.59s/it]
100%|##########| 4/4 [01:11<00:00, 17.81s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 14:41:08,970 | Epoch12 Valid:
2025-08-27 14:41:08,970 | domain:Food
2025-08-27 14:41:08,970 | model_moe:
2025-08-27 14:41:08,971 | MRR: 0.3501
2025-08-27 14:41:08,971 | HR @1|5|10: 0.2540 	 0.4751 	 0.5302 	
2025-08-27 14:41:08,971 | NDCG @5|10: 0.3715 	 0.3898
2025-08-27 14:41:08,971 | domain:Kitchen
2025-08-27 14:41:08,972 | model_moe:
2025-08-27 14:41:08,972 | MRR: 0.0944
2025-08-27 14:41:08,972 | HR @1|5|10: 0.0511 	 0.1271 	 0.1690 	
2025-08-27 14:41:08,973 | NDCG @5|10: 0.0909 	 0.1043
2025-08-27 14:41:08,973 | domain:Clothing
2025-08-27 14:41:08,973 | model_moe:
2025-08-27 14:41:08,973 | MRR: 0.0228
2025-08-27 14:41:08,974 | HR @1|5|10: 0.0110 	 0.0244 	 0.0416 	
2025-08-27 14:41:08,974 | NDCG @5|10: 0.0180 	 0.0236
2025-08-27 14:41:08,974 | domain:Beauty
2025-08-27 14:41:08,975 | model_moe:
2025-08-27 14:41:08,975 | MRR: 0.2376
2025-08-27 14:41:08,975 | HR @1|5|10: 0.1663 	 0.3278 	 0.3840 	
2025-08-27 14:41:08,975 | NDCG @5|10: 0.2495 	 0.2676
2025-08-27 14:41:08,976 | 	avg_model_moe:
2025-08-27 14:41:08,976 | MRR: 0.1762
2025-08-27 14:41:08,976 | HR @1|5|10: 0.1206 	 0.2386 	 0.2812 	
2025-08-27 14:41:08,977 | NDCG @5|10: 0.1825 	 0.1963
2025-08-27 14:41:08,977 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:41:40,891 | Epoch 13/60 - client 1 -  Training Loss: 38.744

 25%|##5       | 1/4 [00:30<01:30, 30.10s/it]2025-08-27 14:41:52,709 | Epoch 13/60 - client 3 -  Training Loss: 37.663

 50%|#####     | 2/4 [00:41<00:38, 19.35s/it]2025-08-27 14:42:04,842 | Epoch 13/60 - client 0 -  Training Loss: 34.843

 75%|#######5  | 3/4 [00:54<00:16, 16.05s/it]2025-08-27 14:42:21,208 | Epoch 13/60 - client 2 -  Training Loss: 36.102

100%|##########| 4/4 [01:10<00:00, 16.18s/it]
100%|##########| 4/4 [01:10<00:00, 17.60s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:42:25,110 | Epoch13 Valid:
2025-08-27 14:42:25,111 | domain:Food
2025-08-27 14:42:25,111 | model_moe:
2025-08-27 14:42:25,111 | MRR: 0.3543
2025-08-27 14:42:25,112 | HR @1|5|10: 0.2609 	 0.4736 	 0.5325 	
2025-08-27 14:42:25,112 | NDCG @5|10: 0.3739 	 0.3934
2025-08-27 14:42:25,112 | domain:Kitchen
2025-08-27 14:42:25,113 | model_moe:
2025-08-27 14:42:25,113 | MRR: 0.0978
2025-08-27 14:42:25,113 | HR @1|5|10: 0.0548 	 0.1275 	 0.1722 	
2025-08-27 14:42:25,113 | NDCG @5|10: 0.0930 	 0.1074
2025-08-27 14:42:25,114 | domain:Clothing
2025-08-27 14:42:25,114 | model_moe:
2025-08-27 14:42:25,114 | MRR: 0.0236
2025-08-27 14:42:25,115 | HR @1|5|10: 0.0122 	 0.0244 	 0.0367 	
2025-08-27 14:42:25,115 | NDCG @5|10: 0.0189 	 0.0228
2025-08-27 14:42:25,115 | domain:Beauty
2025-08-27 14:42:25,115 | model_moe:
2025-08-27 14:42:25,116 | MRR: 0.2421
2025-08-27 14:42:25,116 | HR @1|5|10: 0.1722 	 0.3278 	 0.3756 	
2025-08-27 14:42:25,116 | NDCG @5|10: 0.2531 	 0.2685
2025-08-27 14:42:25,117 | 	avg_model_moe:
2025-08-27 14:42:25,117 | MRR: 0.1794
2025-08-27 14:42:25,117 | HR @1|5|10: 0.1250 	 0.2383 	 0.2792 	
2025-08-27 14:42:25,117 | NDCG @5|10: 0.1847 	 0.1980
2025-08-27 14:42:25,118 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:42:38,882 | Epoch 14/60 - client 3 -  Training Loss: 37.137

 25%|##5       | 1/4 [00:11<00:35, 11.94s/it]2025-08-27 14:42:51,143 | Epoch 14/60 - client 0 -  Training Loss: 34.428

 50%|#####     | 2/4 [00:24<00:24, 12.13s/it]2025-08-27 14:43:07,527 | Epoch 14/60 - client 2 -  Training Loss: 35.414

 75%|#######5  | 3/4 [00:40<00:14, 14.07s/it]2025-08-27 14:43:37,840 | Epoch 14/60 - client 1 -  Training Loss: 38.202

100%|##########| 4/4 [01:10<00:00, 20.48s/it]
100%|##########| 4/4 [01:10<00:00, 17.72s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.04it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.01it/s]
2025-08-27 14:43:41,810 | Epoch14 Valid:
2025-08-27 14:43:41,810 | domain:Food
2025-08-27 14:43:41,810 | model_moe:
2025-08-27 14:43:41,811 | MRR: 0.3535
2025-08-27 14:43:41,811 | HR @1|5|10: 0.2563 	 0.4790 	 0.5333 	
2025-08-27 14:43:41,811 | NDCG @5|10: 0.3751 	 0.3931
2025-08-27 14:43:41,812 | domain:Kitchen
2025-08-27 14:43:41,812 | model_moe:
2025-08-27 14:43:41,812 | MRR: 0.0990
2025-08-27 14:43:41,812 | HR @1|5|10: 0.0562 	 0.1308 	 0.1754 	
2025-08-27 14:43:41,813 | NDCG @5|10: 0.0948 	 0.1091
2025-08-27 14:43:41,813 | domain:Clothing
2025-08-27 14:43:41,813 | model_moe:
2025-08-27 14:43:41,814 | MRR: 0.0233
2025-08-27 14:43:41,814 | HR @1|5|10: 0.0122 	 0.0269 	 0.0391 	
2025-08-27 14:43:41,814 | NDCG @5|10: 0.0194 	 0.0232
2025-08-27 14:43:41,815 | domain:Beauty
2025-08-27 14:43:41,815 | model_moe:
2025-08-27 14:43:41,815 | MRR: 0.2433
2025-08-27 14:43:41,816 | HR @1|5|10: 0.1734 	 0.3325 	 0.3828 	
2025-08-27 14:43:41,816 | NDCG @5|10: 0.2555 	 0.2715
2025-08-27 14:43:41,816 | 	avg_model_moe:
2025-08-27 14:43:41,816 | MRR: 0.1798
2025-08-27 14:43:41,817 | HR @1|5|10: 0.1245 	 0.2423 	 0.2826 	
2025-08-27 14:43:41,817 | NDCG @5|10: 0.1862 	 0.1992
2025-08-27 14:43:41,817 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:43:56,004 | Epoch 15/60 - client 0 -  Training Loss: 34.066

 25%|##5       | 1/4 [00:12<00:37, 12.34s/it]2025-08-27 14:44:08,021 | Epoch 15/60 - client 3 -  Training Loss: 36.654

 50%|#####     | 2/4 [00:24<00:24, 12.15s/it]2025-08-27 14:44:24,407 | Epoch 15/60 - client 2 -  Training Loss: 34.788

 75%|#######5  | 3/4 [00:40<00:14, 14.08s/it]2025-08-27 14:44:54,775 | Epoch 15/60 - client 1 -  Training Loss: 37.682

100%|##########| 4/4 [01:11<00:00, 20.51s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:44:58,684 | Epoch15 Valid:
2025-08-27 14:44:58,685 | domain:Food
2025-08-27 14:44:58,685 | model_moe:
2025-08-27 14:44:58,685 | MRR: 0.3627
2025-08-27 14:44:58,686 | HR @1|5|10: 0.2701 	 0.4836 	 0.5356 	
2025-08-27 14:44:58,686 | NDCG @5|10: 0.3833 	 0.4004
2025-08-27 14:44:58,686 | domain:Kitchen
2025-08-27 14:44:58,687 | model_moe:
2025-08-27 14:44:58,687 | MRR: 0.1023
2025-08-27 14:44:58,687 | HR @1|5|10: 0.0589 	 0.1340 	 0.1832 	
2025-08-27 14:44:58,688 | NDCG @5|10: 0.0976 	 0.1135
2025-08-27 14:44:58,688 | domain:Clothing
2025-08-27 14:44:58,688 | model_moe:
2025-08-27 14:44:58,689 | MRR: 0.0233
2025-08-27 14:44:58,689 | HR @1|5|10: 0.0122 	 0.0232 	 0.0416 	
2025-08-27 14:44:58,689 | NDCG @5|10: 0.0179 	 0.0238
2025-08-27 14:44:58,689 | domain:Beauty
2025-08-27 14:44:58,690 | model_moe:
2025-08-27 14:44:58,690 | MRR: 0.2494
2025-08-27 14:44:58,690 | HR @1|5|10: 0.1806 	 0.3361 	 0.3852 	
2025-08-27 14:44:58,691 | NDCG @5|10: 0.2611 	 0.2769
2025-08-27 14:44:58,691 | 	avg_model_moe:
2025-08-27 14:44:58,691 | MRR: 0.1844
2025-08-27 14:44:58,691 | HR @1|5|10: 0.1305 	 0.2442 	 0.2864 	
2025-08-27 14:44:58,692 | NDCG @5|10: 0.1900 	 0.2037
2025-08-27 14:44:58,692 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:45:17,118 | Epoch 16/60 - client 2 -  Training Loss: 34.223

 25%|##5       | 1/4 [00:16<00:49, 16.50s/it]2025-08-27 14:45:47,500 | Epoch 16/60 - client 1 -  Training Loss: 37.200

 50%|#####     | 2/4 [00:46<00:49, 24.66s/it]2025-08-27 14:45:59,577 | Epoch 16/60 - client 3 -  Training Loss: 36.216

 75%|#######5  | 3/4 [00:58<00:18, 18.92s/it]2025-08-27 14:46:11,991 | Epoch 16/60 - client 0 -  Training Loss: 33.717

100%|##########| 4/4 [01:11<00:00, 16.35s/it]
100%|##########| 4/4 [01:11<00:00, 17.84s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 14:46:15,918 | Epoch16 Valid:
2025-08-27 14:46:15,919 | domain:Food
2025-08-27 14:46:15,919 | model_moe:
2025-08-27 14:46:15,919 | MRR: 0.3602
2025-08-27 14:46:15,919 | HR @1|5|10: 0.2632 	 0.4836 	 0.5363 	
2025-08-27 14:46:15,920 | NDCG @5|10: 0.3813 	 0.3987
2025-08-27 14:46:15,920 | domain:Kitchen
2025-08-27 14:46:15,920 | model_moe:
2025-08-27 14:46:15,921 | MRR: 0.1000
2025-08-27 14:46:15,921 | HR @1|5|10: 0.0557 	 0.1335 	 0.1809 	
2025-08-27 14:46:15,921 | NDCG @5|10: 0.0962 	 0.1114
2025-08-27 14:46:15,921 | domain:Clothing
2025-08-27 14:46:15,922 | model_moe:
2025-08-27 14:46:15,922 | MRR: 0.0233
2025-08-27 14:46:15,922 | HR @1|5|10: 0.0122 	 0.0269 	 0.0391 	
2025-08-27 14:46:15,923 | NDCG @5|10: 0.0192 	 0.0231
2025-08-27 14:46:15,923 | domain:Beauty
2025-08-27 14:46:15,923 | model_moe:
2025-08-27 14:46:15,923 | MRR: 0.2484
2025-08-27 14:46:15,924 | HR @1|5|10: 0.1806 	 0.3337 	 0.3828 	
2025-08-27 14:46:15,924 | NDCG @5|10: 0.2594 	 0.2753
2025-08-27 14:46:15,924 | 	avg_model_moe:
2025-08-27 14:46:15,925 | MRR: 0.1830
2025-08-27 14:46:15,925 | HR @1|5|10: 0.1279 	 0.2444 	 0.2848 	
2025-08-27 14:46:15,925 | NDCG @5|10: 0.1890 	 0.2021
2025-08-27 14:46:15,925 | Early Stopping counter: 1 out of 10
2025-08-27 14:46:15,926 | Learning rate decay counter: 1 out of 1
2025-08-27 14:46:15,926 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:46:32,383 | Epoch 17/60 - client 2 -  Training Loss: 33.701

 25%|##5       | 1/4 [00:16<00:49, 16.46s/it]2025-08-27 14:47:02,841 | Epoch 17/60 - client 1 -  Training Loss: 36.753

 50%|#####     | 2/4 [00:46<00:49, 24.69s/it]2025-08-27 14:47:15,135 | Epoch 17/60 - client 0 -  Training Loss: 33.398

 75%|#######5  | 3/4 [00:59<00:19, 19.03s/it]2025-08-27 14:47:27,080 | Epoch 17/60 - client 3 -  Training Loss: 35.802

100%|##########| 4/4 [01:11<00:00, 16.23s/it]
100%|##########| 4/4 [01:11<00:00, 17.79s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:47:30,982 | Epoch17 Valid:
2025-08-27 14:47:30,983 | domain:Food
2025-08-27 14:47:30,983 | model_moe:
2025-08-27 14:47:30,983 | MRR: 0.3626
2025-08-27 14:47:30,984 | HR @1|5|10: 0.2663 	 0.4836 	 0.5386 	
2025-08-27 14:47:30,984 | NDCG @5|10: 0.3831 	 0.4012
2025-08-27 14:47:30,984 | domain:Kitchen
2025-08-27 14:47:30,984 | model_moe:
2025-08-27 14:47:30,985 | MRR: 0.1012
2025-08-27 14:47:30,985 | HR @1|5|10: 0.0552 	 0.1354 	 0.1878 	
2025-08-27 14:47:30,985 | NDCG @5|10: 0.0972 	 0.1141
2025-08-27 14:47:30,986 | domain:Clothing
2025-08-27 14:47:30,986 | model_moe:
2025-08-27 14:47:30,986 | MRR: 0.0252
2025-08-27 14:47:30,986 | HR @1|5|10: 0.0147 	 0.0306 	 0.0416 	
2025-08-27 14:47:30,987 | NDCG @5|10: 0.0220 	 0.0254
2025-08-27 14:47:30,987 | domain:Beauty
2025-08-27 14:47:30,987 | model_moe:
2025-08-27 14:47:30,987 | MRR: 0.2484
2025-08-27 14:47:30,988 | HR @1|5|10: 0.1782 	 0.3397 	 0.3840 	
2025-08-27 14:47:30,988 | NDCG @5|10: 0.2615 	 0.2758
2025-08-27 14:47:30,988 | 	avg_model_moe:
2025-08-27 14:47:30,988 | MRR: 0.1844
2025-08-27 14:47:30,989 | HR @1|5|10: 0.1286 	 0.2473 	 0.2880 	
2025-08-27 14:47:30,989 | NDCG @5|10: 0.1909 	 0.2041
2025-08-27 14:47:30,989 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:47:42,937 | Epoch 18/60 - client 3 -  Training Loss: 35.427

 25%|##5       | 1/4 [00:11<00:35, 11.95s/it]2025-08-27 14:47:55,305 | Epoch 18/60 - client 0 -  Training Loss: 33.107

 50%|#####     | 2/4 [00:24<00:24, 12.20s/it]2025-08-27 14:48:11,747 | Epoch 18/60 - client 2 -  Training Loss: 33.231

 75%|#######5  | 3/4 [00:40<00:14, 14.13s/it]2025-08-27 14:48:42,080 | Epoch 18/60 - client 1 -  Training Loss: 36.341

100%|##########| 4/4 [01:11<00:00, 20.53s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:48:45,974 | Epoch18 Valid:
2025-08-27 14:48:45,975 | domain:Food
2025-08-27 14:48:45,975 | model_moe:
2025-08-27 14:48:45,975 | MRR: 0.3609
2025-08-27 14:48:45,976 | HR @1|5|10: 0.2647 	 0.4843 	 0.5409 	
2025-08-27 14:48:45,976 | NDCG @5|10: 0.3818 	 0.4004
2025-08-27 14:48:45,976 | domain:Kitchen
2025-08-27 14:48:45,976 | model_moe:
2025-08-27 14:48:45,977 | MRR: 0.1036
2025-08-27 14:48:45,977 | HR @1|5|10: 0.0580 	 0.1395 	 0.1892 	
2025-08-27 14:48:45,977 | NDCG @5|10: 0.1001 	 0.1162
2025-08-27 14:48:45,978 | domain:Clothing
2025-08-27 14:48:45,978 | model_moe:
2025-08-27 14:48:45,978 | MRR: 0.0246
2025-08-27 14:48:45,978 | HR @1|5|10: 0.0134 	 0.0281 	 0.0379 	
2025-08-27 14:48:45,979 | NDCG @5|10: 0.0205 	 0.0238
2025-08-27 14:48:45,979 | domain:Beauty
2025-08-27 14:48:45,979 | model_moe:
2025-08-27 14:48:45,980 | MRR: 0.2511
2025-08-27 14:48:45,980 | HR @1|5|10: 0.1842 	 0.3325 	 0.3852 	
2025-08-27 14:48:45,980 | NDCG @5|10: 0.2609 	 0.2780
2025-08-27 14:48:45,980 | 	avg_model_moe:
2025-08-27 14:48:45,981 | MRR: 0.1850
2025-08-27 14:48:45,981 | HR @1|5|10: 0.1301 	 0.2461 	 0.2883 	
2025-08-27 14:48:45,981 | NDCG @5|10: 0.1909 	 0.2046
2025-08-27 14:48:45,981 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:48:59,881 | Epoch 19/60 - client 3 -  Training Loss: 35.059

 25%|##5       | 1/4 [00:11<00:35, 11.89s/it]2025-08-27 14:49:16,542 | Epoch 19/60 - client 2 -  Training Loss: 32.773

 50%|#####     | 2/4 [00:28<00:29, 14.70s/it]2025-08-27 14:49:47,017 | Epoch 19/60 - client 1 -  Training Loss: 35.943

 75%|#######5  | 3/4 [00:59<00:21, 21.90s/it]2025-08-27 14:49:59,304 | Epoch 19/60 - client 0 -  Training Loss: 32.826

100%|##########| 4/4 [01:11<00:00, 18.11s/it]
100%|##########| 4/4 [01:11<00:00, 17.83s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:50:03,183 | Epoch19 Valid:
2025-08-27 14:50:03,184 | domain:Food
2025-08-27 14:50:03,184 | model_moe:
2025-08-27 14:50:03,392 | MRR: 0.3646
2025-08-27 14:50:03,392 | HR @1|5|10: 0.2701 	 0.4813 	 0.5402 	
2025-08-27 14:50:03,393 | NDCG @5|10: 0.3836 	 0.4030
2025-08-27 14:50:03,393 | domain:Kitchen
2025-08-27 14:50:03,393 | model_moe:
2025-08-27 14:50:03,394 | MRR: 0.1023
2025-08-27 14:50:03,394 | HR @1|5|10: 0.0562 	 0.1358 	 0.1901 	
2025-08-27 14:50:03,394 | NDCG @5|10: 0.0980 	 0.1156
2025-08-27 14:50:03,394 | domain:Clothing
2025-08-27 14:50:03,395 | model_moe:
2025-08-27 14:50:03,395 | MRR: 0.0258
2025-08-27 14:50:03,395 | HR @1|5|10: 0.0147 	 0.0293 	 0.0403 	
2025-08-27 14:50:03,396 | NDCG @5|10: 0.0218 	 0.0253
2025-08-27 14:50:03,396 | domain:Beauty
2025-08-27 14:50:03,396 | model_moe:
2025-08-27 14:50:03,396 | MRR: 0.2495
2025-08-27 14:50:03,397 | HR @1|5|10: 0.1782 	 0.3385 	 0.3852 	
2025-08-27 14:50:03,397 | NDCG @5|10: 0.2619 	 0.2770
2025-08-27 14:50:03,397 | 	avg_model_moe:
2025-08-27 14:50:03,397 | MRR: 0.1855
2025-08-27 14:50:03,398 | HR @1|5|10: 0.1298 	 0.2462 	 0.2890 	
2025-08-27 14:50:03,398 | NDCG @5|10: 0.1913 	 0.2052
2025-08-27 14:50:03,398 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:50:35,676 | Epoch 20/60 - client 1 -  Training Loss: 35.555

 25%|##5       | 1/4 [00:30<01:30, 30.32s/it]2025-08-27 14:50:52,062 | Epoch 20/60 - client 2 -  Training Loss: 32.351

 50%|#####     | 2/4 [00:46<00:44, 22.12s/it]2025-08-27 14:51:03,998 | Epoch 20/60 - client 3 -  Training Loss: 34.712

 75%|#######5  | 3/4 [00:58<00:17, 17.47s/it]2025-08-27 14:51:16,188 | Epoch 20/60 - client 0 -  Training Loss: 32.565

100%|##########| 4/4 [01:10<00:00, 15.39s/it]
100%|##########| 4/4 [01:10<00:00, 17.71s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:51:20,042 | Epoch20 Valid:
2025-08-27 14:51:20,043 | domain:Food
2025-08-27 14:51:20,043 | model_moe:
2025-08-27 14:51:20,043 | MRR: 0.3637
2025-08-27 14:51:20,043 | HR @1|5|10: 0.2678 	 0.4858 	 0.5425 	
2025-08-27 14:51:20,044 | NDCG @5|10: 0.3845 	 0.4030
2025-08-27 14:51:20,044 | domain:Kitchen
2025-08-27 14:51:20,044 | model_moe:
2025-08-27 14:51:20,045 | MRR: 0.1040
2025-08-27 14:51:20,045 | HR @1|5|10: 0.0566 	 0.1427 	 0.1989 	
2025-08-27 14:51:20,045 | NDCG @5|10: 0.1013 	 0.1193
2025-08-27 14:51:20,045 | domain:Clothing
2025-08-27 14:51:20,046 | model_moe:
2025-08-27 14:51:20,046 | MRR: 0.0241
2025-08-27 14:51:20,046 | HR @1|5|10: 0.0122 	 0.0244 	 0.0440 	
2025-08-27 14:51:20,047 | NDCG @5|10: 0.0188 	 0.0251
2025-08-27 14:51:20,047 | domain:Beauty
2025-08-27 14:51:20,047 | model_moe:
2025-08-27 14:51:20,047 | MRR: 0.2501
2025-08-27 14:51:20,048 | HR @1|5|10: 0.1794 	 0.3385 	 0.3828 	
2025-08-27 14:51:20,048 | NDCG @5|10: 0.2620 	 0.2767
2025-08-27 14:51:20,048 | 	avg_model_moe:
2025-08-27 14:51:20,048 | MRR: 0.1855
2025-08-27 14:51:20,049 | HR @1|5|10: 0.1290 	 0.2479 	 0.2920 	
2025-08-27 14:51:20,049 | NDCG @5|10: 0.1916 	 0.2060
2025-08-27 14:51:20,049 | Early Stopping counter: 1 out of 10
2025-08-27 14:51:20,050 | Learning rate decay counter: 1 out of 1
2025-08-27 14:51:20,050 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:51:31,954 | Epoch 21/60 - client 3 -  Training Loss: 34.392

 25%|##5       | 1/4 [00:11<00:35, 11.90s/it]2025-08-27 14:51:48,359 | Epoch 21/60 - client 2 -  Training Loss: 31.966

 50%|#####     | 2/4 [00:28<00:29, 14.55s/it]2025-08-27 14:52:18,571 | Epoch 21/60 - client 1 -  Training Loss: 35.196

 75%|#######5  | 3/4 [00:58<00:21, 21.70s/it]2025-08-27 14:52:30,762 | Epoch 21/60 - client 0 -  Training Loss: 32.316

100%|##########| 4/4 [01:10<00:00, 17.95s/it]
100%|##########| 4/4 [01:10<00:00, 17.68s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:52:34,632 | Epoch21 Valid:
2025-08-27 14:52:34,633 | domain:Food
2025-08-27 14:52:34,633 | model_moe:
2025-08-27 14:52:34,633 | MRR: 0.3659
2025-08-27 14:52:34,634 | HR @1|5|10: 0.2716 	 0.4843 	 0.5402 	
2025-08-27 14:52:34,634 | NDCG @5|10: 0.3856 	 0.4039
2025-08-27 14:52:34,634 | domain:Kitchen
2025-08-27 14:52:34,635 | model_moe:
2025-08-27 14:52:34,635 | MRR: 0.1049
2025-08-27 14:52:34,635 | HR @1|5|10: 0.0562 	 0.1455 	 0.1975 	
2025-08-27 14:52:34,635 | NDCG @5|10: 0.1027 	 0.1195
2025-08-27 14:52:34,636 | domain:Clothing
2025-08-27 14:52:34,636 | model_moe:
2025-08-27 14:52:34,636 | MRR: 0.0261
2025-08-27 14:52:34,637 | HR @1|5|10: 0.0147 	 0.0269 	 0.0416 	
2025-08-27 14:52:34,637 | NDCG @5|10: 0.0209 	 0.0257
2025-08-27 14:52:34,637 | domain:Beauty
2025-08-27 14:52:34,637 | model_moe:
2025-08-27 14:52:34,638 | MRR: 0.2512
2025-08-27 14:52:34,638 | HR @1|5|10: 0.1818 	 0.3373 	 0.3816 	
2025-08-27 14:52:34,638 | NDCG @5|10: 0.2626 	 0.2773
2025-08-27 14:52:34,638 | 	avg_model_moe:
2025-08-27 14:52:34,639 | MRR: 0.1870
2025-08-27 14:52:34,639 | HR @1|5|10: 0.1311 	 0.2485 	 0.2902 	
2025-08-27 14:52:34,639 | NDCG @5|10: 0.1929 	 0.2066
2025-08-27 14:52:34,640 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:52:48,664 | Epoch 22/60 - client 0 -  Training Loss: 32.082

 25%|##5       | 1/4 [00:12<00:36, 12.19s/it]2025-08-27 14:53:05,054 | Epoch 22/60 - client 2 -  Training Loss: 31.605

 50%|#####     | 2/4 [00:28<00:29, 14.66s/it]2025-08-27 14:53:16,930 | Epoch 22/60 - client 3 -  Training Loss: 34.089

 75%|#######5  | 3/4 [00:40<00:13, 13.39s/it]2025-08-27 14:53:47,211 | Epoch 22/60 - client 1 -  Training Loss: 34.847

100%|##########| 4/4 [01:10<00:00, 20.06s/it]
100%|##########| 4/4 [01:10<00:00, 17.68s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:53:51,077 | Epoch22 Valid:
2025-08-27 14:53:51,077 | domain:Food
2025-08-27 14:53:51,078 | model_moe:
2025-08-27 14:53:51,078 | MRR: 0.3654
2025-08-27 14:53:51,078 | HR @1|5|10: 0.2708 	 0.4851 	 0.5455 	
2025-08-27 14:53:51,079 | NDCG @5|10: 0.3853 	 0.4049
2025-08-27 14:53:51,079 | domain:Kitchen
2025-08-27 14:53:51,079 | model_moe:
2025-08-27 14:53:51,080 | MRR: 0.1058
2025-08-27 14:53:51,080 | HR @1|5|10: 0.0571 	 0.1459 	 0.2021 	
2025-08-27 14:53:51,080 | NDCG @5|10: 0.1033 	 0.1212
2025-08-27 14:53:51,081 | domain:Clothing
2025-08-27 14:53:51,081 | model_moe:
2025-08-27 14:53:51,081 | MRR: 0.0256
2025-08-27 14:53:51,082 | HR @1|5|10: 0.0134 	 0.0281 	 0.0416 	
2025-08-27 14:53:51,082 | NDCG @5|10: 0.0210 	 0.0253
2025-08-27 14:53:51,082 | domain:Beauty
2025-08-27 14:53:51,083 | model_moe:
2025-08-27 14:53:51,083 | MRR: 0.2487
2025-08-27 14:53:51,083 | HR @1|5|10: 0.1782 	 0.3397 	 0.3816 	
2025-08-27 14:53:51,084 | NDCG @5|10: 0.2615 	 0.2752
2025-08-27 14:53:51,084 | 	avg_model_moe:
2025-08-27 14:53:51,084 | MRR: 0.1863
2025-08-27 14:53:51,084 | HR @1|5|10: 0.1299 	 0.2497 	 0.2927 	
2025-08-27 14:53:51,085 | NDCG @5|10: 0.1928 	 0.2067
2025-08-27 14:53:51,085 | Early Stopping counter: 1 out of 10
2025-08-27 14:53:51,085 | Learning rate decay counter: 1 out of 1
2025-08-27 14:53:51,086 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:54:02,956 | Epoch 23/60 - client 3 -  Training Loss: 33.797

 25%|##5       | 1/4 [00:11<00:35, 11.87s/it]2025-08-27 14:54:15,145 | Epoch 23/60 - client 0 -  Training Loss: 31.850

 50%|#####     | 2/4 [00:24<00:24, 12.06s/it]2025-08-27 14:54:45,333 | Epoch 23/60 - client 1 -  Training Loss: 34.514

 75%|#######5  | 3/4 [00:54<00:20, 20.34s/it]2025-08-27 14:55:01,671 | Epoch 23/60 - client 2 -  Training Loss: 31.257

100%|##########| 4/4 [01:10<00:00, 18.76s/it]
100%|##########| 4/4 [01:10<00:00, 17.65s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:55:05,530 | Epoch23 Valid:
2025-08-27 14:55:05,530 | domain:Food
2025-08-27 14:55:05,531 | model_moe:
2025-08-27 14:55:05,531 | MRR: 0.3653
2025-08-27 14:55:05,531 | HR @1|5|10: 0.2701 	 0.4843 	 0.5432 	
2025-08-27 14:55:05,532 | NDCG @5|10: 0.3851 	 0.4043
2025-08-27 14:55:05,532 | domain:Kitchen
2025-08-27 14:55:05,532 | model_moe:
2025-08-27 14:55:05,533 | MRR: 0.1066
2025-08-27 14:55:05,533 | HR @1|5|10: 0.0585 	 0.1446 	 0.1994 	
2025-08-27 14:55:05,533 | NDCG @5|10: 0.1034 	 0.1211
2025-08-27 14:55:05,534 | domain:Clothing
2025-08-27 14:55:05,534 | model_moe:
2025-08-27 14:55:05,534 | MRR: 0.0261
2025-08-27 14:55:05,534 | HR @1|5|10: 0.0147 	 0.0269 	 0.0416 	
2025-08-27 14:55:05,535 | NDCG @5|10: 0.0210 	 0.0257
2025-08-27 14:55:05,535 | domain:Beauty
2025-08-27 14:55:05,535 | model_moe:
2025-08-27 14:55:05,536 | MRR: 0.2476
2025-08-27 14:55:05,536 | HR @1|5|10: 0.1770 	 0.3325 	 0.3816 	
2025-08-27 14:55:05,536 | NDCG @5|10: 0.2584 	 0.2745
2025-08-27 14:55:05,536 | 	avg_model_moe:
2025-08-27 14:55:05,537 | MRR: 0.1864
2025-08-27 14:55:05,537 | HR @1|5|10: 0.1301 	 0.2471 	 0.2914 	
2025-08-27 14:55:05,537 | NDCG @5|10: 0.1920 	 0.2064
2025-08-27 14:55:05,538 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:55:17,508 | Epoch 24/60 - client 3 -  Training Loss: 33.518

 25%|##5       | 1/4 [00:11<00:35, 11.97s/it]2025-08-27 14:55:33,846 | Epoch 24/60 - client 2 -  Training Loss: 30.936

 50%|#####     | 2/4 [00:28<00:29, 14.54s/it]2025-08-27 14:56:04,016 | Epoch 24/60 - client 1 -  Training Loss: 34.197

 75%|#######5  | 3/4 [00:58<00:21, 21.68s/it]2025-08-27 14:56:16,234 | Epoch 24/60 - client 0 -  Training Loss: 31.633

100%|##########| 4/4 [01:10<00:00, 17.94s/it]
100%|##########| 4/4 [01:10<00:00, 17.67s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 14:56:20,123 | Epoch24 Valid:
2025-08-27 14:56:20,123 | domain:Food
2025-08-27 14:56:20,124 | model_moe:
2025-08-27 14:56:20,124 | MRR: 0.3669
2025-08-27 14:56:20,124 | HR @1|5|10: 0.2716 	 0.4874 	 0.5432 	
2025-08-27 14:56:20,125 | NDCG @5|10: 0.3874 	 0.4056
2025-08-27 14:56:20,125 | domain:Kitchen
2025-08-27 14:56:20,125 | model_moe:
2025-08-27 14:56:20,125 | MRR: 0.1057
2025-08-27 14:56:20,126 | HR @1|5|10: 0.0566 	 0.1492 	 0.2049 	
2025-08-27 14:56:20,126 | NDCG @5|10: 0.1041 	 0.1220
2025-08-27 14:56:20,126 | domain:Clothing
2025-08-27 14:56:20,127 | model_moe:
2025-08-27 14:56:20,127 | MRR: 0.0260
2025-08-27 14:56:20,127 | HR @1|5|10: 0.0147 	 0.0293 	 0.0416 	
2025-08-27 14:56:20,127 | NDCG @5|10: 0.0217 	 0.0256
2025-08-27 14:56:20,128 | domain:Beauty
2025-08-27 14:56:20,128 | model_moe:
2025-08-27 14:56:20,128 | MRR: 0.2495
2025-08-27 14:56:20,129 | HR @1|5|10: 0.1794 	 0.3325 	 0.3840 	
2025-08-27 14:56:20,129 | NDCG @5|10: 0.2598 	 0.2766
2025-08-27 14:56:20,129 | 	avg_model_moe:
2025-08-27 14:56:20,129 | MRR: 0.1870
2025-08-27 14:56:20,130 | HR @1|5|10: 0.1306 	 0.2496 	 0.2934 	
2025-08-27 14:56:20,130 | NDCG @5|10: 0.1932 	 0.2074
2025-08-27 14:56:20,130 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:56:52,934 | Epoch 25/60 - client 1 -  Training Loss: 33.890

 25%|##5       | 1/4 [00:30<01:31, 30.34s/it]2025-08-27 14:57:09,449 | Epoch 25/60 - client 2 -  Training Loss: 30.640

 50%|#####     | 2/4 [00:46<00:44, 22.21s/it]2025-08-27 14:57:21,408 | Epoch 25/60 - client 3 -  Training Loss: 33.255

 75%|#######5  | 3/4 [00:58<00:17, 17.53s/it]2025-08-27 14:57:33,690 | Epoch 25/60 - client 0 -  Training Loss: 31.426

100%|##########| 4/4 [01:11<00:00, 15.46s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 14:57:37,569 | Epoch25 Valid:
2025-08-27 14:57:37,570 | domain:Food
2025-08-27 14:57:37,570 | model_moe:
2025-08-27 14:57:37,571 | MRR: 0.3645
2025-08-27 14:57:37,571 | HR @1|5|10: 0.2693 	 0.4858 	 0.5417 	
2025-08-27 14:57:37,571 | NDCG @5|10: 0.3851 	 0.4033
2025-08-27 14:57:37,571 | domain:Kitchen
2025-08-27 14:57:37,572 | model_moe:
2025-08-27 14:57:37,572 | MRR: 0.1087
2025-08-27 14:57:37,572 | HR @1|5|10: 0.0589 	 0.1515 	 0.2053 	
2025-08-27 14:57:37,573 | NDCG @5|10: 0.1069 	 0.1243
2025-08-27 14:57:37,573 | domain:Clothing
2025-08-27 14:57:37,573 | model_moe:
2025-08-27 14:57:37,573 | MRR: 0.0254
2025-08-27 14:57:37,574 | HR @1|5|10: 0.0134 	 0.0269 	 0.0391 	
2025-08-27 14:57:37,574 | NDCG @5|10: 0.0204 	 0.0244
2025-08-27 14:57:37,574 | domain:Beauty
2025-08-27 14:57:37,575 | model_moe:
2025-08-27 14:57:37,575 | MRR: 0.2484
2025-08-27 14:57:37,575 | HR @1|5|10: 0.1782 	 0.3361 	 0.3816 	
2025-08-27 14:57:37,576 | NDCG @5|10: 0.2602 	 0.2751
2025-08-27 14:57:37,576 | 	avg_model_moe:
2025-08-27 14:57:37,576 | MRR: 0.1868
2025-08-27 14:57:37,576 | HR @1|5|10: 0.1300 	 0.2501 	 0.2919 	
2025-08-27 14:57:37,577 | NDCG @5|10: 0.1932 	 0.2068
2025-08-27 14:57:37,577 | Early Stopping counter: 1 out of 10
2025-08-27 14:57:37,577 | Learning rate decay counter: 1 out of 1
2025-08-27 14:57:37,578 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:58:07,901 | Epoch 26/60 - client 1 -  Training Loss: 33.614

 25%|##5       | 1/4 [00:30<01:30, 30.32s/it]2025-08-27 14:58:19,862 | Epoch 26/60 - client 3 -  Training Loss: 32.998

 50%|#####     | 2/4 [00:42<00:39, 19.52s/it]2025-08-27 14:58:32,129 | Epoch 26/60 - client 0 -  Training Loss: 31.234

 75%|#######5  | 3/4 [00:54<00:16, 16.21s/it]2025-08-27 14:58:48,642 | Epoch 26/60 - client 2 -  Training Loss: 30.344

100%|##########| 4/4 [01:11<00:00, 16.33s/it]
100%|##########| 4/4 [01:11<00:00, 17.77s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 14:58:52,563 | Epoch26 Valid:
2025-08-27 14:58:52,563 | domain:Food
2025-08-27 14:58:52,563 | model_moe:
2025-08-27 14:58:52,564 | MRR: 0.3666
2025-08-27 14:58:52,564 | HR @1|5|10: 0.2724 	 0.4843 	 0.5440 	
2025-08-27 14:58:52,564 | NDCG @5|10: 0.3861 	 0.4054
2025-08-27 14:58:52,565 | domain:Kitchen
2025-08-27 14:58:52,565 | model_moe:
2025-08-27 14:58:52,565 | MRR: 0.1088
2025-08-27 14:58:52,565 | HR @1|5|10: 0.0594 	 0.1519 	 0.2113 	
2025-08-27 14:58:52,566 | NDCG @5|10: 0.1069 	 0.1261
2025-08-27 14:58:52,566 | domain:Clothing
2025-08-27 14:58:52,566 | model_moe:
2025-08-27 14:58:52,567 | MRR: 0.0262
2025-08-27 14:58:52,567 | HR @1|5|10: 0.0147 	 0.0318 	 0.0416 	
2025-08-27 14:58:52,567 | NDCG @5|10: 0.0227 	 0.0257
2025-08-27 14:58:52,568 | domain:Beauty
2025-08-27 14:58:52,568 | model_moe:
2025-08-27 14:58:52,568 | MRR: 0.2517
2025-08-27 14:58:52,568 | HR @1|5|10: 0.1830 	 0.3361 	 0.3840 	
2025-08-27 14:58:52,569 | NDCG @5|10: 0.2625 	 0.2783
2025-08-27 14:58:52,569 | 	avg_model_moe:
2025-08-27 14:58:52,569 | MRR: 0.1883
2025-08-27 14:58:52,569 | HR @1|5|10: 0.1324 	 0.2510 	 0.2952 	
2025-08-27 14:58:52,570 | NDCG @5|10: 0.1945 	 0.2089
2025-08-27 14:58:52,570 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 14:59:10,694 | Epoch 27/60 - client 2 -  Training Loss: 30.081

 25%|##5       | 1/4 [00:16<00:48, 16.28s/it]2025-08-27 14:59:40,781 | Epoch 27/60 - client 1 -  Training Loss: 33.345

 50%|#####     | 2/4 [00:46<00:48, 24.40s/it]2025-08-27 14:59:52,934 | Epoch 27/60 - client 0 -  Training Loss: 31.041

 75%|#######5  | 3/4 [00:58<00:18, 18.81s/it]2025-08-27 15:00:04,789 | Epoch 27/60 - client 3 -  Training Loss: 32.771

100%|##########| 4/4 [01:10<00:00, 16.06s/it]
100%|##########| 4/4 [01:10<00:00, 17.59s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 15:00:08,646 | Epoch27 Valid:
2025-08-27 15:00:08,646 | domain:Food
2025-08-27 15:00:08,647 | model_moe:
2025-08-27 15:00:08,647 | MRR: 0.3674
2025-08-27 15:00:08,647 | HR @1|5|10: 0.2724 	 0.4881 	 0.5471 	
2025-08-27 15:00:08,647 | NDCG @5|10: 0.3879 	 0.4070
2025-08-27 15:00:08,648 | domain:Kitchen
2025-08-27 15:00:08,648 | model_moe:
2025-08-27 15:00:08,648 | MRR: 0.1097
2025-08-27 15:00:08,649 | HR @1|5|10: 0.0585 	 0.1547 	 0.2127 	
2025-08-27 15:00:08,649 | NDCG @5|10: 0.1081 	 0.1270
2025-08-27 15:00:08,649 | domain:Clothing
2025-08-27 15:00:08,650 | model_moe:
2025-08-27 15:00:08,650 | MRR: 0.0261
2025-08-27 15:00:08,650 | HR @1|5|10: 0.0134 	 0.0318 	 0.0452 	
2025-08-27 15:00:08,650 | NDCG @5|10: 0.0224 	 0.0266
2025-08-27 15:00:08,651 | domain:Beauty
2025-08-27 15:00:08,651 | model_moe:
2025-08-27 15:00:08,651 | MRR: 0.2511
2025-08-27 15:00:08,651 | HR @1|5|10: 0.1830 	 0.3349 	 0.3828 	
2025-08-27 15:00:08,652 | NDCG @5|10: 0.2617 	 0.2775
2025-08-27 15:00:08,652 | 	avg_model_moe:
2025-08-27 15:00:08,652 | MRR: 0.1886
2025-08-27 15:00:08,653 | HR @1|5|10: 0.1318 	 0.2524 	 0.2969 	
2025-08-27 15:00:08,653 | NDCG @5|10: 0.1950 	 0.2095
2025-08-27 15:00:08,653 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:00:23,316 | Epoch 28/60 - client 0 -  Training Loss: 30.865

 25%|##5       | 1/4 [00:12<00:37, 12.42s/it]2025-08-27 15:00:39,943 | Epoch 28/60 - client 2 -  Training Loss: 29.819

 50%|#####     | 2/4 [00:29<00:29, 14.89s/it]2025-08-27 15:01:10,420 | Epoch 28/60 - client 1 -  Training Loss: 33.068

 75%|#######5  | 3/4 [00:59<00:22, 22.01s/it]2025-08-27 15:01:22,419 | Epoch 28/60 - client 3 -  Training Loss: 32.534

100%|##########| 4/4 [01:11<00:00, 18.06s/it]
100%|##########| 4/4 [01:11<00:00, 17.88s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:04<00:00,  1.02s/it]
2025-08-27 15:01:26,506 | Epoch28 Valid:
2025-08-27 15:01:26,506 | domain:Food
2025-08-27 15:01:26,507 | model_moe:
2025-08-27 15:01:26,507 | MRR: 0.3636
2025-08-27 15:01:26,507 | HR @1|5|10: 0.2663 	 0.4897 	 0.5455 	
2025-08-27 15:01:26,508 | NDCG @5|10: 0.3857 	 0.4037
2025-08-27 15:01:26,508 | domain:Kitchen
2025-08-27 15:01:26,508 | model_moe:
2025-08-27 15:01:26,508 | MRR: 0.1104
2025-08-27 15:01:26,509 | HR @1|5|10: 0.0594 	 0.1547 	 0.2132 	
2025-08-27 15:01:26,509 | NDCG @5|10: 0.1086 	 0.1275
2025-08-27 15:01:26,509 | domain:Clothing
2025-08-27 15:01:26,510 | model_moe:
2025-08-27 15:01:26,510 | MRR: 0.0269
2025-08-27 15:01:26,510 | HR @1|5|10: 0.0134 	 0.0318 	 0.0489 	
2025-08-27 15:01:26,511 | NDCG @5|10: 0.0228 	 0.0283
2025-08-27 15:01:26,511 | domain:Beauty
2025-08-27 15:01:26,511 | model_moe:
2025-08-27 15:01:26,511 | MRR: 0.2485
2025-08-27 15:01:26,512 | HR @1|5|10: 0.1782 	 0.3361 	 0.3840 	
2025-08-27 15:01:26,512 | NDCG @5|10: 0.2601 	 0.2760
2025-08-27 15:01:26,512 | 	avg_model_moe:
2025-08-27 15:01:26,513 | MRR: 0.1874
2025-08-27 15:01:26,513 | HR @1|5|10: 0.1293 	 0.2531 	 0.2979 	
2025-08-27 15:01:26,513 | NDCG @5|10: 0.1943 	 0.2089
2025-08-27 15:01:26,514 | Early Stopping counter: 1 out of 10
2025-08-27 15:01:26,514 | Learning rate decay counter: 1 out of 1
2025-08-27 15:01:26,514 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:01:42,902 | Epoch 29/60 - client 2 -  Training Loss: 29.571

 25%|##5       | 1/4 [00:16<00:49, 16.39s/it]2025-08-27 15:01:54,836 | Epoch 29/60 - client 3 -  Training Loss: 32.305

 50%|#####     | 2/4 [00:28<00:27, 13.77s/it]2025-08-27 15:02:07,147 | Epoch 29/60 - client 0 -  Training Loss: 30.695

 75%|#######5  | 3/4 [00:40<00:13, 13.10s/it]2025-08-27 15:02:37,569 | Epoch 29/60 - client 1 -  Training Loss: 32.803

100%|##########| 4/4 [01:11<00:00, 19.94s/it]
100%|##########| 4/4 [01:11<00:00, 17.76s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:02:41,467 | Epoch29 Valid:
2025-08-27 15:02:41,468 | domain:Food
2025-08-27 15:02:41,468 | model_moe:
2025-08-27 15:02:41,468 | MRR: 0.3629
2025-08-27 15:02:41,469 | HR @1|5|10: 0.2655 	 0.4858 	 0.5455 	
2025-08-27 15:02:41,469 | NDCG @5|10: 0.3838 	 0.4033
2025-08-27 15:02:41,469 | domain:Kitchen
2025-08-27 15:02:41,470 | model_moe:
2025-08-27 15:02:41,470 | MRR: 0.1110
2025-08-27 15:02:41,470 | HR @1|5|10: 0.0599 	 0.1584 	 0.2164 	
2025-08-27 15:02:41,471 | NDCG @5|10: 0.1101 	 0.1288
2025-08-27 15:02:41,471 | domain:Clothing
2025-08-27 15:02:41,471 | model_moe:
2025-08-27 15:02:41,472 | MRR: 0.0273
2025-08-27 15:02:41,472 | HR @1|5|10: 0.0147 	 0.0330 	 0.0477 	
2025-08-27 15:02:41,472 | NDCG @5|10: 0.0237 	 0.0284
2025-08-27 15:02:41,472 | domain:Beauty
2025-08-27 15:02:41,473 | model_moe:
2025-08-27 15:02:41,473 | MRR: 0.2498
2025-08-27 15:02:41,473 | HR @1|5|10: 0.1794 	 0.3385 	 0.3816 	
2025-08-27 15:02:41,474 | NDCG @5|10: 0.2621 	 0.2765
2025-08-27 15:02:41,474 | 	avg_model_moe:
2025-08-27 15:02:41,474 | MRR: 0.1878
2025-08-27 15:02:41,474 | HR @1|5|10: 0.1299 	 0.2539 	 0.2978 	
2025-08-27 15:02:41,475 | NDCG @5|10: 0.1950 	 0.2092
2025-08-27 15:02:41,475 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:02:53,419 | Epoch 30/60 - client 3 -  Training Loss: 32.089

 25%|##5       | 1/4 [00:11<00:35, 11.94s/it]2025-08-27 15:03:05,743 | Epoch 30/60 - client 0 -  Training Loss: 30.527

 50%|#####     | 2/4 [00:24<00:24, 12.17s/it]2025-08-27 15:03:36,151 | Epoch 30/60 - client 1 -  Training Loss: 32.561

 75%|#######5  | 3/4 [00:54<00:20, 20.50s/it]2025-08-27 15:03:52,676 | Epoch 30/60 - client 2 -  Training Loss: 29.335

100%|##########| 4/4 [01:11<00:00, 18.93s/it]
100%|##########| 4/4 [01:11<00:00, 17.80s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:03:56,590 | Epoch30 Valid:
2025-08-27 15:03:56,590 | domain:Food
2025-08-27 15:03:56,590 | model_moe:
2025-08-27 15:03:56,591 | MRR: 0.3651
2025-08-27 15:03:56,591 | HR @1|5|10: 0.2678 	 0.4866 	 0.5402 	
2025-08-27 15:03:56,591 | NDCG @5|10: 0.3861 	 0.4035
2025-08-27 15:03:56,592 | domain:Kitchen
2025-08-27 15:03:56,592 | model_moe:
2025-08-27 15:03:56,592 | MRR: 0.1139
2025-08-27 15:03:56,592 | HR @1|5|10: 0.0631 	 0.1616 	 0.2164 	
2025-08-27 15:03:56,593 | NDCG @5|10: 0.1133 	 0.1311
2025-08-27 15:03:56,593 | domain:Clothing
2025-08-27 15:03:56,593 | model_moe:
2025-08-27 15:03:56,594 | MRR: 0.0281
2025-08-27 15:03:56,594 | HR @1|5|10: 0.0147 	 0.0342 	 0.0477 	
2025-08-27 15:03:56,594 | NDCG @5|10: 0.0246 	 0.0289
2025-08-27 15:03:56,595 | domain:Beauty
2025-08-27 15:03:56,595 | model_moe:
2025-08-27 15:03:56,595 | MRR: 0.2484
2025-08-27 15:03:56,595 | HR @1|5|10: 0.1782 	 0.3373 	 0.3840 	
2025-08-27 15:03:56,596 | NDCG @5|10: 0.2607 	 0.2761
2025-08-27 15:03:56,596 | 	avg_model_moe:
2025-08-27 15:03:56,596 | MRR: 0.1889
2025-08-27 15:03:56,597 | HR @1|5|10: 0.1309 	 0.2549 	 0.2971 	
2025-08-27 15:03:56,597 | NDCG @5|10: 0.1962 	 0.2099
2025-08-27 15:03:56,597 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:04:28,720 | Epoch 31/60 - client 1 -  Training Loss: 32.319

 25%|##5       | 1/4 [00:30<01:30, 30.16s/it]2025-08-27 15:04:40,600 | Epoch 31/60 - client 3 -  Training Loss: 31.897

 50%|#####     | 2/4 [00:42<00:38, 19.41s/it]2025-08-27 15:04:52,787 | Epoch 31/60 - client 0 -  Training Loss: 30.362

 75%|#######5  | 3/4 [00:54<00:16, 16.11s/it]2025-08-27 15:05:09,087 | Epoch 31/60 - client 2 -  Training Loss: 29.116

100%|##########| 4/4 [01:10<00:00, 16.19s/it]
100%|##########| 4/4 [01:10<00:00, 17.63s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:05:12,982 | Epoch31 Valid:
2025-08-27 15:05:12,983 | domain:Food
2025-08-27 15:05:12,983 | model_moe:
2025-08-27 15:05:12,983 | MRR: 0.3647
2025-08-27 15:05:12,983 | HR @1|5|10: 0.2686 	 0.4881 	 0.5425 	
2025-08-27 15:05:12,984 | NDCG @5|10: 0.3860 	 0.4037
2025-08-27 15:05:12,984 | domain:Kitchen
2025-08-27 15:05:12,984 | model_moe:
2025-08-27 15:05:12,985 | MRR: 0.1141
2025-08-27 15:05:12,985 | HR @1|5|10: 0.0631 	 0.1579 	 0.2187 	
2025-08-27 15:05:12,985 | NDCG @5|10: 0.1120 	 0.1316
2025-08-27 15:05:12,985 | domain:Clothing
2025-08-27 15:05:12,986 | model_moe:
2025-08-27 15:05:12,986 | MRR: 0.0278
2025-08-27 15:05:12,986 | HR @1|5|10: 0.0159 	 0.0306 	 0.0452 	
2025-08-27 15:05:12,987 | NDCG @5|10: 0.0233 	 0.0279
2025-08-27 15:05:12,987 | domain:Beauty
2025-08-27 15:05:12,987 | model_moe:
2025-08-27 15:05:12,987 | MRR: 0.2515
2025-08-27 15:05:12,988 | HR @1|5|10: 0.1818 	 0.3409 	 0.3828 	
2025-08-27 15:05:12,988 | NDCG @5|10: 0.2643 	 0.2780
2025-08-27 15:05:12,988 | 	avg_model_moe:
2025-08-27 15:05:12,989 | MRR: 0.1895
2025-08-27 15:05:12,989 | HR @1|5|10: 0.1323 	 0.2544 	 0.2973 	
2025-08-27 15:05:12,989 | NDCG @5|10: 0.1964 	 0.2103
2025-08-27 15:05:12,989 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:05:45,236 | Epoch 32/60 - client 1 -  Training Loss: 32.099

 25%|##5       | 1/4 [00:30<01:31, 30.39s/it]2025-08-27 15:05:57,173 | Epoch 32/60 - client 3 -  Training Loss: 31.686

 50%|#####     | 2/4 [00:42<00:39, 19.54s/it]2025-08-27 15:06:09,437 | Epoch 32/60 - client 0 -  Training Loss: 30.205

 75%|#######5  | 3/4 [00:54<00:16, 16.22s/it]2025-08-27 15:06:25,829 | Epoch 32/60 - client 2 -  Training Loss: 28.902

100%|##########| 4/4 [01:10<00:00, 16.29s/it]
100%|##########| 4/4 [01:10<00:00, 17.75s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:06:29,740 | Epoch32 Valid:
2025-08-27 15:06:29,741 | domain:Food
2025-08-27 15:06:29,741 | model_moe:
2025-08-27 15:06:29,741 | MRR: 0.3635
2025-08-27 15:06:29,742 | HR @1|5|10: 0.2670 	 0.4858 	 0.5417 	
2025-08-27 15:06:29,742 | NDCG @5|10: 0.3844 	 0.4026
2025-08-27 15:06:29,742 | domain:Kitchen
2025-08-27 15:06:29,743 | model_moe:
2025-08-27 15:06:29,743 | MRR: 0.1143
2025-08-27 15:06:29,743 | HR @1|5|10: 0.0612 	 0.1644 	 0.2187 	
2025-08-27 15:06:29,743 | NDCG @5|10: 0.1142 	 0.1318
2025-08-27 15:06:29,744 | domain:Clothing
2025-08-27 15:06:29,744 | model_moe:
2025-08-27 15:06:29,744 | MRR: 0.0281
2025-08-27 15:06:29,745 | HR @1|5|10: 0.0147 	 0.0330 	 0.0465 	
2025-08-27 15:06:29,745 | NDCG @5|10: 0.0243 	 0.0286
2025-08-27 15:06:29,745 | domain:Beauty
2025-08-27 15:06:29,745 | model_moe:
2025-08-27 15:06:29,746 | MRR: 0.2491
2025-08-27 15:06:29,746 | HR @1|5|10: 0.1794 	 0.3349 	 0.3792 	
2025-08-27 15:06:29,746 | NDCG @5|10: 0.2603 	 0.2750
2025-08-27 15:06:29,747 | 	avg_model_moe:
2025-08-27 15:06:29,747 | MRR: 0.1888
2025-08-27 15:06:29,747 | HR @1|5|10: 0.1306 	 0.2545 	 0.2965 	
2025-08-27 15:06:29,747 | NDCG @5|10: 0.1958 	 0.2095
2025-08-27 15:06:29,748 | Early Stopping counter: 1 out of 10
2025-08-27 15:06:29,748 | Learning rate decay counter: 1 out of 1
2025-08-27 15:06:29,748 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:06:46,158 | Epoch 33/60 - client 2 -  Training Loss: 28.696

 25%|##5       | 1/4 [00:16<00:49, 16.41s/it]2025-08-27 15:06:58,140 | Epoch 33/60 - client 3 -  Training Loss: 31.502

 50%|#####     | 2/4 [00:28<00:27, 13.81s/it]2025-08-27 15:07:28,611 | Epoch 33/60 - client 1 -  Training Loss: 31.883

 75%|#######5  | 3/4 [00:58<00:21, 21.42s/it]2025-08-27 15:07:40,890 | Epoch 33/60 - client 0 -  Training Loss: 30.057

100%|##########| 4/4 [01:11<00:00, 17.81s/it]
100%|##########| 4/4 [01:11<00:00, 17.79s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:07:44,781 | Epoch33 Valid:
2025-08-27 15:07:44,782 | domain:Food
2025-08-27 15:07:44,782 | model_moe:
2025-08-27 15:07:44,782 | MRR: 0.3649
2025-08-27 15:07:44,783 | HR @1|5|10: 0.2701 	 0.4851 	 0.5402 	
2025-08-27 15:07:44,783 | NDCG @5|10: 0.3852 	 0.4032
2025-08-27 15:07:44,783 | domain:Kitchen
2025-08-27 15:07:44,783 | model_moe:
2025-08-27 15:07:44,784 | MRR: 0.1152
2025-08-27 15:07:44,784 | HR @1|5|10: 0.0626 	 0.1644 	 0.2210 	
2025-08-27 15:07:44,784 | NDCG @5|10: 0.1149 	 0.1330
2025-08-27 15:07:44,785 | domain:Clothing
2025-08-27 15:07:44,785 | model_moe:
2025-08-27 15:07:44,785 | MRR: 0.0274
2025-08-27 15:07:44,785 | HR @1|5|10: 0.0147 	 0.0330 	 0.0465 	
2025-08-27 15:07:44,786 | NDCG @5|10: 0.0238 	 0.0281
2025-08-27 15:07:44,786 | domain:Beauty
2025-08-27 15:07:44,786 | model_moe:
2025-08-27 15:07:44,787 | MRR: 0.2500
2025-08-27 15:07:44,787 | HR @1|5|10: 0.1794 	 0.3385 	 0.3804 	
2025-08-27 15:07:44,787 | NDCG @5|10: 0.2625 	 0.2763
2025-08-27 15:07:44,787 | 	avg_model_moe:
2025-08-27 15:07:44,788 | MRR: 0.1894
2025-08-27 15:07:44,788 | HR @1|5|10: 0.1317 	 0.2552 	 0.2970 	
2025-08-27 15:07:44,788 | NDCG @5|10: 0.1966 	 0.2102
2025-08-27 15:07:44,789 | Early Stopping counter: 2 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:08:15,113 | Epoch 34/60 - client 1 -  Training Loss: 31.668

 25%|##5       | 1/4 [00:30<01:30, 30.33s/it]2025-08-27 15:08:27,086 | Epoch 34/60 - client 3 -  Training Loss: 31.316

 50%|#####     | 2/4 [00:42<00:39, 19.53s/it]2025-08-27 15:08:39,353 | Epoch 34/60 - client 0 -  Training Loss: 29.920

 75%|#######5  | 3/4 [00:54<00:16, 16.21s/it]2025-08-27 15:08:55,779 | Epoch 34/60 - client 2 -  Training Loss: 28.505

100%|##########| 4/4 [01:10<00:00, 16.30s/it]
100%|##########| 4/4 [01:10<00:00, 17.75s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 15:08:59,716 | Epoch34 Valid:
2025-08-27 15:08:59,716 | domain:Food
2025-08-27 15:08:59,716 | model_moe:
2025-08-27 15:08:59,717 | MRR: 0.3648
2025-08-27 15:08:59,717 | HR @1|5|10: 0.2693 	 0.4866 	 0.5440 	
2025-08-27 15:08:59,717 | NDCG @5|10: 0.3855 	 0.4043
2025-08-27 15:08:59,718 | domain:Kitchen
2025-08-27 15:08:59,718 | model_moe:
2025-08-27 15:08:59,718 | MRR: 0.1154
2025-08-27 15:08:59,718 | HR @1|5|10: 0.0617 	 0.1676 	 0.2196 	
2025-08-27 15:08:59,719 | NDCG @5|10: 0.1164 	 0.1331
2025-08-27 15:08:59,719 | domain:Clothing
2025-08-27 15:08:59,719 | model_moe:
2025-08-27 15:08:59,720 | MRR: 0.0267
2025-08-27 15:08:59,720 | HR @1|5|10: 0.0122 	 0.0318 	 0.0477 	
2025-08-27 15:08:59,720 | NDCG @5|10: 0.0227 	 0.0279
2025-08-27 15:08:59,720 | domain:Beauty
2025-08-27 15:08:59,721 | model_moe:
2025-08-27 15:08:59,721 | MRR: 0.2498
2025-08-27 15:08:59,721 | HR @1|5|10: 0.1794 	 0.3373 	 0.3804 	
2025-08-27 15:08:59,722 | NDCG @5|10: 0.2619 	 0.2761
2025-08-27 15:08:59,722 | 	avg_model_moe:
2025-08-27 15:08:59,722 | MRR: 0.1892
2025-08-27 15:08:59,722 | HR @1|5|10: 0.1307 	 0.2558 	 0.2979 	
2025-08-27 15:08:59,723 | NDCG @5|10: 0.1966 	 0.2103
2025-08-27 15:08:59,723 | Early Stopping counter: 3 out of 10
2025-08-27 15:08:59,723 | Learning rate decay counter: 1 out of 1
2025-08-27 15:08:59,724 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:09:30,186 | Epoch 35/60 - client 1 -  Training Loss: 31.478

 25%|##5       | 1/4 [00:30<01:31, 30.46s/it]2025-08-27 15:09:42,474 | Epoch 35/60 - client 0 -  Training Loss: 29.779

 50%|#####     | 2/4 [00:42<00:39, 19.77s/it]2025-08-27 15:09:58,869 | Epoch 35/60 - client 2 -  Training Loss: 28.326

 75%|#######5  | 3/4 [00:59<00:18, 18.23s/it]2025-08-27 15:10:10,848 | Epoch 35/60 - client 3 -  Training Loss: 31.146

100%|##########| 4/4 [01:11<00:00, 15.76s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.05it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:10:14,737 | Epoch35 Valid:
2025-08-27 15:10:14,738 | domain:Food
2025-08-27 15:10:14,738 | model_moe:
2025-08-27 15:10:14,738 | MRR: 0.3644
2025-08-27 15:10:14,739 | HR @1|5|10: 0.2678 	 0.4851 	 0.5440 	
2025-08-27 15:10:14,739 | NDCG @5|10: 0.3848 	 0.4040
2025-08-27 15:10:14,739 | domain:Kitchen
2025-08-27 15:10:14,740 | model_moe:
2025-08-27 15:10:14,740 | MRR: 0.1156
2025-08-27 15:10:14,740 | HR @1|5|10: 0.0617 	 0.1680 	 0.2205 	
2025-08-27 15:10:14,740 | NDCG @5|10: 0.1164 	 0.1334
2025-08-27 15:10:14,741 | domain:Clothing
2025-08-27 15:10:14,741 | model_moe:
2025-08-27 15:10:14,741 | MRR: 0.0267
2025-08-27 15:10:14,742 | HR @1|5|10: 0.0122 	 0.0330 	 0.0489 	
2025-08-27 15:10:14,742 | NDCG @5|10: 0.0231 	 0.0282
2025-08-27 15:10:14,742 | domain:Beauty
2025-08-27 15:10:14,742 | model_moe:
2025-08-27 15:10:14,743 | MRR: 0.2499
2025-08-27 15:10:14,743 | HR @1|5|10: 0.1794 	 0.3373 	 0.3816 	
2025-08-27 15:10:14,743 | NDCG @5|10: 0.2619 	 0.2766
2025-08-27 15:10:14,744 | 	avg_model_moe:
2025-08-27 15:10:14,744 | MRR: 0.1892
2025-08-27 15:10:14,744 | HR @1|5|10: 0.1303 	 0.2559 	 0.2988 	
2025-08-27 15:10:14,744 | NDCG @5|10: 0.1965 	 0.2105
2025-08-27 15:10:14,745 | Early Stopping counter: 4 out of 10
2025-08-27 15:10:14,745 | Learning rate decay counter: 1 out of 1
2025-08-27 15:10:14,745 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:10:27,020 | Epoch 36/60 - client 0 -  Training Loss: 29.642

 25%|##5       | 1/4 [00:12<00:36, 12.28s/it]2025-08-27 15:10:57,432 | Epoch 36/60 - client 1 -  Training Loss: 31.276

 50%|#####     | 2/4 [00:42<00:45, 22.94s/it]2025-08-27 15:11:13,824 | Epoch 36/60 - client 2 -  Training Loss: 28.133

 75%|#######5  | 3/4 [00:59<00:19, 19.95s/it]2025-08-27 15:11:25,861 | Epoch 36/60 - client 3 -  Training Loss: 30.966

100%|##########| 4/4 [01:11<00:00, 16.83s/it]
100%|##########| 4/4 [01:11<00:00, 17.78s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:11:29,771 | Epoch36 Valid:
2025-08-27 15:11:29,772 | domain:Food
2025-08-27 15:11:29,772 | model_moe:
2025-08-27 15:11:29,772 | MRR: 0.3653
2025-08-27 15:11:29,773 | HR @1|5|10: 0.2693 	 0.4866 	 0.5394 	
2025-08-27 15:11:29,773 | NDCG @5|10: 0.3862 	 0.4033
2025-08-27 15:11:29,773 | domain:Kitchen
2025-08-27 15:11:29,774 | model_moe:
2025-08-27 15:11:29,774 | MRR: 0.1173
2025-08-27 15:11:29,774 | HR @1|5|10: 0.0635 	 0.1694 	 0.2233 	
2025-08-27 15:11:29,775 | NDCG @5|10: 0.1180 	 0.1353
2025-08-27 15:11:29,775 | domain:Clothing
2025-08-27 15:11:29,775 | model_moe:
2025-08-27 15:11:29,775 | MRR: 0.0278
2025-08-27 15:11:29,776 | HR @1|5|10: 0.0147 	 0.0342 	 0.0416 	
2025-08-27 15:11:29,776 | NDCG @5|10: 0.0245 	 0.0269
2025-08-27 15:11:29,776 | domain:Beauty
2025-08-27 15:11:29,777 | model_moe:
2025-08-27 15:11:29,777 | MRR: 0.2494
2025-08-27 15:11:29,777 | HR @1|5|10: 0.1806 	 0.3337 	 0.3804 	
2025-08-27 15:11:29,777 | NDCG @5|10: 0.2603 	 0.2758
2025-08-27 15:11:29,778 | 	avg_model_moe:
2025-08-27 15:11:29,778 | MRR: 0.1900
2025-08-27 15:11:29,778 | HR @1|5|10: 0.1320 	 0.2560 	 0.2962 	
2025-08-27 15:11:29,778 | NDCG @5|10: 0.1972 	 0.2103
2025-08-27 15:11:29,779 | Validation score increased.  Saving model ...

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:12:01,921 | Epoch 37/60 - client 1 -  Training Loss: 31.086

 25%|##5       | 1/4 [00:30<01:30, 30.07s/it]2025-08-27 15:12:18,220 | Epoch 37/60 - client 2 -  Training Loss: 27.955

 50%|#####     | 2/4 [00:46<00:43, 21.97s/it]2025-08-27 15:12:30,447 | Epoch 37/60 - client 0 -  Training Loss: 29.514

 75%|#######5  | 3/4 [00:58<00:17, 17.52s/it]2025-08-27 15:12:42,256 | Epoch 37/60 - client 3 -  Training Loss: 30.800

100%|##########| 4/4 [01:10<00:00, 15.27s/it]
100%|##########| 4/4 [01:10<00:00, 17.60s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 15:12:46,102 | Epoch37 Valid:
2025-08-27 15:12:46,103 | domain:Food
2025-08-27 15:12:46,103 | model_moe:
2025-08-27 15:12:46,103 | MRR: 0.3638
2025-08-27 15:12:46,103 | HR @1|5|10: 0.2686 	 0.4828 	 0.5432 	
2025-08-27 15:12:46,104 | NDCG @5|10: 0.3836 	 0.4033
2025-08-27 15:12:46,104 | domain:Kitchen
2025-08-27 15:12:46,104 | model_moe:
2025-08-27 15:12:46,105 | MRR: 0.1178
2025-08-27 15:12:46,105 | HR @1|5|10: 0.0631 	 0.1680 	 0.2238 	
2025-08-27 15:12:46,105 | NDCG @5|10: 0.1177 	 0.1357
2025-08-27 15:12:46,106 | domain:Clothing
2025-08-27 15:12:46,106 | model_moe:
2025-08-27 15:12:46,106 | MRR: 0.0278
2025-08-27 15:12:46,107 | HR @1|5|10: 0.0134 	 0.0318 	 0.0477 	
2025-08-27 15:12:46,107 | NDCG @5|10: 0.0235 	 0.0286
2025-08-27 15:12:46,107 | domain:Beauty
2025-08-27 15:12:46,107 | model_moe:
2025-08-27 15:12:46,108 | MRR: 0.2499
2025-08-27 15:12:46,108 | HR @1|5|10: 0.1818 	 0.3301 	 0.3828 	
2025-08-27 15:12:46,108 | NDCG @5|10: 0.2593 	 0.2769
2025-08-27 15:12:46,109 | 	avg_model_moe:
2025-08-27 15:12:46,109 | MRR: 0.1898
2025-08-27 15:12:46,109 | HR @1|5|10: 0.1317 	 0.2532 	 0.2994 	
2025-08-27 15:12:46,109 | NDCG @5|10: 0.1960 	 0.2111
2025-08-27 15:12:46,110 | Early Stopping counter: 1 out of 10
2025-08-27 15:12:46,110 | Learning rate decay counter: 1 out of 1
2025-08-27 15:12:46,110 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:12:58,219 | Epoch 38/60 - client 0 -  Training Loss: 29.382

 25%|##5       | 1/4 [00:12<00:36, 12.11s/it]2025-08-27 15:13:10,085 | Epoch 38/60 - client 3 -  Training Loss: 30.652

 50%|#####     | 2/4 [00:23<00:23, 11.97s/it]2025-08-27 15:13:26,387 | Epoch 38/60 - client 2 -  Training Loss: 27.807

 75%|#######5  | 3/4 [00:40<00:13, 13.95s/it]2025-08-27 15:13:56,494 | Epoch 38/60 - client 1 -  Training Loss: 30.905

100%|##########| 4/4 [01:10<00:00, 20.33s/it]
100%|##########| 4/4 [01:10<00:00, 17.60s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.05s/it]
100%|##########| 4/4 [00:03<00:00,  1.11it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 15:14:00,419 | Epoch38 Valid:
2025-08-27 15:14:00,419 | domain:Food
2025-08-27 15:14:00,420 | model_moe:
2025-08-27 15:14:00,420 | MRR: 0.3640
2025-08-27 15:14:00,420 | HR @1|5|10: 0.2678 	 0.4881 	 0.5448 	
2025-08-27 15:14:00,421 | NDCG @5|10: 0.3857 	 0.4039
2025-08-27 15:14:00,421 | domain:Kitchen
2025-08-27 15:14:00,421 | model_moe:
2025-08-27 15:14:00,421 | MRR: 0.1172
2025-08-27 15:14:00,422 | HR @1|5|10: 0.0626 	 0.1653 	 0.2238 	
2025-08-27 15:14:00,422 | NDCG @5|10: 0.1163 	 0.1352
2025-08-27 15:14:00,422 | domain:Clothing
2025-08-27 15:14:00,423 | model_moe:
2025-08-27 15:14:00,423 | MRR: 0.0276
2025-08-27 15:14:00,423 | HR @1|5|10: 0.0134 	 0.0318 	 0.0428 	
2025-08-27 15:14:00,424 | NDCG @5|10: 0.0235 	 0.0270
2025-08-27 15:14:00,424 | domain:Beauty
2025-08-27 15:14:00,424 | model_moe:
2025-08-27 15:14:00,424 | MRR: 0.2472
2025-08-27 15:14:00,425 | HR @1|5|10: 0.1770 	 0.3325 	 0.3816 	
2025-08-27 15:14:00,425 | NDCG @5|10: 0.2583 	 0.2745
2025-08-27 15:14:00,425 | 	avg_model_moe:
2025-08-27 15:14:00,426 | MRR: 0.1890
2025-08-27 15:14:00,426 | HR @1|5|10: 0.1302 	 0.2544 	 0.2982 	
2025-08-27 15:14:00,426 | NDCG @5|10: 0.1960 	 0.2102
2025-08-27 15:14:00,426 | Early Stopping counter: 2 out of 10
2025-08-27 15:14:00,427 | Learning rate decay counter: 1 out of 1
2025-08-27 15:14:00,427 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:14:30,550 | Epoch 39/60 - client 1 -  Training Loss: 30.727

 25%|##5       | 1/4 [00:30<01:30, 30.12s/it]2025-08-27 15:14:42,384 | Epoch 39/60 - client 3 -  Training Loss: 30.495

 50%|#####     | 2/4 [00:41<00:38, 19.37s/it]2025-08-27 15:14:54,517 | Epoch 39/60 - client 0 -  Training Loss: 29.274

 75%|#######5  | 3/4 [00:54<00:16, 16.06s/it]2025-08-27 15:15:10,794 | Epoch 39/60 - client 2 -  Training Loss: 27.647

100%|##########| 4/4 [01:10<00:00, 16.15s/it]
100%|##########| 4/4 [01:10<00:00, 17.59s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 15:15:14,656 | Epoch39 Valid:
2025-08-27 15:15:14,656 | domain:Food
2025-08-27 15:15:14,657 | model_moe:
2025-08-27 15:15:14,657 | MRR: 0.3638
2025-08-27 15:15:14,657 | HR @1|5|10: 0.2678 	 0.4843 	 0.5409 	
2025-08-27 15:15:14,658 | NDCG @5|10: 0.3842 	 0.4026
2025-08-27 15:15:14,658 | domain:Kitchen
2025-08-27 15:15:14,658 | model_moe:
2025-08-27 15:15:14,658 | MRR: 0.1165
2025-08-27 15:15:14,659 | HR @1|5|10: 0.0612 	 0.1680 	 0.2261 	
2025-08-27 15:15:14,659 | NDCG @5|10: 0.1168 	 0.1353
2025-08-27 15:15:14,659 | domain:Clothing
2025-08-27 15:15:14,660 | model_moe:
2025-08-27 15:15:14,660 | MRR: 0.0284
2025-08-27 15:15:14,660 | HR @1|5|10: 0.0134 	 0.0355 	 0.0428 	
2025-08-27 15:15:14,660 | NDCG @5|10: 0.0252 	 0.0276
2025-08-27 15:15:14,661 | domain:Beauty
2025-08-27 15:15:14,661 | model_moe:
2025-08-27 15:15:14,661 | MRR: 0.2475
2025-08-27 15:15:14,662 | HR @1|5|10: 0.1782 	 0.3289 	 0.3792 	
2025-08-27 15:15:14,662 | NDCG @5|10: 0.2572 	 0.2739
2025-08-27 15:15:14,662 | 	avg_model_moe:
2025-08-27 15:15:14,662 | MRR: 0.1890
2025-08-27 15:15:14,663 | HR @1|5|10: 0.1302 	 0.2542 	 0.2972 	
2025-08-27 15:15:14,663 | NDCG @5|10: 0.1958 	 0.2099
2025-08-27 15:15:14,663 | Early Stopping counter: 3 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:15:26,777 | Epoch 40/60 - client 0 -  Training Loss: 29.161

 25%|##5       | 1/4 [00:12<00:36, 12.11s/it]2025-08-27 15:15:43,188 | Epoch 40/60 - client 2 -  Training Loss: 27.509

 50%|#####     | 2/4 [00:28<00:29, 14.64s/it]2025-08-27 15:15:55,049 | Epoch 40/60 - client 3 -  Training Loss: 30.354

 75%|#######5  | 3/4 [00:40<00:13, 13.37s/it]2025-08-27 15:16:25,178 | Epoch 40/60 - client 1 -  Training Loss: 30.560

100%|##########| 4/4 [01:10<00:00, 19.99s/it]
100%|##########| 4/4 [01:10<00:00, 17.63s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.34s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.04s/it]
100%|##########| 4/4 [00:03<00:00,  1.12it/s]
100%|##########| 4/4 [00:03<00:00,  1.02it/s]
2025-08-27 15:16:29,101 | Epoch40 Valid:
2025-08-27 15:16:29,102 | domain:Food
2025-08-27 15:16:29,102 | model_moe:
2025-08-27 15:16:29,102 | MRR: 0.3626
2025-08-27 15:16:29,103 | HR @1|5|10: 0.2640 	 0.4927 	 0.5440 	
2025-08-27 15:16:29,103 | NDCG @5|10: 0.3865 	 0.4028
2025-08-27 15:16:29,103 | domain:Kitchen
2025-08-27 15:16:29,103 | model_moe:
2025-08-27 15:16:29,104 | MRR: 0.1174
2025-08-27 15:16:29,104 | HR @1|5|10: 0.0626 	 0.1699 	 0.2238 	
2025-08-27 15:16:29,104 | NDCG @5|10: 0.1180 	 0.1353
2025-08-27 15:16:29,309 | domain:Clothing
2025-08-27 15:16:29,309 | model_moe:
2025-08-27 15:16:29,309 | MRR: 0.0278
2025-08-27 15:16:29,310 | HR @1|5|10: 0.0134 	 0.0330 	 0.0428 	
2025-08-27 15:16:29,310 | NDCG @5|10: 0.0239 	 0.0272
2025-08-27 15:16:29,310 | domain:Beauty
2025-08-27 15:16:29,311 | model_moe:
2025-08-27 15:16:29,311 | MRR: 0.2460
2025-08-27 15:16:29,311 | HR @1|5|10: 0.1746 	 0.3325 	 0.3780 	
2025-08-27 15:16:29,312 | NDCG @5|10: 0.2576 	 0.2725
2025-08-27 15:16:29,312 | 	avg_model_moe:
2025-08-27 15:16:29,312 | MRR: 0.1885
2025-08-27 15:16:29,313 | HR @1|5|10: 0.1287 	 0.2570 	 0.2971 	
2025-08-27 15:16:29,313 | NDCG @5|10: 0.1965 	 0.2095
2025-08-27 15:16:29,313 | Early Stopping counter: 4 out of 10
2025-08-27 15:16:29,313 | Learning rate decay counter: 1 out of 1
2025-08-27 15:16:29,314 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:16:59,441 | Epoch 41/60 - client 1 -  Training Loss: 30.395

 25%|##5       | 1/4 [00:30<01:30, 30.13s/it]2025-08-27 15:17:15,789 | Epoch 41/60 - client 2 -  Training Loss: 27.363

 50%|#####     | 2/4 [00:46<00:44, 22.02s/it]2025-08-27 15:17:28,022 | Epoch 41/60 - client 0 -  Training Loss: 29.046

 75%|#######5  | 3/4 [00:58<00:17, 17.55s/it]2025-08-27 15:17:39,857 | Epoch 41/60 - client 3 -  Training Loss: 30.212

100%|##########| 4/4 [01:10<00:00, 15.30s/it]
100%|##########| 4/4 [01:10<00:00, 17.64s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.06it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.32s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:17:43,752 | Epoch41 Valid:
2025-08-27 15:17:43,753 | domain:Food
2025-08-27 15:17:43,753 | model_moe:
2025-08-27 15:17:43,753 | MRR: 0.3624
2025-08-27 15:17:43,754 | HR @1|5|10: 0.2663 	 0.4866 	 0.5455 	
2025-08-27 15:17:43,754 | NDCG @5|10: 0.3838 	 0.4029
2025-08-27 15:17:43,754 | domain:Kitchen
2025-08-27 15:17:43,754 | model_moe:
2025-08-27 15:17:43,755 | MRR: 0.1176
2025-08-27 15:17:43,755 | HR @1|5|10: 0.0626 	 0.1685 	 0.2261 	
2025-08-27 15:17:43,755 | NDCG @5|10: 0.1176 	 0.1361
2025-08-27 15:17:43,756 | domain:Clothing
2025-08-27 15:17:43,756 | model_moe:
2025-08-27 15:17:43,756 | MRR: 0.0287
2025-08-27 15:17:43,757 | HR @1|5|10: 0.0159 	 0.0306 	 0.0403 	
2025-08-27 15:17:43,757 | NDCG @5|10: 0.0238 	 0.0271
2025-08-27 15:17:43,757 | domain:Beauty
2025-08-27 15:17:43,757 | model_moe:
2025-08-27 15:17:43,758 | MRR: 0.2491
2025-08-27 15:17:43,758 | HR @1|5|10: 0.1806 	 0.3301 	 0.3840 	
2025-08-27 15:17:43,758 | NDCG @5|10: 0.2586 	 0.2764
2025-08-27 15:17:43,759 | 	avg_model_moe:
2025-08-27 15:17:43,759 | MRR: 0.1895
2025-08-27 15:17:43,759 | HR @1|5|10: 0.1313 	 0.2540 	 0.2990 	
2025-08-27 15:17:43,759 | NDCG @5|10: 0.1959 	 0.2106
2025-08-27 15:17:43,760 | Early Stopping counter: 5 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:18:13,876 | Epoch 42/60 - client 1 -  Training Loss: 30.241

 25%|##5       | 1/4 [00:30<01:30, 30.12s/it]2025-08-27 15:18:30,168 | Epoch 42/60 - client 2 -  Training Loss: 27.226

 50%|#####     | 2/4 [00:46<00:43, 21.98s/it]2025-08-27 15:18:42,021 | Epoch 42/60 - client 3 -  Training Loss: 30.069

 75%|#######5  | 3/4 [00:58<00:17, 17.36s/it]2025-08-27 15:18:54,178 | Epoch 42/60 - client 0 -  Training Loss: 28.939

100%|##########| 4/4 [01:10<00:00, 15.30s/it]
100%|##########| 4/4 [01:10<00:00, 17.60s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.33s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:18:58,070 | Epoch42 Valid:
2025-08-27 15:18:58,071 | domain:Food
2025-08-27 15:18:58,071 | model_moe:
2025-08-27 15:18:58,071 | MRR: 0.3628
2025-08-27 15:18:58,072 | HR @1|5|10: 0.2670 	 0.4843 	 0.5432 	
2025-08-27 15:18:58,072 | NDCG @5|10: 0.3833 	 0.4026
2025-08-27 15:18:58,072 | domain:Kitchen
2025-08-27 15:18:58,073 | model_moe:
2025-08-27 15:18:58,073 | MRR: 0.1189
2025-08-27 15:18:58,073 | HR @1|5|10: 0.0649 	 0.1685 	 0.2251 	
2025-08-27 15:18:58,074 | NDCG @5|10: 0.1185 	 0.1368
2025-08-27 15:18:58,074 | domain:Clothing
2025-08-27 15:18:58,074 | model_moe:
2025-08-27 15:18:58,074 | MRR: 0.0274
2025-08-27 15:18:58,075 | HR @1|5|10: 0.0122 	 0.0355 	 0.0452 	
2025-08-27 15:18:58,075 | NDCG @5|10: 0.0244 	 0.0276
2025-08-27 15:18:58,075 | domain:Beauty
2025-08-27 15:18:58,076 | model_moe:
2025-08-27 15:18:58,076 | MRR: 0.2464
2025-08-27 15:18:58,076 | HR @1|5|10: 0.1746 	 0.3278 	 0.3828 	
2025-08-27 15:18:58,077 | NDCG @5|10: 0.2560 	 0.2741
2025-08-27 15:18:58,077 | 	avg_model_moe:
2025-08-27 15:18:58,077 | MRR: 0.1889
2025-08-27 15:18:58,077 | HR @1|5|10: 0.1297 	 0.2540 	 0.2991 	
2025-08-27 15:18:58,078 | NDCG @5|10: 0.1956 	 0.2102
2025-08-27 15:18:58,078 | Early Stopping counter: 6 out of 10
2025-08-27 15:18:58,078 | Learning rate decay counter: 1 out of 1
2025-08-27 15:18:58,079 | Learning rate decay

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:19:27,931 | Epoch 43/60 - client 1 -  Training Loss: 30.085

 25%|##5       | 1/4 [00:29<01:29, 29.85s/it]2025-08-27 15:19:44,079 | Epoch 43/60 - client 2 -  Training Loss: 27.097

 50%|#####     | 2/4 [00:46<00:43, 21.79s/it]2025-08-27 15:19:55,754 | Epoch 43/60 - client 3 -  Training Loss: 29.941

 75%|#######5  | 3/4 [00:57<00:17, 17.17s/it]2025-08-27 15:20:07,848 | Epoch 43/60 - client 0 -  Training Loss: 28.838

100%|##########| 4/4 [01:09<00:00, 15.17s/it]
100%|##########| 4/4 [01:09<00:00, 17.44s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.29s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.01s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 15:20:11,682 | Epoch43 Valid:
2025-08-27 15:20:11,682 | domain:Food
2025-08-27 15:20:11,682 | model_moe:
2025-08-27 15:20:11,683 | MRR: 0.3613
2025-08-27 15:20:11,683 | HR @1|5|10: 0.2640 	 0.4851 	 0.5371 	
2025-08-27 15:20:11,683 | NDCG @5|10: 0.3829 	 0.3998
2025-08-27 15:20:11,684 | domain:Kitchen
2025-08-27 15:20:11,894 | model_moe:
2025-08-27 15:20:11,895 | MRR: 0.1183
2025-08-27 15:20:11,895 | HR @1|5|10: 0.0649 	 0.1680 	 0.2242 	
2025-08-27 15:20:11,895 | NDCG @5|10: 0.1179 	 0.1360
2025-08-27 15:20:11,896 | domain:Clothing
2025-08-27 15:20:11,896 | model_moe:
2025-08-27 15:20:11,896 | MRR: 0.0277
2025-08-27 15:20:11,897 | HR @1|5|10: 0.0134 	 0.0318 	 0.0440 	
2025-08-27 15:20:11,897 | NDCG @5|10: 0.0236 	 0.0276
2025-08-27 15:20:11,897 | domain:Beauty
2025-08-27 15:20:11,897 | model_moe:
2025-08-27 15:20:11,898 | MRR: 0.2498
2025-08-27 15:20:11,898 | HR @1|5|10: 0.1806 	 0.3278 	 0.3852 	
2025-08-27 15:20:11,898 | NDCG @5|10: 0.2582 	 0.2771
2025-08-27 15:20:11,899 | 	avg_model_moe:
2025-08-27 15:20:11,899 | MRR: 0.1892
2025-08-27 15:20:11,899 | HR @1|5|10: 0.1307 	 0.2532 	 0.2976 	
2025-08-27 15:20:11,899 | NDCG @5|10: 0.1956 	 0.2101
2025-08-27 15:20:11,900 | Early Stopping counter: 7 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:20:41,842 | Epoch 44/60 - client 1 -  Training Loss: 29.945

 25%|##5       | 1/4 [00:29<01:29, 29.94s/it]2025-08-27 15:20:53,537 | Epoch 44/60 - client 3 -  Training Loss: 29.812

 50%|#####     | 2/4 [00:41<00:38, 19.21s/it]2025-08-27 15:21:05,510 | Epoch 44/60 - client 0 -  Training Loss: 28.735

 75%|#######5  | 3/4 [00:53<00:15, 15.90s/it]2025-08-27 15:21:21,656 | Epoch 44/60 - client 2 -  Training Loss: 26.971

100%|##########| 4/4 [01:09<00:00, 16.00s/it]
100%|##########| 4/4 [01:09<00:00, 17.44s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.07it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.14it/s]
100%|##########| 4/4 [00:03<00:00,  1.04it/s]
2025-08-27 15:21:25,505 | Epoch44 Valid:
2025-08-27 15:21:25,505 | domain:Food
2025-08-27 15:21:25,506 | model_moe:
2025-08-27 15:21:25,506 | MRR: 0.3639
2025-08-27 15:21:25,506 | HR @1|5|10: 0.2686 	 0.4858 	 0.5432 	
2025-08-27 15:21:25,506 | NDCG @5|10: 0.3847 	 0.4033
2025-08-27 15:21:25,507 | domain:Kitchen
2025-08-27 15:21:25,507 | model_moe:
2025-08-27 15:21:25,507 | MRR: 0.1201
2025-08-27 15:21:25,508 | HR @1|5|10: 0.0663 	 0.1667 	 0.2251 	
2025-08-27 15:21:25,508 | NDCG @5|10: 0.1188 	 0.1376
2025-08-27 15:21:25,508 | domain:Clothing
2025-08-27 15:21:25,508 | model_moe:
2025-08-27 15:21:25,509 | MRR: 0.0274
2025-08-27 15:21:25,509 | HR @1|5|10: 0.0122 	 0.0367 	 0.0428 	
2025-08-27 15:21:25,509 | NDCG @5|10: 0.0252 	 0.0271
2025-08-27 15:21:25,510 | domain:Beauty
2025-08-27 15:21:25,510 | model_moe:
2025-08-27 15:21:25,510 | MRR: 0.2460
2025-08-27 15:21:25,510 | HR @1|5|10: 0.1758 	 0.3218 	 0.3828 	
2025-08-27 15:21:25,511 | NDCG @5|10: 0.2536 	 0.2737
2025-08-27 15:21:25,511 | 	avg_model_moe:
2025-08-27 15:21:25,511 | MRR: 0.1894
2025-08-27 15:21:25,512 | HR @1|5|10: 0.1307 	 0.2527 	 0.2985 	
2025-08-27 15:21:25,512 | NDCG @5|10: 0.1956 	 0.2104
2025-08-27 15:21:25,512 | Early Stopping counter: 8 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:21:37,486 | Epoch 45/60 - client 0 -  Training Loss: 28.640

 25%|##5       | 1/4 [00:11<00:35, 11.97s/it]2025-08-27 15:22:07,324 | Epoch 45/60 - client 1 -  Training Loss: 29.804

 50%|#####     | 2/4 [00:41<00:44, 22.48s/it]2025-08-27 15:22:23,566 | Epoch 45/60 - client 2 -  Training Loss: 26.846

 75%|#######5  | 3/4 [00:58<00:19, 19.63s/it]2025-08-27 15:22:35,227 | Epoch 45/60 - client 3 -  Training Loss: 29.689

100%|##########| 4/4 [01:09<00:00, 16.49s/it]
100%|##########| 4/4 [01:09<00:00, 17.43s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.08it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.30s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.02s/it]
100%|##########| 4/4 [00:03<00:00,  1.15it/s]
100%|##########| 4/4 [00:03<00:00,  1.05it/s]
2025-08-27 15:22:39,060 | Epoch45 Valid:
2025-08-27 15:22:39,061 | domain:Food
2025-08-27 15:22:39,061 | model_moe:
2025-08-27 15:22:39,061 | MRR: 0.3651
2025-08-27 15:22:39,062 | HR @1|5|10: 0.2708 	 0.4866 	 0.5455 	
2025-08-27 15:22:39,062 | NDCG @5|10: 0.3860 	 0.4050
2025-08-27 15:22:39,062 | domain:Kitchen
2025-08-27 15:22:39,063 | model_moe:
2025-08-27 15:22:39,063 | MRR: 0.1192
2025-08-27 15:22:39,063 | HR @1|5|10: 0.0658 	 0.1671 	 0.2228 	
2025-08-27 15:22:39,063 | NDCG @5|10: 0.1184 	 0.1364
2025-08-27 15:22:39,064 | domain:Clothing
2025-08-27 15:22:39,064 | model_moe:
2025-08-27 15:22:39,064 | MRR: 0.0264
2025-08-27 15:22:39,065 | HR @1|5|10: 0.0122 	 0.0330 	 0.0440 	
2025-08-27 15:22:39,065 | NDCG @5|10: 0.0230 	 0.0265
2025-08-27 15:22:39,065 | domain:Beauty
2025-08-27 15:22:39,066 | model_moe:
2025-08-27 15:22:39,066 | MRR: 0.2477
2025-08-27 15:22:39,066 | HR @1|5|10: 0.1770 	 0.3278 	 0.3864 	
2025-08-27 15:22:39,066 | NDCG @5|10: 0.2568 	 0.2759
2025-08-27 15:22:39,067 | 	avg_model_moe:
2025-08-27 15:22:39,067 | MRR: 0.1896
2025-08-27 15:22:39,067 | HR @1|5|10: 0.1315 	 0.2536 	 0.2997 	
2025-08-27 15:22:39,068 | NDCG @5|10: 0.1960 	 0.2109
2025-08-27 15:22:39,068 | Early Stopping counter: 9 out of 10

  0%|          | 0/4 [00:00<?, ?it/s]2025-08-27 15:23:08,889 | Epoch 46/60 - client 1 -  Training Loss: 29.663

 25%|##5       | 1/4 [00:29<01:29, 29.82s/it]2025-08-27 15:23:20,843 | Epoch 46/60 - client 0 -  Training Loss: 28.540

 50%|#####     | 2/4 [00:41<00:38, 19.31s/it]2025-08-27 15:23:32,482 | Epoch 46/60 - client 3 -  Training Loss: 29.566

 75%|#######5  | 3/4 [00:53<00:15, 15.81s/it]2025-08-27 15:23:48,612 | Epoch 46/60 - client 2 -  Training Loss: 26.728

100%|##########| 4/4 [01:09<00:00, 15.94s/it]
100%|##########| 4/4 [01:09<00:00, 17.39s/it]

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:00<00:02,  1.02it/s]
 50%|#####     | 2/4 [00:02<00:02,  1.31s/it]
 75%|#######5  | 3/4 [00:03<00:01,  1.03s/it]
100%|##########| 4/4 [00:03<00:00,  1.13it/s]
100%|##########| 4/4 [00:03<00:00,  1.03it/s]
2025-08-27 15:23:52,506 | Epoch46 Valid:
2025-08-27 15:23:52,507 | domain:Food
2025-08-27 15:23:52,507 | model_moe:
2025-08-27 15:23:52,507 | MRR: 0.3616
2025-08-27 15:23:52,508 | HR @1|5|10: 0.2640 	 0.4828 	 0.5409 	
2025-08-27 15:23:52,508 | NDCG @5|10: 0.3821 	 0.4011
2025-08-27 15:23:52,508 | domain:Kitchen
2025-08-27 15:23:52,509 | model_moe:
2025-08-27 15:23:52,509 | MRR: 0.1203
2025-08-27 15:23:52,509 | HR @1|5|10: 0.0668 	 0.1699 	 0.2270 	
2025-08-27 15:23:52,510 | NDCG @5|10: 0.1199 	 0.1383
2025-08-27 15:23:52,510 | domain:Clothing
2025-08-27 15:23:52,510 | model_moe:
2025-08-27 15:23:52,510 | MRR: 0.0277
2025-08-27 15:23:52,511 | HR @1|5|10: 0.0134 	 0.0342 	 0.0452 	
2025-08-27 15:23:52,511 | NDCG @5|10: 0.0245 	 0.0280
2025-08-27 15:23:52,511 | domain:Beauty
2025-08-27 15:23:52,512 | model_moe:
2025-08-27 15:23:52,512 | MRR: 0.2482
2025-08-27 15:23:52,512 | HR @1|5|10: 0.1782 	 0.3278 	 0.3876 	
2025-08-27 15:23:52,512 | NDCG @5|10: 0.2569 	 0.2767
2025-08-27 15:23:52,513 | 	avg_model_moe:
2025-08-27 15:23:52,513 | MRR: 0.1894
2025-08-27 15:23:52,513 | HR @1|5|10: 0.1306 	 0.2537 	 0.3002 	
2025-08-27 15:23:52,718 | NDCG @5|10: 0.1959 	 0.2110
2025-08-27 15:23:52,718 | Early Stopping counter: 10 out of 10
2025-08-27 15:23:52,718 | Early stopping

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|##5       | 1/4 [00:02<00:06,  2.22s/it]
 50%|#####     | 2/4 [00:06<00:06,  3.33s/it]
 75%|#######5  | 3/4 [00:10<00:03,  3.63s/it]
100%|##########| 4/4 [00:12<00:00,  3.15s/it]
100%|##########| 4/4 [00:12<00:00,  3.18s/it]
2025-08-27 15:24:05,442 | Test:
2025-08-27 15:24:05,442 | domain:Food
2025-08-27 15:24:05,443 | model_moe:
2025-08-27 15:24:05,443 | MRR: 0.3009
2025-08-27 15:24:05,443 | HR @1|5|10: 0.2102 	 0.4047 	 0.4827 	
2025-08-27 15:24:05,443 | NDCG @5|10: 0.3137 	 0.3390
2025-08-27 15:24:05,444 | domain:Kitchen
2025-08-27 15:24:05,444 | model_moe:
2025-08-27 15:24:05,444 | MRR: 0.1190
2025-08-27 15:24:05,445 | HR @1|5|10: 0.0661 	 0.1668 	 0.2285 	
2025-08-27 15:24:05,445 | NDCG @5|10: 0.1176 	 0.1377
2025-08-27 15:24:05,445 | domain:Clothing
2025-08-27 15:24:05,445 | model_moe:
2025-08-27 15:24:05,446 | MRR: 0.0292
2025-08-27 15:24:05,446 | HR @1|5|10: 0.0150 	 0.0335 	 0.0485 	
2025-08-27 15:24:05,446 | NDCG @5|10: 0.0248 	 0.0296
2025-08-27 15:24:05,447 | domain:Beauty
2025-08-27 15:24:05,447 | model_moe:
2025-08-27 15:24:05,447 | MRR: 0.1974
2025-08-27 15:24:05,447 | HR @1|5|10: 0.1193 	 0.2936 	 0.3544 	
2025-08-27 15:24:05,448 | NDCG @5|10: 0.2091 	 0.2289
2025-08-27 15:24:05,448 | 	avg_model_moe:
2025-08-27 15:24:05,448 | MRR: 0.1616
2025-08-27 15:24:05,449 | HR @1|5|10: 0.1027 	 0.2246 	 0.2785 	
2025-08-27 15:24:05,449 | NDCG @5|10: 0.1663 	 0.1838
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 15:26:47,407 | Running with the following configs:
	domains : ['Movies', 'Books', 'Games']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 1.0
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 15:27:11,844 | Epoch 1/40 - client 2 -  Training Loss: 31.982

 33%|###3      | 1/3 [00:24<00:48, 24.43s/it]2025-08-27 15:30:26,883 | Epoch 1/40 - client 1 -  Training Loss: 34.979

 67%|######6   | 2/3 [03:39<02:04, 124.79s/it]2025-08-27 15:32:42,698 | Epoch 1/40 - client 0 -  Training Loss: 36.583

100%|##########| 3/3 [05:55<00:00, 129.82s/it]
100%|##########| 3/3 [05:55<00:00, 118.43s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.76s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.22s/it]
100%|##########| 3/3 [00:15<00:00,  4.49s/it]
100%|##########| 3/3 [00:15<00:00,  5.18s/it]
2025-08-27 15:32:58,258 | Epoch1 Valid:
2025-08-27 15:32:58,259 | domain:Movies
2025-08-27 15:32:58,259 | model_moe:
2025-08-27 15:32:58,259 | MRR: 0.0368
2025-08-27 15:32:58,259 | HR @1|5|10: 0.0206 	 0.0407 	 0.0591 	
2025-08-27 15:32:58,260 | NDCG @5|10: 0.0306 	 0.0366
2025-08-27 15:32:58,260 | domain:Books
2025-08-27 15:32:58,260 | model_moe:
2025-08-27 15:32:58,261 | MRR: 0.0226
2025-08-27 15:32:58,261 | HR @1|5|10: 0.0156 	 0.0227 	 0.0296 	
2025-08-27 15:32:58,261 | NDCG @5|10: 0.0190 	 0.0213
2025-08-27 15:32:58,261 | domain:Games
2025-08-27 15:32:58,262 | model_moe:
2025-08-27 15:32:58,262 | MRR: 0.0593
2025-08-27 15:32:58,262 | HR @1|5|10: 0.0371 	 0.0742 	 0.0939 	
2025-08-27 15:32:58,262 | NDCG @5|10: 0.0562 	 0.0626
2025-08-27 15:32:58,263 | 	avg_model_moe:
2025-08-27 15:32:58,263 | MRR: 0.0396
2025-08-27 15:32:58,263 | HR @1|5|10: 0.0244 	 0.0459 	 0.0609 	
2025-08-27 15:32:58,264 | NDCG @5|10: 0.0353 	 0.0402
2025-08-27 15:32:58,264 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 15:35:15,463 | Epoch 2/40 - client 0 -  Training Loss: 34.287

 33%|###3      | 1/3 [02:15<04:30, 135.10s/it]2025-08-27 15:35:28,339 | Epoch 2/40 - client 2 -  Training Loss: 30.025

 67%|######6   | 2/3 [02:27<01:03, 63.20s/it] 2025-08-27 15:38:42,552 | Epoch 2/40 - client 1 -  Training Loss: 32.819

100%|##########| 3/3 [05:42<00:00, 123.02s/it]
100%|##########| 3/3 [05:42<00:00, 114.06s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.68s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.10s/it]
100%|##########| 3/3 [00:15<00:00,  4.41s/it]
100%|##########| 3/3 [00:15<00:00,  5.09s/it]
2025-08-27 15:38:57,838 | Epoch2 Valid:
2025-08-27 15:38:57,838 | domain:Movies
2025-08-27 15:38:57,839 | model_moe:
2025-08-27 15:38:57,839 | MRR: 0.0975
2025-08-27 15:38:57,839 | HR @1|5|10: 0.0546 	 0.1228 	 0.1741 	
2025-08-27 15:38:57,840 | NDCG @5|10: 0.0898 	 0.1063
2025-08-27 15:38:57,840 | domain:Books
2025-08-27 15:38:57,840 | model_moe:
2025-08-27 15:38:57,840 | MRR: 0.0709
2025-08-27 15:38:57,841 | HR @1|5|10: 0.0415 	 0.0845 	 0.1201 	
2025-08-27 15:38:57,841 | NDCG @5|10: 0.0635 	 0.0749
2025-08-27 15:38:57,841 | domain:Games
2025-08-27 15:38:57,842 | model_moe:
2025-08-27 15:38:57,842 | MRR: 0.0626
2025-08-27 15:38:57,842 | HR @1|5|10: 0.0378 	 0.0779 	 0.1041 	
2025-08-27 15:38:57,842 | NDCG @5|10: 0.0586 	 0.0672
2025-08-27 15:38:57,843 | 	avg_model_moe:
2025-08-27 15:38:57,843 | MRR: 0.0770
2025-08-27 15:38:57,843 | HR @1|5|10: 0.0446 	 0.0951 	 0.1327 	
2025-08-27 15:38:57,844 | NDCG @5|10: 0.0706 	 0.0828
2025-08-27 15:38:57,844 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 15:41:14,980 | Epoch 3/40 - client 0 -  Training Loss: 33.235

 33%|###3      | 1/3 [02:14<04:29, 134.97s/it]2025-08-27 15:44:29,703 | Epoch 3/40 - client 1 -  Training Loss: 31.583

 67%|######6   | 2/3 [05:29<02:50, 170.12s/it]2025-08-27 15:44:42,780 | Epoch 3/40 - client 2 -  Training Loss: 29.015

100%|##########| 3/3 [05:42<00:00, 98.41s/it] 
100%|##########| 3/3 [05:42<00:00, 114.26s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.59s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.06s/it]
100%|##########| 3/3 [00:15<00:00,  4.37s/it]
100%|##########| 3/3 [00:15<00:00,  5.05s/it]
2025-08-27 15:44:57,940 | Epoch3 Valid:
2025-08-27 15:44:57,940 | domain:Movies
2025-08-27 15:44:57,940 | model_moe:
2025-08-27 15:44:57,941 | MRR: 0.1239
2025-08-27 15:44:57,941 | HR @1|5|10: 0.0728 	 0.1632 	 0.2211 	
2025-08-27 15:44:57,941 | NDCG @5|10: 0.1190 	 0.1376
2025-08-27 15:44:57,942 | domain:Books
2025-08-27 15:44:57,942 | model_moe:
2025-08-27 15:44:57,942 | MRR: 0.0943
2025-08-27 15:44:57,942 | HR @1|5|10: 0.0551 	 0.1202 	 0.1644 	
2025-08-27 15:44:57,943 | NDCG @5|10: 0.0883 	 0.1025
2025-08-27 15:44:57,943 | domain:Games
2025-08-27 15:44:57,943 | model_moe:
2025-08-27 15:44:57,944 | MRR: 0.0734
2025-08-27 15:44:57,944 | HR @1|5|10: 0.0480 	 0.0932 	 0.1150 	
2025-08-27 15:44:57,944 | NDCG @5|10: 0.0708 	 0.0778
2025-08-27 15:44:57,944 | 	avg_model_moe:
2025-08-27 15:44:57,945 | MRR: 0.0972
2025-08-27 15:44:57,945 | HR @1|5|10: 0.0586 	 0.1255 	 0.1668 	
2025-08-27 15:44:57,945 | NDCG @5|10: 0.0927 	 0.1060
2025-08-27 15:44:57,946 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 15:48:14,034 | Epoch 4/40 - client 1 -  Training Loss: 30.450

 33%|###3      | 1/3 [03:14<06:28, 194.33s/it]2025-08-27 15:50:28,594 | Epoch 4/40 - client 0 -  Training Loss: 32.291

 67%|######6   | 2/3 [05:28<02:39, 159.17s/it]2025-08-27 15:50:41,447 | Epoch 4/40 - client 2 -  Training Loss: 28.084

100%|##########| 3/3 [05:41<00:00, 92.36s/it] 
100%|##########| 3/3 [05:41<00:00, 113.92s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.56s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.05s/it]
100%|##########| 3/3 [00:15<00:00,  4.37s/it]
100%|##########| 3/3 [00:15<00:00,  5.04s/it]
2025-08-27 15:50:56,598 | Epoch4 Valid:
2025-08-27 15:50:56,598 | domain:Movies
2025-08-27 15:50:56,599 | model_moe:
2025-08-27 15:50:56,599 | MRR: 0.1402
2025-08-27 15:50:56,599 | HR @1|5|10: 0.0847 	 0.1836 	 0.2450 	
2025-08-27 15:50:56,599 | NDCG @5|10: 0.1361 	 0.1559
2025-08-27 15:50:56,600 | domain:Books
2025-08-27 15:50:56,600 | model_moe:
2025-08-27 15:50:56,600 | MRR: 0.1116
2025-08-27 15:50:56,601 | HR @1|5|10: 0.0653 	 0.1471 	 0.1973 	
2025-08-27 15:50:56,601 | NDCG @5|10: 0.1070 	 0.1231
2025-08-27 15:50:56,601 | domain:Games
2025-08-27 15:50:56,601 | model_moe:
2025-08-27 15:50:56,602 | MRR: 0.0863
2025-08-27 15:50:56,602 | HR @1|5|10: 0.0611 	 0.1004 	 0.1281 	
2025-08-27 15:50:56,602 | NDCG @5|10: 0.0817 	 0.0907
2025-08-27 15:50:56,602 | 	avg_model_moe:
2025-08-27 15:50:56,603 | MRR: 0.1127
2025-08-27 15:50:56,603 | HR @1|5|10: 0.0704 	 0.1437 	 0.1901 	
2025-08-27 15:50:56,603 | NDCG @5|10: 0.1083 	 0.1232
2025-08-27 15:50:56,603 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 15:54:13,233 | Epoch 5/40 - client 1 -  Training Loss: 29.221

 33%|###3      | 1/3 [03:14<06:28, 194.46s/it]2025-08-27 15:54:26,146 | Epoch 5/40 - client 2 -  Training Loss: 27.107

 67%|######6   | 2/3 [03:27<01:27, 87.67s/it] 2025-08-27 15:56:40,912 | Epoch 5/40 - client 0 -  Training Loss: 31.313

100%|##########| 3/3 [05:42<00:00, 109.17s/it]
100%|##########| 3/3 [05:42<00:00, 114.04s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.59s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.16s/it]
100%|##########| 3/3 [00:15<00:00,  4.43s/it]
100%|##########| 3/3 [00:15<00:00,  5.11s/it]
2025-08-27 15:56:56,261 | Epoch5 Valid:
2025-08-27 15:56:56,261 | domain:Movies
2025-08-27 15:56:56,262 | model_moe:
2025-08-27 15:56:56,262 | MRR: 0.1504
2025-08-27 15:56:56,262 | HR @1|5|10: 0.0919 	 0.2011 	 0.2622 	
2025-08-27 15:56:56,263 | NDCG @5|10: 0.1481 	 0.1678
2025-08-27 15:56:56,263 | domain:Books
2025-08-27 15:56:56,263 | model_moe:
2025-08-27 15:56:56,263 | MRR: 0.1239
2025-08-27 15:56:56,264 | HR @1|5|10: 0.0731 	 0.1624 	 0.2203 	
2025-08-27 15:56:56,264 | NDCG @5|10: 0.1191 	 0.1378
2025-08-27 15:56:56,264 | domain:Games
2025-08-27 15:56:56,265 | model_moe:
2025-08-27 15:56:56,265 | MRR: 0.0991
2025-08-27 15:56:56,265 | HR @1|5|10: 0.0742 	 0.1157 	 0.1419 	
2025-08-27 15:56:56,265 | NDCG @5|10: 0.0953 	 0.1038
2025-08-27 15:56:56,266 | 	avg_model_moe:
2025-08-27 15:56:56,266 | MRR: 0.1245
2025-08-27 15:56:56,266 | HR @1|5|10: 0.0797 	 0.1598 	 0.2081 	
2025-08-27 15:56:56,266 | NDCG @5|10: 0.1209 	 0.1365
2025-08-27 15:56:56,267 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:00:11,733 | Epoch 6/40 - client 1 -  Training Loss: 28.017

 33%|###3      | 1/3 [03:13<06:27, 193.70s/it]2025-08-27 16:02:26,538 | Epoch 6/40 - client 0 -  Training Loss: 30.398

 67%|######6   | 2/3 [05:28<02:39, 159.06s/it]2025-08-27 16:02:39,361 | Epoch 6/40 - client 2 -  Training Loss: 26.110

100%|##########| 3/3 [05:41<00:00, 92.28s/it] 
100%|##########| 3/3 [05:41<00:00, 113.78s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.57s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.06s/it]
100%|##########| 3/3 [00:15<00:00,  4.37s/it]
100%|##########| 3/3 [00:15<00:00,  5.05s/it]
2025-08-27 16:02:54,524 | Epoch6 Valid:
2025-08-27 16:02:54,524 | domain:Movies
2025-08-27 16:02:54,525 | model_moe:
2025-08-27 16:02:54,525 | MRR: 0.1579
2025-08-27 16:02:54,525 | HR @1|5|10: 0.0973 	 0.2115 	 0.2756 	
2025-08-27 16:02:54,526 | NDCG @5|10: 0.1558 	 0.1765
2025-08-27 16:02:54,526 | domain:Books
2025-08-27 16:02:54,526 | model_moe:
2025-08-27 16:02:54,527 | MRR: 0.1301
2025-08-27 16:02:54,527 | HR @1|5|10: 0.0778 	 0.1717 	 0.2305 	
2025-08-27 16:02:54,527 | NDCG @5|10: 0.1260 	 0.1449
2025-08-27 16:02:54,527 | domain:Games
2025-08-27 16:02:54,528 | model_moe:
2025-08-27 16:02:54,528 | MRR: 0.1099
2025-08-27 16:02:54,528 | HR @1|5|10: 0.0822 	 0.1295 	 0.1579 	
2025-08-27 16:02:54,528 | NDCG @5|10: 0.1069 	 0.1161
2025-08-27 16:02:54,529 | 	avg_model_moe:
2025-08-27 16:02:54,529 | MRR: 0.1326
2025-08-27 16:02:54,529 | HR @1|5|10: 0.0858 	 0.1709 	 0.2213 	
2025-08-27 16:02:54,530 | NDCG @5|10: 0.1296 	 0.1459
2025-08-27 16:02:54,530 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:05:11,838 | Epoch 7/40 - client 0 -  Training Loss: 29.635

 33%|###3      | 1/3 [02:15<04:31, 135.56s/it]2025-08-27 16:08:26,745 | Epoch 7/40 - client 1 -  Training Loss: 27.019

 67%|######6   | 2/3 [05:30<02:50, 170.47s/it]2025-08-27 16:08:39,679 | Epoch 7/40 - client 2 -  Training Loss: 25.216

100%|##########| 3/3 [05:43<00:00, 98.54s/it] 
100%|##########| 3/3 [05:43<00:00, 114.47s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.60s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.19s/it]
100%|##########| 3/3 [00:15<00:00,  4.47s/it]
100%|##########| 3/3 [00:15<00:00,  5.15s/it]
2025-08-27 16:08:55,138 | Epoch7 Valid:
2025-08-27 16:08:55,138 | domain:Movies
2025-08-27 16:08:55,139 | model_moe:
2025-08-27 16:08:55,139 | MRR: 0.1628
2025-08-27 16:08:55,139 | HR @1|5|10: 0.1006 	 0.2183 	 0.2810 	
2025-08-27 16:08:55,140 | NDCG @5|10: 0.1612 	 0.1814
2025-08-27 16:08:55,140 | domain:Books
2025-08-27 16:08:55,140 | model_moe:
2025-08-27 16:08:55,140 | MRR: 0.1326
2025-08-27 16:08:55,141 | HR @1|5|10: 0.0796 	 0.1757 	 0.2346 	
2025-08-27 16:08:55,141 | NDCG @5|10: 0.1287 	 0.1477
2025-08-27 16:08:55,141 | domain:Games
2025-08-27 16:08:55,142 | model_moe:
2025-08-27 16:08:55,142 | MRR: 0.1165
2025-08-27 16:08:55,142 | HR @1|5|10: 0.0895 	 0.1368 	 0.1587 	
2025-08-27 16:08:55,142 | NDCG @5|10: 0.1140 	 0.1209
2025-08-27 16:08:55,143 | 	avg_model_moe:
2025-08-27 16:08:55,143 | MRR: 0.1373
2025-08-27 16:08:55,143 | HR @1|5|10: 0.0899 	 0.1769 	 0.2247 	
2025-08-27 16:08:55,143 | NDCG @5|10: 0.1346 	 0.1500
2025-08-27 16:08:55,144 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:11:12,049 | Epoch 8/40 - client 0 -  Training Loss: 29.014

 33%|###3      | 1/3 [02:14<04:29, 134.94s/it]2025-08-27 16:11:24,947 | Epoch 8/40 - client 2 -  Training Loss: 24.488

 67%|######6   | 2/3 [02:27<01:03, 63.15s/it] 2025-08-27 16:14:39,490 | Epoch 8/40 - client 1 -  Training Loss: 26.252

100%|##########| 3/3 [05:42<00:00, 123.15s/it]
100%|##########| 3/3 [05:42<00:00, 114.13s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.51s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.01s/it]
100%|##########| 3/3 [00:15<00:00,  4.35s/it]
100%|##########| 3/3 [00:15<00:00,  5.02s/it]
2025-08-27 16:14:54,556 | Epoch8 Valid:
2025-08-27 16:14:54,556 | domain:Movies
2025-08-27 16:14:54,556 | model_moe:
2025-08-27 16:14:54,557 | MRR: 0.1655
2025-08-27 16:14:54,557 | HR @1|5|10: 0.1024 	 0.2221 	 0.2870 	
2025-08-27 16:14:54,557 | NDCG @5|10: 0.1639 	 0.1849
2025-08-27 16:14:54,558 | domain:Books
2025-08-27 16:14:54,558 | model_moe:
2025-08-27 16:14:54,558 | MRR: 0.1393
2025-08-27 16:14:54,558 | HR @1|5|10: 0.0843 	 0.1830 	 0.2436 	
2025-08-27 16:14:54,559 | NDCG @5|10: 0.1353 	 0.1549
2025-08-27 16:14:54,559 | domain:Games
2025-08-27 16:14:54,559 | model_moe:
2025-08-27 16:14:54,559 | MRR: 0.1226
2025-08-27 16:14:54,560 | HR @1|5|10: 0.0946 	 0.1412 	 0.1710 	
2025-08-27 16:14:54,560 | NDCG @5|10: 0.1193 	 0.1288
2025-08-27 16:14:54,560 | 	avg_model_moe:
2025-08-27 16:14:54,561 | MRR: 0.1425
2025-08-27 16:14:54,561 | HR @1|5|10: 0.0938 	 0.1821 	 0.2339 	
2025-08-27 16:14:54,561 | NDCG @5|10: 0.1395 	 0.1562
2025-08-27 16:14:54,561 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:15:09,033 | Epoch 9/40 - client 2 -  Training Loss: 23.916

 33%|###3      | 1/3 [00:12<00:25, 12.74s/it]2025-08-27 16:17:23,159 | Epoch 9/40 - client 0 -  Training Loss: 28.484

 67%|######6   | 2/3 [02:26<01:24, 84.14s/it]2025-08-27 16:20:36,831 | Epoch 9/40 - client 1 -  Training Loss: 25.644

100%|##########| 3/3 [05:40<00:00, 134.16s/it]
100%|##########| 3/3 [05:40<00:00, 113.51s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.72s/it]
 67%|######6   | 2/3 [00:14<00:07,  7.24s/it]
100%|##########| 3/3 [00:15<00:00,  4.47s/it]
100%|##########| 3/3 [00:15<00:00,  5.17s/it]
2025-08-27 16:20:52,349 | Epoch9 Valid:
2025-08-27 16:20:52,349 | domain:Movies
2025-08-27 16:20:52,350 | model_moe:
2025-08-27 16:20:52,350 | MRR: 0.1687
2025-08-27 16:20:52,350 | HR @1|5|10: 0.1033 	 0.2299 	 0.2939 	
2025-08-27 16:20:52,351 | NDCG @5|10: 0.1683 	 0.1890
2025-08-27 16:20:52,351 | domain:Books
2025-08-27 16:20:52,351 | model_moe:
2025-08-27 16:20:52,352 | MRR: 0.1463
2025-08-27 16:20:52,352 | HR @1|5|10: 0.0896 	 0.1945 	 0.2556 	
2025-08-27 16:20:52,352 | NDCG @5|10: 0.1434 	 0.1631
2025-08-27 16:20:52,352 | domain:Games
2025-08-27 16:20:52,353 | model_moe:
2025-08-27 16:20:52,353 | MRR: 0.1237
2025-08-27 16:20:52,353 | HR @1|5|10: 0.0946 	 0.1456 	 0.1761 	
2025-08-27 16:20:52,354 | NDCG @5|10: 0.1210 	 0.1308
2025-08-27 16:20:52,354 | 	avg_model_moe:
2025-08-27 16:20:52,354 | MRR: 0.1462
2025-08-27 16:20:52,354 | HR @1|5|10: 0.0958 	 0.1900 	 0.2418 	
2025-08-27 16:20:52,355 | NDCG @5|10: 0.1442 	 0.1610
2025-08-27 16:20:52,355 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:24:08,550 | Epoch 10/40 - client 1 -  Training Loss: 25.132

 33%|###3      | 1/3 [03:14<06:28, 194.04s/it]2025-08-27 16:26:23,437 | Epoch 10/40 - client 0 -  Training Loss: 28.015

 67%|######6   | 2/3 [05:28<02:39, 159.24s/it]2025-08-27 16:26:36,365 | Epoch 10/40 - client 2 -  Training Loss: 23.417

100%|##########| 3/3 [05:41<00:00, 92.43s/it] 
100%|##########| 3/3 [05:41<00:00, 113.95s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.52s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.99s/it]
100%|##########| 3/3 [00:15<00:00,  4.33s/it]
100%|##########| 3/3 [00:15<00:00,  5.00s/it]
2025-08-27 16:26:51,391 | Epoch10 Valid:
2025-08-27 16:26:51,392 | domain:Movies
2025-08-27 16:26:51,392 | model_moe:
2025-08-27 16:26:51,392 | MRR: 0.1737
2025-08-27 16:26:51,393 | HR @1|5|10: 0.1073 	 0.2343 	 0.3046 	
2025-08-27 16:26:51,393 | NDCG @5|10: 0.1727 	 0.1954
2025-08-27 16:26:51,393 | domain:Books
2025-08-27 16:26:51,394 | model_moe:
2025-08-27 16:26:51,395 | MRR: 0.1497
2025-08-27 16:26:51,395 | HR @1|5|10: 0.0920 	 0.1977 	 0.2605 	
2025-08-27 16:26:51,396 | NDCG @5|10: 0.1466 	 0.1669
2025-08-27 16:26:51,396 | domain:Games
2025-08-27 16:26:51,396 | model_moe:
2025-08-27 16:26:51,396 | MRR: 0.1274
2025-08-27 16:26:51,397 | HR @1|5|10: 0.0968 	 0.1507 	 0.1769 	
2025-08-27 16:26:51,398 | NDCG @5|10: 0.1254 	 0.1337
2025-08-27 16:26:51,399 | 	avg_model_moe:
2025-08-27 16:26:51,399 | MRR: 0.1503
2025-08-27 16:26:51,399 | HR @1|5|10: 0.0987 	 0.1942 	 0.2473 	
2025-08-27 16:26:51,399 | NDCG @5|10: 0.1482 	 0.1654
2025-08-27 16:26:51,400 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:27:06,223 | Epoch 11/40 - client 2 -  Training Loss: 22.982

 33%|###3      | 1/3 [00:12<00:25, 12.86s/it]2025-08-27 16:29:21,203 | Epoch 11/40 - client 0 -  Training Loss: 27.585

 67%|######6   | 2/3 [02:27<01:24, 84.70s/it]2025-08-27 16:32:35,565 | Epoch 11/40 - client 1 -  Training Loss: 24.669

100%|##########| 3/3 [05:42<00:00, 134.77s/it]
100%|##########| 3/3 [05:42<00:00, 114.07s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.51s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.99s/it]
100%|##########| 3/3 [00:15<00:00,  4.33s/it]
100%|##########| 3/3 [00:15<00:00,  5.00s/it]
2025-08-27 16:32:50,604 | Epoch11 Valid:
2025-08-27 16:32:50,605 | domain:Movies
2025-08-27 16:32:50,605 | model_moe:
2025-08-27 16:32:50,606 | MRR: 0.1761
2025-08-27 16:32:50,606 | HR @1|5|10: 0.1092 	 0.2368 	 0.3070 	
2025-08-27 16:32:50,606 | NDCG @5|10: 0.1751 	 0.1978
2025-08-27 16:32:50,606 | domain:Books
2025-08-27 16:32:50,607 | model_moe:
2025-08-27 16:32:50,607 | MRR: 0.1531
2025-08-27 16:32:50,607 | HR @1|5|10: 0.0949 	 0.2025 	 0.2661 	
2025-08-27 16:32:50,608 | NDCG @5|10: 0.1503 	 0.1708
2025-08-27 16:32:50,608 | domain:Games
2025-08-27 16:32:50,609 | model_moe:
2025-08-27 16:32:50,610 | MRR: 0.1263
2025-08-27 16:32:50,610 | HR @1|5|10: 0.0975 	 0.1507 	 0.1732 	
2025-08-27 16:32:50,610 | NDCG @5|10: 0.1245 	 0.1317
2025-08-27 16:32:50,611 | 	avg_model_moe:
2025-08-27 16:32:50,611 | MRR: 0.1518
2025-08-27 16:32:50,611 | HR @1|5|10: 0.1005 	 0.1966 	 0.2488 	
2025-08-27 16:32:50,611 | NDCG @5|10: 0.1500 	 0.1668
2025-08-27 16:32:50,612 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:33:05,752 | Epoch 12/40 - client 2 -  Training Loss: 22.605

 33%|###3      | 1/3 [00:12<00:25, 12.76s/it]2025-08-27 16:36:19,186 | Epoch 12/40 - client 1 -  Training Loss: 24.260

 67%|######6   | 2/3 [03:26<01:59, 119.04s/it]2025-08-27 16:38:33,299 | Epoch 12/40 - client 0 -  Training Loss: 27.201

100%|##########| 3/3 [05:40<00:00, 125.92s/it]
100%|##########| 3/3 [05:40<00:00, 113.43s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:13,  6.60s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.03s/it]
100%|##########| 3/3 [00:15<00:00,  4.35s/it]
100%|##########| 3/3 [00:15<00:00,  5.03s/it]
2025-08-27 16:38:48,407 | Epoch12 Valid:
2025-08-27 16:38:48,407 | domain:Movies
2025-08-27 16:38:48,407 | model_moe:
2025-08-27 16:38:48,408 | MRR: 0.1791
2025-08-27 16:38:48,408 | HR @1|5|10: 0.1113 	 0.2425 	 0.3108 	
2025-08-27 16:38:48,408 | NDCG @5|10: 0.1789 	 0.2009
2025-08-27 16:38:48,408 | domain:Books
2025-08-27 16:38:48,409 | model_moe:
2025-08-27 16:38:48,409 | MRR: 0.1543
2025-08-27 16:38:48,409 | HR @1|5|10: 0.0938 	 0.2061 	 0.2679 	
2025-08-27 16:38:48,409 | NDCG @5|10: 0.1519 	 0.1719
2025-08-27 16:38:48,410 | domain:Games
2025-08-27 16:38:48,410 | model_moe:
2025-08-27 16:38:48,410 | MRR: 0.1236
2025-08-27 16:38:48,411 | HR @1|5|10: 0.0939 	 0.1463 	 0.1718 	
2025-08-27 16:38:48,411 | NDCG @5|10: 0.1211 	 0.1292
2025-08-27 16:38:48,411 | 	avg_model_moe:
2025-08-27 16:38:48,411 | MRR: 0.1523
2025-08-27 16:38:48,412 | HR @1|5|10: 0.0997 	 0.1983 	 0.2501 	
2025-08-27 16:38:48,412 | NDCG @5|10: 0.1506 	 0.1673
2025-08-27 16:38:48,412 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:41:04,166 | Epoch 13/40 - client 0 -  Training Loss: 26.845

 33%|###3      | 1/3 [02:13<04:27, 133.82s/it]2025-08-27 16:41:16,743 | Epoch 13/40 - client 2 -  Training Loss: 22.270

 67%|######6   | 2/3 [02:26<01:02, 62.50s/it] 2025-08-27 16:44:29,490 | Epoch 13/40 - client 1 -  Training Loss: 23.889

100%|##########| 3/3 [05:39<00:00, 121.97s/it]
100%|##########| 3/3 [05:39<00:00, 113.05s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.44s/it]
 67%|######6   | 2/3 [00:13<00:07,  7.02s/it]
100%|##########| 3/3 [00:15<00:00,  4.34s/it]
100%|##########| 3/3 [00:15<00:00,  5.01s/it]
2025-08-27 16:44:44,522 | Epoch13 Valid:
2025-08-27 16:44:44,523 | domain:Movies
2025-08-27 16:44:44,523 | model_moe:
2025-08-27 16:44:44,523 | MRR: 0.1819
2025-08-27 16:44:44,523 | HR @1|5|10: 0.1127 	 0.2459 	 0.3148 	
2025-08-27 16:44:44,524 | NDCG @5|10: 0.1817 	 0.2039
2025-08-27 16:44:44,524 | domain:Books
2025-08-27 16:44:44,524 | model_moe:
2025-08-27 16:44:44,525 | MRR: 0.1590
2025-08-27 16:44:44,525 | HR @1|5|10: 0.0984 	 0.2121 	 0.2738 	
2025-08-27 16:44:44,525 | NDCG @5|10: 0.1569 	 0.1769
2025-08-27 16:44:44,525 | domain:Games
2025-08-27 16:44:44,526 | model_moe:
2025-08-27 16:44:44,526 | MRR: 0.1277
2025-08-27 16:44:44,526 | HR @1|5|10: 0.0975 	 0.1514 	 0.1812 	
2025-08-27 16:44:44,526 | NDCG @5|10: 0.1254 	 0.1348
2025-08-27 16:44:44,527 | 	avg_model_moe:
2025-08-27 16:44:44,527 | MRR: 0.1562
2025-08-27 16:44:44,527 | HR @1|5|10: 0.1029 	 0.2031 	 0.2566 	
2025-08-27 16:44:44,528 | NDCG @5|10: 0.1547 	 0.1719
2025-08-27 16:44:44,528 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:44:59,242 | Epoch 14/40 - client 2 -  Training Loss: 21.960

 33%|###3      | 1/3 [00:12<00:25, 12.55s/it]2025-08-27 16:47:12,186 | Epoch 14/40 - client 0 -  Training Loss: 26.520

 67%|######6   | 2/3 [02:25<01:23, 83.37s/it]2025-08-27 16:50:24,471 | Epoch 14/40 - client 1 -  Training Loss: 23.546

100%|##########| 3/3 [05:37<00:00, 133.10s/it]
100%|##########| 3/3 [05:37<00:00, 112.59s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.39s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.87s/it]
100%|##########| 3/3 [00:14<00:00,  4.25s/it]
100%|##########| 3/3 [00:14<00:00,  4.91s/it]
2025-08-27 16:50:39,212 | Epoch14 Valid:
2025-08-27 16:50:39,213 | domain:Movies
2025-08-27 16:50:39,213 | model_moe:
2025-08-27 16:50:39,213 | MRR: 0.1828
2025-08-27 16:50:39,213 | HR @1|5|10: 0.1137 	 0.2453 	 0.3168 	
2025-08-27 16:50:39,214 | NDCG @5|10: 0.1821 	 0.2052
2025-08-27 16:50:39,214 | domain:Books
2025-08-27 16:50:39,214 | model_moe:
2025-08-27 16:50:39,215 | MRR: 0.1588
2025-08-27 16:50:39,215 | HR @1|5|10: 0.0974 	 0.2136 	 0.2761 	
2025-08-27 16:50:39,215 | NDCG @5|10: 0.1571 	 0.1773
2025-08-27 16:50:39,215 | domain:Games
2025-08-27 16:50:39,216 | model_moe:
2025-08-27 16:50:39,216 | MRR: 0.1265
2025-08-27 16:50:39,216 | HR @1|5|10: 0.0961 	 0.1492 	 0.1790 	
2025-08-27 16:50:39,217 | NDCG @5|10: 0.1234 	 0.1331
2025-08-27 16:50:39,217 | 	avg_model_moe:
2025-08-27 16:50:39,217 | MRR: 0.1560
2025-08-27 16:50:39,217 | HR @1|5|10: 0.1024 	 0.2027 	 0.2573 	
2025-08-27 16:50:39,218 | NDCG @5|10: 0.1542 	 0.1718
2025-08-27 16:50:39,218 | Early Stopping counter: 1 out of 5
2025-08-27 16:50:39,218 | Learning rate decay counter: 1 out of 1
2025-08-27 16:50:39,218 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:52:52,241 | Epoch 15/40 - client 0 -  Training Loss: 26.211

 33%|###3      | 1/3 [02:13<04:26, 133.03s/it]2025-08-27 16:53:04,771 | Epoch 15/40 - client 2 -  Training Loss: 21.702

 67%|######6   | 2/3 [02:25<01:02, 62.14s/it] 2025-08-27 16:56:17,019 | Epoch 15/40 - client 1 -  Training Loss: 23.234

100%|##########| 3/3 [05:37<00:00, 121.56s/it]
100%|##########| 3/3 [05:37<00:00, 112.60s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.43s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.93s/it]
100%|##########| 3/3 [00:14<00:00,  4.28s/it]
100%|##########| 3/3 [00:14<00:00,  4.95s/it]
2025-08-27 16:56:31,877 | Epoch15 Valid:
2025-08-27 16:56:31,878 | domain:Movies
2025-08-27 16:56:31,878 | model_moe:
2025-08-27 16:56:31,878 | MRR: 0.1850
2025-08-27 16:56:31,878 | HR @1|5|10: 0.1160 	 0.2489 	 0.3168 	
2025-08-27 16:56:31,879 | NDCG @5|10: 0.1848 	 0.2067
2025-08-27 16:56:31,879 | domain:Books
2025-08-27 16:56:31,879 | model_moe:
2025-08-27 16:56:31,880 | MRR: 0.1590
2025-08-27 16:56:31,880 | HR @1|5|10: 0.0979 	 0.2133 	 0.2802 	
2025-08-27 16:56:31,880 | NDCG @5|10: 0.1571 	 0.1787
2025-08-27 16:56:31,880 | domain:Games
2025-08-27 16:56:31,881 | model_moe:
2025-08-27 16:56:31,881 | MRR: 0.1277
2025-08-27 16:56:31,881 | HR @1|5|10: 0.0975 	 0.1514 	 0.1790 	
2025-08-27 16:56:31,881 | NDCG @5|10: 0.1251 	 0.1338
2025-08-27 16:56:31,882 | 	avg_model_moe:
2025-08-27 16:56:31,882 | MRR: 0.1572
2025-08-27 16:56:31,882 | HR @1|5|10: 0.1038 	 0.2045 	 0.2587 	
2025-08-27 16:56:31,883 | NDCG @5|10: 0.1557 	 0.1731
2025-08-27 16:56:31,883 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 16:56:46,173 | Epoch 16/40 - client 2 -  Training Loss: 21.463

 33%|###3      | 1/3 [00:12<00:25, 12.52s/it]2025-08-27 16:59:58,083 | Epoch 16/40 - client 1 -  Training Loss: 22.950

 67%|######6   | 2/3 [03:24<01:58, 118.05s/it]2025-08-27 17:02:10,670 | Epoch 16/40 - client 0 -  Training Loss: 25.932

100%|##########| 3/3 [05:37<00:00, 124.68s/it]
100%|##########| 3/3 [05:37<00:00, 112.34s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.39s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.87s/it]
100%|##########| 3/3 [00:14<00:00,  4.24s/it]
100%|##########| 3/3 [00:14<00:00,  4.90s/it]
2025-08-27 17:02:25,405 | Epoch16 Valid:
2025-08-27 17:02:25,406 | domain:Movies
2025-08-27 17:02:25,406 | model_moe:
2025-08-27 17:02:25,406 | MRR: 0.1861
2025-08-27 17:02:25,406 | HR @1|5|10: 0.1169 	 0.2495 	 0.3213 	
2025-08-27 17:02:25,407 | NDCG @5|10: 0.1855 	 0.2086
2025-08-27 17:02:25,407 | domain:Books
2025-08-27 17:02:25,410 | model_moe:
2025-08-27 17:02:25,410 | MRR: 0.1602
2025-08-27 17:02:25,410 | HR @1|5|10: 0.0978 	 0.2119 	 0.2807 	
2025-08-27 17:02:25,410 | NDCG @5|10: 0.1573 	 0.1795
2025-08-27 17:02:25,411 | domain:Games
2025-08-27 17:02:25,411 | model_moe:
2025-08-27 17:02:25,411 | MRR: 0.1241
2025-08-27 17:02:25,413 | HR @1|5|10: 0.0939 	 0.1499 	 0.1790 	
2025-08-27 17:02:25,413 | NDCG @5|10: 0.1219 	 0.1311
2025-08-27 17:02:25,413 | 	avg_model_moe:
2025-08-27 17:02:25,413 | MRR: 0.1568
2025-08-27 17:02:25,414 | HR @1|5|10: 0.1028 	 0.2038 	 0.2603 	
2025-08-27 17:02:25,414 | NDCG @5|10: 0.1549 	 0.1731
2025-08-27 17:02:25,414 | Early Stopping counter: 1 out of 5
2025-08-27 17:02:25,416 | Learning rate decay counter: 1 out of 1
2025-08-27 17:02:25,416 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:02:37,975 | Epoch 17/40 - client 2 -  Training Loss: 21.233

 33%|###3      | 1/3 [00:12<00:25, 12.56s/it]2025-08-27 17:05:49,828 | Epoch 17/40 - client 1 -  Training Loss: 22.677

 67%|######6   | 2/3 [03:24<01:58, 118.03s/it]2025-08-27 17:08:02,600 | Epoch 17/40 - client 0 -  Training Loss: 25.656

100%|##########| 3/3 [05:37<00:00, 124.76s/it]
100%|##########| 3/3 [05:37<00:00, 112.40s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.42s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.92s/it]
100%|##########| 3/3 [00:14<00:00,  4.28s/it]
100%|##########| 3/3 [00:14<00:00,  4.94s/it]
2025-08-27 17:08:17,445 | Epoch17 Valid:
2025-08-27 17:08:17,445 | domain:Movies
2025-08-27 17:08:17,446 | model_moe:
2025-08-27 17:08:17,446 | MRR: 0.1868
2025-08-27 17:08:17,446 | HR @1|5|10: 0.1170 	 0.2506 	 0.3232 	
2025-08-27 17:08:17,447 | NDCG @5|10: 0.1863 	 0.2097
2025-08-27 17:08:17,447 | domain:Books
2025-08-27 17:08:17,447 | model_moe:
2025-08-27 17:08:17,447 | MRR: 0.1606
2025-08-27 17:08:17,448 | HR @1|5|10: 0.0984 	 0.2133 	 0.2796 	
2025-08-27 17:08:17,448 | NDCG @5|10: 0.1581 	 0.1796
2025-08-27 17:08:17,448 | domain:Games
2025-08-27 17:08:17,449 | model_moe:
2025-08-27 17:08:17,449 | MRR: 0.1249
2025-08-27 17:08:17,449 | HR @1|5|10: 0.0932 	 0.1492 	 0.1798 	
2025-08-27 17:08:17,449 | NDCG @5|10: 0.1219 	 0.1318
2025-08-27 17:08:17,450 | 	avg_model_moe:
2025-08-27 17:08:17,450 | MRR: 0.1574
2025-08-27 17:08:17,450 | HR @1|5|10: 0.1028 	 0.2044 	 0.2609 	
2025-08-27 17:08:17,450 | NDCG @5|10: 0.1554 	 0.1737
2025-08-27 17:08:17,451 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:10:32,536 | Epoch 18/40 - client 0 -  Training Loss: 25.406

 33%|###3      | 1/3 [02:13<04:26, 133.18s/it]2025-08-27 17:13:44,530 | Epoch 18/40 - client 1 -  Training Loss: 22.429

 67%|######6   | 2/3 [05:25<02:47, 167.77s/it]2025-08-27 17:13:57,007 | Epoch 18/40 - client 2 -  Training Loss: 21.035

100%|##########| 3/3 [05:37<00:00, 96.86s/it] 
100%|##########| 3/3 [05:37<00:00, 112.55s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.40s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.89s/it]
100%|##########| 3/3 [00:14<00:00,  4.26s/it]
100%|##########| 3/3 [00:14<00:00,  4.92s/it]
2025-08-27 17:14:11,777 | Epoch18 Valid:
2025-08-27 17:14:11,778 | domain:Movies
2025-08-27 17:14:11,778 | model_moe:
2025-08-27 17:14:11,778 | MRR: 0.1873
2025-08-27 17:14:11,778 | HR @1|5|10: 0.1181 	 0.2491 	 0.3229 	
2025-08-27 17:14:11,779 | NDCG @5|10: 0.1862 	 0.2100
2025-08-27 17:14:11,779 | domain:Books
2025-08-27 17:14:11,779 | model_moe:
2025-08-27 17:14:11,780 | MRR: 0.1621
2025-08-27 17:14:11,780 | HR @1|5|10: 0.0998 	 0.2155 	 0.2812 	
2025-08-27 17:14:11,780 | NDCG @5|10: 0.1599 	 0.1811
2025-08-27 17:14:11,780 | domain:Games
2025-08-27 17:14:11,781 | model_moe:
2025-08-27 17:14:11,781 | MRR: 0.1208
2025-08-27 17:14:11,781 | HR @1|5|10: 0.0866 	 0.1521 	 0.1820 	
2025-08-27 17:14:11,782 | NDCG @5|10: 0.1198 	 0.1294
2025-08-27 17:14:11,782 | 	avg_model_moe:
2025-08-27 17:14:11,782 | MRR: 0.1567
2025-08-27 17:14:11,782 | HR @1|5|10: 0.1015 	 0.2056 	 0.2620 	
2025-08-27 17:14:11,783 | NDCG @5|10: 0.1553 	 0.1735
2025-08-27 17:14:11,783 | Early Stopping counter: 1 out of 5
2025-08-27 17:14:11,783 | Learning rate decay counter: 1 out of 1
2025-08-27 17:14:11,784 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:14:24,243 | Epoch 19/40 - client 2 -  Training Loss: 20.837

 33%|###3      | 1/3 [00:12<00:24, 12.46s/it]2025-08-27 17:17:36,028 | Epoch 19/40 - client 1 -  Training Loss: 22.207

 67%|######6   | 2/3 [03:24<01:57, 117.94s/it]2025-08-27 17:19:48,818 | Epoch 19/40 - client 0 -  Training Loss: 25.165

100%|##########| 3/3 [05:37<00:00, 124.73s/it]
100%|##########| 3/3 [05:37<00:00, 112.35s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.41s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.90s/it]
100%|##########| 3/3 [00:14<00:00,  4.26s/it]
100%|##########| 3/3 [00:14<00:00,  4.92s/it]
2025-08-27 17:20:03,609 | Epoch19 Valid:
2025-08-27 17:20:03,611 | domain:Movies
2025-08-27 17:20:03,611 | model_moe:
2025-08-27 17:20:03,612 | MRR: 0.1877
2025-08-27 17:20:03,612 | HR @1|5|10: 0.1188 	 0.2515 	 0.3198 	
2025-08-27 17:20:03,612 | NDCG @5|10: 0.1874 	 0.2094
2025-08-27 17:20:03,612 | domain:Books
2025-08-27 17:20:03,613 | model_moe:
2025-08-27 17:20:03,613 | MRR: 0.1599
2025-08-27 17:20:03,613 | HR @1|5|10: 0.0972 	 0.2157 	 0.2793 	
2025-08-27 17:20:03,614 | NDCG @5|10: 0.1584 	 0.1789
2025-08-27 17:20:03,614 | domain:Games
2025-08-27 17:20:03,614 | model_moe:
2025-08-27 17:20:03,614 | MRR: 0.1197
2025-08-27 17:20:03,615 | HR @1|5|10: 0.0852 	 0.1463 	 0.1805 	
2025-08-27 17:20:03,615 | NDCG @5|10: 0.1170 	 0.1282
2025-08-27 17:20:03,615 | 	avg_model_moe:
2025-08-27 17:20:03,616 | MRR: 0.1558
2025-08-27 17:20:03,616 | HR @1|5|10: 0.1004 	 0.2045 	 0.2599 	
2025-08-27 17:20:03,616 | NDCG @5|10: 0.1543 	 0.1722
2025-08-27 17:20:03,616 | Early Stopping counter: 2 out of 5
2025-08-27 17:20:03,617 | Learning rate decay counter: 1 out of 1
2025-08-27 17:20:03,617 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:20:16,119 | Epoch 20/40 - client 2 -  Training Loss: 20.656

 33%|###3      | 1/3 [00:12<00:25, 12.50s/it]2025-08-27 17:22:28,839 | Epoch 20/40 - client 0 -  Training Loss: 24.937

 67%|######6   | 2/3 [02:25<01:23, 83.22s/it]2025-08-27 17:25:40,961 | Epoch 20/40 - client 1 -  Training Loss: 21.989

100%|##########| 3/3 [05:37<00:00, 132.95s/it]
100%|##########| 3/3 [05:37<00:00, 112.45s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.37s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.88s/it]
100%|##########| 3/3 [00:14<00:00,  4.25s/it]
100%|##########| 3/3 [00:14<00:00,  4.91s/it]
2025-08-27 17:25:55,728 | Epoch20 Valid:
2025-08-27 17:25:55,728 | domain:Movies
2025-08-27 17:25:55,729 | model_moe:
2025-08-27 17:25:55,729 | MRR: 0.1879
2025-08-27 17:25:55,729 | HR @1|5|10: 0.1193 	 0.2509 	 0.3203 	
2025-08-27 17:25:55,730 | NDCG @5|10: 0.1873 	 0.2097
2025-08-27 17:25:55,730 | domain:Books
2025-08-27 17:25:55,730 | model_moe:
2025-08-27 17:25:55,730 | MRR: 0.1607
2025-08-27 17:25:55,731 | HR @1|5|10: 0.0975 	 0.2140 	 0.2790 	
2025-08-27 17:25:55,731 | NDCG @5|10: 0.1583 	 0.1794
2025-08-27 17:25:55,731 | domain:Games
2025-08-27 17:25:55,732 | model_moe:
2025-08-27 17:25:55,732 | MRR: 0.1189
2025-08-27 17:25:55,732 | HR @1|5|10: 0.0844 	 0.1463 	 0.1769 	
2025-08-27 17:25:55,732 | NDCG @5|10: 0.1164 	 0.1263
2025-08-27 17:25:55,733 | 	avg_model_moe:
2025-08-27 17:25:55,733 | MRR: 0.1558
2025-08-27 17:25:55,733 | HR @1|5|10: 0.1004 	 0.2037 	 0.2587 	
2025-08-27 17:25:55,734 | NDCG @5|10: 0.1540 	 0.1718
2025-08-27 17:25:55,734 | Early Stopping counter: 3 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:26:08,211 | Epoch 21/40 - client 2 -  Training Loss: 20.491

 33%|###3      | 1/3 [00:12<00:24, 12.48s/it]2025-08-27 17:28:21,036 | Epoch 21/40 - client 0 -  Training Loss: 24.729

 67%|######6   | 2/3 [02:25<01:23, 83.27s/it]2025-08-27 17:31:33,224 | Epoch 21/40 - client 1 -  Training Loss: 21.786

100%|##########| 3/3 [05:37<00:00, 133.01s/it]
100%|##########| 3/3 [05:37<00:00, 112.50s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.39s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.89s/it]
100%|##########| 3/3 [00:14<00:00,  4.26s/it]
100%|##########| 3/3 [00:14<00:00,  4.92s/it]
2025-08-27 17:31:48,001 | Epoch21 Valid:
2025-08-27 17:31:48,003 | domain:Movies
2025-08-27 17:31:48,003 | model_moe:
2025-08-27 17:31:48,003 | MRR: 0.1865
2025-08-27 17:31:48,004 | HR @1|5|10: 0.1174 	 0.2486 	 0.3197 	
2025-08-27 17:31:48,004 | NDCG @5|10: 0.1855 	 0.2085
2025-08-27 17:31:48,004 | domain:Books
2025-08-27 17:31:48,005 | model_moe:
2025-08-27 17:31:48,007 | MRR: 0.1598
2025-08-27 17:31:48,007 | HR @1|5|10: 0.0973 	 0.2128 	 0.2761 	
2025-08-27 17:31:48,008 | NDCG @5|10: 0.1574 	 0.1780
2025-08-27 17:31:48,008 | domain:Games
2025-08-27 17:31:48,008 | model_moe:
2025-08-27 17:31:48,009 | MRR: 0.1169
2025-08-27 17:31:48,009 | HR @1|5|10: 0.0822 	 0.1477 	 0.1805 	
2025-08-27 17:31:48,012 | NDCG @5|10: 0.1155 	 0.1259
2025-08-27 17:31:48,013 | 	avg_model_moe:
2025-08-27 17:31:48,013 | MRR: 0.1544
2025-08-27 17:31:48,013 | HR @1|5|10: 0.0990 	 0.2031 	 0.2588 	
2025-08-27 17:31:48,013 | NDCG @5|10: 0.1528 	 0.1708
2025-08-27 17:31:48,014 | Early Stopping counter: 4 out of 5
2025-08-27 17:31:48,014 | Learning rate decay counter: 1 out of 1
2025-08-27 17:31:48,016 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:34:00,990 | Epoch 22/40 - client 0 -  Training Loss: 24.531

 33%|###3      | 1/3 [02:12<04:25, 132.77s/it]2025-08-27 17:34:13,486 | Epoch 22/40 - client 2 -  Training Loss: 20.332

 67%|######6   | 2/3 [02:25<01:02, 62.02s/it] 2025-08-27 17:37:25,639 | Epoch 22/40 - client 1 -  Training Loss: 21.604

100%|##########| 3/3 [05:37<00:00, 121.44s/it]
100%|##########| 3/3 [05:37<00:00, 112.47s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:06<00:12,  6.43s/it]
 67%|######6   | 2/3 [00:13<00:06,  6.91s/it]
100%|##########| 3/3 [00:14<00:00,  4.28s/it]
100%|##########| 3/3 [00:14<00:00,  4.94s/it]
2025-08-27 17:37:40,475 | Epoch22 Valid:
2025-08-27 17:37:40,476 | domain:Movies
2025-08-27 17:37:40,476 | model_moe:
2025-08-27 17:37:40,476 | MRR: 0.1856
2025-08-27 17:37:40,477 | HR @1|5|10: 0.1158 	 0.2496 	 0.3184 	
2025-08-27 17:37:40,477 | NDCG @5|10: 0.1852 	 0.2075
2025-08-27 17:37:40,477 | domain:Books
2025-08-27 17:37:40,477 | model_moe:
2025-08-27 17:37:40,478 | MRR: 0.1605
2025-08-27 17:37:40,478 | HR @1|5|10: 0.0982 	 0.2147 	 0.2823 	
2025-08-27 17:37:40,478 | NDCG @5|10: 0.1584 	 0.1801
2025-08-27 17:37:40,479 | domain:Games
2025-08-27 17:37:40,479 | model_moe:
2025-08-27 17:37:40,479 | MRR: 0.1177
2025-08-27 17:37:40,479 | HR @1|5|10: 0.0837 	 0.1419 	 0.1783 	
2025-08-27 17:37:40,482 | NDCG @5|10: 0.1138 	 0.1258
2025-08-27 17:37:40,482 | 	avg_model_moe:
2025-08-27 17:37:40,483 | MRR: 0.1546
2025-08-27 17:37:40,483 | HR @1|5|10: 0.0992 	 0.2021 	 0.2597 	
2025-08-27 17:37:40,483 | NDCG @5|10: 0.1525 	 0.1711
2025-08-27 17:37:40,483 | Early Stopping counter: 5 out of 5
2025-08-27 17:37:40,484 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:08<00:17,  8.79s/it]
 67%|######6   | 2/3 [00:18<00:09,  9.45s/it]
100%|##########| 3/3 [00:20<00:00,  5.89s/it]
100%|##########| 3/3 [00:20<00:00,  6.79s/it]
2025-08-27 17:38:00,842 | Test:
2025-08-27 17:38:00,842 | domain:Movies
2025-08-27 17:38:00,843 | model_moe:
2025-08-27 17:38:00,843 | MRR: 0.1906
2025-08-27 17:38:00,843 | HR @1|5|10: 0.1212 	 0.2523 	 0.3226 	
2025-08-27 17:38:00,844 | NDCG @5|10: 0.1902 	 0.2129
2025-08-27 17:38:00,844 | domain:Books
2025-08-27 17:38:00,844 | model_moe:
2025-08-27 17:38:00,844 | MRR: 0.1345
2025-08-27 17:38:00,845 | HR @1|5|10: 0.0842 	 0.1751 	 0.2334 	
2025-08-27 17:38:00,845 | NDCG @5|10: 0.1310 	 0.1498
2025-08-27 17:38:00,845 | domain:Games
2025-08-27 17:38:00,845 | model_moe:
2025-08-27 17:38:00,846 | MRR: 0.0785
2025-08-27 17:38:00,846 | HR @1|5|10: 0.0485 	 0.1011 	 0.1267 	
2025-08-27 17:38:00,846 | NDCG @5|10: 0.0760 	 0.0842
2025-08-27 17:38:00,847 | 	avg_model_moe:
2025-08-27 17:38:00,847 | MRR: 0.1345
2025-08-27 17:38:00,847 | HR @1|5|10: 0.0846 	 0.1762 	 0.2276 	
2025-08-27 17:38:00,847 | NDCG @5|10: 0.1324 	 0.1490
/mnt/beegfs/home/reco/liuyu/FMoE-CDSR/local_graph.py:14: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
2025-08-27 17:40:53,215 | Running with the following configs:
	domains : ['Sports', 'Garden', 'Home']
	load_prep : False
	max_seq_len : 16
	log_dir : log
	cuda : True
	gpu : 0
	epochs : 40
	local_epoch : 3
	optimizer : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 10
	batch_size : 256
	seed : 42
	eval_interval : 1
	frac : 1.0
	mu : 0
	checkpoint_dir : checkpoint
	id : 0
	do_eval : False
	es_patience : 5
	ld_patience : 1
	alpha : 1.0
	beta : 0.1
	omega : 0.1
	anneal_cap : 0.01
	total_annealing_step : 10000
	temperature : 1.0
	sim : dot


  0%|          | 0/3 [00:00<?, ?it/s]/home/reco/.conda/envs/feddcsr-4090/lib/python3.8/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
2025-08-27 17:41:20,551 | Epoch 1/40 - client 1 -  Training Loss: 23.170

 33%|###3      | 1/3 [00:27<00:54, 27.33s/it]2025-08-27 17:43:07,044 | Epoch 1/40 - client 2 -  Training Loss: 27.573

 67%|######6   | 2/3 [02:13<01:13, 73.90s/it]2025-08-27 17:46:10,601 | Epoch 1/40 - client 0 -  Training Loss: 28.834

100%|##########| 3/3 [05:17<00:00, 123.97s/it]
100%|##########| 3/3 [05:17<00:00, 105.79s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.60s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.20s/it]
100%|##########| 3/3 [00:18<00:00,  5.83s/it]
100%|##########| 3/3 [00:18<00:00,  6.10s/it]
2025-08-27 17:46:28,914 | Epoch1 Valid:
2025-08-27 17:46:28,915 | domain:Sports
2025-08-27 17:46:28,915 | model_moe:
2025-08-27 17:46:28,915 | MRR: 0.0336
2025-08-27 17:46:28,915 | HR @1|5|10: 0.0188 	 0.0377 	 0.0525 	
2025-08-27 17:46:28,916 | NDCG @5|10: 0.0285 	 0.0332
2025-08-27 17:46:28,916 | domain:Garden
2025-08-27 17:46:28,916 | model_moe:
2025-08-27 17:46:28,917 | MRR: 0.0432
2025-08-27 17:46:28,917 | HR @1|5|10: 0.0280 	 0.0478 	 0.0618 	
2025-08-27 17:46:28,917 | NDCG @5|10: 0.0387 	 0.0431
2025-08-27 17:46:28,917 | domain:Home
2025-08-27 17:46:28,918 | model_moe:
2025-08-27 17:46:28,918 | MRR: 0.0472
2025-08-27 17:46:28,918 | HR @1|5|10: 0.0333 	 0.0530 	 0.0643 	
2025-08-27 17:46:28,919 | NDCG @5|10: 0.0434 	 0.0470
2025-08-27 17:46:28,919 | 	avg_model_moe:
2025-08-27 17:46:28,919 | MRR: 0.0413
2025-08-27 17:46:28,919 | HR @1|5|10: 0.0267 	 0.0462 	 0.0595 	
2025-08-27 17:46:28,920 | NDCG @5|10: 0.0368 	 0.0411
2025-08-27 17:46:28,920 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:48:17,948 | Epoch 2/40 - client 2 -  Training Loss: 23.626

 33%|###3      | 1/3 [01:46<03:32, 106.25s/it]2025-08-27 17:51:21,062 | Epoch 2/40 - client 0 -  Training Loss: 24.364

 67%|######6   | 2/3 [04:49<02:31, 151.47s/it]2025-08-27 17:51:41,934 | Epoch 2/40 - client 1 -  Training Loss: 20.170

100%|##########| 3/3 [05:10<00:00, 91.83s/it] 
100%|##########| 3/3 [05:10<00:00, 103.41s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.52s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.16s/it]
100%|##########| 3/3 [00:18<00:00,  5.77s/it]
100%|##########| 3/3 [00:18<00:00,  6.04s/it]
2025-08-27 17:52:00,069 | Epoch2 Valid:
2025-08-27 17:52:00,069 | domain:Sports
2025-08-27 17:52:00,070 | model_moe:
2025-08-27 17:52:00,070 | MRR: 0.0572
2025-08-27 17:52:00,070 | HR @1|5|10: 0.0421 	 0.0635 	 0.0752 	
2025-08-27 17:52:00,071 | NDCG @5|10: 0.0532 	 0.0569
2025-08-27 17:52:00,071 | domain:Garden
2025-08-27 17:52:00,071 | model_moe:
2025-08-27 17:52:00,071 | MRR: 0.0561
2025-08-27 17:52:00,072 | HR @1|5|10: 0.0410 	 0.0631 	 0.0764 	
2025-08-27 17:52:00,072 | NDCG @5|10: 0.0523 	 0.0565
2025-08-27 17:52:00,072 | domain:Home
2025-08-27 17:52:00,072 | model_moe:
2025-08-27 17:52:00,073 | MRR: 0.0561
2025-08-27 17:52:00,073 | HR @1|5|10: 0.0417 	 0.0614 	 0.0738 	
2025-08-27 17:52:00,073 | NDCG @5|10: 0.0518 	 0.0558
2025-08-27 17:52:00,074 | 	avg_model_moe:
2025-08-27 17:52:00,074 | MRR: 0.0564
2025-08-27 17:52:00,074 | HR @1|5|10: 0.0416 	 0.0627 	 0.0751 	
2025-08-27 17:52:00,074 | NDCG @5|10: 0.0524 	 0.0564
2025-08-27 17:52:00,075 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:53:48,315 | Epoch 3/40 - client 2 -  Training Loss: 19.618

 33%|###3      | 1/3 [01:45<03:31, 105.95s/it]2025-08-27 17:56:50,721 | Epoch 3/40 - client 0 -  Training Loss: 20.145

 67%|######6   | 2/3 [04:48<02:30, 150.92s/it]2025-08-27 17:57:11,544 | Epoch 3/40 - client 1 -  Training Loss: 17.529

100%|##########| 3/3 [05:09<00:00, 91.51s/it] 
100%|##########| 3/3 [05:09<00:00, 103.06s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.48s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.14s/it]
100%|##########| 3/3 [00:18<00:00,  5.73s/it]
100%|##########| 3/3 [00:18<00:00,  6.00s/it]
2025-08-27 17:57:29,566 | Epoch3 Valid:
2025-08-27 17:57:29,566 | domain:Sports
2025-08-27 17:57:29,567 | model_moe:
2025-08-27 17:57:29,567 | MRR: 0.0685
2025-08-27 17:57:29,567 | HR @1|5|10: 0.0552 	 0.0724 	 0.0843 	
2025-08-27 17:57:29,568 | NDCG @5|10: 0.0641 	 0.0679
2025-08-27 17:57:29,569 | domain:Garden
2025-08-27 17:57:29,572 | model_moe:
2025-08-27 17:57:29,572 | MRR: 0.0743
2025-08-27 17:57:29,573 | HR @1|5|10: 0.0579 	 0.0820 	 0.0956 	
2025-08-27 17:57:29,574 | NDCG @5|10: 0.0707 	 0.0750
2025-08-27 17:57:29,574 | domain:Home
2025-08-27 17:57:29,575 | model_moe:
2025-08-27 17:57:29,576 | MRR: 0.0642
2025-08-27 17:57:29,576 | HR @1|5|10: 0.0514 	 0.0662 	 0.0796 	
2025-08-27 17:57:29,577 | NDCG @5|10: 0.0591 	 0.0634
2025-08-27 17:57:29,577 | 	avg_model_moe:
2025-08-27 17:57:29,577 | MRR: 0.0690
2025-08-27 17:57:29,578 | HR @1|5|10: 0.0548 	 0.0735 	 0.0865 	
2025-08-27 17:57:29,578 | NDCG @5|10: 0.0646 	 0.0687
2025-08-27 17:57:29,580 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 17:59:18,491 | Epoch 4/40 - client 2 -  Training Loss: 16.285

 33%|###3      | 1/3 [01:46<03:32, 106.35s/it]2025-08-27 17:59:39,335 | Epoch 4/40 - client 1 -  Training Loss: 14.468

 67%|######6   | 2/3 [02:07<00:56, 56.05s/it] 2025-08-27 18:02:42,732 | Epoch 4/40 - client 0 -  Training Loss: 16.723

100%|##########| 3/3 [05:10<00:00, 114.20s/it]
100%|##########| 3/3 [05:10<00:00, 103.53s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.58s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.19s/it]
100%|##########| 3/3 [00:18<00:00,  5.80s/it]
100%|##########| 3/3 [00:18<00:00,  6.08s/it]
2025-08-27 18:03:00,987 | Epoch4 Valid:
2025-08-27 18:03:00,988 | domain:Sports
2025-08-27 18:03:00,988 | model_moe:
2025-08-27 18:03:00,988 | MRR: 0.0776
2025-08-27 18:03:00,989 | HR @1|5|10: 0.0641 	 0.0814 	 0.0934 	
2025-08-27 18:03:00,989 | NDCG @5|10: 0.0730 	 0.0769
2025-08-27 18:03:00,989 | domain:Garden
2025-08-27 18:03:00,990 | model_moe:
2025-08-27 18:03:00,990 | MRR: 0.0837
2025-08-27 18:03:00,990 | HR @1|5|10: 0.0664 	 0.0934 	 0.1087 	
2025-08-27 18:03:00,991 | NDCG @5|10: 0.0806 	 0.0855
2025-08-27 18:03:00,991 | domain:Home
2025-08-27 18:03:00,991 | model_moe:
2025-08-27 18:03:00,991 | MRR: 0.0700
2025-08-27 18:03:00,992 | HR @1|5|10: 0.0556 	 0.0747 	 0.0883 	
2025-08-27 18:03:00,992 | NDCG @5|10: 0.0656 	 0.0700
2025-08-27 18:03:00,992 | 	avg_model_moe:
2025-08-27 18:03:00,992 | MRR: 0.0771
2025-08-27 18:03:00,993 | HR @1|5|10: 0.0620 	 0.0831 	 0.0968 	
2025-08-27 18:03:00,993 | NDCG @5|10: 0.0731 	 0.0775
2025-08-27 18:03:00,993 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:06:06,885 | Epoch 5/40 - client 0 -  Training Loss: 14.523

 33%|###3      | 1/3 [03:03<06:06, 183.08s/it]2025-08-27 18:06:27,856 | Epoch 5/40 - client 1 -  Training Loss: 12.129

 67%|######6   | 2/3 [03:24<01:27, 87.72s/it] 2025-08-27 18:08:14,217 | Epoch 5/40 - client 2 -  Training Loss: 14.061

100%|##########| 3/3 [05:10<00:00, 96.23s/it]
100%|##########| 3/3 [05:10<00:00, 103.47s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.51s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.15s/it]
100%|##########| 3/3 [00:18<00:00,  5.77s/it]
100%|##########| 3/3 [00:18<00:00,  6.04s/it]
2025-08-27 18:08:32,359 | Epoch5 Valid:
2025-08-27 18:08:32,360 | domain:Sports
2025-08-27 18:08:32,360 | model_moe:
2025-08-27 18:08:32,360 | MRR: 0.0831
2025-08-27 18:08:32,361 | HR @1|5|10: 0.0687 	 0.0873 	 0.1018 	
2025-08-27 18:08:32,361 | NDCG @5|10: 0.0784 	 0.0830
2025-08-27 18:08:32,361 | domain:Garden
2025-08-27 18:08:32,361 | model_moe:
2025-08-27 18:08:32,362 | MRR: 0.0885
2025-08-27 18:08:32,362 | HR @1|5|10: 0.0716 	 0.0969 	 0.1109 	
2025-08-27 18:08:32,362 | NDCG @5|10: 0.0849 	 0.0894
2025-08-27 18:08:32,363 | domain:Home
2025-08-27 18:08:32,363 | model_moe:
2025-08-27 18:08:32,363 | MRR: 0.0751
2025-08-27 18:08:32,363 | HR @1|5|10: 0.0599 	 0.0819 	 0.0949 	
2025-08-27 18:08:32,364 | NDCG @5|10: 0.0713 	 0.0755
2025-08-27 18:08:32,364 | 	avg_model_moe:
2025-08-27 18:08:32,364 | MRR: 0.0822
2025-08-27 18:08:32,364 | HR @1|5|10: 0.0667 	 0.0887 	 0.1026 	
2025-08-27 18:08:32,365 | NDCG @5|10: 0.0782 	 0.0826
2025-08-27 18:08:32,365 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:11:38,091 | Epoch 6/40 - client 0 -  Training Loss: 13.090

 33%|###3      | 1/3 [03:03<06:06, 183.19s/it]2025-08-27 18:11:58,790 | Epoch 6/40 - client 1 -  Training Loss: 10.553

 67%|######6   | 2/3 [03:23<01:27, 87.61s/it] 2025-08-27 18:13:44,888 | Epoch 6/40 - client 2 -  Training Loss: 12.571

100%|##########| 3/3 [05:09<00:00, 96.05s/it]
100%|##########| 3/3 [05:09<00:00, 103.33s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.52s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.15s/it]
100%|##########| 3/3 [00:18<00:00,  5.77s/it]
100%|##########| 3/3 [00:18<00:00,  6.04s/it]
2025-08-27 18:14:03,021 | Epoch6 Valid:
2025-08-27 18:14:03,021 | domain:Sports
2025-08-27 18:14:03,022 | model_moe:
2025-08-27 18:14:03,022 | MRR: 0.0857
2025-08-27 18:14:03,022 | HR @1|5|10: 0.0711 	 0.0905 	 0.1031 	
2025-08-27 18:14:03,022 | NDCG @5|10: 0.0812 	 0.0853
2025-08-27 18:14:03,023 | domain:Garden
2025-08-27 18:14:03,023 | model_moe:
2025-08-27 18:14:03,023 | MRR: 0.0904
2025-08-27 18:14:03,024 | HR @1|5|10: 0.0729 	 0.0982 	 0.1145 	
2025-08-27 18:14:03,024 | NDCG @5|10: 0.0865 	 0.0917
2025-08-27 18:14:03,024 | domain:Home
2025-08-27 18:14:03,024 | model_moe:
2025-08-27 18:14:03,025 | MRR: 0.0767
2025-08-27 18:14:03,025 | HR @1|5|10: 0.0604 	 0.0833 	 0.0963 	
2025-08-27 18:14:03,025 | NDCG @5|10: 0.0728 	 0.0770
2025-08-27 18:14:03,025 | 	avg_model_moe:
2025-08-27 18:14:03,026 | MRR: 0.0842
2025-08-27 18:14:03,026 | HR @1|5|10: 0.0681 	 0.0907 	 0.1047 	
2025-08-27 18:14:03,026 | NDCG @5|10: 0.0802 	 0.0847
2025-08-27 18:14:03,027 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:15:51,728 | Epoch 7/40 - client 2 -  Training Loss: 11.572

 33%|###3      | 1/3 [01:46<03:32, 106.44s/it]2025-08-27 18:18:55,079 | Epoch 7/40 - client 0 -  Training Loss: 12.095

 67%|######6   | 2/3 [04:49<02:31, 151.68s/it]2025-08-27 18:19:15,936 | Epoch 7/40 - client 1 -  Training Loss: 9.492

100%|##########| 3/3 [05:10<00:00, 91.94s/it] 
100%|##########| 3/3 [05:10<00:00, 103.55s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.56s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.17s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.05s/it]
2025-08-27 18:19:34,111 | Epoch7 Valid:
2025-08-27 18:19:34,112 | domain:Sports
2025-08-27 18:19:34,112 | model_moe:
2025-08-27 18:19:34,112 | MRR: 0.0868
2025-08-27 18:19:34,113 | HR @1|5|10: 0.0719 	 0.0918 	 0.1050 	
2025-08-27 18:19:34,113 | NDCG @5|10: 0.0823 	 0.0865
2025-08-27 18:19:34,113 | domain:Garden
2025-08-27 18:19:34,113 | model_moe:
2025-08-27 18:19:34,114 | MRR: 0.0902
2025-08-27 18:19:34,114 | HR @1|5|10: 0.0716 	 0.1005 	 0.1158 	
2025-08-27 18:19:34,114 | NDCG @5|10: 0.0871 	 0.0920
2025-08-27 18:19:34,115 | domain:Home
2025-08-27 18:19:34,115 | model_moe:
2025-08-27 18:19:34,115 | MRR: 0.0769
2025-08-27 18:19:34,115 | HR @1|5|10: 0.0610 	 0.0832 	 0.0963 	
2025-08-27 18:19:34,116 | NDCG @5|10: 0.0730 	 0.0772
2025-08-27 18:19:34,116 | 	avg_model_moe:
2025-08-27 18:19:34,116 | MRR: 0.0846
2025-08-27 18:19:34,116 | HR @1|5|10: 0.0682 	 0.0918 	 0.1057 	
2025-08-27 18:19:34,117 | NDCG @5|10: 0.0808 	 0.0852
2025-08-27 18:19:34,117 | Validation score increased.  Saving model ...

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:21:22,287 | Epoch 8/40 - client 2 -  Training Loss: 10.778

 33%|###3      | 1/3 [01:45<03:31, 105.90s/it]2025-08-27 18:21:43,199 | Epoch 8/40 - client 1 -  Training Loss: 8.695

 67%|######6   | 2/3 [02:06<00:55, 55.91s/it] 2025-08-27 18:24:45,473 | Epoch 8/40 - client 0 -  Training Loss: 11.295

100%|##########| 3/3 [05:09<00:00, 113.61s/it]
100%|##########| 3/3 [05:09<00:00, 103.03s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.51s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.17s/it]
100%|##########| 3/3 [00:18<00:00,  5.89s/it]
100%|##########| 3/3 [00:18<00:00,  6.13s/it]
2025-08-27 18:25:03,878 | Epoch8 Valid:
2025-08-27 18:25:03,879 | domain:Sports
2025-08-27 18:25:03,879 | model_moe:
2025-08-27 18:25:03,879 | MRR: 0.0867
2025-08-27 18:25:03,879 | HR @1|5|10: 0.0713 	 0.0929 	 0.1066 	
2025-08-27 18:25:03,880 | NDCG @5|10: 0.0825 	 0.0869
2025-08-27 18:25:03,880 | domain:Garden
2025-08-27 18:25:03,880 | model_moe:
2025-08-27 18:25:03,881 | MRR: 0.0893
2025-08-27 18:25:03,881 | HR @1|5|10: 0.0696 	 0.0986 	 0.1171 	
2025-08-27 18:25:03,881 | NDCG @5|10: 0.0856 	 0.0915
2025-08-27 18:25:03,881 | domain:Home
2025-08-27 18:25:03,882 | model_moe:
2025-08-27 18:25:03,882 | MRR: 0.0764
2025-08-27 18:25:03,882 | HR @1|5|10: 0.0603 	 0.0840 	 0.0960 	
2025-08-27 18:25:03,883 | NDCG @5|10: 0.0729 	 0.0767
2025-08-27 18:25:03,883 | 	avg_model_moe:
2025-08-27 18:25:03,883 | MRR: 0.0841
2025-08-27 18:25:03,883 | HR @1|5|10: 0.0670 	 0.0918 	 0.1066 	
2025-08-27 18:25:03,884 | NDCG @5|10: 0.0803 	 0.0850
2025-08-27 18:25:03,884 | Early Stopping counter: 1 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:25:24,615 | Epoch 9/40 - client 1 -  Training Loss: 8.055

 33%|###3      | 1/3 [00:20<00:41, 20.73s/it]2025-08-27 18:27:10,373 | Epoch 9/40 - client 2 -  Training Loss: 10.091

 67%|######6   | 2/3 [02:06<01:10, 70.75s/it]2025-08-27 18:30:12,482 | Epoch 9/40 - client 0 -  Training Loss: 10.589

100%|##########| 3/3 [05:08<00:00, 121.60s/it]
100%|##########| 3/3 [05:08<00:00, 102.87s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.73s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.27s/it]
100%|##########| 3/3 [00:18<00:00,  5.88s/it]
100%|##########| 3/3 [00:18<00:00,  6.16s/it]
2025-08-27 18:30:30,995 | Epoch9 Valid:
2025-08-27 18:30:30,995 | domain:Sports
2025-08-27 18:30:30,996 | model_moe:
2025-08-27 18:30:30,996 | MRR: 0.0863
2025-08-27 18:30:30,996 | HR @1|5|10: 0.0700 	 0.0926 	 0.1076 	
2025-08-27 18:30:30,996 | NDCG @5|10: 0.0820 	 0.0868
2025-08-27 18:30:30,997 | domain:Garden
2025-08-27 18:30:30,997 | model_moe:
2025-08-27 18:30:30,997 | MRR: 0.0896
2025-08-27 18:30:30,998 | HR @1|5|10: 0.0699 	 0.1005 	 0.1181 	
2025-08-27 18:30:30,998 | NDCG @5|10: 0.0864 	 0.0919
2025-08-27 18:30:30,998 | domain:Home
2025-08-27 18:30:30,998 | model_moe:
2025-08-27 18:30:31,000 | MRR: 0.0765
2025-08-27 18:30:31,000 | HR @1|5|10: 0.0603 	 0.0836 	 0.0959 	
2025-08-27 18:30:31,001 | NDCG @5|10: 0.0728 	 0.0768
2025-08-27 18:30:31,001 | 	avg_model_moe:
2025-08-27 18:30:31,001 | MRR: 0.0841
2025-08-27 18:30:31,001 | HR @1|5|10: 0.0667 	 0.0922 	 0.1072 	
2025-08-27 18:30:31,002 | NDCG @5|10: 0.0804 	 0.0852
2025-08-27 18:30:31,002 | Early Stopping counter: 2 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:32:16,857 | Epoch 10/40 - client 2 -  Training Loss: 9.485

 33%|###3      | 1/3 [01:45<03:31, 105.86s/it]2025-08-27 18:32:37,436 | Epoch 10/40 - client 1 -  Training Loss: 7.535

 67%|######6   | 2/3 [02:06<00:55, 55.69s/it] 2025-08-27 18:35:39,944 | Epoch 10/40 - client 0 -  Training Loss: 9.969

100%|##########| 3/3 [05:08<00:00, 113.60s/it]
100%|##########| 3/3 [05:08<00:00, 102.98s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.51s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.14s/it]
100%|##########| 3/3 [00:18<00:00,  5.75s/it]
100%|##########| 3/3 [00:18<00:00,  6.02s/it]
2025-08-27 18:35:58,034 | Epoch10 Valid:
2025-08-27 18:35:58,034 | domain:Sports
2025-08-27 18:35:58,037 | model_moe:
2025-08-27 18:35:58,037 | MRR: 0.0860
2025-08-27 18:35:58,038 | HR @1|5|10: 0.0696 	 0.0931 	 0.1078 	
2025-08-27 18:35:58,038 | NDCG @5|10: 0.0818 	 0.0865
2025-08-27 18:35:58,038 | domain:Garden
2025-08-27 18:35:58,039 | model_moe:
2025-08-27 18:35:58,039 | MRR: 0.0900
2025-08-27 18:35:58,039 | HR @1|5|10: 0.0699 	 0.0992 	 0.1191 	
2025-08-27 18:35:58,040 | NDCG @5|10: 0.0861 	 0.0924
2025-08-27 18:35:58,040 | domain:Home
2025-08-27 18:35:58,040 | model_moe:
2025-08-27 18:35:58,040 | MRR: 0.0762
2025-08-27 18:35:58,041 | HR @1|5|10: 0.0601 	 0.0831 	 0.0952 	
2025-08-27 18:35:58,041 | NDCG @5|10: 0.0725 	 0.0764
2025-08-27 18:35:58,041 | 	avg_model_moe:
2025-08-27 18:35:58,042 | MRR: 0.0841
2025-08-27 18:35:58,042 | HR @1|5|10: 0.0665 	 0.0918 	 0.1074 	
2025-08-27 18:35:58,042 | NDCG @5|10: 0.0801 	 0.0851
2025-08-27 18:35:58,042 | Early Stopping counter: 3 out of 5

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:39:00,377 | Epoch 11/40 - client 0 -  Training Loss: 9.421

 33%|###3      | 1/3 [03:02<06:04, 182.33s/it]2025-08-27 18:39:20,949 | Epoch 11/40 - client 1 -  Training Loss: 7.093

 67%|######6   | 2/3 [03:22<01:27, 87.18s/it] 2025-08-27 18:41:07,033 | Epoch 11/40 - client 2 -  Training Loss: 8.968

100%|##########| 3/3 [05:08<00:00, 95.81s/it]
100%|##########| 3/3 [05:08<00:00, 103.00s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:18,  9.40s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.09s/it]
100%|##########| 3/3 [00:17<00:00,  5.69s/it]
100%|##########| 3/3 [00:17<00:00,  5.96s/it]
2025-08-27 18:41:24,935 | Epoch11 Valid:
2025-08-27 18:41:24,935 | domain:Sports
2025-08-27 18:41:24,936 | model_moe:
2025-08-27 18:41:24,936 | MRR: 0.0864
2025-08-27 18:41:24,936 | HR @1|5|10: 0.0693 	 0.0934 	 0.1085 	
2025-08-27 18:41:24,937 | NDCG @5|10: 0.0821 	 0.0870
2025-08-27 18:41:24,937 | domain:Garden
2025-08-27 18:41:24,937 | model_moe:
2025-08-27 18:41:24,938 | MRR: 0.0888
2025-08-27 18:41:24,938 | HR @1|5|10: 0.0690 	 0.0995 	 0.1174 	
2025-08-27 18:41:24,938 | NDCG @5|10: 0.0852 	 0.0909
2025-08-27 18:41:24,938 | domain:Home
2025-08-27 18:41:24,939 | model_moe:
2025-08-27 18:41:24,939 | MRR: 0.0758
2025-08-27 18:41:24,939 | HR @1|5|10: 0.0592 	 0.0827 	 0.0951 	
2025-08-27 18:41:24,939 | NDCG @5|10: 0.0720 	 0.0760
2025-08-27 18:41:24,940 | 	avg_model_moe:
2025-08-27 18:41:24,940 | MRR: 0.0836
2025-08-27 18:41:24,940 | HR @1|5|10: 0.0658 	 0.0919 	 0.1070 	
2025-08-27 18:41:24,941 | NDCG @5|10: 0.0798 	 0.0846
2025-08-27 18:41:24,941 | Early Stopping counter: 4 out of 5
2025-08-27 18:41:24,941 | Learning rate decay counter: 1 out of 1
2025-08-27 18:41:24,941 | Learning rate decay

  0%|          | 0/3 [00:00<?, ?it/s]2025-08-27 18:41:45,560 | Epoch 12/40 - client 1 -  Training Loss: 6.721

 33%|###3      | 1/3 [00:20<00:41, 20.62s/it]2025-08-27 18:43:31,045 | Epoch 12/40 - client 2 -  Training Loss: 8.487

 67%|######6   | 2/3 [02:06<01:10, 70.54s/it]2025-08-27 18:46:32,531 | Epoch 12/40 - client 0 -  Training Loss: 8.915

100%|##########| 3/3 [05:07<00:00, 121.20s/it]
100%|##########| 3/3 [05:07<00:00, 102.53s/it]

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:09<00:19,  9.57s/it]
 67%|######6   | 2/3 [00:11<00:05,  5.19s/it]
100%|##########| 3/3 [00:18<00:00,  5.78s/it]
100%|##########| 3/3 [00:18<00:00,  6.06s/it]
2025-08-27 18:46:50,726 | Epoch12 Valid:
2025-08-27 18:46:50,727 | domain:Sports
2025-08-27 18:46:50,727 | model_moe:
2025-08-27 18:46:50,727 | MRR: 0.0862
2025-08-27 18:46:50,728 | HR @1|5|10: 0.0691 	 0.0934 	 0.1095 	
2025-08-27 18:46:50,728 | NDCG @5|10: 0.0818 	 0.0869
2025-08-27 18:46:50,728 | domain:Garden
2025-08-27 18:46:50,729 | model_moe:
2025-08-27 18:46:50,729 | MRR: 0.0885
2025-08-27 18:46:50,729 | HR @1|5|10: 0.0686 	 0.1002 	 0.1165 	
2025-08-27 18:46:50,730 | NDCG @5|10: 0.0851 	 0.0904
2025-08-27 18:46:50,730 | domain:Home
2025-08-27 18:46:50,730 | model_moe:
2025-08-27 18:46:50,730 | MRR: 0.0751
2025-08-27 18:46:50,731 | HR @1|5|10: 0.0581 	 0.0831 	 0.0948 	
2025-08-27 18:46:50,731 | NDCG @5|10: 0.0718 	 0.0755
2025-08-27 18:46:50,731 | 	avg_model_moe:
2025-08-27 18:46:50,731 | MRR: 0.0833
2025-08-27 18:46:50,732 | HR @1|5|10: 0.0653 	 0.0922 	 0.1069 	
2025-08-27 18:46:50,732 | NDCG @5|10: 0.0795 	 0.0843
2025-08-27 18:46:50,732 | Early Stopping counter: 5 out of 5
2025-08-27 18:46:50,733 | Early stopping

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|###3      | 1/3 [00:13<00:27, 13.68s/it]
 67%|######6   | 2/3 [00:16<00:07,  7.52s/it]
100%|##########| 3/3 [00:26<00:00,  8.39s/it]
100%|##########| 3/3 [00:26<00:00,  8.77s/it]
2025-08-27 18:47:17,045 | Test:
2025-08-27 18:47:17,045 | domain:Sports
2025-08-27 18:47:17,045 | model_moe:
2025-08-27 18:47:17,046 | MRR: 0.0647
2025-08-27 18:47:17,046 | HR @1|5|10: 0.0514 	 0.0706 	 0.0799 	
2025-08-27 18:47:17,046 | NDCG @5|10: 0.0613 	 0.0643
2025-08-27 18:47:17,047 | domain:Garden
2025-08-27 18:47:17,047 | model_moe:
2025-08-27 18:47:17,047 | MRR: 0.0752
2025-08-27 18:47:17,047 | HR @1|5|10: 0.0614 	 0.0793 	 0.0944 	
2025-08-27 18:47:17,048 | NDCG @5|10: 0.0711 	 0.0759
2025-08-27 18:47:17,048 | domain:Home
2025-08-27 18:47:17,048 | model_moe:
2025-08-27 18:47:17,049 | MRR: 0.0577
2025-08-27 18:47:17,049 | HR @1|5|10: 0.0446 	 0.0630 	 0.0734 	
2025-08-27 18:47:17,049 | NDCG @5|10: 0.0543 	 0.0577
2025-08-27 18:47:17,049 | 	avg_model_moe:
2025-08-27 18:47:17,050 | MRR: 0.0659
2025-08-27 18:47:17,050 | HR @1|5|10: 0.0524 	 0.0710 	 0.0826 	
2025-08-27 18:47:17,050 | NDCG @5|10: 0.0623 	 0.0660
